import{d as ba,f as p,a as o,t as ha,c as xa,s as N}from"../chunks/Bkky6kvZ.js";import{a as wa,o as Sa,az as ya,c as n,e as t,h as l,s as c,d as e,t as U,g as ka,A as Da,ax as La,r as s,n as b,f as Ba}from"../chunks/813s5maz.js";import{i as $}from"../chunks/Bf7HnLem.js";import{h as Ca}from"../chunks/BgIwEmqo.js";import{s as Fa}from"../chunks/UKAZQVVw.js";import{s as Ma}from"../chunks/LBYG0Yba.js";import{b as Na}from"../chunks/D4jp30Ch.js";import{c as z,u as $a}from"../chunks/CbPjToI1.js";var za=p('<span class="loading-dot svelte-11l5u6u"></span> Saving...',1),Ea=p('<div class="loading-state svelte-11l5u6u"><div class="loading-spinner svelte-11l5u6u"></div> <span class="svelte-11l5u6u">Loading statistics...</span></div>'),Ta=p('<div class="stats-grid svelte-11l5u6u"><div class="stat-item svelte-11l5u6u"><span class="stat-value font-mono svelte-11l5u6u"> </span> <span class="stat-label svelte-11l5u6u">Total Readings</span></div> <div class="stat-item svelte-11l5u6u"><span class="stat-value font-mono svelte-11l5u6u"> </span> <span class="stat-label svelte-11l5u6u">Estimated Size</span></div> <div class="stat-item full-width svelte-11l5u6u"><span class="stat-label svelte-11l5u6u">Data Range</span> <span class="stat-range font-mono svelte-11l5u6u"> </span></div></div>'),Va=p('<p class="text-muted svelte-11l5u6u">No statistics available</p>'),ja=p(`<div class="page-container svelte-11l5u6u"><div class="page-header svelte-11l5u6u"><h1 class="page-title svelte-11l5u6u">Logging</h1> <p class="page-description svelte-11l5u6u">Configure local data logging and export readings</p></div> <div class="grid gap-6 md:grid-cols-2 svelte-11l5u6u"><div class="card svelte-11l5u6u"><div class="card-header svelte-11l5u6u"><h2 class="card-title svelte-11l5u6u">Settings</h2></div> <div class="card-body svelte-11l5u6u"><div class="setting-row svelte-11l5u6u"><div class="setting-info svelte-11l5u6u"><span class="setting-label svelte-11l5u6u">Local Logging</span> <span class="setting-description svelte-11l5u6u">Store readings to database</span></div> <button type="button" aria-label="Toggle local logging"><span class="toggle-slider svelte-11l5u6u"></span></button></div> <div class="setting-row svelte-11l5u6u"><div class="setting-info svelte-11l5u6u"><span class="setting-label svelte-11l5u6u">Logging Interval</span> <span class="setting-description svelte-11l5u6u">How often to save readings</span></div> <div class="interval-select svelte-11l5u6u"><select class="select-input svelte-11l5u6u"><option class="svelte-11l5u6u">1 min</option><option class="svelte-11l5u6u">5 min</option><option class="svelte-11l5u6u">10 min</option><option class="svelte-11l5u6u">15 min</option><option class="svelte-11l5u6u">30 min</option><option class="svelte-11l5u6u">60 min</option></select></div></div> <div class="mt-6 svelte-11l5u6u"><button type="button" class="btn-primary svelte-11l5u6u"><!></button></div></div></div> <div class="card svelte-11l5u6u"><div class="card-header svelte-11l5u6u"><h2 class="card-title svelte-11l5u6u">Database</h2></div> <div class="card-body svelte-11l5u6u"><!></div></div> <div class="card md:col-span-2 svelte-11l5u6u"><div class="card-header svelte-11l5u6u"><h2 class="card-title svelte-11l5u6u">Export Data</h2></div> <div class="card-body svelte-11l5u6u"><div class="export-section svelte-11l5u6u"><div class="export-info svelte-11l5u6u"><p class="export-description svelte-11l5u6u">Download all recorded readings as a CSV file. The export includes timestamp,
							tilt ID, color, beer name, raw and calibrated values for SG and temperature,
							and signal strength.</p></div> <a href="/log.csv" download="tilt_readings.csv" class="btn-secondary svelte-11l5u6u"><svg class="w-4 h-4 svelte-11l5u6u" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" class="svelte-11l5u6u"></path></svg> Download CSV</a></div></div></div></div></div>`);function Oa(W,X){wa(X,!0);let u=c(null),E=c(!0),g=c(!1),v=c(!0),_=c(15);async function Y(){try{const a=await fetch("/api/stats");a.ok&&n(u,await a.json(),!0)}catch(a){console.error("Failed to load stats:",a)}finally{n(E,!1)}}function T(){n(v,z.config.local_logging_enabled,!0),n(_,z.config.local_interval_minutes,!0)}async function Z(){n(g,!0);try{await $a({local_logging_enabled:l(v),local_interval_minutes:l(_)})}finally{n(g,!1)}}function aa(a){return!Number.isFinite(a)||a<0?"0 B":a<1024?`${a} B`:a<1024*1024?`${(a/1024).toFixed(1)} KB`:`${(a/(1024*1024)).toFixed(1)} MB`}function V(a){return a?new Date(a).toLocaleString():"N/A"}function ea(a){return a.toLocaleString()}Sa(()=>{Y(),T()}),ya(()=>{z.loaded&&T()});var h=ja();Ca("11l5u6u",a=>{Da(()=>{La.title="Logging | BrewSignal"})});var j=t(e(h),2),x=e(j),A=t(e(x),2),w=e(A),S=t(e(w),2);let I;S.__click=()=>n(v,!l(v)),s(w);var y=t(w,2),R=t(e(y),2),f=e(R),k=e(f);k.value=k.__value=1;var D=t(k);D.value=D.__value=5;var L=t(D);L.value=L.__value=10;var B=t(L);B.value=B.__value=15;var C=t(B);C.value=C.__value=30;var G=t(C);G.value=G.__value=60,s(f),s(R),s(y);var H=t(y,2),m=e(H);m.__click=Z;var sa=e(m);{var ta=a=>{var i=za();b(),o(a,i)},la=a=>{var i=ha("Save Settings");o(a,i)};$(sa,a=>{l(g)?a(ta):a(la,!1)})}s(m),s(H),s(A),s(x);var K=t(x,2),q=t(e(K),2),ia=e(q);{var na=a=>{var i=Ea();o(a,i)},va=a=>{var i=xa(),oa=Ba(i);{var ua=r=>{var d=Ta(),F=e(d),J=e(F),da=e(J,!0);s(J),b(2),s(F);var M=t(F,2),O=e(M),ca=e(O,!0);s(O),b(2),s(M);var P=t(M,2),Q=t(e(P),2),pa=e(Q);s(Q),s(P),s(d),U((ga,_a,fa,ma)=>{N(da,ga),N(ca,_a),N(pa,`${fa??""} â€” ${ma??""}`)},[()=>ea(l(u).total_readings),()=>aa(l(u).estimated_size_bytes),()=>V(l(u).oldest_reading),()=>V(l(u).newest_reading)]),o(r,d)},ra=r=>{var d=Va();o(r,d)};$(oa,r=>{l(u)?r(ua):r(ra,!1)},!0)}o(a,i)};$(ia,a=>{l(E)?a(na):a(va,!1)})}s(q),s(K),b(2),s(j),s(h),U(()=>{I=Ma(S,1,"toggle svelte-11l5u6u",null,I,{active:l(v)}),Fa(S,"aria-pressed",l(v)),f.disabled=!l(v),m.disabled=l(g)}),Na(f,()=>l(_),a=>n(_,a)),o(W,h),ka()}ba(["click"]);export{Oa as component};
