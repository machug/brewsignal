import{d as me,f as _,a as i,c as H,s as N,h as fe,t as ze}from"../chunks/BPY3LF1i.js";import{a as be,az as he,h as t,s as b,c as l,o as ye,t as x,g as ke,aC as we,e as v,d as n,u as xe,ax as Le,r as o,f as O,n as A}from"../chunks/WzhiZOZ9.js";import{i as d}from"../chunks/DTo_ih-i.js";import{h as Ce}from"../chunks/BJzfFUzm.js";import{s as Me}from"../chunks/D5Ox4mlS.js";import{b as Re}from"../chunks/l7yICoyS.js";import{s as Be,a as Se}from"../chunks/fcLv_oK9.js";import{g as L}from"../chunks/3iv9KrT2.js";import{p as $e}from"../chunks/CZsBb9cU.js";import{N as je,O as Ee}from"../chunks/K3YiLSbk.js";import{R as Ie}from"../chunks/BksCZVP8.js";const Ne=!1,at=Object.freeze(Object.defineProperty({__proto__:null,prerender:Ne},Symbol.toStringTag,{value:"Module"}));var Oe=_('<div class="loading-state svelte-1gzu0z"><div class="spinner svelte-1gzu0z"></div> <p>Loading recipe...</p></div>'),Ae=_('<div class="error-state svelte-1gzu0z"><p class="error-message svelte-1gzu0z"> </p></div>'),De=_('<span class="btn-spinner svelte-1gzu0z"></span> Analyzing...',1),Fe=fe('<svg class="btn-icon svelte-1gzu0z" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456z"></path></svg> AI Review',1),Pe=_('<span class="btn-spinner svelte-1gzu0z"></span> Saving...',1),Te=_('<div class="error-banner svelte-1gzu0z"><svg class="error-icon svelte-1gzu0z" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span class="error-text svelte-1gzu0z"> </span> <button class="error-dismiss svelte-1gzu0z" aria-label="Dismiss error"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" class="svelte-1gzu0z"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg></button></div>'),Ue=_('<div class="saving-overlay svelte-1gzu0z"><div class="spinner-large svelte-1gzu0z"></div> <span>Saving recipe...</span></div>'),qe=_('<div class="page-header svelte-1gzu0z"><div class="header-content svelte-1gzu0z"><h1 class="page-title svelte-1gzu0z">Edit Recipe</h1> <p class="page-description svelte-1gzu0z"> </p></div> <div class="header-actions svelte-1gzu0z"><button type="button" class="btn-ghost svelte-1gzu0z">Cancel</button> <span class="action-divider svelte-1gzu0z"></span> <button type="button" class="btn-review svelte-1gzu0z"><!></button> <button type="button" class="btn-save svelte-1gzu0z"><!></button></div></div> <!> <!> <!>',1),Ge=_('<div class="page-container svelte-1gzu0z"><div class="back-link svelte-1gzu0z"><a class="back-btn svelte-1gzu0z"><svg class="back-icon svelte-1gzu0z" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg> Back to Recipe</a></div> <!></div>');function st(J,K){be(K,!0);const Q=()=>Se($e,"$page",V),[V,W]=Be();let g=b(null),C=b(!0),u=b(null),h=b(!1),m=b(void 0),M=b(!1),p=xe(()=>{const e=parseInt(Q().params.id||"",10);return isNaN(e)||e<=0?null:e});he(()=>{const e=setInterval(()=>{t(m)&&l(M,t(m).getReviewLoading(),!0)},100);return()=>clearInterval(e)}),ye(async()=>{if(!t(p)){l(C,!1),L("/recipes");return}try{l(g,await je(t(p)),!0)}catch(e){l(u,e instanceof Error?e.message:"Failed to load recipe",!0)}finally{l(C,!1)}});async function X(e){if(t(p)){l(h,!0),l(u,null);try{const c={name:e.name,author:e.author||void 0,type:e.type||void 0,batch_size_liters:e.batch_size_liters,efficiency_percent:e.efficiency_percent,boil_time_minutes:e.boil_time_minutes,og:e.og,fg:e.fg,abv:e.abv,ibu:e.ibu,color_srm:e.color_srm,notes:e.notes||void 0,yeast_name:e.yeast?.name,yeast_lab:e.yeast?.producer,yeast_product_id:e.yeast?.product_id,yeast_temp_min:e.yeast?.temp_low??void 0,yeast_temp_max:e.yeast?.temp_high??void 0,yeast_attenuation:e.yeast?.attenuation_low&&e.yeast?.attenuation_high?(e.yeast.attenuation_low+e.yeast.attenuation_high)/2:void 0,format_extensions:{fermentables:e.fermentables.map(s=>({id:s.id,name:s.name,amount_kg:s.amount_kg,color_lovibond:s.color_lovibond,potential_sg:s.potential_sg,type:s.type,origin:s.origin,maltster:s.maltster})),hops:e.hops.map(s=>({id:s.id,name:s.name,amount_grams:s.amount_grams,alpha_acid_percent:s.alpha_acid_percent,boil_time_minutes:s.boil_time_minutes,use:s.use,form:s.form,origin:s.origin,purpose:s.purpose}))}};await Ee(t(p),c),L(`/recipes/${t(p)}`)}catch(c){l(u,c instanceof Error?c.message:"Failed to update recipe",!0),l(h,!1)}}}function D(){t(p)?L(`/recipes/${t(p)}`):L("/recipes")}var R=Ge();Ce("1gzu0z",e=>{we(()=>{Le.title=`Edit ${(t(g)?.name||"Recipe")??""} | BrewSignal`})});var B=n(R),Y=n(B);o(B);var Z=v(B,2);{var ee=e=>{var c=Oe();i(e,c)},te=e=>{var c=H(),s=O(c);{var ae=f=>{var z=Ae(),k=n(z),S=n(k,!0);o(k),o(z),x(()=>N(S,t(u))),i(f,z)},se=f=>{var z=H(),k=O(z);{var S=$=>{var F=qe(),j=O(F),E=n(j),P=v(n(E),2),re=n(P);o(P),o(E);var T=v(E,2),U=n(T);U.__click=D;var y=v(U,4);y.__click=()=>t(m)?.review();var ie=n(y);{var ne=a=>{var r=De();A(),i(a,r)},oe=a=>{var r=Fe();A(),i(a,r)};d(ie,a=>{t(M)?a(ne):a(oe,!1)})}o(y);var w=v(y,2);w.__click=()=>t(m)?.save();var le=n(w);{var ve=a=>{var r=Pe();A(),i(a,r)},ce=a=>{var r=ze("Save Changes");i(a,r)};d(le,a=>{t(h)?a(ve):a(ce,!1)})}o(w),o(T),o(j);var q=v(j,2);{var ue=a=>{var r=Te(),I=v(n(r),2),de=n(I,!0);o(I);var ge=v(I,2);ge.__click=()=>l(u,null),o(r),x(()=>N(de,t(u))),i(a,r)};d(q,a=>{t(u)&&a(ue)})}var G=v(q,2);{var pe=a=>{var r=Ue();i(a,r)};d(G,a=>{t(h)&&a(pe)})}var _e=v(G,2);Re(Ie(_e,{get initialData(){return t(g)},onSave:X,onCancel:D}),a=>l(m,a,!0),()=>t(m)),x(()=>{N(re,`Editing: ${t(g).name??""}`),y.disabled=t(M),w.disabled=t(h)}),i($,F)};d(k,$=>{t(g)&&$(S)},!0)}i(f,z)};d(s,f=>{t(u)&&!t(g)?f(ae):f(se,!1)},!0)}i(e,c)};d(Z,e=>{t(C)?e(ee):e(te,!1)})}o(R),x(()=>Me(Y,"href",`/recipes/${t(p)??""}`)),i(J,R),ke(),W()}me(["click"]);export{st as component,at as universal};
