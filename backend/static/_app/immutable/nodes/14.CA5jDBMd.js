import{d as oa,f as d,a as c,s as j,t as Ye,b as vt}from"../chunks/D7bl-hCC.js";import{ah as ca,aq as o,p as va,ao as da,ap as pa,aj as ha,s as n,e as ua,ak as t,al as a,c as e,ai as ct,am as _a,an as s,as as E,ar as A,at as Qe}from"../chunks/CDGrRRS4.js";import{e as fa,i as ga}from"../chunks/qsSua8e8.js";import{i as h}from"../chunks/Cg1NE5Eo.js";import{h as ma}from"../chunks/DA8KTw8j.js";import{r as U,s as L}from"../chunks/BDaOlnf6.js";import{s as I}from"../chunks/vT9oYAV7.js";import{b as P}from"../chunks/DjjCnkE4.js";import{i as ja,s as ba,b as ya}from"../chunks/Hxk7fwGZ.js";import{c as g,f as wa,u as Xe,a as Sa}from"../chunks/DsuwS_ry.js";var xa=d('<div class="loading-state svelte-hj1sc2"><div class="loading-spinner svelte-hj1sc2"></div> <span class="svelte-hj1sc2">Loading system information...</span></div>'),ka=d('<div class="info-grid svelte-hj1sc2"><div class="info-item svelte-hj1sc2"><span class="info-label svelte-hj1sc2">Hostname</span> <span class="info-value font-mono svelte-hj1sc2"> </span></div> <div class="info-item svelte-hj1sc2"><span class="info-label svelte-hj1sc2">Version</span> <span class="info-value font-mono svelte-hj1sc2"> </span></div> <div class="info-item svelte-hj1sc2"><span class="info-label svelte-hj1sc2">Uptime</span> <span class="info-value font-mono svelte-hj1sc2"> </span></div> <div class="info-item svelte-hj1sc2"><span class="info-label svelte-hj1sc2">IP Address</span> <span class="info-value font-mono svelte-hj1sc2"> </span></div></div>'),Ca=d('<p class="text-muted svelte-hj1sc2">Unable to load system information</p>'),Ta=d('<div class="setting-row sub-setting svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Smoothing Samples</span> <span class="setting-description svelte-hj1sc2">Number of readings to average</span></div> <select class="select-input-sm svelte-hj1sc2"><option class="svelte-hj1sc2">3</option><option class="svelte-hj1sc2">5</option><option class="svelte-hj1sc2">10</option><option class="svelte-hj1sc2">15</option><option class="svelte-hj1sc2">20</option></select></div>'),Aa=d('<span class="loading-dot svelte-hj1sc2"></span> Saving...',1),Fa=d('<p class="config-error svelte-hj1sc2"> </p>'),Ea=d('<p class="config-success svelte-hj1sc2">Settings saved</p>'),za=d('<option class="svelte-hj1sc2"> </option>'),Ha=d('<div class="loading-spinner-small svelte-hj1sc2"></div>'),Ma=d('<div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Connection Status</span></div> <span> </span></div>'),Ua=d("<span> </span>"),Ia=d('<span class="loading-dot svelte-hj1sc2"></span> Saving...',1),Pa=d('<p class="config-error svelte-hj1sc2"> </p>'),Ra=d('<p class="config-success svelte-hj1sc2">Settings saved</p>'),Ba=d('<!> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Home Assistant URL</span> <span class="setting-description svelte-hj1sc2">e.g., http://192.168.1.100:8123</span></div> <input type="url" placeholder="http://homeassistant.local:8123" class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Access Token</span> <span class="setting-description svelte-hj1sc2">Long-lived access token from HA profile</span></div> <input type="password" placeholder="Enter token..." class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Test Connection</span></div> <div class="test-connection svelte-hj1sc2"><button type="button" class="btn-secondary-sm svelte-hj1sc2"> </button> <!></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Ambient Temp Entity</span> <span class="setting-description svelte-hj1sc2">e.g., sensor.fermenter_room_temperature</span></div> <input type="text" placeholder="sensor.xxx_temperature" class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Ambient Humidity Entity</span> <span class="setting-description svelte-hj1sc2">Optional humidity sensor</span></div> <input type="text" placeholder="sensor.xxx_humidity" class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Weather Entity</span> <span class="setting-description svelte-hj1sc2">For forecast display, e.g., weather.home</span></div> <input type="text" placeholder="weather.home" class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Chamber Temperature Entity</span> <span class="setting-description svelte-hj1sc2">Temperature sensor inside fermentation chamber</span></div> <input type="text" placeholder="sensor.chamber_temperature" class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Chamber Humidity Entity</span> <span class="setting-description svelte-hj1sc2">Humidity sensor inside fermentation chamber</span></div> <input type="text" placeholder="sensor.chamber_humidity" class="input-field svelte-hj1sc2"/></div> <div class="mt-4 config-actions svelte-hj1sc2"><button type="button" class="btn-primary svelte-hj1sc2"><!></button> <!> <!></div>',1),Da=d('<span class="loading-dot svelte-hj1sc2"></span> Saving...',1),Oa=d('<p class="config-error svelte-hj1sc2"> </p>'),Na=d('<p class="config-success svelte-hj1sc2">Settings saved</p>'),La=d(`<p class="section-note svelte-hj1sc2">Configure heater switches per batch. These are the default settings used when a batch doesn't specify its own.</p> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Default Target Temperature</span> <span class="setting-description svelte-hj1sc2"> </span></div> <div class="input-with-unit svelte-hj1sc2"><input type="number" step="0.5" class="input-field input-number svelte-hj1sc2"/> <span class="unit svelte-hj1sc2"> </span></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Default Hysteresis</span> <span class="setting-description svelte-hj1sc2"> </span></div> <div class="input-with-unit svelte-hj1sc2"><input type="number" class="input-field input-number svelte-hj1sc2"/> <span class="unit svelte-hj1sc2"> </span></div></div> <div class="mt-4 config-actions svelte-hj1sc2"><button type="button" class="btn-primary svelte-hj1sc2"><!></button> <!> <!></div>`,1),Ja=d('<div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Temperature Control</h2></div> <div class="card-body svelte-hj1sc2"><div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Enable Temperature Control</span> <span class="setting-description svelte-hj1sc2">Automatically control heaters for batches</span></div> <button type="button" aria-label="Toggle temperature control"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <!></div></div>'),Ga=d('<div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Alert Threshold</span> <span class="setting-description svelte-hj1sc2">Alert when forecast differs from target by this amount (°C)</span></div> <div class="input-with-unit svelte-hj1sc2"><input type="number" min="1" max="15" step="0.5" class="input-field-sm svelte-hj1sc2"/> <span class="unit svelte-hj1sc2">°C</span></div></div> <p class="setting-hint mt-2 svelte-hj1sc2">Alerts are generated when the forecast high or low temperatures differ from your target fermentation temperature by more than the threshold.</p>',1),Wa=d('<span class="loading-dot svelte-hj1sc2"></span> Saving...',1),qa=d('<p class="config-error svelte-hj1sc2"> </p>'),Ka=d('<p class="config-success svelte-hj1sc2">Settings saved</p>'),Va=d('<div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Weather Alerts</h2></div> <div class="card-body svelte-hj1sc2"><div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Enable Weather Alerts</span> <span class="setting-description svelte-hj1sc2">Get alerts when forecast temps may affect fermentation</span></div> <button type="button" aria-label="Toggle weather alerts"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <!> <div class="mt-4 config-actions svelte-hj1sc2"><button type="button" class="btn-primary svelte-hj1sc2"><!></button> <!> <!></div></div></div>'),Ya=d('<div class="stat-item svelte-hj1sc2"><span class="stat-value font-mono svelte-hj1sc2"> </span> <span class="stat-label svelte-hj1sc2">Total Readings</span></div> <div class="stat-item svelte-hj1sc2"><span class="stat-value font-mono svelte-hj1sc2"> </span> <span class="stat-label svelte-hj1sc2">Estimated Size</span></div>',1),Qa=d('<p class="text-muted svelte-hj1sc2">Unable to load storage stats</p>'),Xa=d('<button type="button" class="btn-danger-sm svelte-hj1sc2"> </button>'),Za=d('<p class="cleanup-message svelte-hj1sc2"> </p>'),$a=d('<span class="loading-dot svelte-hj1sc2"></span> Rebooting...',1),en=vt('<svg class="w-4 h-4 svelte-hj1sc2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" class="svelte-hj1sc2"></path></svg> Reboot System',1),sn=d('<span class="loading-dot svelte-hj1sc2"></span> Shutting down...',1),tn=vt('<svg class="w-4 h-4 svelte-hj1sc2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" class="svelte-hj1sc2"></path></svg> Shutdown System',1),an=d('<div class="grid gap-6 svelte-hj1sc2"><div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">System Information</h2></div> <div class="card-body svelte-hj1sc2"><!></div></div> <div class="grid gap-6 md:grid-cols-2 svelte-hj1sc2"><div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Application Settings</h2></div> <div class="card-body svelte-hj1sc2"><div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Temperature Units</span> <span class="setting-description svelte-hj1sc2">Display temperature in Celsius or Fahrenheit</span></div> <div class="unit-toggle svelte-hj1sc2"><button type="button">°C</button> <button type="button">°F</button></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Gravity Units</span> <span class="setting-description svelte-hj1sc2">Display gravity as SG, Plato, or Brix</span></div> <div class="unit-toggle svelte-hj1sc2"><button type="button">SG</button> <button type="button">°P</button> <button type="button">°Bx</button></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Minimum RSSI</span> <span class="setting-description svelte-hj1sc2">Ignore readings below this signal strength</span></div> <div class="rssi-input svelte-hj1sc2"><input type="number" min="-100" max="0" class="input-field-sm svelte-hj1sc2"/> <span class="input-suffix svelte-hj1sc2">dBm</span></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Reading Smoothing</span> <span class="setting-description svelte-hj1sc2">Average multiple readings to reduce noise</span></div> <button type="button" aria-label="Toggle reading smoothing"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <!> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Identify by MAC</span> <span class="setting-description svelte-hj1sc2">Use MAC address instead of broadcast ID</span></div> <button type="button" aria-label="Toggle identify by MAC address"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <div class="mt-4 config-actions svelte-hj1sc2"><button type="button" class="btn-primary svelte-hj1sc2"><!></button> <!> <!></div></div></div> <div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Timezone</h2></div> <div class="card-body svelte-hj1sc2"><p class="section-description svelte-hj1sc2">Current timezone: <span class="font-mono text-[var(--accent)] svelte-hj1sc2"> </span></p> <div class="timezone-selector svelte-hj1sc2"><select class="select-input svelte-hj1sc2"></select> <!></div></div></div></div> <div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Home Assistant</h2></div> <div class="card-body svelte-hj1sc2"><div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Enable Integration</span> <span class="setting-description svelte-hj1sc2">Connect to Home Assistant for ambient temp and control</span></div> <button type="button" aria-label="Enable Home Assistant integration"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <!></div></div> <!> <!> <div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Storage & Data Cleanup</h2></div> <div class="card-body svelte-hj1sc2"><div class="storage-grid svelte-hj1sc2"><div class="storage-stats svelte-hj1sc2"><!></div> <div class="cleanup-section svelte-hj1sc2"><p class="section-description mb-3 svelte-hj1sc2">Remove old readings to free up storage. Readings older than the specified days will be permanently deleted.</p> <div class="cleanup-controls svelte-hj1sc2"><div class="cleanup-input-group svelte-hj1sc2"><label for="retention-days" class="svelte-hj1sc2">Keep readings from last</label> <input id="retention-days" type="number" min="1" max="365" class="input-field-sm svelte-hj1sc2"/> <span class="svelte-hj1sc2">days</span></div> <div class="cleanup-actions svelte-hj1sc2"><button type="button" class="btn-secondary-sm svelte-hj1sc2"> </button> <!></div></div> <!></div></div></div></div> <div class="card danger-zone svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Power Controls</h2></div> <div class="card-body svelte-hj1sc2"><p class="section-description danger-text svelte-hj1sc2">These actions will affect the entire system. Make sure you have saved any pending work.</p> <div class="power-buttons svelte-hj1sc2"><button type="button" class="btn-warning svelte-hj1sc2"><!></button> <button type="button" class="btn-danger svelte-hj1sc2"><!></button></div></div></div></div>'),nn=d('<div class="page-container svelte-hj1sc2"><div class="page-header svelte-hj1sc2"><h1 class="page-title svelte-hj1sc2">System</h1> <p class="page-description svelte-hj1sc2">System settings, timezone configuration, and power controls</p> <div class="header-actions svelte-hj1sc2"><a href="/system/maintenance" class="btn-secondary-link svelte-hj1sc2"><svg class="w-4 h-4 svelte-hj1sc2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" class="svelte-hj1sc2"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" class="svelte-hj1sc2"></path></svg> Data Maintenance</a></div></div> <!></div>');function fn(dt,pt){ca(pt,!0);let $=o(null),ye=o(null),Ss=o(va([])),oe=o(""),xs=o(!0),b=o(null),ce=o("C"),Y=o("sg"),we=o(-100),ee=o(!1),Se=o(5),ve=o(!1),xe=o(!1),ke=o(null),Ce=o(!1),de=o(30),B=o(null),J=o(!1),pe=o(""),he=o(""),Te=o(""),Ae=o(""),Fe=o(""),Ee=o(""),ue=o(""),ze=o(!1),se=o(null),He=o(null),Me=o(!1),Ue=o(null),Ie=o(!1),te=o(!1),Pe=o(68),_e=o(1),Re=o(!1),Be=o(null),De=o(!1),ae=o(!1),Oe=o(3),Ne=o(!1),Le=o(null),Je=o(!1),G=ct(()=>g.config.temp_units==="C"),Ge=ct(()=>e(G)?"°C":"°F");function ht(i){return e(G)?Sa(i):i}function ut(i){return e(G)?wa(i):i}async function _t(){try{const i=await fetch("/api/system/info");i.ok&&n($,await i.json(),!0)}catch(i){console.error("Failed to load system info:",i)}}async function ks(){try{const i=await fetch("/api/system/storage");i.ok&&n(ye,await i.json(),!0)}catch(i){console.error("Failed to load storage stats:",i)}}async function ft(){try{const[i,C]=await Promise.all([fetch("/api/system/timezones"),fetch("/api/system/timezone")]);if(i.ok){const z=await i.json();n(Ss,z.timezones||[],!0)}if(C.ok){const z=await C.json();n(oe,z.timezone||"UTC",!0)}}catch(i){console.error("Failed to load timezones:",i)}}function Cs(){n(ce,g.config.temp_units,!0),n(Y,g.config.sg_units,!0),n(we,g.config.min_rssi,!0),n(ee,g.config.smoothing_enabled,!0),n(Se,g.config.smoothing_samples,!0),n(ve,g.config.id_by_mac,!0),n(J,g.config.ha_enabled,!0),n(pe,g.config.ha_url,!0),n(he,g.config.ha_token,!0),n(Te,g.config.ha_ambient_temp_entity_id,!0),n(Ae,g.config.ha_ambient_humidity_entity_id,!0),n(Fe,g.config.ha_chamber_temp_entity_id,!0),n(Ee,g.config.ha_chamber_humidity_entity_id,!0),n(ue,g.config.ha_weather_entity_id,!0),n(te,g.config.temp_control_enabled,!0),n(Pe,Math.round(ut(g.config.temp_target)*2)/2),n(_e,g.config.temp_units==="C"?Math.round(g.config.temp_hysteresis*(5/9)*100)/100:g.config.temp_hysteresis,!0),n(ae,g.config.weather_alerts_enabled,!0),n(Oe,g.config.alert_temp_threshold,!0)}async function gt(){n(xe,!0),n(ke,null),n(Ce,!1);try{const i=await Xe({temp_units:e(ce),sg_units:e(Y),min_rssi:e(we),smoothing_enabled:e(ee),smoothing_samples:e(Se),id_by_mac:e(ve)});i.success?(n(Ce,!0),setTimeout(()=>n(Ce,!1),3e3)):n(ke,i.error||"Failed to save settings",!0)}finally{n(xe,!1)}}async function mt(){n(Me,!0),n(Ue,null),n(Ie,!1);try{const i=await Xe({ha_enabled:e(J),ha_url:e(pe),ha_token:e(he),ha_ambient_temp_entity_id:e(Te),ha_ambient_humidity_entity_id:e(Ae),ha_chamber_temp_entity_id:e(Fe),ha_chamber_humidity_entity_id:e(Ee),ha_weather_entity_id:e(ue)});i.success?(n(Ie,!0),setTimeout(()=>n(Ie,!1),3e3),await As()):n(Ue,i.error||"Failed to save settings",!0)}finally{n(Me,!1)}}async function jt(){n(Re,!0),n(Be,null),n(De,!1);try{const i=ht(e(Pe)),C=e(G)?e(_e)*(9/5):e(_e),z=await Xe({temp_control_enabled:e(te),temp_target:i,temp_hysteresis:C});z.success?(n(De,!0),setTimeout(()=>n(De,!1),3e3)):n(Be,z.error||"Failed to save settings",!0)}finally{n(Re,!1)}}async function bt(){n(Ne,!0),n(Le,null),n(Je,!1);try{const i=await Xe({weather_alerts_enabled:e(ae),alert_temp_threshold:e(Oe)});i.success?(n(Je,!0),setTimeout(()=>n(Je,!1),3e3)):n(Le,i.error||"Failed to save settings",!0)}finally{n(Ne,!1)}}async function yt(i){n(b,"timezone");try{(await fetch("/api/system/timezone",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({timezone:i})})).ok&&n(oe,i,!0)}catch(C){console.error("Failed to set timezone:",C)}finally{n(b,null)}}async function wt(){n(b,"cleanup-preview");try{const i=await fetch("/api/system/cleanup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({retention_days:e(de),confirm:!1})});i.ok&&n(B,await i.json(),!0)}catch(i){console.error("Failed to preview cleanup:",i)}finally{n(b,null)}}async function St(){if(!(!e(B)||e(B).readings_to_delete===0)&&confirm(`Delete ${e(B).readings_to_delete.toLocaleString()} readings older than ${e(de)} days?`)){n(b,"cleanup");try{(await fetch("/api/system/cleanup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({retention_days:e(de),confirm:!0})})).ok&&(n(B,null),await ks())}catch(i){console.error("Failed to execute cleanup:",i)}finally{n(b,null)}}}async function xt(){if(confirm("Are you sure you want to reboot the system? The UI will be unavailable until restart completes.")){n(b,"reboot");try{await fetch("/api/system/reboot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirm:!0})})}catch(i){console.error("Reboot command failed:",i)}finally{n(b,null)}}}async function kt(){if(confirm("Are you sure you want to shut down the system? You will need physical access to restart.")){n(b,"shutdown");try{await fetch("/api/system/shutdown",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirm:!0})})}catch(i){console.error("Shutdown command failed:",i)}finally{n(b,null)}}}function Ct(i){if(!i)return"Unknown";const C=Math.floor(i/86400),z=Math.floor(i%86400/3600),fe=Math.floor(i%3600/60),ne=[];return C>0&&ne.push(`${C}d`),z>0&&ne.push(`${z}h`),fe>0&&ne.push(`${fe}m`),ne.length>0?ne.join(" "):"< 1m"}function Tt(i){return!Number.isFinite(i)||i<0?"0 B":i<1024?`${i} B`:i<1024*1024?`${(i/1024).toFixed(1)} KB`:`${(i/(1024*1024)).toFixed(1)} MB`}function Ts(i){return i.toLocaleString()}async function At(){n(ze,!0),n(se,null);try{const i=await fetch("/api/ha/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e(pe),token:e(he)})});i.ok?n(se,await i.json(),!0):n(se,{success:!1,message:"Request failed"},!0)}catch{n(se,{success:!1,message:"Network error"},!0)}finally{n(ze,!1)}}async function As(){try{const i=await fetch("/api/ha/status");i.ok&&n(He,await i.json(),!0)}catch(i){console.error("Failed to load HA status:",i)}}da(async()=>{await Promise.all([_t(),ks(),ft(),As()]),Cs(),n(xs,!1)}),pa(()=>{g.loaded&&Cs()});var Ze=nn();ma("hj1sc2",i=>{ua(()=>{_a.title="System | BrewSignal"})});var Ft=t(a(Ze),2);{var Et=i=>{var C=xa();c(i,C)},zt=i=>{var C=an(),z=a(C),fe=t(a(z),2),ne=a(fe);{var Ht=l=>{var r=ka(),p=a(r),_=t(a(p),2),m=a(_,!0);s(_),s(p);var S=t(p,2),x=t(a(S),2),H=a(x);s(x),s(S);var k=t(S,2),T=t(a(k),2),M=a(T,!0);s(T),s(k);var D=t(k,2),q=t(a(D),2),Q=a(q,!0);s(q),s(D),s(r),A(O=>{j(m,e($).hostname),j(H,`v${e($).version??""}`),j(M,O),j(Q,e($).ip_addresses.length>0?e($).ip_addresses[0]:"Unknown")},[()=>Ct(e($).uptime_seconds)]),c(l,r)},Mt=l=>{var r=Ca();c(l,r)};h(ne,l=>{e($)?l(Ht):l(Mt,!1)})}s(fe),s(z);var $e=t(z,2),es=a($e),Fs=t(a(es),2),ss=a(Fs),Es=t(a(ss),2),ts=a(Es);let zs;ts.__click=()=>n(ce,"C");var Hs=t(ts,2);let Ms;Hs.__click=()=>n(ce,"F"),s(Es),s(ss);var as=t(ss,2),Us=t(a(as),2),ns=a(Us);let Is;ns.__click=()=>n(Y,"sg");var is=t(ns,2);let Ps;is.__click=()=>n(Y,"plato");var Rs=t(is,2);let Bs;Rs.__click=()=>n(Y,"brix"),s(Us),s(as);var ls=t(as,2),Ds=t(a(ls),2),Os=a(Ds);U(Os),E(2),s(Ds),s(ls);var rs=t(ls,2),os=t(a(rs),2);let Ns;os.__click=()=>n(ee,!e(ee)),s(rs);var Ls=t(rs,2);{var Ut=l=>{var r=Ta(),p=t(a(r),2),_=a(p);_.value=_.__value=3;var m=t(_);m.value=m.__value=5;var S=t(m);S.value=S.__value=10;var x=t(S);x.value=x.__value=15;var H=t(x);H.value=H.__value=20,s(p),s(r),ya(p,()=>e(Se),k=>n(Se,k)),c(l,r)};h(Ls,l=>{e(ee)&&l(Ut)})}var cs=t(Ls,2),vs=t(a(cs),2);let Js;vs.__click=()=>n(ve,!e(ve)),s(cs);var Gs=t(cs,2),ge=a(Gs);ge.__click=gt;var It=a(ge);{var Pt=l=>{var r=Aa();E(),c(l,r)},Rt=l=>{var r=Ye("Save Settings");c(l,r)};h(It,l=>{e(xe)?l(Pt):l(Rt,!1)})}s(ge);var Ws=t(ge,2);{var Bt=l=>{var r=Fa(),p=a(r,!0);s(r),A(()=>j(p,e(ke))),c(l,r)};h(Ws,l=>{e(ke)&&l(Bt)})}var Dt=t(Ws,2);{var Ot=l=>{var r=Ea();c(l,r)};h(Dt,l=>{e(Ce)&&l(Ot)})}s(Gs),s(Fs),s(es);var qs=t(es,2),Ks=t(a(qs),2),ds=a(Ks),Vs=t(a(ds)),Nt=a(Vs,!0);s(Vs),s(ds);var Ys=t(ds,2),W=a(Ys);W.__change=l=>yt(l.currentTarget.value),fa(W,21,()=>e(Ss),ga,(l,r)=>{var p=za(),_=a(p,!0);s(p);var m={};A(()=>{j(_,e(r)),m!==(m=e(r))&&(p.value=(p.__value=e(r))??"")}),c(l,p)}),s(W);var Qs;ja(W);var Lt=t(W,2);{var Jt=l=>{var r=Ha();c(l,r)};h(Lt,l=>{e(b)==="timezone"&&l(Jt)})}s(Ys),s(Ks),s(qs),s($e);var ps=t($e,2),Xs=t(a(ps),2),hs=a(Xs),us=t(a(hs),2);let Zs;us.__click=()=>n(J,!e(J)),s(hs);var Gt=t(hs,2);{var Wt=l=>{var r=Ba(),p=Qe(r);{var _=v=>{var w=Ma(),u=t(a(w),2);let F;var ws=a(u,!0);s(u),s(w),A(()=>{F=I(u,1,"status-badge svelte-hj1sc2",null,F,{connected:e(He).connected}),j(ws,e(He).connected?"Connected":"Disconnected")}),c(v,w)};h(p,v=>{e(He)&&v(_)})}var m=t(p,2),S=t(a(m),2);U(S),s(m);var x=t(m,2),H=t(a(x),2);U(H),s(x);var k=t(x,2),T=t(a(k),2),M=a(T);M.__click=At;var D=a(M,!0);s(M);var q=t(M,2);{var Q=v=>{var w=Ua();let u;var F=a(w,!0);s(w),A(()=>{u=I(w,1,"test-result svelte-hj1sc2",null,u,{success:e(se).success}),j(F,e(se).message)}),c(v,w)};h(q,v=>{e(se)&&v(Q)})}s(T),s(k);var O=t(k,2),N=t(a(O),2);U(N),s(O);var X=t(O,2),f=t(a(X),2);U(f),s(X);var y=t(X,2),R=t(a(y),2);U(R),s(y);var K=t(y,2),ie=t(a(K),2);U(ie),s(K);var Z=t(K,2),V=t(a(Z),2);U(V),s(Z);var be=t(Z,2),le=a(be);le.__click=mt;var qe=a(le);{var re=v=>{var w=Ia();E(),c(v,w)},js=v=>{var w=Ye("Save HA Settings");c(v,w)};h(qe,v=>{e(Me)?v(re):v(js,!1)})}s(le);var Ke=t(le,2);{var bs=v=>{var w=Pa(),u=a(w,!0);s(w),A(()=>j(u,e(Ue))),c(v,w)};h(Ke,v=>{e(Ue)&&v(bs)})}var Ve=t(Ke,2);{var ys=v=>{var w=Ra();c(v,w)};h(Ve,v=>{e(Ie)&&v(ys)})}s(be),A(()=>{M.disabled=e(ze)||!e(pe)||!e(he),j(D,e(ze)?"Testing...":"Test"),le.disabled=e(Me)}),P(S,()=>e(pe),v=>n(pe,v)),P(H,()=>e(he),v=>n(he,v)),P(N,()=>e(Te),v=>n(Te,v)),P(f,()=>e(Ae),v=>n(Ae,v)),P(R,()=>e(ue),v=>n(ue,v)),P(ie,()=>e(Fe),v=>n(Fe,v)),P(V,()=>e(Ee),v=>n(Ee,v)),c(l,r)};h(Gt,l=>{e(J)&&l(Wt)})}s(Xs),s(ps);var $s=t(ps,2);{var qt=l=>{var r=Ja(),p=t(a(r),2),_=a(p),m=t(a(_),2);let S;m.__click=()=>n(te,!e(te)),s(_);var x=t(_,2);{var H=k=>{var T=La(),M=t(Qe(T),2),D=a(M),q=t(a(D),2),Q=a(q);s(q),s(D);var O=t(D,2),N=a(O);U(N);var X=t(N,2),f=a(X,!0);s(X),s(O),s(M);var y=t(M,2),R=a(y),K=t(a(R),2),ie=a(K);s(K),s(R);var Z=t(R,2),V=a(Z);U(V);var be=t(V,2),le=a(be,!0);s(be),s(Z),s(y);var qe=t(y,2),re=a(qe);re.__click=jt;var js=a(re);{var Ke=u=>{var F=Da();E(),c(u,F)},bs=u=>{var F=Ye("Save Control Settings");c(u,F)};h(js,u=>{e(Re)?u(Ke):u(bs,!1)})}s(re);var Ve=t(re,2);{var ys=u=>{var F=Oa(),ws=a(F,!0);s(F),A(()=>j(ws,e(Be))),c(u,F)};h(Ve,u=>{e(Be)&&u(ys)})}var v=t(Ve,2);{var w=u=>{var F=Na();c(u,F)};h(v,u=>{e(De)&&u(w)})}s(qe),A(()=>{j(Q,`Desired fermentation temperature (${e(Ge)??""})`),L(N,"min",e(G)?0:32),L(N,"max",e(G)?38:100),j(f,e(Ge)),j(ie,`± tolerance before triggering (${e(Ge)??""})`),L(V,"min",e(G)?.3:.5),L(V,"max",e(G)?5.5:10),L(V,"step",e(G)?.25:.5),j(le,e(Ge)),re.disabled=e(Re)}),P(N,()=>e(Pe),u=>n(Pe,u)),P(V,()=>e(_e),u=>n(_e,u)),c(k,T)};h(x,k=>{e(te)&&k(H)})}s(p),s(r),A(()=>{S=I(m,1,"toggle svelte-hj1sc2",null,S,{active:e(te)}),L(m,"aria-pressed",e(te))}),c(l,r)};h($s,l=>{e(J)&&l(qt)})}var et=t($s,2);{var Kt=l=>{var r=Va(),p=t(a(r),2),_=a(p),m=t(a(_),2);let S;m.__click=()=>n(ae,!e(ae)),s(_);var x=t(_,2);{var H=f=>{var y=Ga(),R=Qe(y),K=t(a(R),2),ie=a(K);U(ie),E(2),s(K),s(R),E(2),P(ie,()=>e(Oe),Z=>n(Oe,Z)),c(f,y)};h(x,f=>{e(ae)&&f(H)})}var k=t(x,2),T=a(k);T.__click=bt;var M=a(T);{var D=f=>{var y=Wa();E(),c(f,y)},q=f=>{var y=Ye("Save Alert Settings");c(f,y)};h(M,f=>{e(Ne)?f(D):f(q,!1)})}s(T);var Q=t(T,2);{var O=f=>{var y=qa(),R=a(y,!0);s(y),A(()=>j(R,e(Le))),c(f,y)};h(Q,f=>{e(Le)&&f(O)})}var N=t(Q,2);{var X=f=>{var y=Ka();c(f,y)};h(N,f=>{e(Je)&&f(X)})}s(k),s(p),s(r),A(()=>{S=I(m,1,"toggle svelte-hj1sc2",null,S,{active:e(ae)}),L(m,"aria-pressed",e(ae)),T.disabled=e(Ne)}),c(l,r)};h(et,l=>{e(J)&&e(ue)&&l(Kt)})}var _s=t(et,2),st=t(a(_s),2),tt=a(st),fs=a(tt),Vt=a(fs);{var Yt=l=>{var r=Ya(),p=Qe(r),_=a(p),m=a(_,!0);s(_),E(2),s(p);var S=t(p,2),x=a(S),H=a(x,!0);s(x),E(2),s(S),A((k,T)=>{j(m,k),j(H,T)},[()=>Ts(e(ye).total_readings),()=>Tt(e(ye).estimated_size_bytes)]),c(l,r)},Qt=l=>{var r=Qa();c(l,r)};h(Vt,l=>{e(ye)?l(Yt):l(Qt,!1)})}s(fs);var at=t(fs,2),gs=t(a(at),2),ms=a(gs),nt=t(a(ms),2);U(nt),E(2),s(ms);var it=t(ms,2),me=a(it);me.__click=wt;var Xt=a(me,!0);s(me);var Zt=t(me,2);{var $t=l=>{var r=Xa();r.__click=St;var p=a(r,!0);s(r),A(_=>{r.disabled=e(b)!==null,j(p,_)},[()=>e(b)==="cleanup"?"Deleting...":`Delete ${Ts(e(B).readings_to_delete)} readings`]),c(l,r)};h(Zt,l=>{e(B)&&e(B).readings_to_delete>0&&l($t)})}s(it),s(gs);var ea=t(gs,2);{var sa=l=>{var r=Za(),p=a(r);s(r),A(()=>j(p,`No readings older than ${e(de)??""} days found.`)),c(l,r)};h(ea,l=>{e(B)&&e(B).readings_to_delete===0&&l(sa)})}s(at),s(tt),s(st),s(_s);var lt=t(_s,2),rt=t(a(lt),2),ot=t(a(rt),2),je=a(ot);je.__click=xt;var ta=a(je);{var aa=l=>{var r=$a();E(),c(l,r)},na=l=>{var r=en();E(),c(l,r)};h(ta,l=>{e(b)==="reboot"?l(aa):l(na,!1)})}s(je);var We=t(je,2);We.__click=kt;var ia=a(We);{var la=l=>{var r=sn();E(),c(l,r)},ra=l=>{var r=tn();E(),c(l,r)};h(ia,l=>{e(b)==="shutdown"?l(la):l(ra,!1)})}s(We),s(ot),s(rt),s(lt),s(C),A(()=>{zs=I(ts,1,"unit-btn svelte-hj1sc2",null,zs,{active:e(ce)==="C"}),Ms=I(Hs,1,"unit-btn svelte-hj1sc2",null,Ms,{active:e(ce)==="F"}),Is=I(ns,1,"unit-btn svelte-hj1sc2",null,Is,{active:e(Y)==="sg"}),Ps=I(is,1,"unit-btn svelte-hj1sc2",null,Ps,{active:e(Y)==="plato"}),Bs=I(Rs,1,"unit-btn svelte-hj1sc2",null,Bs,{active:e(Y)==="brix"}),Ns=I(os,1,"toggle svelte-hj1sc2",null,Ns,{active:e(ee)}),L(os,"aria-pressed",e(ee)),Js=I(vs,1,"toggle svelte-hj1sc2",null,Js,{active:e(ve)}),L(vs,"aria-pressed",e(ve)),ge.disabled=e(xe),j(Nt,e(oe)),W.disabled=e(b)==="timezone",Qs!==(Qs=e(oe))&&(W.value=(W.__value=e(oe))??"",ba(W,e(oe))),Zs=I(us,1,"toggle svelte-hj1sc2",null,Zs,{active:e(J)}),L(us,"aria-pressed",e(J)),me.disabled=e(b)!==null,j(Xt,e(b)==="cleanup-preview"?"Checking...":"Preview"),je.disabled=e(b)!==null,We.disabled=e(b)!==null}),P(Os,()=>e(we),l=>n(we,l)),P(nt,()=>e(de),l=>n(de,l)),c(i,C)};h(Ft,i=>{e(xs)?i(Et):i(zt,!1)})}s(Ze),c(dt,Ze),ha()}oa(["click","change"]);export{fn as component};
