import{d as St,f as _,a as v,s as m,c as Ft,e as Zt,h as wa,t as ka}from"../chunks/CCsyRfs1.js";import{a as Ct,s as g,p as rt,o as sa,c as o,e as s,g as qt,d as a,r as t,h as e,t as h,u as K,n as Xe,f as st,ax as Tt,i as Fa,ay as za,z as Ba,aw as Sa}from"../chunks/DyQh1CUw.js";import{i as x}from"../chunks/HQeVE6fZ.js";import{h as Ca}from"../chunks/BZNRDT2A.js";import{b as qa}from"../chunks/BlPaiSLK.js";import{g as ea}from"../chunks/B0NlAMNf.js";import{z as La,A as Ma,a4 as Pa,h as Aa,y as Oa,a5 as Ra,a6 as Ia,a7 as Ua}from"../chunks/DciRO_hW.js";import{e as Te,i as ut}from"../chunks/DndLTv14.js";import{h as Ta}from"../chunks/DRjuPuC8.js";import{r as Ue,b as ht}from"../chunks/DPJa9AuX.js";import{s as ra}from"../chunks/C1-3ELYM.js";import{s as yt}from"../chunks/COCsBJqH.js";import{b as at}from"../chunks/B_acRpXz.js";import{b as zt,i as ta,s as aa}from"../chunks/U9y4h8n3.js";import{p as Bt}from"../chunks/B-ZSmncO.js";import{Y as Ga}from"../chunks/B8Ai3Rw5.js";function la(p,c){return 1+p.reduce((k,z)=>{const T=(z.potential_sg-1)*1e3,te=z.amount_kg*T*8.345*(c.efficiency_percent/100)/c.batch_size_liters;return k+te},0)/1e3}function Ha(p,c){return 1+(p-1)*1e3*(1-c/100)/1e3}function ia(p,c,y="simple"){return y==="simple"?(p-c)*131.25:76.08*(p-c)/(1.775-p)*(c/.794)}function na(p,c,y){if(p.use==="dry_hop"||p.boil_time_minutes<=0)return 0;const R=1.65*Math.pow(125e-6,c-1),k=(1-Math.exp(-.04*p.boil_time_minutes))/4.15;let z=R*k;p.form==="pellet"&&(z*=1.1),p.use==="first_wort"&&(z*=1.1),p.use==="whirlpool"&&(z*=.2);const T=p.alpha_acid_percent/100*p.amount_grams*z*1e3/y;return Math.max(0,T)}function oa(p,c,y){return p.reduce((R,k)=>R+na(k,c,y),0)}function va(p,c){const y=(c-1)*1e3;return y>0?p/y:0}function ua(p,c){const y=c*.264172,R=p.reduce((z,T)=>{const te=T.amount_kg*2.20462;return z+te*T.color_srm/y},0),k=1.4922*Math.pow(R,.6859);return Math.min(40,Math.max(0,k))}function Gt(p){const c=Math.max(1,Math.min(40,p)),y={1:"#FFE699",2:"#FFD878",3:"#FFCA5A",4:"#FFBF42",5:"#FBB123",6:"#F8A600",7:"#F39C00",8:"#EA8F00",9:"#E58500",10:"#DE7C00",11:"#D77200",12:"#CF6900",13:"#CB6200",14:"#C35900",15:"#BB5100",16:"#B54C00",17:"#B04500",18:"#A63E00",19:"#A13700",20:"#9B3200",25:"#7C2900",30:"#5E1E00",35:"#401500",40:"#261000"},R=Object.keys(y).map(Number).sort((z,T)=>z-T);let k=R[0];for(const z of R)if(z<=c)k=z;else break;return y[k]||"#261000"}function Da(p){return p<2?"Pale Straw":p<3?"Straw":p<4?"Pale Gold":p<6?"Deep Gold":p<9?"Amber":p<12?"Copper":p<15?"Light Brown":p<18?"Brown":p<20?"Dark Brown":p<24?"Very Dark":p<30?"Black":"Opaque Black"}function Ea(p,c,y=330){const k=ia(p,c)*.79*7*(y/100),z=(c-1)*1e3*.4*(y/100);return Math.round(k+z)}function ja(p,c,y,R){const k=la(p,R),z=Ha(k,y.attenuation_percent),T=ia(k,z),te=oa(c,k,R.batch_size_liters),L=ua(p,R.batch_size_liters);return{og:Math.round(k*1e3)/1e3,fg:Math.round(z*1e3)/1e3,abv:Math.round(T*10)/10,ibu:Math.round(te),srm:Math.round(L*10)/10,color_hex:Gt(L),calories_per_330ml:Ea(k,z,330)}}var Na=_('<span class="stats svelte-1qls65z"> <span class="color-swatch svelte-1qls65z"></span> </span>'),Va=_('<div class="empty-state svelte-1qls65z"><p class="svelte-1qls65z">No fermentables added yet.</p> <button type="button" class="browse-btn svelte-1qls65z">Browse Library</button></div>'),Ya=_('<span class="ferm-type svelte-1qls65z"> </span>'),$a=_('<span class="detail svelte-1qls65z"> </span>'),Wa=_('<span class="detail svelte-1qls65z"> </span>'),Ja=_('<span class="detail svelte-1qls65z"> </span>'),Ka=_('<div class="ferm-item svelte-1qls65z"><div class="ferm-main svelte-1qls65z"><div class="ferm-info svelte-1qls65z"><span class="ferm-name svelte-1qls65z"> </span> <!></div> <div class="ferm-details svelte-1qls65z"><!> <!> <!></div></div> <div class="ferm-controls svelte-1qls65z"><div class="amount-input svelte-1qls65z"><input type="number" step="0.1" min="0" class="svelte-1qls65z"/> <span class="unit svelte-1qls65z">kg</span></div> <span class="percent svelte-1qls65z"> </span> <button type="button" class="remove-btn svelte-1qls65z">×</button></div></div>'),Qa=_('<div class="fermentables-list svelte-1qls65z"></div>'),Xa=_('<div class="loading svelte-1qls65z"><div class="spinner svelte-1qls65z"></div> <p>Loading fermentables...</p></div>'),Za=_('<div class="error-box svelte-1qls65z"><p class="error-text svelte-1qls65z"> </p></div>'),es=_("<option> </option>"),ts=_("<option> </option>"),as=_('<span class="item-maltster svelte-1qls65z"> </span>'),ss=_('<span class="item-color svelte-1qls65z"><span class="color-dot svelte-1qls65z"></span> </span>'),rs=_('<span class="item-potential svelte-1qls65z"> </span>'),ls=_('<button type="button"><div class="item-main svelte-1qls65z"><span class="item-name svelte-1qls65z"> </span> <!></div> <div class="item-details svelte-1qls65z"><!> <!></div></button>'),is=_('<div class="type-group svelte-1qls65z"><h5 class="type-name svelte-1qls65z"> </h5> <!></div>'),ns=_('<div class="no-results svelte-1qls65z"><p class="svelte-1qls65z">No fermentables match your filters</p></div>'),os=_('<div class="filters svelte-1qls65z"><input type="text" placeholder="Search fermentables..." class="search-input svelte-1qls65z"/> <div class="filter-row svelte-1qls65z"><select class="filter-select svelte-1qls65z"><option>All Types</option><!></select> <select class="filter-select svelte-1qls65z"><option>All Origins</option><!></select></div></div> <div class="library-list svelte-1qls65z"><!> <!></div>',1),vs=_('<div class="browser-overlay svelte-1qls65z"><div class="browser-modal svelte-1qls65z"><div class="browser-header svelte-1qls65z"><h4 class="svelte-1qls65z">Add Fermentable</h4> <button type="button" class="close-btn svelte-1qls65z">×</button></div> <!></div></div>'),us=_('<div class="fermentable-selector svelte-1qls65z"><div class="selector-header svelte-1qls65z"><div class="header-left svelte-1qls65z"><h3 class="svelte-1qls65z">Grain Bill</h3> <!></div> <button type="button" class="add-btn svelte-1qls65z">+ Add Fermentable</button></div> <!> <!></div>');function cs(p,c){Ct(c,!0);let y=Bt(c,"batchSizeLiters",3,20),R=Bt(c,"efficiencyPercent",3,72),k=g(rt([])),z=g(rt([])),T=g(rt([])),te=g(!0),L=g(null),ae=g(""),N=g(""),V=g(""),ie=g(!1),de=K(()=>c.fermentables.reduce((d,r)=>d+r.amount_kg,0)),Ge=K(()=>()=>{if(c.fermentables.length===0)return{og:1,srm:0,color_hex:"#FFE699"};const d=c.fermentables.map(F=>({name:F.name,amount_kg:F.amount_kg,potential_sg:F.potential_sg||1.036,color_srm:F.color_srm||2})),r={batch_size_liters:y(),efficiency_percent:R()},i=la(d,r),u=ua(d,y()),w=Gt(u);return{og:i,srm:u,color_hex:w}}),Ae=K(()=>()=>e(k).filter(d=>{const r=!e(ae)||d.name.toLowerCase().includes(e(ae).toLowerCase())||d.maltster?.toLowerCase().includes(e(ae).toLowerCase())||d.origin?.toLowerCase().includes(e(ae).toLowerCase()),i=!e(N)||d.type===e(N),u=!e(V)||d.origin===e(V);return r&&i&&u})),me=K(()=>()=>{const d={};for(const i of e(Ae)()){const u=i.type||"Other";d[u]||(d[u]=[]),d[u].push(i)}const r=["base","specialty","adjunct","sugar","extract","fruit","other"];return Object.fromEntries(Object.entries(d).sort(([i],[u])=>{const w=r.indexOf(i.toLowerCase()),F=r.indexOf(u.toLowerCase());return w>=0&&F>=0?w-F:w>=0?-1:F>=0?1:i.localeCompare(u)}))});sa(async()=>{try{const[d,r,i]=await Promise.all([La(),Ma(),Pa()]);o(k,d,!0),o(z,r.types||[],!0),o(T,i.origins||[],!0)}catch(d){o(L,d instanceof Error?d.message:"Failed to load fermentables",!0),console.error("Failed to load fermentables:",d)}finally{o(te,!1)}});function He(d){if(c.fermentables.some(i=>i.id===d.id))return;const r={...d,amount_kg:.5};c.onUpdate([...c.fermentables,r])}function Ce(d){c.onUpdate(c.fermentables.filter(r=>r.id!==d))}function De(d,r){c.onUpdate(c.fermentables.map(i=>i.id===d?{...i,amount_kg:Math.max(0,r)}:i))}function Q(d){return!d||!e(de)?"0%":(d/e(de)*100).toFixed(1)+"%"}function fe(d){return d==null?"--":d.toFixed(0)+"°L"}function we(d){return d==null?"--":d.toFixed(3)}function $e(d){switch(d?.toLowerCase()){case"base":return"var(--positive)";case"specialty":return"var(--warning)";case"adjunct":return"var(--info)";case"sugar":return"var(--accent-primary)";case"extract":return"var(--text-secondary)";default:return"var(--text-tertiary)"}}var be=us(),n=a(be),M=a(n),Oe=s(a(M),2);{var I=d=>{var r=Na(),i=a(r),u=s(i),w=s(u);t(r),h((F,E,ue,H)=>{m(i,`${F??""} kg · OG ${E??""} · `),yt(u,`background-color: ${ue??""}`),m(w,` ${H??""} SRM`)},[()=>e(de).toFixed(2),()=>e(Ge)().og.toFixed(3),()=>e(Ge)().color_hex,()=>e(Ge)().srm.toFixed(0)]),v(d,r)};x(Oe,d=>{c.fermentables.length>0&&d(I)})}t(M);var ct=s(M,2);ct.__click=()=>o(ie,!0),t(n);var lt=s(n,2);{var it=d=>{var r=Va(),i=s(a(r),2);i.__click=()=>o(ie,!0),t(r),v(d,r)},dt=d=>{var r=Qa();Te(r,21,()=>c.fermentables,i=>i.id,(i,u)=>{var w=Ka(),F=a(w),E=a(F),ue=a(E),H=a(ue,!0);t(ue);var j=s(ue,2);{var qe=C=>{var P=Ya(),xe=a(P,!0);t(P),h(ce=>{yt(P,`color: ${ce??""}`),m(xe,e(u).type)},[()=>$e(e(u).type)]),v(C,P)};x(j,C=>{e(u).type&&C(qe)})}t(E);var We=s(E,2),_e=a(We);{var B=C=>{var P=$a(),xe=a(P,!0);t(P),h(()=>m(xe,e(u).maltster)),v(C,P)};x(_e,C=>{e(u).maltster&&C(B)})}var G=s(_e,2);{var X=C=>{var P=Wa(),xe=a(P,!0);t(P),h(ce=>m(xe,ce),[()=>fe(e(u).color_srm)]),v(C,P)};x(G,C=>{e(u).color_srm&&C(X)})}var Z=s(G,2);{var pe=C=>{var P=Ja(),xe=a(P,!0);t(P),h(ce=>m(xe,ce),[()=>we(e(u).potential_sg)]),v(C,P)};x(Z,C=>{e(u).potential_sg&&C(pe)})}t(We),t(F);var ne=s(F,2),ee=a(ne),ke=a(ee);Ue(ke),ke.__change=C=>De(e(u).id,parseFloat(C.currentTarget.value)||0),Xe(2),t(ee);var ge=s(ee,2),Fe=a(ge,!0);t(ge);var Le=s(ge,2);Le.__click=()=>Ce(e(u).id),t(ne),t(w),h(C=>{m(H,e(u).name),ht(ke,e(u).amount_kg),m(Fe,C)},[()=>Q(e(u).amount_kg)]),v(i,w)}),t(r),v(d,r)};x(lt,d=>{c.fermentables.length===0?d(it):d(dt,!1)})}var _t=s(lt,2);{var pt=d=>{var r=vs();r.__click=()=>o(ie,!1);var i=a(r);i.__click=H=>H.stopPropagation();var u=a(i),w=s(a(u),2);w.__click=()=>o(ie,!1),t(u);var F=s(u,2);{var E=H=>{var j=Xa();v(H,j)},ue=H=>{var j=Ft(),qe=st(j);{var We=B=>{var G=Za(),X=a(G),Z=a(X,!0);t(X),t(G),h(()=>m(Z,e(L))),v(B,G)},_e=B=>{var G=os(),X=st(G),Z=a(X);Ue(Z);var pe=s(Z,2),ne=a(pe),ee=a(ne);ee.value=ee.__value="";var ke=s(ee);Te(ke,17,()=>e(z),ut,(U,Y)=>{var $=es(),A=a($,!0);t($);var W={};h(()=>{m(A,e(Y)),W!==(W=e(Y))&&($.value=($.__value=e(Y))??"")}),v(U,$)}),t(ne);var ge=s(ne,2),Fe=a(ge);Fe.value=Fe.__value="";var Le=s(Fe);Te(Le,17,()=>e(T),ut,(U,Y)=>{var $=ts(),A=a($,!0);t($);var W={};h(()=>{m(A,e(Y)),W!==(W=e(Y))&&($.value=($.__value=e(Y))??"")}),v(U,$)}),t(ge),t(pe),t(X);var C=s(X,2),P=a(C);Te(P,17,()=>Object.entries(e(me)()),([U,Y])=>U,(U,Y)=>{var $=K(()=>Tt(e(Y),2));let A=()=>e($)[0],W=()=>e($)[1];var se=is(),Me=a(se),Ee=a(Me,!0);t(Me);var Re=s(Me,2);Te(Re,17,W,re=>re.id,(re,oe)=>{const je=K(()=>c.fermentables.some(S=>S.id===e(oe).id));var ve=ls();let le;ve.__click=()=>He(e(oe));var ze=a(ve),Be=a(ze),Ne=a(Be,!0);t(Be);var he=s(Be,2);{var Je=S=>{var q=as(),J=a(q,!0);t(q),h(()=>m(J,e(oe).maltster)),v(S,q)};x(he,S=>{e(oe).maltster&&S(Je)})}t(ze);var Ve=s(ze,2),Ie=a(Ve);{var ye=S=>{var q=ss(),J=a(q),Ye=s(J);t(q),h((mt,wt)=>{yt(J,`background-color: ${mt??""}`),m(Ye,` ${wt??""}°L`)},[()=>Gt(e(oe).color_srm),()=>e(oe).color_srm.toFixed(0)]),v(S,q)};x(Ie,S=>{e(oe).color_srm&&S(ye)})}var et=s(Ie,2);{var O=S=>{var q=rs(),J=a(q,!0);t(q),h(Ye=>m(J,Ye),[()=>e(oe).potential_sg.toFixed(3)]),v(S,q)};x(et,S=>{e(oe).potential_sg&&S(O)})}t(Ve),t(ve),h(()=>{le=ra(ve,1,"library-item svelte-1qls65z",null,le,{added:e(je)}),ve.disabled=e(je),m(Ne,e(oe).name)}),v(re,ve)}),t(se),h(()=>m(Ee,A())),v(U,se)});var xe=s(P,2);{var ce=U=>{var Y=ns();v(U,Y)};x(xe,U=>{Object.keys(e(me)()).length===0&&U(ce)})}t(C),at(Z,()=>e(ae),U=>o(ae,U)),zt(ne,()=>e(N),U=>o(N,U)),zt(ge,()=>e(V),U=>o(V,U)),v(B,G)};x(qe,B=>{e(L)?B(We):B(_e,!1)},!0)}v(H,j)};x(F,H=>{e(te)?H(E):H(ue,!1)})}t(i),t(r),v(d,r)};x(_t,d=>{e(ie)&&d(pt)})}t(be),v(p,be),qt()}St(["click","change"]);var ds=_('<span class="stats svelte-4wskud"> <span class="balance svelte-4wskud"> </span></span>'),_s=_('<div class="empty-state svelte-4wskud"><p class="svelte-4wskud">No hops added yet.</p> <button type="button" class="browse-btn svelte-4wskud">Browse Library</button></div>'),ps=_('<span class="hop-origin svelte-4wskud"> </span>'),ms=_('<span class="ibu-value svelte-4wskud"> </span>'),fs=_('<span class="ibu-zero svelte-4wskud">0 IBU</span>'),bs=_('<div class="control-group svelte-4wskud"><label class="svelte-4wskud">Time</label> <div class="input-with-unit svelte-4wskud"><input type="number" step="5" min="0" max="90" class="svelte-4wskud"/> <span class="unit svelte-4wskud">min</span></div></div>'),gs=_('<div class="hop-item svelte-4wskud"><div class="hop-main svelte-4wskud"><div class="hop-info svelte-4wskud"><span class="hop-name svelte-4wskud"> </span> <!></div> <div class="hop-ibu svelte-4wskud"><!></div></div> <div class="hop-controls svelte-4wskud"><div class="control-row svelte-4wskud"><div class="control-group svelte-4wskud"><label class="svelte-4wskud">Amount</label> <div class="input-with-unit svelte-4wskud"><input type="number" step="5" min="0" class="svelte-4wskud"/> <span class="unit svelte-4wskud">g</span></div></div> <div class="control-group svelte-4wskud"><label class="svelte-4wskud">AA%</label> <input type="number" step="0.1" min="0" max="25" class="aa-input svelte-4wskud"/></div> <!> <div class="control-group svelte-4wskud"><label class="svelte-4wskud">Use</label> <select class="svelte-4wskud"><option>Boil</option><option>First Wort</option><option>Whirlpool</option><option>Dry Hop</option><option>Mash</option></select></div> <div class="control-group svelte-4wskud"><label class="svelte-4wskud">Form</label> <select class="svelte-4wskud"><option>Pellet</option><option>Whole</option><option>Plug</option></select></div></div> <button type="button" class="remove-btn svelte-4wskud">×</button></div></div>'),xs=_('<div class="use-group svelte-4wskud"><h4 class="use-name svelte-4wskud"> </h4> <!></div>'),hs=_('<div class="hops-list svelte-4wskud"></div>'),ys=_('<div class="loading svelte-4wskud"><div class="spinner svelte-4wskud"></div> <p>Loading hops...</p></div>'),ws=_('<div class="error-box svelte-4wskud"><p class="error-text svelte-4wskud"> </p></div>'),ks=_("<option> </option>"),Fs=_('<span class="item-origin svelte-4wskud"> </span>'),zs=_('<span class="item-aroma svelte-4wskud"> </span>'),Bs=_('<button type="button" class="library-item svelte-4wskud"><div class="item-main svelte-4wskud"><span class="item-name svelte-4wskud"> </span> <!></div> <div class="item-details svelte-4wskud"><span class="item-aa svelte-4wskud"> </span> <!></div></button>'),Ss=_('<div class="purpose-group svelte-4wskud"><h5 class="purpose-name svelte-4wskud"> </h5> <!></div>'),Cs=_('<div class="no-results svelte-4wskud"><p class="svelte-4wskud">No hops match your filters</p></div>'),qs=_('<div class="filters svelte-4wskud"><input type="text" placeholder="Search hops..." class="search-input svelte-4wskud"/> <div class="filter-row svelte-4wskud"><select class="filter-select svelte-4wskud"><option>All Purposes</option><option>Bittering</option><option>Aroma</option><option>Dual Purpose</option></select> <select class="filter-select svelte-4wskud"><option>All Origins</option><!></select></div></div> <div class="library-list svelte-4wskud"><!> <!></div>',1),Ls=_('<div class="browser-overlay svelte-4wskud"><div class="browser-modal svelte-4wskud"><div class="browser-header svelte-4wskud"><h4 class="svelte-4wskud">Add Hop</h4> <button type="button" class="close-btn svelte-4wskud">×</button></div> <!></div></div>'),Ms=_('<div class="hop-selector svelte-4wskud"><div class="selector-header svelte-4wskud"><div class="header-left svelte-4wskud"><h3 class="svelte-4wskud">Hop Schedule</h3> <!></div> <button type="button" class="add-btn svelte-4wskud">+ Add Hop</button></div> <!> <!></div>');function Ps(p,c){Ct(c,!0);let y=Bt(c,"og",3,1.05),R=Bt(c,"batchSizeLiters",3,20),k=g(rt([])),z=g(rt([])),T=g(!0),te=g(null),L=g(""),ae=g(""),N=g(""),V=g(!1),ie=K(()=>()=>{if(c.hops.length===0)return 0;const r=c.hops.map(i=>({name:i.name,amount_grams:i.amount_grams,alpha_acid_percent:i.alpha_acid_percent,boil_time_minutes:i.boil_time_minutes,form:i.form,use:i.use}));return oa(r,y(),R())}),de=K(()=>()=>va(e(ie)(),y())),Ge=K(()=>()=>{const r=e(de)();return r<.3?"Very Sweet":r<.5?"Malty":r<.7?"Balanced":r<.9?"Hoppy":"Very Bitter"});function Ae(r){const i={name:r.name,amount_grams:r.amount_grams,alpha_acid_percent:r.alpha_acid_percent,boil_time_minutes:r.boil_time_minutes,form:r.form,use:r.use};return na(i,y(),R())}let me=K(()=>()=>e(k).filter(r=>{const i=!e(L)||r.name.toLowerCase().includes(e(L).toLowerCase())||r.origin?.toLowerCase().includes(e(L).toLowerCase())||r.aroma_profile?.toLowerCase().includes(e(L).toLowerCase()),u=!e(ae)||r.origin===e(ae),w=!e(N)||r.purpose===e(N);return i&&u&&w})),He=K(()=>()=>{const r={};for(const u of e(me)()){const w=u.purpose||"Other";r[w]||(r[w]=[]),r[w].push(u)}const i=["dual","bittering","aroma"];return Object.fromEntries(Object.entries(r).sort(([u],[w])=>{const F=i.indexOf(u.toLowerCase()),E=i.indexOf(w.toLowerCase());return F>=0&&E>=0?F-E:F>=0?-1:E>=0?1:u.localeCompare(w)}))}),Ce=K(()=>()=>{const r={};for(const i of c.hops){const u=i.use||"boil";r[u]||(r[u]=[]),r[u].push(i)}return r.boil&&r.boil.sort((i,u)=>u.boil_time_minutes-i.boil_time_minutes),r});sa(async()=>{try{const[r,i]=await Promise.all([Aa(),Oa()]);o(k,r,!0),o(z,i.origins||[],!0)}catch(r){o(te,r instanceof Error?r.message:"Failed to load hops",!0),console.error("Failed to load hops:",r)}finally{o(T,!1)}});function De(r){const i=r.alpha_acid_low&&r.alpha_acid_high?(r.alpha_acid_low+r.alpha_acid_high)/2:r.alpha_acid_low||r.alpha_acid_high||10,u={...r,amount_grams:30,boil_time_minutes:60,use:"boil",form:"pellet",alpha_acid_percent:i};c.onUpdate([...c.hops,u])}function Q(r){const i=[...c.hops];i.splice(r,1),c.onUpdate(i)}function fe(r,i,u){const w=c.hops.map((F,E)=>E===r?{...F,[i]:u}:F);c.onUpdate(w)}function we(r,i){return r!=null&&i!=null?`${r.toFixed(1)}-${i.toFixed(1)}%`:r!=null?`${r.toFixed(1)}%+`:i!=null?`≤${i.toFixed(1)}%`:"--"}function $e(r){return{boil:"Boil",whirlpool:"Whirlpool",dry_hop:"Dry Hop",first_wort:"First Wort",mash:"Mash"}[r]||r}function be(r){switch(r?.toLowerCase()){case"bittering":return"var(--warning)";case"aroma":return"var(--positive)";case"dual":return"var(--info)";default:return"var(--text-tertiary)"}}var n=Ms(),M=a(n),Oe=a(M),I=s(a(Oe),2);{var ct=r=>{var i=ds(),u=a(i),w=s(u),F=a(w,!0);t(w),t(i),h((E,ue,H)=>{m(u,`${E??""} IBU · BU:GU ${ue??""} · `),m(F,H)},[()=>e(ie)().toFixed(0),()=>e(de)().toFixed(2),()=>e(Ge)()]),v(r,i)};x(I,r=>{c.hops.length>0&&r(ct)})}t(Oe);var lt=s(Oe,2);lt.__click=()=>o(V,!0),t(M);var it=s(M,2);{var dt=r=>{var i=_s(),u=s(a(i),2);u.__click=()=>o(V,!0),t(i),v(r,i)},_t=r=>{var i=hs();Te(i,21,()=>Object.entries(e(Ce)()),ut,(u,w)=>{var F=K(()=>Tt(e(w),2));let E=()=>e(F)[0],ue=()=>e(F)[1];var H=xs(),j=a(H),qe=a(j,!0);t(j);var We=s(j,2);Te(We,19,ue,(_e,B)=>_e.id+"-"+B,(_e,B)=>{const G=K(()=>c.hops.indexOf(e(B))),X=K(()=>Ae(e(B)));var Z=gs(),pe=a(Z),ne=a(pe),ee=a(ne),ke=a(ee,!0);t(ee);var ge=s(ee,2);{var Fe=O=>{var S=ps(),q=a(S,!0);t(S),h(()=>m(q,e(B).origin)),v(O,S)};x(ge,O=>{e(B).origin&&O(Fe)})}t(ne);var Le=s(ne,2),C=a(Le);{var P=O=>{var S=ms(),q=a(S);t(S),h(J=>m(q,`+${J??""} IBU`),[()=>e(X).toFixed(0)]),v(O,S)},xe=O=>{var S=fs();v(O,S)};x(C,O=>{e(X)>0?O(P):O(xe,!1)})}t(Le),t(pe);var ce=s(pe,2),U=a(ce),Y=a(U),$=s(a(Y),2),A=a($);Ue(A),A.__change=O=>fe(e(G),"amount_grams",parseFloat(O.currentTarget.value)||0),Xe(2),t($),t(Y);var W=s(Y,2),se=s(a(W),2);Ue(se),se.__change=O=>fe(e(G),"alpha_acid_percent",parseFloat(O.currentTarget.value)||0),t(W);var Me=s(W,2);{var Ee=O=>{var S=bs(),q=s(a(S),2),J=a(q);Ue(J),J.__change=Ye=>fe(e(G),"boil_time_minutes",parseInt(Ye.currentTarget.value)||0),Xe(2),t(q),t(S),h(()=>ht(J,e(B).boil_time_minutes)),v(O,S)};x(Me,O=>{e(B).use==="boil"&&O(Ee)})}var Re=s(Me,2),re=s(a(Re),2);re.__change=O=>fe(e(G),"use",O.currentTarget.value);var oe=a(re);oe.value=oe.__value="boil";var je=s(oe);je.value=je.__value="first_wort";var ve=s(je);ve.value=ve.__value="whirlpool";var le=s(ve);le.value=le.__value="dry_hop";var ze=s(le);ze.value=ze.__value="mash",t(re);var Be;ta(re),t(Re);var Ne=s(Re,2),he=s(a(Ne),2);he.__change=O=>fe(e(G),"form",O.currentTarget.value);var Je=a(he);Je.value=Je.__value="pellet";var Ve=s(Je);Ve.value=Ve.__value="whole";var Ie=s(Ve);Ie.value=Ie.__value="plug",t(he);var ye;ta(he),t(Ne),t(U);var et=s(U,2);et.__click=()=>Q(e(G)),t(ce),t(Z),h(()=>{m(ke,e(B).name),ht(A,e(B).amount_grams),ht(se,e(B).alpha_acid_percent),Be!==(Be=e(B).use)&&(re.value=(re.__value=e(B).use)??"",aa(re,e(B).use)),ye!==(ye=e(B).form)&&(he.value=(he.__value=e(B).form)??"",aa(he,e(B).form))}),v(_e,Z)}),t(H),h(_e=>m(qe,_e),[()=>$e(E())]),v(u,H)}),t(i),v(r,i)};x(it,r=>{c.hops.length===0?r(dt):r(_t,!1)})}var pt=s(it,2);{var d=r=>{var i=Ls();i.__click=()=>o(V,!1);var u=a(i);u.__click=j=>j.stopPropagation();var w=a(u),F=s(a(w),2);F.__click=()=>o(V,!1),t(w);var E=s(w,2);{var ue=j=>{var qe=ys();v(j,qe)},H=j=>{var qe=Ft(),We=st(qe);{var _e=G=>{var X=ws(),Z=a(X),pe=a(Z,!0);t(Z),t(X),h(()=>m(pe,e(te))),v(G,X)},B=G=>{var X=qs(),Z=st(X),pe=a(Z);Ue(pe);var ne=s(pe,2),ee=a(ne),ke=a(ee);ke.value=ke.__value="";var ge=s(ke);ge.value=ge.__value="bittering";var Fe=s(ge);Fe.value=Fe.__value="aroma";var Le=s(Fe);Le.value=Le.__value="dual",t(ee);var C=s(ee,2),P=a(C);P.value=P.__value="";var xe=s(P);Te(xe,17,()=>e(z),ut,(A,W)=>{var se=ks(),Me=a(se,!0);t(se);var Ee={};h(()=>{m(Me,e(W)),Ee!==(Ee=e(W))&&(se.value=(se.__value=e(W))??"")}),v(A,se)}),t(C),t(ne),t(Z);var ce=s(Z,2),U=a(ce);Te(U,17,()=>Object.entries(e(He)()),([A,W])=>A,(A,W)=>{var se=K(()=>Tt(e(W),2));let Me=()=>e(se)[0],Ee=()=>e(se)[1];var Re=Ss(),re=a(Re),oe=a(re,!0);t(re);var je=s(re,2);Te(je,17,Ee,ve=>ve.id,(ve,le)=>{var ze=Bs();ze.__click=()=>De(e(le));var Be=a(ze),Ne=a(Be),he=a(Ne,!0);t(Ne);var Je=s(Ne,2);{var Ve=q=>{var J=Fs(),Ye=a(J,!0);t(J),h(()=>m(Ye,e(le).origin)),v(q,J)};x(Je,q=>{e(le).origin&&q(Ve)})}t(Be);var Ie=s(Be,2),ye=a(Ie),et=a(ye,!0);t(ye);var O=s(ye,2);{var S=q=>{var J=zs(),Ye=a(J,!0);t(J),h(()=>m(Ye,e(le).aroma_profile)),v(q,J)};x(O,q=>{e(le).aroma_profile&&q(S)})}t(Ie),t(ze),h(q=>{m(he,e(le).name),m(et,q)},[()=>we(e(le).alpha_acid_low,e(le).alpha_acid_high)]),v(ve,ze)}),t(Re),h(ve=>{yt(re,`color: ${ve??""}`),m(oe,Me())},[()=>be(Me())]),v(A,Re)});var Y=s(U,2);{var $=A=>{var W=Cs();v(A,W)};x(Y,A=>{Object.keys(e(He)()).length===0&&A($)})}t(ce),at(pe,()=>e(L),A=>o(L,A)),zt(ee,()=>e(N),A=>o(N,A)),zt(C,()=>e(ae),A=>o(ae,A)),v(G,X)};x(We,G=>{e(te)?G(_e):G(B,!1)},!0)}v(j,qe)};x(E,j=>{e(T)?j(ue):j(H,!1)})}t(u),t(i),v(r,i)};x(pt,r=>{e(V)&&r(d)})}t(n),v(p,n),qt()}St(["click","change"]);var As=_("<span> </span>"),Os=_('<div class="style-warnings svelte-1rtvxu4"><span class="warnings-label svelte-1rtvxu4">Style Guidelines:</span> <!></div>'),Rs=_('<span class="autocomplete-spinner svelte-1rtvxu4"></span>'),Is=_('<button type="button" class="clear-style svelte-1rtvxu4" aria-label="Clear style">&times;</button>'),Us=_('<span class="style-category svelte-1rtvxu4"> </span>'),Ts=_('<li><button type="button" class="style-option svelte-1rtvxu4"><span class="style-name svelte-1rtvxu4"> </span> <!></button></li>'),Gs=_('<ul class="style-dropdown svelte-1rtvxu4"></ul>'),Hs=_('<div class="review-loading svelte-1rtvxu4"><div class="spinner svelte-1rtvxu4"></div> <p class="svelte-1rtvxu4"> </p></div>'),Ds=_('<div class="review-error svelte-1rtvxu4"><p> </p></div>'),Es=_('<span class="style-badge found svelte-1rtvxu4"> </span>'),js=_('<span class="style-badge not-found svelte-1rtvxu4">Style not in BJCP database</span>'),Ns=_('<div class="review-meta svelte-1rtvxu4"><!> <span class="model-badge svelte-1rtvxu4"> </span></div> <div class="review-content svelte-1rtvxu4"><!></div>',1),Vs=_('<div class="modal-overlay svelte-1rtvxu4" role="presentation"><div class="modal-content svelte-1rtvxu4" role="dialog" aria-modal="true" aria-labelledby="review-modal-title" tabindex="-1"><div class="modal-header svelte-1rtvxu4"><h2 id="review-modal-title" class="svelte-1rtvxu4">AI Recipe Review</h2> <button class="modal-close svelte-1rtvxu4" aria-label="Close">&times;</button></div> <div class="modal-body svelte-1rtvxu4"><!></div></div></div>'),Ys=_('<div class="recipe-builder svelte-1rtvxu4"><div class="stats-panel svelte-1rtvxu4"><div class="stat-group svelte-1rtvxu4"><div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">OG</span> <span class="stat-value svelte-1rtvxu4"> </span></div> <div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">FG</span> <span class="stat-value svelte-1rtvxu4"> </span></div> <div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">ABV</span> <span class="stat-value svelte-1rtvxu4"> </span></div></div> <div class="stat-group svelte-1rtvxu4"><div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">IBU</span> <span class="stat-value svelte-1rtvxu4"> </span></div> <div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">BU:GU</span> <span class="stat-value balance svelte-1rtvxu4"> </span> <span class="stat-sub svelte-1rtvxu4"> </span></div></div> <div class="stat-group svelte-1rtvxu4"><div class="stat color-stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">Color</span> <div class="color-display svelte-1rtvxu4"><span class="color-swatch svelte-1rtvxu4"></span> <span class="stat-value svelte-1rtvxu4"> </span></div> <span class="stat-sub svelte-1rtvxu4"> </span></div></div> <div class="stat-group svelte-1rtvxu4"><div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">Calories</span> <span class="stat-value svelte-1rtvxu4"> </span> <span class="stat-sub svelte-1rtvxu4">per 330ml</span></div></div></div> <!> <div class="section metadata-section svelte-1rtvxu4"><h2 class="section-title svelte-1rtvxu4">Recipe Details</h2> <div class="form-grid svelte-1rtvxu4"><div class="form-field full-width svelte-1rtvxu4"><label for="recipe-name" class="svelte-1rtvxu4">Recipe Name *</label> <input id="recipe-name" type="text" placeholder="e.g., My Awesome IPA" class="form-input svelte-1rtvxu4"/></div> <div class="form-field svelte-1rtvxu4"><label for="author" class="svelte-1rtvxu4">Brewer</label> <input id="author" type="text" placeholder="Your name" class="form-input svelte-1rtvxu4"/></div> <div class="form-field style-autocomplete svelte-1rtvxu4"><label for="style" class="svelte-1rtvxu4">Style</label> <div class="autocomplete-container svelte-1rtvxu4"><input id="style" type="text" placeholder="Search BJCP styles..." class="form-input svelte-1rtvxu4" autocomplete="off"/> <!> <!></div> <!></div></div></div> <div class="section params-section svelte-1rtvxu4"><h2 class="section-title svelte-1rtvxu4">Batch Parameters</h2> <div class="params-grid svelte-1rtvxu4"><div class="param-field svelte-1rtvxu4"><label for="batch-size" class="svelte-1rtvxu4">Batch Size</label> <div class="input-with-unit svelte-1rtvxu4"><input id="batch-size" type="number" min="1" step="1" class="form-input svelte-1rtvxu4"/> <span class="unit svelte-1rtvxu4">L</span></div></div> <div class="param-field svelte-1rtvxu4"><label for="efficiency" class="svelte-1rtvxu4">Efficiency</label> <div class="input-with-unit svelte-1rtvxu4"><input id="efficiency" type="number" min="50" max="95" step="1" class="form-input svelte-1rtvxu4"/> <span class="unit svelte-1rtvxu4">%</span></div></div> <div class="param-field svelte-1rtvxu4"><label for="boil-time" class="svelte-1rtvxu4">Boil Time</label> <div class="input-with-unit svelte-1rtvxu4"><input id="boil-time" type="number" min="30" max="120" step="5" class="form-input svelte-1rtvxu4"/> <span class="unit svelte-1rtvxu4">min</span></div></div></div></div> <div class="section svelte-1rtvxu4"><!></div> <div class="section svelte-1rtvxu4"><!></div> <div class="section yeast-section svelte-1rtvxu4"><!></div> <div class="section notes-section svelte-1rtvxu4"><h2 class="section-title svelte-1rtvxu4">Notes</h2> <textarea placeholder="Brewing notes, tips, or variations..." rows="4" class="notes-input svelte-1rtvxu4"></textarea></div></div> <!>',1);function $s(p,c){Ct(c,!0);function y(){r()}function R(){i()}function k(){return e($e)}function z(){return e(T).trim().length>0}let T=g(""),te=g(""),L=g(""),ae=g(""),N=g(rt([])),V=g(null),ie=g(!1),de=g(!1),Ge=null,Ae=g(20),me=g(72),He=g(60),Ce=g(rt([])),De=g(rt([])),Q=g(null),fe=g(!1),we=g(null),$e=g(!1),be=g(null),n=K(()=>()=>{if(e(Ce).length===0)return{og:1,fg:1,abv:0,ibu:0,srm:0,color_hex:"#FFE699",calories_per_330ml:0};const l=e(Ce).map(D=>({name:D.name,amount_kg:D.amount_kg,potential_sg:D.potential_sg||1.036,color_srm:D.color_srm||2})),f=e(De).map(D=>({name:D.name,amount_grams:D.amount_grams,alpha_acid_percent:D.alpha_acid_percent,boil_time_minutes:D.boil_time_minutes,form:D.form,use:D.use})),b={name:e(Q)?.name||"Default Yeast",attenuation_percent:e(Q)?.attenuation_low&&e(Q)?.attenuation_high?(e(Q).attenuation_low+e(Q).attenuation_high)/2:75,temp_min_c:e(Q)?.temp_low||18,temp_max_c:e(Q)?.temp_high||22},Se={batch_size_liters:e(Ae),efficiency_percent:e(me),boil_time_minutes:e(He)};return ja(l,f,b,Se)}),M=K(()=>()=>va(e(n)().ibu,e(n)().og)),Oe=K(()=>()=>{const l=e(M)();return l<.3?"Very Malty":l<.5?"Malty":l<.7?"Balanced":l<.9?"Hoppy":"Very Bitter"}),I=K(()=>()=>{if(!e(V))return[];const l=e(n)(),f=[],b=e(V);return b.og_min!==void 0&&b.og_max!==void 0&&(l.og<b.og_min?f.push({stat:"OG",value:l.og.toFixed(3),range:`${b.og_min.toFixed(3)} - ${b.og_max.toFixed(3)}`,severity:"warning"}):l.og>b.og_max&&f.push({stat:"OG",value:l.og.toFixed(3),range:`${b.og_min.toFixed(3)} - ${b.og_max.toFixed(3)}`,severity:"warning"})),b.fg_min!==void 0&&b.fg_max!==void 0&&(l.fg<b.fg_min||l.fg>b.fg_max)&&f.push({stat:"FG",value:l.fg.toFixed(3),range:`${b.fg_min.toFixed(3)} - ${b.fg_max.toFixed(3)}`,severity:"warning"}),b.abv_min!==void 0&&b.abv_max!==void 0&&(l.abv<b.abv_min||l.abv>b.abv_max)&&f.push({stat:"ABV",value:`${l.abv.toFixed(1)}%`,range:`${b.abv_min.toFixed(1)}% - ${b.abv_max.toFixed(1)}%`,severity:"warning"}),b.ibu_min!==void 0&&b.ibu_max!==void 0&&(l.ibu<b.ibu_min||l.ibu>b.ibu_max)&&f.push({stat:"IBU",value:l.ibu.toFixed(0),range:`${b.ibu_min} - ${b.ibu_max}`,severity:"warning"}),b.srm_min!==void 0&&b.srm_max!==void 0&&(l.srm<b.srm_min||l.srm>b.srm_max)&&f.push({stat:"Color",value:`${l.srm.toFixed(0)} SRM`,range:`${b.srm_min} - ${b.srm_max} SRM`,severity:"warning"}),f});async function ct(l){if(l.length<2){o(N,[],!0),o(de,!1);return}Ge&&clearTimeout(Ge),Ge=setTimeout(async()=>{o(ie,!0);try{o(N,await Ra(l,8),!0),o(de,e(N).length>0)}catch(f){console.error("Failed to search styles:",f),o(N,[],!0)}finally{o(ie,!1)}},300)}function lt(l){const f=l.target;o(L,f.value,!0),e(V)&&e(L)!==e(V).name&&o(V,null),ct(e(L))}function it(l){o(V,l,!0),o(L,l.name,!0),o(de,!1),o(N,[],!0)}function dt(){o(V,null),o(L,""),o(N,[],!0),o(de,!1)}function _t(l){o(Ce,l,!0)}function pt(l){o(De,l,!0)}function d(l){o(Q,l,!0)}function r(){if(!e(T).trim()){alert("Please enter a recipe name");return}const l={name:e(T),author:e(te),type:e(L),batch_size_liters:e(Ae),efficiency_percent:e(me),boil_time_minutes:e(He),og:e(n)().og,fg:e(n)().fg,abv:e(n)().abv,ibu:e(n)().ibu,color_srm:e(n)().srm,fermentables:e(Ce),hops:e(De),yeast:e(Q),notes:e(ae)};c.onSave?.(l)}async function i(){if(!e(L).trim()){o(be,"Please enter a beer style to get an AI review"),o(fe,!0);return}if(e(Ce).length===0){o(be,"Please add at least one fermentable to get an AI review"),o(fe,!0);return}o($e,!0),o(be,null),o(fe,!0);try{const l=e(n)();o(we,await Ia({name:e(T)||"Untitled Recipe",style:e(L),og:l.og,fg:l.fg,abv:l.abv,ibu:l.ibu,color_srm:l.srm,fermentables:e(Ce).map(f=>({name:f.name,amount_kg:f.amount_kg,color_srm:f.color_srm,type:f.category})),hops:e(De).map(f=>({name:f.name,amount_grams:f.amount_grams,boil_time_minutes:f.boil_time_minutes,alpha_acid_percent:f.alpha_acid_percent,use:f.use})),yeast:e(Q)?{name:e(Q).name,producer:e(Q).producer,attenuation:e(Q).attenuation}:void 0}),!0)}catch(l){o(be,l instanceof Error?l.message:"Failed to get AI review",!0)}finally{o($e,!1)}}function u(){o(fe,!1),o(we,null),o(be,null)}var w={save:y,review:R,getReviewLoading:k,canSave:z},F=Ys(),E=st(F),ue=a(E),H=a(ue),j=a(H),qe=s(a(j),2),We=a(qe,!0);t(qe),t(j);var _e=s(j,2),B=s(a(_e),2),G=a(B,!0);t(B),t(_e);var X=s(_e,2),Z=s(a(X),2),pe=a(Z);t(Z),t(X),t(H);var ne=s(H,2),ee=a(ne),ke=s(a(ee),2),ge=a(ke,!0);t(ke),t(ee);var Fe=s(ee,2),Le=s(a(Fe),2),C=a(Le,!0);t(Le);var P=s(Le,2),xe=a(P,!0);t(P),t(Fe),t(ne);var ce=s(ne,2),U=a(ce),Y=s(a(U),2),$=a(Y),A=s($,2),W=a(A);t(A),t(Y);var se=s(Y,2),Me=a(se,!0);t(se),t(U),t(ce);var Ee=s(ce,2),Re=a(Ee),re=s(a(Re),2),oe=a(re,!0);t(re),Xe(2),t(Re),t(Ee),t(ue);var je=s(ue,2);{var ve=l=>{var f=Os(),b=s(a(f),2);Te(b,17,()=>e(I)(),ut,(Se,D)=>{var Pe=As(),Ze=a(Pe);t(Pe),h(()=>{ra(Pe,1,`warning-badge ${e(D).severity??""}`,"svelte-1rtvxu4"),m(Ze,`${e(D).stat??""}: ${e(D).value??""} (target: ${e(D).range??""})`)}),v(Se,Pe)}),t(f),v(l,f)};x(je,l=>{e(I)().length>0&&l(ve)})}var le=s(je,2),ze=s(a(le),2),Be=a(ze),Ne=s(a(Be),2);Ue(Ne),t(Be);var he=s(Be,2),Je=s(a(he),2);Ue(Je),t(he);var Ve=s(he,2),Ie=s(a(Ve),2),ye=a(Ie);Ue(ye),ye.__input=lt;var et=s(ye,2);{var O=l=>{var f=Rs();v(l,f)};x(et,l=>{e(ie)&&l(O)})}var S=s(et,2);{var q=l=>{var f=Is();f.__click=dt,v(l,f)};x(S,l=>{e(V)&&l(q)})}t(Ie);var J=s(Ie,2);{var Ye=l=>{var f=Gs();Te(f,21,()=>e(N),ut,(b,Se)=>{var D=Ts(),Pe=a(D);Pe.__click=()=>it(e(Se));var Ze=a(Pe),ft=a(Ze,!0);t(Ze);var bt=s(Ze,2);{var Ke=Qe=>{var tt=Us(),gt=a(tt,!0);t(tt),h(()=>m(gt,e(Se).category)),v(Qe,tt)};x(bt,Qe=>{e(Se).category&&Qe(Ke)})}t(Pe),t(D),h(()=>m(ft,e(Se).name)),v(b,D)}),t(f),v(l,f)};x(J,l=>{e(de)&&e(N).length>0&&l(Ye)})}t(Ve),t(ze),t(le);var mt=s(le,2),wt=s(a(mt),2),Lt=a(wt),Ht=s(a(Lt),2),Dt=a(Ht);Ue(Dt),Xe(2),t(Ht),t(Lt);var Mt=s(Lt,2),Et=s(a(Mt),2),jt=a(Et);Ue(jt),Xe(2),t(Et),t(Mt);var Nt=s(Mt,2),Vt=s(a(Nt),2),Yt=a(Vt);Ue(Yt),Xe(2),t(Vt),t(Nt),t(wt),t(mt);var Pt=s(mt,2),ca=a(Pt);cs(ca,{get fermentables(){return e(Ce)},get batchSizeLiters(){return e(Ae)},get efficiencyPercent(){return e(me)},onUpdate:_t}),t(Pt);var At=s(Pt,2),da=a(At);{let l=K(()=>e(n)().og);Ps(da,{get hops(){return e(De)},get og(){return e(l)},get batchSizeLiters(){return e(Ae)},onUpdate:pt})}t(At);var Ot=s(At,2),_a=a(Ot);{let l=K(()=>e(Q)?.id);Ga(_a,{get selectedYeastId(){return e(l)},onSelect:d,label:"Select Yeast Strain"})}t(Ot);var $t=s(Ot,2),Wt=s(a($t),2);Fa(Wt),t($t),t(E);var pa=s(E,2);{var ma=l=>{var f=Vs();f.__click=u;var b=a(f),Se=a(b),D=s(a(Se),2);D.__click=u,t(Se);var Pe=s(Se,2),Ze=a(Pe);{var ft=Ke=>{var Qe=Hs(),tt=s(a(Qe),2),gt=a(tt);t(tt),t(Qe),h(()=>m(gt,`Analyzing your recipe against ${(e(L)||"style guidelines")??""}...`)),v(Ke,Qe)},bt=Ke=>{var Qe=Ft(),tt=st(Qe);{var gt=nt=>{var ot=Ds(),kt=a(ot),Rt=a(kt,!0);t(kt),t(ot),h(()=>m(Rt,e(be))),v(nt,ot)},fa=nt=>{var ot=Ft(),kt=st(ot);{var Rt=It=>{var Jt=Ns(),Ut=st(Jt),Kt=a(Ut);{var ba=vt=>{var xt=Es(),ya=a(xt);t(xt),h(()=>m(ya,`BJCP Style: ${e(we).style_name??""}`)),v(vt,xt)},ga=vt=>{var xt=js();v(vt,xt)};x(Kt,vt=>{e(we).style_found?vt(ba):vt(ga,!1)})}var Qt=s(Kt,2),xa=a(Qt);t(Qt),t(Ut);var Xt=s(Ut,2),ha=a(Xt);Ta(ha,()=>e(we).review.replace(/\n/g,"<br>")),t(Xt),h(()=>m(xa,`Model: ${e(we).model??""}`)),v(It,Jt)};x(kt,It=>{e(we)&&It(Rt)},!0)}v(nt,ot)};x(tt,nt=>{e(be)?nt(gt):nt(fa,!1)},!0)}v(Ke,Qe)};x(Ze,Ke=>{e($e)?Ke(ft):Ke(bt,!1)})}t(Pe),t(b),t(f),v(l,f)};x(pa,l=>{e(fe)&&l(ma)})}return h((l,f,b,Se,D,Pe,Ze,ft,bt,Ke)=>{m(We,l),m(G,f),m(pe,`${b??""}%`),m(ge,Se),m(C,D),m(xe,Pe),yt($,`background-color: ${Ze??""}`),m(W,`${ft??""} SRM`),m(Me,bt),m(oe,Ke),ht(ye,e(L))},[()=>e(n)().og.toFixed(3),()=>e(n)().fg.toFixed(3),()=>e(n)().abv.toFixed(1),()=>e(n)().ibu.toFixed(0),()=>e(M)().toFixed(2),()=>e(Oe)(),()=>e(n)().color_hex,()=>e(n)().srm.toFixed(0),()=>Da(e(n)().srm),()=>e(n)().calories_per_330ml]),at(Ne,()=>e(T),l=>o(T,l)),at(Je,()=>e(te),l=>o(te,l)),Zt("focus",ye,()=>e(L).length>=2&&e(N).length>0&&o(de,!0)),Zt("blur",ye,()=>setTimeout(()=>o(de,!1),200)),at(Dt,()=>e(Ae),l=>o(Ae,l)),at(jt,()=>e(me),l=>o(me,l)),at(Yt,()=>e(He),l=>o(He,l)),at(Wt,()=>e(ae),l=>o(ae,l)),v(p,F),qt(w)}St(["input","click"]);var Ws=_('<span class="btn-spinner svelte-1pes5m5"></span> Analyzing...',1),Js=wa('<svg class="btn-icon svelte-1pes5m5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456z"></path></svg> AI Review',1),Ks=_('<span class="btn-spinner svelte-1pes5m5"></span> Saving...',1),Qs=_('<div class="error-banner svelte-1pes5m5"><svg class="error-icon svelte-1pes5m5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div>'),Xs=_('<div class="saving-overlay svelte-1pes5m5"><div class="spinner svelte-1pes5m5"></div> <span>Saving recipe...</span></div>'),Zs=_('<div class="page-container svelte-1pes5m5"><div class="back-link svelte-1pes5m5"><a href="/recipes" class="back-btn svelte-1pes5m5"><svg class="back-icon svelte-1pes5m5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg> Back to Recipes</a></div> <div class="page-header svelte-1pes5m5"><div class="header-content svelte-1pes5m5"><h1 class="page-title svelte-1pes5m5">Create New Recipe</h1> <p class="page-description svelte-1pes5m5">Build your recipe with real-time calculations, or <a href="/recipes/import" class="import-link svelte-1pes5m5">import from BeerXML/BeerJSON</a></p></div> <div class="header-actions svelte-1pes5m5"><button type="button" class="btn-ghost svelte-1pes5m5">Cancel</button> <button type="button" class="btn-review svelte-1pes5m5"><!></button> <button type="button" class="btn-save svelte-1pes5m5"><!></button></div></div> <!> <!> <!></div>');function fr(p,c){Ct(c,!0);let y=g(!1),R=g(null),k=g(void 0),z=g(!1);za(()=>{const n=setInterval(()=>{e(k)&&o(z,e(k).getReviewLoading(),!0)},100);return()=>clearInterval(n)});async function T(n){o(y,!0),o(R,null);try{const M={name:n.name,author:n.author||void 0,type:n.type||void 0,batch_size_liters:n.batch_size_liters,efficiency_percent:n.efficiency_percent,boil_time_minutes:n.boil_time_minutes,og:n.og,fg:n.fg,abv:n.abv,ibu:n.ibu,color_srm:n.color_srm,notes:n.notes||void 0,yeast_name:n.yeast?.name,yeast_lab:n.yeast?.producer,yeast_product_id:n.yeast?.product_id,yeast_temp_min:n.yeast?.temp_low??void 0,yeast_temp_max:n.yeast?.temp_high??void 0,yeast_attenuation:n.yeast?.attenuation_low&&n.yeast?.attenuation_high?(n.yeast.attenuation_low+n.yeast.attenuation_high)/2:void 0,format_extensions:{fermentables:n.fermentables.map(I=>({id:I.id,name:I.name,amount_kg:I.amount_kg,color_lovibond:I.color_lovibond,potential_sg:I.potential_sg,type:I.type,origin:I.origin,maltster:I.maltster})),hops:n.hops.map(I=>({id:I.id,name:I.name,amount_grams:I.amount_grams,alpha_acid_percent:I.alpha_acid_percent,boil_time_minutes:I.boil_time_minutes,use:I.use,form:I.form,origin:I.origin,purpose:I.purpose}))}},Oe=await Ua(M);ea(`/recipes/${Oe.id}`)}catch(M){o(R,M instanceof Error?M.message:"Failed to create recipe",!0),o(y,!1)}}function te(){ea("/recipes")}var L=Zs();Ca("1pes5m5",n=>{Ba(()=>{Sa.title="New Recipe | BrewSignal"})});var ae=s(a(L),2),N=s(a(ae),2),V=a(N);V.__click=te;var ie=s(V,2);ie.__click=()=>e(k)?.review();var de=a(ie);{var Ge=n=>{var M=Ws();Xe(),v(n,M)},Ae=n=>{var M=Js();Xe(),v(n,M)};x(de,n=>{e(z)?n(Ge):n(Ae,!1)})}t(ie);var me=s(ie,2);me.__click=()=>e(k)?.save();var He=a(me);{var Ce=n=>{var M=Ks();Xe(),v(n,M)},De=n=>{var M=ka("Save Recipe");v(n,M)};x(He,n=>{e(y)?n(Ce):n(De,!1)})}t(me),t(N),t(ae);var Q=s(ae,2);{var fe=n=>{var M=Qs(),Oe=s(a(M),2),I=a(Oe,!0);t(Oe),t(M),h(()=>m(I,e(R))),v(n,M)};x(Q,n=>{e(R)&&n(fe)})}var we=s(Q,2);{var $e=n=>{var M=Xs();v(n,M)};x(we,n=>{e(y)&&n($e)})}var be=s(we,2);qa($s(be,{onSave:T,onCancel:te}),n=>o(k,n,!0),()=>e(k)),t(L),h(()=>{ie.disabled=e(z),me.disabled=e(y)}),v(p,L),qt()}St(["click"]);export{fr as component};
