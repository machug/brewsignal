import{d as St,f as _,a as v,s as m,c as Ft,e as Zt,h as wa,t as ka}from"../chunks/CCsyRfs1.js";import{a as qt,s as g,p as rt,o as sa,c as o,e as s,g as Ct,d as a,r as t,h as e,t as h,u as K,n as Xe,f as st,ax as Ht,i as Fa,ay as za,z as Ba,aw as Sa}from"../chunks/DyQh1CUw.js";import{i as x}from"../chunks/HQeVE6fZ.js";import{h as qa}from"../chunks/BZNRDT2A.js";import{b as Ca}from"../chunks/BlPaiSLK.js";import{g as ea}from"../chunks/C2wp5FgX.js";import{z as La,A as Aa,a4 as Ma,h as Pa,y as Oa,a5 as Ra,a6 as Ua,a7 as Ia}from"../chunks/DciRO_hW.js";import{e as He,i as ut}from"../chunks/DndLTv14.js";import{h as Ha}from"../chunks/DRjuPuC8.js";import{r as Ie,b as ht}from"../chunks/DPJa9AuX.js";import{s as ra}from"../chunks/C1-3ELYM.js";import{s as yt}from"../chunks/COCsBJqH.js";import{b as at}from"../chunks/B_acRpXz.js";import{b as zt,i as ta,s as aa}from"../chunks/U9y4h8n3.js";import{p as Bt}from"../chunks/B-ZSmncO.js";import{Y as Ta}from"../chunks/B8Ai3Rw5.js";function la(p,c){return 1+p.reduce((M,k)=>{const z=(k.potential_sg-1)*1e3,H=k.amount_kg*z*c.efficiency_percent/(c.batch_size_liters/100);return M+H},0)/1e3}function Da(p,c){return 1+(p-1)*1e3*(1-c/100)/1e3}function ia(p,c,y="simple"){return y==="simple"?(p-c)*131.25:76.08*(p-c)/(1.775-p)*(c/.794)}function na(p,c,y){if(p.use==="dry_hop"||p.boil_time_minutes<=0)return 0;const M=1.65*Math.pow(125e-6,c-1),k=(1-Math.exp(-.04*p.boil_time_minutes))/4.15;let z=M*k;p.form==="pellet"&&(z*=1.1),p.use==="first_wort"&&(z*=1.1),p.use==="whirlpool"&&(z*=.2);const H=p.alpha_acid_percent/100*p.amount_grams*z*1e3/(y*10);return Math.max(0,H)}function oa(p,c,y){return p.reduce((M,k)=>M+na(k,c,y),0)}function va(p,c){const y=(c-1)*1e3;return y>0?p/y:0}function ua(p,c){const y=c*.264172,M=p.reduce((z,H)=>{const ve=H.amount_kg*2.20462;return z+ve*H.color_srm/y},0),k=1.4922*Math.pow(M,.6859);return Math.min(40,Math.max(0,k))}function Tt(p){const c=Math.max(1,Math.min(40,p)),y={1:"#FFE699",2:"#FFD878",3:"#FFCA5A",4:"#FFBF42",5:"#FBB123",6:"#F8A600",7:"#F39C00",8:"#EA8F00",9:"#E58500",10:"#DE7C00",11:"#D77200",12:"#CF6900",13:"#CB6200",14:"#C35900",15:"#BB5100",16:"#B54C00",17:"#B04500",18:"#A63E00",19:"#A13700",20:"#9B3200",25:"#7C2900",30:"#5E1E00",35:"#401500",40:"#261000"},M=Object.keys(y).map(Number).sort((z,H)=>z-H);let k=M[0];for(const z of M)if(z<=c)k=z;else break;return y[k]||"#261000"}function Ga(p){return p<2?"Pale Straw":p<3?"Straw":p<4?"Pale Gold":p<6?"Deep Gold":p<9?"Amber":p<12?"Copper":p<15?"Light Brown":p<18?"Brown":p<20?"Dark Brown":p<24?"Very Dark":p<30?"Black":"Opaque Black"}function Ea(p,c,y=330){const k=ia(p,c)*.79*7*(y/100),z=(c-1)*1e3*.4*(y/100);return Math.round(k+z)}function ja(p,c,y,M){const k=la(p,M),z=Da(k,y.attenuation_percent),H=ia(k,z),ve=oa(c,k,M.batch_size_liters),L=ua(p,M.batch_size_liters);return{og:Math.round(k*1e3)/1e3,fg:Math.round(z*1e3)/1e3,abv:Math.round(H*10)/10,ibu:Math.round(ve),srm:Math.round(L*10)/10,color_hex:Tt(L),calories_per_330ml:Ea(k,z,330)}}var Na=_('<span class="stats svelte-1qls65z"> <span class="color-swatch svelte-1qls65z"></span> </span>'),Va=_('<div class="empty-state svelte-1qls65z"><p class="svelte-1qls65z">No fermentables added yet.</p> <button type="button" class="browse-btn svelte-1qls65z">Browse Library</button></div>'),Ya=_('<span class="ferm-type svelte-1qls65z"> </span>'),$a=_('<span class="detail svelte-1qls65z"> </span>'),Wa=_('<span class="detail svelte-1qls65z"> </span>'),Ja=_('<span class="detail svelte-1qls65z"> </span>'),Ka=_('<div class="ferm-item svelte-1qls65z"><div class="ferm-main svelte-1qls65z"><div class="ferm-info svelte-1qls65z"><span class="ferm-name svelte-1qls65z"> </span> <!></div> <div class="ferm-details svelte-1qls65z"><!> <!> <!></div></div> <div class="ferm-controls svelte-1qls65z"><div class="amount-input svelte-1qls65z"><input type="number" step="0.1" min="0" class="svelte-1qls65z"/> <span class="unit svelte-1qls65z">kg</span></div> <span class="percent svelte-1qls65z"> </span> <button type="button" class="remove-btn svelte-1qls65z">×</button></div></div>'),Qa=_('<div class="fermentables-list svelte-1qls65z"></div>'),Xa=_('<div class="loading svelte-1qls65z"><div class="spinner svelte-1qls65z"></div> <p>Loading fermentables...</p></div>'),Za=_('<div class="error-box svelte-1qls65z"><p class="error-text svelte-1qls65z"> </p></div>'),es=_("<option> </option>"),ts=_("<option> </option>"),as=_('<span class="item-maltster svelte-1qls65z"> </span>'),ss=_('<span class="item-color svelte-1qls65z"><span class="color-dot svelte-1qls65z"></span> </span>'),rs=_('<span class="item-potential svelte-1qls65z"> </span>'),ls=_('<button type="button"><div class="item-main svelte-1qls65z"><span class="item-name svelte-1qls65z"> </span> <!></div> <div class="item-details svelte-1qls65z"><!> <!></div></button>'),is=_('<div class="type-group svelte-1qls65z"><h5 class="type-name svelte-1qls65z"> </h5> <!></div>'),ns=_('<div class="no-results svelte-1qls65z"><p class="svelte-1qls65z">No fermentables match your filters</p></div>'),os=_('<div class="filters svelte-1qls65z"><input type="text" placeholder="Search fermentables..." class="search-input svelte-1qls65z"/> <div class="filter-row svelte-1qls65z"><select class="filter-select svelte-1qls65z"><option>All Types</option><!></select> <select class="filter-select svelte-1qls65z"><option>All Origins</option><!></select></div></div> <div class="library-list svelte-1qls65z"><!> <!></div>',1),vs=_('<div class="browser-overlay svelte-1qls65z"><div class="browser-modal svelte-1qls65z"><div class="browser-header svelte-1qls65z"><h4 class="svelte-1qls65z">Add Fermentable</h4> <button type="button" class="close-btn svelte-1qls65z">×</button></div> <!></div></div>'),us=_('<div class="fermentable-selector svelte-1qls65z"><div class="selector-header svelte-1qls65z"><div class="header-left svelte-1qls65z"><h3 class="svelte-1qls65z">Grain Bill</h3> <!></div> <button type="button" class="add-btn svelte-1qls65z">+ Add Fermentable</button></div> <!> <!></div>');function cs(p,c){qt(c,!0);let y=Bt(c,"batchSizeLiters",3,20),M=Bt(c,"efficiencyPercent",3,72),k=g(rt([])),z=g(rt([])),H=g(rt([])),ve=g(!0),L=g(null),te=g(""),V=g(""),E=g(""),ae=g(!1),de=K(()=>c.fermentables.reduce((d,r)=>d+r.amount_kg,0)),Te=K(()=>()=>{if(c.fermentables.length===0)return{og:1,srm:0,color_hex:"#FFE699"};const d=c.fermentables.map(F=>({name:F.name,amount_kg:F.amount_kg,potential_sg:F.potential_sg||1.036,color_srm:F.color_srm||2})),r={batch_size_liters:y(),efficiency_percent:M()},i=la(d,r),u=ua(d,y()),w=Tt(u);return{og:i,srm:u,color_hex:w}}),Pe=K(()=>()=>e(k).filter(d=>{const r=!e(te)||d.name.toLowerCase().includes(e(te).toLowerCase())||d.maltster?.toLowerCase().includes(e(te).toLowerCase())||d.origin?.toLowerCase().includes(e(te).toLowerCase()),i=!e(V)||d.type===e(V),u=!e(E)||d.origin===e(E);return r&&i&&u})),me=K(()=>()=>{const d={};for(const i of e(Pe)()){const u=i.type||"Other";d[u]||(d[u]=[]),d[u].push(i)}const r=["base","specialty","adjunct","sugar","extract","fruit","other"];return Object.fromEntries(Object.entries(d).sort(([i],[u])=>{const w=r.indexOf(i.toLowerCase()),F=r.indexOf(u.toLowerCase());return w>=0&&F>=0?w-F:w>=0?-1:F>=0?1:i.localeCompare(u)}))});sa(async()=>{try{const[d,r,i]=await Promise.all([La(),Aa(),Ma()]);o(k,d,!0),o(z,r.types||[],!0),o(H,i.origins||[],!0)}catch(d){o(L,d instanceof Error?d.message:"Failed to load fermentables",!0),console.error("Failed to load fermentables:",d)}finally{o(ve,!1)}});function De(d){if(c.fermentables.some(i=>i.id===d.id))return;const r={...d,amount_kg:.5};c.onUpdate([...c.fermentables,r]),o(ae,!1)}function qe(d){c.onUpdate(c.fermentables.filter(r=>r.id!==d))}function Ge(d,r){c.onUpdate(c.fermentables.map(i=>i.id===d?{...i,amount_kg:Math.max(0,r)}:i))}function Q(d){return!d||!e(de)?"0%":(d/e(de)*100).toFixed(1)+"%"}function fe(d){return d==null?"--":d.toFixed(0)+"°L"}function we(d){return d==null?"--":d.toFixed(3)}function $e(d){switch(d?.toLowerCase()){case"base":return"var(--positive)";case"specialty":return"var(--warning)";case"adjunct":return"var(--info)";case"sugar":return"var(--accent-primary)";case"extract":return"var(--text-secondary)";default:return"var(--text-tertiary)"}}var be=us(),n=a(be),A=a(n),Oe=s(a(A),2);{var U=d=>{var r=Na(),i=a(r),u=s(i),w=s(u);t(r),h((F,j,ue,D)=>{m(i,`${F??""} kg · OG ${j??""} · `),yt(u,`background-color: ${ue??""}`),m(w,` ${D??""} SRM`)},[()=>e(de).toFixed(2),()=>e(Te)().og.toFixed(3),()=>e(Te)().color_hex,()=>e(Te)().srm.toFixed(0)]),v(d,r)};x(Oe,d=>{c.fermentables.length>0&&d(U)})}t(A);var ct=s(A,2);ct.__click=()=>o(ae,!0),t(n);var lt=s(n,2);{var it=d=>{var r=Va(),i=s(a(r),2);i.__click=()=>o(ae,!0),t(r),v(d,r)},dt=d=>{var r=Qa();He(r,21,()=>c.fermentables,i=>i.id,(i,u)=>{var w=Ka(),F=a(w),j=a(F),ue=a(j),D=a(ue,!0);t(ue);var N=s(ue,2);{var Ce=q=>{var P=Ya(),xe=a(P,!0);t(P),h(ce=>{yt(P,`color: ${ce??""}`),m(xe,e(u).type)},[()=>$e(e(u).type)]),v(q,P)};x(N,q=>{e(u).type&&q(Ce)})}t(j);var We=s(j,2),_e=a(We);{var B=q=>{var P=$a(),xe=a(P,!0);t(P),h(()=>m(xe,e(u).maltster)),v(q,P)};x(_e,q=>{e(u).maltster&&q(B)})}var T=s(_e,2);{var X=q=>{var P=Wa(),xe=a(P,!0);t(P),h(ce=>m(xe,ce),[()=>fe(e(u).color_srm)]),v(q,P)};x(T,q=>{e(u).color_srm&&q(X)})}var Z=s(T,2);{var pe=q=>{var P=Ja(),xe=a(P,!0);t(P),h(ce=>m(xe,ce),[()=>we(e(u).potential_sg)]),v(q,P)};x(Z,q=>{e(u).potential_sg&&q(pe)})}t(We),t(F);var ie=s(F,2),ee=a(ie),ke=a(ee);Ie(ke),ke.__change=q=>Ge(e(u).id,parseFloat(q.currentTarget.value)||0),Xe(2),t(ee);var ge=s(ee,2),Fe=a(ge,!0);t(ge);var Le=s(ge,2);Le.__click=()=>qe(e(u).id),t(ie),t(w),h(q=>{m(D,e(u).name),ht(ke,e(u).amount_kg),m(Fe,q)},[()=>Q(e(u).amount_kg)]),v(i,w)}),t(r),v(d,r)};x(lt,d=>{c.fermentables.length===0?d(it):d(dt,!1)})}var _t=s(lt,2);{var pt=d=>{var r=vs();r.__click=()=>o(ae,!1);var i=a(r);i.__click=D=>D.stopPropagation();var u=a(i),w=s(a(u),2);w.__click=()=>o(ae,!1),t(u);var F=s(u,2);{var j=D=>{var N=Xa();v(D,N)},ue=D=>{var N=Ft(),Ce=st(N);{var We=B=>{var T=Za(),X=a(T),Z=a(X,!0);t(X),t(T),h(()=>m(Z,e(L))),v(B,T)},_e=B=>{var T=os(),X=st(T),Z=a(X);Ie(Z);var pe=s(Z,2),ie=a(pe),ee=a(ie);ee.value=ee.__value="";var ke=s(ee);He(ke,17,()=>e(z),ut,(I,Y)=>{var $=es(),O=a($,!0);t($);var W={};h(()=>{m(O,e(Y)),W!==(W=e(Y))&&($.value=($.__value=e(Y))??"")}),v(I,$)}),t(ie);var ge=s(ie,2),Fe=a(ge);Fe.value=Fe.__value="";var Le=s(Fe);He(Le,17,()=>e(H),ut,(I,Y)=>{var $=ts(),O=a($,!0);t($);var W={};h(()=>{m(O,e(Y)),W!==(W=e(Y))&&($.value=($.__value=e(Y))??"")}),v(I,$)}),t(ge),t(pe),t(X);var q=s(X,2),P=a(q);He(P,17,()=>Object.entries(e(me)()),([I,Y])=>I,(I,Y)=>{var $=K(()=>Ht(e(Y),2));let O=()=>e($)[0],W=()=>e($)[1];var se=is(),Ae=a(se),Ee=a(Ae,!0);t(Ae);var Re=s(Ae,2);He(Re,17,W,re=>re.id,(re,ne)=>{const je=K(()=>c.fermentables.some(S=>S.id===e(ne).id));var oe=ls();let le;oe.__click=()=>De(e(ne));var ze=a(oe),Be=a(ze),Ne=a(Be,!0);t(Be);var he=s(Be,2);{var Je=S=>{var C=as(),J=a(C,!0);t(C),h(()=>m(J,e(ne).maltster)),v(S,C)};x(he,S=>{e(ne).maltster&&S(Je)})}t(ze);var Ve=s(ze,2),Ue=a(Ve);{var ye=S=>{var C=ss(),J=a(C),Ye=s(J);t(C),h((mt,wt)=>{yt(J,`background-color: ${mt??""}`),m(Ye,` ${wt??""}°L`)},[()=>Tt(e(ne).color_srm),()=>e(ne).color_srm.toFixed(0)]),v(S,C)};x(Ue,S=>{e(ne).color_srm&&S(ye)})}var et=s(Ue,2);{var R=S=>{var C=rs(),J=a(C,!0);t(C),h(Ye=>m(J,Ye),[()=>e(ne).potential_sg.toFixed(3)]),v(S,C)};x(et,S=>{e(ne).potential_sg&&S(R)})}t(Ve),t(oe),h(()=>{le=ra(oe,1,"library-item svelte-1qls65z",null,le,{added:e(je)}),oe.disabled=e(je),m(Ne,e(ne).name)}),v(re,oe)}),t(se),h(()=>m(Ee,O())),v(I,se)});var xe=s(P,2);{var ce=I=>{var Y=ns();v(I,Y)};x(xe,I=>{Object.keys(e(me)()).length===0&&I(ce)})}t(q),at(Z,()=>e(te),I=>o(te,I)),zt(ie,()=>e(V),I=>o(V,I)),zt(ge,()=>e(E),I=>o(E,I)),v(B,T)};x(Ce,B=>{e(L)?B(We):B(_e,!1)},!0)}v(D,N)};x(F,D=>{e(ve)?D(j):D(ue,!1)})}t(i),t(r),v(d,r)};x(_t,d=>{e(ae)&&d(pt)})}t(be),v(p,be),Ct()}St(["click","change"]);var ds=_('<span class="stats svelte-4wskud"> <span class="balance svelte-4wskud"> </span></span>'),_s=_('<div class="empty-state svelte-4wskud"><p class="svelte-4wskud">No hops added yet.</p> <button type="button" class="browse-btn svelte-4wskud">Browse Library</button></div>'),ps=_('<span class="hop-origin svelte-4wskud"> </span>'),ms=_('<span class="ibu-value svelte-4wskud"> </span>'),fs=_('<span class="ibu-zero svelte-4wskud">0 IBU</span>'),bs=_('<div class="control-group svelte-4wskud"><label class="svelte-4wskud">Time</label> <div class="input-with-unit svelte-4wskud"><input type="number" step="5" min="0" max="90" class="svelte-4wskud"/> <span class="unit svelte-4wskud">min</span></div></div>'),gs=_('<div class="hop-item svelte-4wskud"><div class="hop-main svelte-4wskud"><div class="hop-info svelte-4wskud"><span class="hop-name svelte-4wskud"> </span> <!></div> <div class="hop-ibu svelte-4wskud"><!></div></div> <div class="hop-controls svelte-4wskud"><div class="control-row svelte-4wskud"><div class="control-group svelte-4wskud"><label class="svelte-4wskud">Amount</label> <div class="input-with-unit svelte-4wskud"><input type="number" step="5" min="0" class="svelte-4wskud"/> <span class="unit svelte-4wskud">g</span></div></div> <div class="control-group svelte-4wskud"><label class="svelte-4wskud">AA%</label> <input type="number" step="0.1" min="0" max="25" class="aa-input svelte-4wskud"/></div> <!> <div class="control-group svelte-4wskud"><label class="svelte-4wskud">Use</label> <select class="svelte-4wskud"><option>Boil</option><option>First Wort</option><option>Whirlpool</option><option>Dry Hop</option><option>Mash</option></select></div> <div class="control-group svelte-4wskud"><label class="svelte-4wskud">Form</label> <select class="svelte-4wskud"><option>Pellet</option><option>Whole</option><option>Plug</option></select></div></div> <button type="button" class="remove-btn svelte-4wskud">×</button></div></div>'),xs=_('<div class="use-group svelte-4wskud"><h4 class="use-name svelte-4wskud"> </h4> <!></div>'),hs=_('<div class="hops-list svelte-4wskud"></div>'),ys=_('<div class="loading svelte-4wskud"><div class="spinner svelte-4wskud"></div> <p>Loading hops...</p></div>'),ws=_('<div class="error-box svelte-4wskud"><p class="error-text svelte-4wskud"> </p></div>'),ks=_("<option> </option>"),Fs=_('<span class="item-origin svelte-4wskud"> </span>'),zs=_('<span class="item-aroma svelte-4wskud"> </span>'),Bs=_('<button type="button" class="library-item svelte-4wskud"><div class="item-main svelte-4wskud"><span class="item-name svelte-4wskud"> </span> <!></div> <div class="item-details svelte-4wskud"><span class="item-aa svelte-4wskud"> </span> <!></div></button>'),Ss=_('<div class="purpose-group svelte-4wskud"><h5 class="purpose-name svelte-4wskud"> </h5> <!></div>'),qs=_('<div class="no-results svelte-4wskud"><p class="svelte-4wskud">No hops match your filters</p></div>'),Cs=_('<div class="filters svelte-4wskud"><input type="text" placeholder="Search hops..." class="search-input svelte-4wskud"/> <div class="filter-row svelte-4wskud"><select class="filter-select svelte-4wskud"><option>All Purposes</option><option>Bittering</option><option>Aroma</option><option>Dual Purpose</option></select> <select class="filter-select svelte-4wskud"><option>All Origins</option><!></select></div></div> <div class="library-list svelte-4wskud"><!> <!></div>',1),Ls=_('<div class="browser-overlay svelte-4wskud"><div class="browser-modal svelte-4wskud"><div class="browser-header svelte-4wskud"><h4 class="svelte-4wskud">Add Hop</h4> <button type="button" class="close-btn svelte-4wskud">×</button></div> <!></div></div>'),As=_('<div class="hop-selector svelte-4wskud"><div class="selector-header svelte-4wskud"><div class="header-left svelte-4wskud"><h3 class="svelte-4wskud">Hop Schedule</h3> <!></div> <button type="button" class="add-btn svelte-4wskud">+ Add Hop</button></div> <!> <!></div>');function Ms(p,c){qt(c,!0);let y=Bt(c,"og",3,1.05),M=Bt(c,"batchSizeLiters",3,20),k=g(rt([])),z=g(rt([])),H=g(!0),ve=g(null),L=g(""),te=g(""),V=g(""),E=g(!1),ae=K(()=>()=>{if(c.hops.length===0)return 0;const r=c.hops.map(i=>({name:i.name,amount_grams:i.amount_grams,alpha_acid_percent:i.alpha_acid_percent,boil_time_minutes:i.boil_time_minutes,form:i.form,use:i.use}));return oa(r,y(),M())}),de=K(()=>()=>va(e(ae)(),y())),Te=K(()=>()=>{const r=e(de)();return r<.3?"Very Sweet":r<.5?"Malty":r<.7?"Balanced":r<.9?"Hoppy":"Very Bitter"});function Pe(r){const i={name:r.name,amount_grams:r.amount_grams,alpha_acid_percent:r.alpha_acid_percent,boil_time_minutes:r.boil_time_minutes,form:r.form,use:r.use};return na(i,y(),M())}let me=K(()=>()=>e(k).filter(r=>{const i=!e(L)||r.name.toLowerCase().includes(e(L).toLowerCase())||r.origin?.toLowerCase().includes(e(L).toLowerCase())||r.aroma_profile?.toLowerCase().includes(e(L).toLowerCase()),u=!e(te)||r.origin===e(te),w=!e(V)||r.purpose===e(V);return i&&u&&w})),De=K(()=>()=>{const r={};for(const u of e(me)()){const w=u.purpose||"Other";r[w]||(r[w]=[]),r[w].push(u)}const i=["dual","bittering","aroma"];return Object.fromEntries(Object.entries(r).sort(([u],[w])=>{const F=i.indexOf(u.toLowerCase()),j=i.indexOf(w.toLowerCase());return F>=0&&j>=0?F-j:F>=0?-1:j>=0?1:u.localeCompare(w)}))}),qe=K(()=>()=>{const r={};for(const i of c.hops){const u=i.use||"boil";r[u]||(r[u]=[]),r[u].push(i)}return r.boil&&r.boil.sort((i,u)=>u.boil_time_minutes-i.boil_time_minutes),r});sa(async()=>{try{const[r,i]=await Promise.all([Pa(),Oa()]);o(k,r,!0),o(z,i.origins||[],!0)}catch(r){o(ve,r instanceof Error?r.message:"Failed to load hops",!0),console.error("Failed to load hops:",r)}finally{o(H,!1)}});function Ge(r){const i=r.alpha_acid_low&&r.alpha_acid_high?(r.alpha_acid_low+r.alpha_acid_high)/2:r.alpha_acid_low||r.alpha_acid_high||10,u={...r,amount_grams:30,boil_time_minutes:60,use:"boil",form:"pellet",alpha_acid_percent:i};c.onUpdate([...c.hops,u]),o(E,!1)}function Q(r){const i=[...c.hops];i.splice(r,1),c.onUpdate(i)}function fe(r,i,u){const w=c.hops.map((F,j)=>j===r?{...F,[i]:u}:F);c.onUpdate(w)}function we(r,i){return r!=null&&i!=null?`${r.toFixed(1)}-${i.toFixed(1)}%`:r!=null?`${r.toFixed(1)}%+`:i!=null?`≤${i.toFixed(1)}%`:"--"}function $e(r){return{boil:"Boil",whirlpool:"Whirlpool",dry_hop:"Dry Hop",first_wort:"First Wort",mash:"Mash"}[r]||r}function be(r){switch(r?.toLowerCase()){case"bittering":return"var(--warning)";case"aroma":return"var(--positive)";case"dual":return"var(--info)";default:return"var(--text-tertiary)"}}var n=As(),A=a(n),Oe=a(A),U=s(a(Oe),2);{var ct=r=>{var i=ds(),u=a(i),w=s(u),F=a(w,!0);t(w),t(i),h((j,ue,D)=>{m(u,`${j??""} IBU · BU:GU ${ue??""} · `),m(F,D)},[()=>e(ae)().toFixed(0),()=>e(de)().toFixed(2),()=>e(Te)()]),v(r,i)};x(U,r=>{c.hops.length>0&&r(ct)})}t(Oe);var lt=s(Oe,2);lt.__click=()=>o(E,!0),t(A);var it=s(A,2);{var dt=r=>{var i=_s(),u=s(a(i),2);u.__click=()=>o(E,!0),t(i),v(r,i)},_t=r=>{var i=hs();He(i,21,()=>Object.entries(e(qe)()),ut,(u,w)=>{var F=K(()=>Ht(e(w),2));let j=()=>e(F)[0],ue=()=>e(F)[1];var D=xs(),N=a(D),Ce=a(N,!0);t(N);var We=s(N,2);He(We,19,ue,(_e,B)=>_e.id+"-"+B,(_e,B)=>{const T=K(()=>c.hops.indexOf(e(B))),X=K(()=>Pe(e(B)));var Z=gs(),pe=a(Z),ie=a(pe),ee=a(ie),ke=a(ee,!0);t(ee);var ge=s(ee,2);{var Fe=R=>{var S=ps(),C=a(S,!0);t(S),h(()=>m(C,e(B).origin)),v(R,S)};x(ge,R=>{e(B).origin&&R(Fe)})}t(ie);var Le=s(ie,2),q=a(Le);{var P=R=>{var S=ms(),C=a(S);t(S),h(J=>m(C,`+${J??""} IBU`),[()=>e(X).toFixed(0)]),v(R,S)},xe=R=>{var S=fs();v(R,S)};x(q,R=>{e(X)>0?R(P):R(xe,!1)})}t(Le),t(pe);var ce=s(pe,2),I=a(ce),Y=a(I),$=s(a(Y),2),O=a($);Ie(O),O.__change=R=>fe(e(T),"amount_grams",parseFloat(R.currentTarget.value)||0),Xe(2),t($),t(Y);var W=s(Y,2),se=s(a(W),2);Ie(se),se.__change=R=>fe(e(T),"alpha_acid_percent",parseFloat(R.currentTarget.value)||0),t(W);var Ae=s(W,2);{var Ee=R=>{var S=bs(),C=s(a(S),2),J=a(C);Ie(J),J.__change=Ye=>fe(e(T),"boil_time_minutes",parseInt(Ye.currentTarget.value)||0),Xe(2),t(C),t(S),h(()=>ht(J,e(B).boil_time_minutes)),v(R,S)};x(Ae,R=>{e(B).use==="boil"&&R(Ee)})}var Re=s(Ae,2),re=s(a(Re),2);re.__change=R=>fe(e(T),"use",R.currentTarget.value);var ne=a(re);ne.value=ne.__value="boil";var je=s(ne);je.value=je.__value="first_wort";var oe=s(je);oe.value=oe.__value="whirlpool";var le=s(oe);le.value=le.__value="dry_hop";var ze=s(le);ze.value=ze.__value="mash",t(re);var Be;ta(re),t(Re);var Ne=s(Re,2),he=s(a(Ne),2);he.__change=R=>fe(e(T),"form",R.currentTarget.value);var Je=a(he);Je.value=Je.__value="pellet";var Ve=s(Je);Ve.value=Ve.__value="whole";var Ue=s(Ve);Ue.value=Ue.__value="plug",t(he);var ye;ta(he),t(Ne),t(I);var et=s(I,2);et.__click=()=>Q(e(T)),t(ce),t(Z),h(()=>{m(ke,e(B).name),ht(O,e(B).amount_grams),ht(se,e(B).alpha_acid_percent),Be!==(Be=e(B).use)&&(re.value=(re.__value=e(B).use)??"",aa(re,e(B).use)),ye!==(ye=e(B).form)&&(he.value=(he.__value=e(B).form)??"",aa(he,e(B).form))}),v(_e,Z)}),t(D),h(_e=>m(Ce,_e),[()=>$e(j())]),v(u,D)}),t(i),v(r,i)};x(it,r=>{c.hops.length===0?r(dt):r(_t,!1)})}var pt=s(it,2);{var d=r=>{var i=Ls();i.__click=()=>o(E,!1);var u=a(i);u.__click=N=>N.stopPropagation();var w=a(u),F=s(a(w),2);F.__click=()=>o(E,!1),t(w);var j=s(w,2);{var ue=N=>{var Ce=ys();v(N,Ce)},D=N=>{var Ce=Ft(),We=st(Ce);{var _e=T=>{var X=ws(),Z=a(X),pe=a(Z,!0);t(Z),t(X),h(()=>m(pe,e(ve))),v(T,X)},B=T=>{var X=Cs(),Z=st(X),pe=a(Z);Ie(pe);var ie=s(pe,2),ee=a(ie),ke=a(ee);ke.value=ke.__value="";var ge=s(ke);ge.value=ge.__value="bittering";var Fe=s(ge);Fe.value=Fe.__value="aroma";var Le=s(Fe);Le.value=Le.__value="dual",t(ee);var q=s(ee,2),P=a(q);P.value=P.__value="";var xe=s(P);He(xe,17,()=>e(z),ut,(O,W)=>{var se=ks(),Ae=a(se,!0);t(se);var Ee={};h(()=>{m(Ae,e(W)),Ee!==(Ee=e(W))&&(se.value=(se.__value=e(W))??"")}),v(O,se)}),t(q),t(ie),t(Z);var ce=s(Z,2),I=a(ce);He(I,17,()=>Object.entries(e(De)()),([O,W])=>O,(O,W)=>{var se=K(()=>Ht(e(W),2));let Ae=()=>e(se)[0],Ee=()=>e(se)[1];var Re=Ss(),re=a(Re),ne=a(re,!0);t(re);var je=s(re,2);He(je,17,Ee,oe=>oe.id,(oe,le)=>{var ze=Bs();ze.__click=()=>Ge(e(le));var Be=a(ze),Ne=a(Be),he=a(Ne,!0);t(Ne);var Je=s(Ne,2);{var Ve=C=>{var J=Fs(),Ye=a(J,!0);t(J),h(()=>m(Ye,e(le).origin)),v(C,J)};x(Je,C=>{e(le).origin&&C(Ve)})}t(Be);var Ue=s(Be,2),ye=a(Ue),et=a(ye,!0);t(ye);var R=s(ye,2);{var S=C=>{var J=zs(),Ye=a(J,!0);t(J),h(()=>m(Ye,e(le).aroma_profile)),v(C,J)};x(R,C=>{e(le).aroma_profile&&C(S)})}t(Ue),t(ze),h(C=>{m(he,e(le).name),m(et,C)},[()=>we(e(le).alpha_acid_low,e(le).alpha_acid_high)]),v(oe,ze)}),t(Re),h(oe=>{yt(re,`color: ${oe??""}`),m(ne,Ae())},[()=>be(Ae())]),v(O,Re)});var Y=s(I,2);{var $=O=>{var W=qs();v(O,W)};x(Y,O=>{Object.keys(e(De)()).length===0&&O($)})}t(ce),at(pe,()=>e(L),O=>o(L,O)),zt(ee,()=>e(V),O=>o(V,O)),zt(q,()=>e(te),O=>o(te,O)),v(T,X)};x(We,T=>{e(ve)?T(_e):T(B,!1)},!0)}v(N,Ce)};x(j,N=>{e(H)?N(ue):N(D,!1)})}t(u),t(i),v(r,i)};x(pt,r=>{e(E)&&r(d)})}t(n),v(p,n),Ct()}St(["click","change"]);var Ps=_("<span> </span>"),Os=_('<div class="style-warnings svelte-1rtvxu4"><span class="warnings-label svelte-1rtvxu4">Style Guidelines:</span> <!></div>'),Rs=_('<span class="autocomplete-spinner svelte-1rtvxu4"></span>'),Us=_('<button type="button" class="clear-style svelte-1rtvxu4" aria-label="Clear style">&times;</button>'),Is=_('<span class="style-category svelte-1rtvxu4"> </span>'),Hs=_('<li><button type="button" class="style-option svelte-1rtvxu4"><span class="style-name svelte-1rtvxu4"> </span> <!></button></li>'),Ts=_('<ul class="style-dropdown svelte-1rtvxu4"></ul>'),Ds=_('<div class="review-loading svelte-1rtvxu4"><div class="spinner svelte-1rtvxu4"></div> <p class="svelte-1rtvxu4"> </p></div>'),Gs=_('<div class="review-error svelte-1rtvxu4"><p> </p></div>'),Es=_('<span class="style-badge found svelte-1rtvxu4"> </span>'),js=_('<span class="style-badge not-found svelte-1rtvxu4">Style not in BJCP database</span>'),Ns=_('<div class="review-meta svelte-1rtvxu4"><!> <span class="model-badge svelte-1rtvxu4"> </span></div> <div class="review-content svelte-1rtvxu4"><!></div>',1),Vs=_('<div class="modal-overlay svelte-1rtvxu4" role="presentation"><div class="modal-content svelte-1rtvxu4" role="dialog" aria-modal="true" aria-labelledby="review-modal-title" tabindex="-1"><div class="modal-header svelte-1rtvxu4"><h2 id="review-modal-title" class="svelte-1rtvxu4">AI Recipe Review</h2> <button class="modal-close svelte-1rtvxu4" aria-label="Close">&times;</button></div> <div class="modal-body svelte-1rtvxu4"><!></div></div></div>'),Ys=_('<div class="recipe-builder svelte-1rtvxu4"><div class="stats-panel svelte-1rtvxu4"><div class="stat-group svelte-1rtvxu4"><div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">OG</span> <span class="stat-value svelte-1rtvxu4"> </span></div> <div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">FG</span> <span class="stat-value svelte-1rtvxu4"> </span></div> <div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">ABV</span> <span class="stat-value svelte-1rtvxu4"> </span></div></div> <div class="stat-group svelte-1rtvxu4"><div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">IBU</span> <span class="stat-value svelte-1rtvxu4"> </span></div> <div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">BU:GU</span> <span class="stat-value balance svelte-1rtvxu4"> </span> <span class="stat-sub svelte-1rtvxu4"> </span></div></div> <div class="stat-group svelte-1rtvxu4"><div class="stat color-stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">Color</span> <div class="color-display svelte-1rtvxu4"><span class="color-swatch svelte-1rtvxu4"></span> <span class="stat-value svelte-1rtvxu4"> </span></div> <span class="stat-sub svelte-1rtvxu4"> </span></div></div> <div class="stat-group svelte-1rtvxu4"><div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">Calories</span> <span class="stat-value svelte-1rtvxu4"> </span> <span class="stat-sub svelte-1rtvxu4">per 330ml</span></div></div></div> <!> <div class="section metadata-section svelte-1rtvxu4"><h2 class="section-title svelte-1rtvxu4">Recipe Details</h2> <div class="form-grid svelte-1rtvxu4"><div class="form-field full-width svelte-1rtvxu4"><label for="recipe-name" class="svelte-1rtvxu4">Recipe Name *</label> <input id="recipe-name" type="text" placeholder="e.g., My Awesome IPA" class="form-input svelte-1rtvxu4"/></div> <div class="form-field svelte-1rtvxu4"><label for="author" class="svelte-1rtvxu4">Brewer</label> <input id="author" type="text" placeholder="Your name" class="form-input svelte-1rtvxu4"/></div> <div class="form-field style-autocomplete svelte-1rtvxu4"><label for="style" class="svelte-1rtvxu4">Style</label> <div class="autocomplete-container svelte-1rtvxu4"><input id="style" type="text" placeholder="Search BJCP styles..." class="form-input svelte-1rtvxu4" autocomplete="off"/> <!> <!></div> <!></div></div></div> <div class="section params-section svelte-1rtvxu4"><h2 class="section-title svelte-1rtvxu4">Batch Parameters</h2> <div class="params-grid svelte-1rtvxu4"><div class="param-field svelte-1rtvxu4"><label for="batch-size" class="svelte-1rtvxu4">Batch Size</label> <div class="input-with-unit svelte-1rtvxu4"><input id="batch-size" type="number" min="1" step="1" class="form-input svelte-1rtvxu4"/> <span class="unit svelte-1rtvxu4">L</span></div></div> <div class="param-field svelte-1rtvxu4"><label for="efficiency" class="svelte-1rtvxu4">Efficiency</label> <div class="input-with-unit svelte-1rtvxu4"><input id="efficiency" type="number" min="50" max="95" step="1" class="form-input svelte-1rtvxu4"/> <span class="unit svelte-1rtvxu4">%</span></div></div> <div class="param-field svelte-1rtvxu4"><label for="boil-time" class="svelte-1rtvxu4">Boil Time</label> <div class="input-with-unit svelte-1rtvxu4"><input id="boil-time" type="number" min="30" max="120" step="5" class="form-input svelte-1rtvxu4"/> <span class="unit svelte-1rtvxu4">min</span></div></div></div></div> <div class="section svelte-1rtvxu4"><!></div> <div class="section svelte-1rtvxu4"><!></div> <div class="section yeast-section svelte-1rtvxu4"><!></div> <div class="section notes-section svelte-1rtvxu4"><h2 class="section-title svelte-1rtvxu4">Notes</h2> <textarea placeholder="Brewing notes, tips, or variations..." rows="4" class="notes-input svelte-1rtvxu4"></textarea></div></div> <!>',1);function $s(p,c){qt(c,!0);function y(){r()}function M(){i()}function k(){return e($e)}function z(){return e(H).trim().length>0}let H=g(""),ve=g(""),L=g(""),te=g(""),V=g(rt([])),E=g(null),ae=g(!1),de=g(!1),Te=null,Pe=g(20),me=g(72),De=g(60),qe=g(rt([])),Ge=g(rt([])),Q=g(null),fe=g(!1),we=g(null),$e=g(!1),be=g(null),n=K(()=>()=>{if(e(qe).length===0)return{og:1,fg:1,abv:0,ibu:0,srm:0,color_hex:"#FFE699",calories_per_330ml:0};const l=e(qe).map(G=>({name:G.name,amount_kg:G.amount_kg,potential_sg:G.potential_sg||1.036,color_srm:G.color_srm||2})),f=e(Ge).map(G=>({name:G.name,amount_grams:G.amount_grams,alpha_acid_percent:G.alpha_acid_percent,boil_time_minutes:G.boil_time_minutes,form:G.form,use:G.use})),b={name:e(Q)?.name||"Default Yeast",attenuation_percent:e(Q)?.attenuation_low&&e(Q)?.attenuation_high?(e(Q).attenuation_low+e(Q).attenuation_high)/2:75,temp_min_c:e(Q)?.temp_low||18,temp_max_c:e(Q)?.temp_high||22},Se={batch_size_liters:e(Pe),efficiency_percent:e(me),boil_time_minutes:e(De)};return ja(l,f,b,Se)}),A=K(()=>()=>va(e(n)().ibu,e(n)().og)),Oe=K(()=>()=>{const l=e(A)();return l<.3?"Very Malty":l<.5?"Malty":l<.7?"Balanced":l<.9?"Hoppy":"Very Bitter"}),U=K(()=>()=>{if(!e(E))return[];const l=e(n)(),f=[],b=e(E);return b.og_min!==void 0&&b.og_max!==void 0&&(l.og<b.og_min?f.push({stat:"OG",value:l.og.toFixed(3),range:`${b.og_min.toFixed(3)} - ${b.og_max.toFixed(3)}`,severity:"warning"}):l.og>b.og_max&&f.push({stat:"OG",value:l.og.toFixed(3),range:`${b.og_min.toFixed(3)} - ${b.og_max.toFixed(3)}`,severity:"warning"})),b.fg_min!==void 0&&b.fg_max!==void 0&&(l.fg<b.fg_min||l.fg>b.fg_max)&&f.push({stat:"FG",value:l.fg.toFixed(3),range:`${b.fg_min.toFixed(3)} - ${b.fg_max.toFixed(3)}`,severity:"warning"}),b.abv_min!==void 0&&b.abv_max!==void 0&&(l.abv<b.abv_min||l.abv>b.abv_max)&&f.push({stat:"ABV",value:`${l.abv.toFixed(1)}%`,range:`${b.abv_min.toFixed(1)}% - ${b.abv_max.toFixed(1)}%`,severity:"warning"}),b.ibu_min!==void 0&&b.ibu_max!==void 0&&(l.ibu<b.ibu_min||l.ibu>b.ibu_max)&&f.push({stat:"IBU",value:l.ibu.toFixed(0),range:`${b.ibu_min} - ${b.ibu_max}`,severity:"warning"}),b.srm_min!==void 0&&b.srm_max!==void 0&&(l.srm<b.srm_min||l.srm>b.srm_max)&&f.push({stat:"Color",value:`${l.srm.toFixed(0)} SRM`,range:`${b.srm_min} - ${b.srm_max} SRM`,severity:"warning"}),f});async function ct(l){if(l.length<2){o(V,[],!0),o(de,!1);return}Te&&clearTimeout(Te),Te=setTimeout(async()=>{o(ae,!0);try{o(V,await Ra(l,8),!0),o(de,e(V).length>0)}catch(f){console.error("Failed to search styles:",f),o(V,[],!0)}finally{o(ae,!1)}},300)}function lt(l){const f=l.target;o(L,f.value,!0),e(E)&&e(L)!==e(E).name&&o(E,null),ct(e(L))}function it(l){o(E,l,!0),o(L,l.name,!0),o(de,!1),o(V,[],!0)}function dt(){o(E,null),o(L,""),o(V,[],!0),o(de,!1)}function _t(l){o(qe,l,!0)}function pt(l){o(Ge,l,!0)}function d(l){o(Q,l,!0)}function r(){if(!e(H).trim()){alert("Please enter a recipe name");return}const l={name:e(H),author:e(ve),type:e(L),batch_size_liters:e(Pe),efficiency_percent:e(me),boil_time_minutes:e(De),og:e(n)().og,fg:e(n)().fg,abv:e(n)().abv,ibu:e(n)().ibu,color_srm:e(n)().srm,fermentables:e(qe),hops:e(Ge),yeast:e(Q),notes:e(te)};c.onSave?.(l)}async function i(){if(!e(L).trim()){o(be,"Please enter a beer style to get an AI review"),o(fe,!0);return}if(e(qe).length===0){o(be,"Please add at least one fermentable to get an AI review"),o(fe,!0);return}o($e,!0),o(be,null),o(fe,!0);try{const l=e(n)();o(we,await Ua({name:e(H)||"Untitled Recipe",style:e(L),og:l.og,fg:l.fg,abv:l.abv,ibu:l.ibu,color_srm:l.srm,fermentables:e(qe).map(f=>({name:f.name,amount_kg:f.amount_kg,color_srm:f.color_srm,type:f.category})),hops:e(Ge).map(f=>({name:f.name,amount_grams:f.amount_grams,boil_time_minutes:f.boil_time_minutes,alpha_acid_percent:f.alpha_acid_percent,use:f.use})),yeast:e(Q)?{name:e(Q).name,producer:e(Q).producer,attenuation:e(Q).attenuation}:void 0}),!0)}catch(l){o(be,l instanceof Error?l.message:"Failed to get AI review",!0)}finally{o($e,!1)}}function u(){o(fe,!1),o(we,null),o(be,null)}var w={save:y,review:M,getReviewLoading:k,canSave:z},F=Ys(),j=st(F),ue=a(j),D=a(ue),N=a(D),Ce=s(a(N),2),We=a(Ce,!0);t(Ce),t(N);var _e=s(N,2),B=s(a(_e),2),T=a(B,!0);t(B),t(_e);var X=s(_e,2),Z=s(a(X),2),pe=a(Z);t(Z),t(X),t(D);var ie=s(D,2),ee=a(ie),ke=s(a(ee),2),ge=a(ke,!0);t(ke),t(ee);var Fe=s(ee,2),Le=s(a(Fe),2),q=a(Le,!0);t(Le);var P=s(Le,2),xe=a(P,!0);t(P),t(Fe),t(ie);var ce=s(ie,2),I=a(ce),Y=s(a(I),2),$=a(Y),O=s($,2),W=a(O);t(O),t(Y);var se=s(Y,2),Ae=a(se,!0);t(se),t(I),t(ce);var Ee=s(ce,2),Re=a(Ee),re=s(a(Re),2),ne=a(re,!0);t(re),Xe(2),t(Re),t(Ee),t(ue);var je=s(ue,2);{var oe=l=>{var f=Os(),b=s(a(f),2);He(b,17,()=>e(U)(),ut,(Se,G)=>{var Me=Ps(),Ze=a(Me);t(Me),h(()=>{ra(Me,1,`warning-badge ${e(G).severity??""}`,"svelte-1rtvxu4"),m(Ze,`${e(G).stat??""}: ${e(G).value??""} (target: ${e(G).range??""})`)}),v(Se,Me)}),t(f),v(l,f)};x(je,l=>{e(U)().length>0&&l(oe)})}var le=s(je,2),ze=s(a(le),2),Be=a(ze),Ne=s(a(Be),2);Ie(Ne),t(Be);var he=s(Be,2),Je=s(a(he),2);Ie(Je),t(he);var Ve=s(he,2),Ue=s(a(Ve),2),ye=a(Ue);Ie(ye),ye.__input=lt;var et=s(ye,2);{var R=l=>{var f=Rs();v(l,f)};x(et,l=>{e(ae)&&l(R)})}var S=s(et,2);{var C=l=>{var f=Us();f.__click=dt,v(l,f)};x(S,l=>{e(E)&&l(C)})}t(Ue);var J=s(Ue,2);{var Ye=l=>{var f=Ts();He(f,21,()=>e(V),ut,(b,Se)=>{var G=Hs(),Me=a(G);Me.__click=()=>it(e(Se));var Ze=a(Me),ft=a(Ze,!0);t(Ze);var bt=s(Ze,2);{var Ke=Qe=>{var tt=Is(),gt=a(tt,!0);t(tt),h(()=>m(gt,e(Se).category)),v(Qe,tt)};x(bt,Qe=>{e(Se).category&&Qe(Ke)})}t(Me),t(G),h(()=>m(ft,e(Se).name)),v(b,G)}),t(f),v(l,f)};x(J,l=>{e(de)&&e(V).length>0&&l(Ye)})}t(Ve),t(ze),t(le);var mt=s(le,2),wt=s(a(mt),2),Lt=a(wt),Dt=s(a(Lt),2),Gt=a(Dt);Ie(Gt),Xe(2),t(Dt),t(Lt);var At=s(Lt,2),Et=s(a(At),2),jt=a(Et);Ie(jt),Xe(2),t(Et),t(At);var Nt=s(At,2),Vt=s(a(Nt),2),Yt=a(Vt);Ie(Yt),Xe(2),t(Vt),t(Nt),t(wt),t(mt);var Mt=s(mt,2),ca=a(Mt);cs(ca,{get fermentables(){return e(qe)},get batchSizeLiters(){return e(Pe)},get efficiencyPercent(){return e(me)},onUpdate:_t}),t(Mt);var Pt=s(Mt,2),da=a(Pt);{let l=K(()=>e(n)().og);Ms(da,{get hops(){return e(Ge)},get og(){return e(l)},get batchSizeLiters(){return e(Pe)},onUpdate:pt})}t(Pt);var Ot=s(Pt,2),_a=a(Ot);{let l=K(()=>e(Q)?.id);Ta(_a,{get selectedYeastId(){return e(l)},onSelect:d,label:"Select Yeast Strain"})}t(Ot);var $t=s(Ot,2),Wt=s(a($t),2);Fa(Wt),t($t),t(j);var pa=s(j,2);{var ma=l=>{var f=Vs();f.__click=u;var b=a(f),Se=a(b),G=s(a(Se),2);G.__click=u,t(Se);var Me=s(Se,2),Ze=a(Me);{var ft=Ke=>{var Qe=Ds(),tt=s(a(Qe),2),gt=a(tt);t(tt),t(Qe),h(()=>m(gt,`Analyzing your recipe against ${(e(L)||"style guidelines")??""}...`)),v(Ke,Qe)},bt=Ke=>{var Qe=Ft(),tt=st(Qe);{var gt=nt=>{var ot=Gs(),kt=a(ot),Rt=a(kt,!0);t(kt),t(ot),h(()=>m(Rt,e(be))),v(nt,ot)},fa=nt=>{var ot=Ft(),kt=st(ot);{var Rt=Ut=>{var Jt=Ns(),It=st(Jt),Kt=a(It);{var ba=vt=>{var xt=Es(),ya=a(xt);t(xt),h(()=>m(ya,`BJCP Style: ${e(we).style_name??""}`)),v(vt,xt)},ga=vt=>{var xt=js();v(vt,xt)};x(Kt,vt=>{e(we).style_found?vt(ba):vt(ga,!1)})}var Qt=s(Kt,2),xa=a(Qt);t(Qt),t(It);var Xt=s(It,2),ha=a(Xt);Ha(ha,()=>e(we).review.replace(/\n/g,"<br>")),t(Xt),h(()=>m(xa,`Model: ${e(we).model??""}`)),v(Ut,Jt)};x(kt,Ut=>{e(we)&&Ut(Rt)},!0)}v(nt,ot)};x(tt,nt=>{e(be)?nt(gt):nt(fa,!1)},!0)}v(Ke,Qe)};x(Ze,Ke=>{e($e)?Ke(ft):Ke(bt,!1)})}t(Me),t(b),t(f),v(l,f)};x(pa,l=>{e(fe)&&l(ma)})}return h((l,f,b,Se,G,Me,Ze,ft,bt,Ke)=>{m(We,l),m(T,f),m(pe,`${b??""}%`),m(ge,Se),m(q,G),m(xe,Me),yt($,`background-color: ${Ze??""}`),m(W,`${ft??""} SRM`),m(Ae,bt),m(ne,Ke),ht(ye,e(L))},[()=>e(n)().og.toFixed(3),()=>e(n)().fg.toFixed(3),()=>e(n)().abv.toFixed(1),()=>e(n)().ibu.toFixed(0),()=>e(A)().toFixed(2),()=>e(Oe)(),()=>e(n)().color_hex,()=>e(n)().srm.toFixed(0),()=>Ga(e(n)().srm),()=>e(n)().calories_per_330ml]),at(Ne,()=>e(H),l=>o(H,l)),at(Je,()=>e(ve),l=>o(ve,l)),Zt("focus",ye,()=>e(L).length>=2&&e(V).length>0&&o(de,!0)),Zt("blur",ye,()=>setTimeout(()=>o(de,!1),200)),at(Gt,()=>e(Pe),l=>o(Pe,l)),at(jt,()=>e(me),l=>o(me,l)),at(Yt,()=>e(De),l=>o(De,l)),at(Wt,()=>e(te),l=>o(te,l)),v(p,F),Ct(w)}St(["input","click"]);var Ws=_('<span class="btn-spinner svelte-1pes5m5"></span> Analyzing...',1),Js=wa('<svg class="btn-icon svelte-1pes5m5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456z"></path></svg> AI Review',1),Ks=_('<span class="btn-spinner svelte-1pes5m5"></span> Saving...',1),Qs=_('<div class="error-banner svelte-1pes5m5"><svg class="error-icon svelte-1pes5m5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div>'),Xs=_('<div class="saving-overlay svelte-1pes5m5"><div class="spinner svelte-1pes5m5"></div> <span>Saving recipe...</span></div>'),Zs=_('<div class="page-container svelte-1pes5m5"><div class="back-link svelte-1pes5m5"><a href="/recipes" class="back-btn svelte-1pes5m5"><svg class="back-icon svelte-1pes5m5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg> Back to Recipes</a></div> <div class="page-header svelte-1pes5m5"><div class="header-content svelte-1pes5m5"><h1 class="page-title svelte-1pes5m5">Create New Recipe</h1> <p class="page-description svelte-1pes5m5">Build your recipe with real-time calculations, or <a href="/recipes/import" class="import-link svelte-1pes5m5">import from BeerXML/BeerJSON</a></p></div> <div class="header-actions svelte-1pes5m5"><button type="button" class="btn-ghost svelte-1pes5m5">Cancel</button> <button type="button" class="btn-review svelte-1pes5m5"><!></button> <button type="button" class="btn-save svelte-1pes5m5"><!></button></div></div> <!> <!> <!></div>');function fr(p,c){qt(c,!0);let y=g(!1),M=g(null),k=g(void 0),z=g(!1);za(()=>{const n=setInterval(()=>{e(k)&&o(z,e(k).getReviewLoading(),!0)},100);return()=>clearInterval(n)});async function H(n){o(y,!0),o(M,null);try{const A={name:n.name,author:n.author||void 0,type:n.type||void 0,batch_size_liters:n.batch_size_liters,efficiency_percent:n.efficiency_percent,boil_time_minutes:n.boil_time_minutes,og:n.og,fg:n.fg,abv:n.abv,ibu:n.ibu,color_srm:n.color_srm,notes:n.notes||void 0,yeast_name:n.yeast?.name,yeast_lab:n.yeast?.producer,yeast_product_id:n.yeast?.product_id,yeast_temp_min:n.yeast?.temp_low??void 0,yeast_temp_max:n.yeast?.temp_high??void 0,yeast_attenuation:n.yeast?.attenuation_low&&n.yeast?.attenuation_high?(n.yeast.attenuation_low+n.yeast.attenuation_high)/2:void 0,format_extensions:{fermentables:n.fermentables.map(U=>({id:U.id,name:U.name,amount_kg:U.amount_kg,color_lovibond:U.color_lovibond,potential_sg:U.potential_sg,type:U.type,origin:U.origin,maltster:U.maltster})),hops:n.hops.map(U=>({id:U.id,name:U.name,amount_grams:U.amount_grams,alpha_acid_percent:U.alpha_acid_percent,boil_time_minutes:U.boil_time_minutes,use:U.use,form:U.form,origin:U.origin,purpose:U.purpose}))}},Oe=await Ia(A);ea(`/recipes/${Oe.id}`)}catch(A){o(M,A instanceof Error?A.message:"Failed to create recipe",!0),o(y,!1)}}function ve(){ea("/recipes")}var L=Zs();qa("1pes5m5",n=>{Ba(()=>{Sa.title="New Recipe | BrewSignal"})});var te=s(a(L),2),V=s(a(te),2),E=a(V);E.__click=ve;var ae=s(E,2);ae.__click=()=>e(k)?.review();var de=a(ae);{var Te=n=>{var A=Ws();Xe(),v(n,A)},Pe=n=>{var A=Js();Xe(),v(n,A)};x(de,n=>{e(z)?n(Te):n(Pe,!1)})}t(ae);var me=s(ae,2);me.__click=()=>e(k)?.save();var De=a(me);{var qe=n=>{var A=Ks();Xe(),v(n,A)},Ge=n=>{var A=ka("Save Recipe");v(n,A)};x(De,n=>{e(y)?n(qe):n(Ge,!1)})}t(me),t(V),t(te);var Q=s(te,2);{var fe=n=>{var A=Qs(),Oe=s(a(A),2),U=a(Oe,!0);t(Oe),t(A),h(()=>m(U,e(M))),v(n,A)};x(Q,n=>{e(M)&&n(fe)})}var we=s(Q,2);{var $e=n=>{var A=Xs();v(n,A)};x(we,n=>{e(y)&&n($e)})}var be=s(we,2);Ca($s(be,{onSave:H,onCancel:ve}),n=>o(k,n,!0),()=>e(k)),t(L),h(()=>{ae.disabled=e(z),me.disabled=e(y)}),v(p,L),Ct()}St(["click"]);export{fr as component};
