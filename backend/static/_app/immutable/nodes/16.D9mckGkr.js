import{d as Dt,f as d,a as v,s as f,c as wt,e as ta,t as aa}from"../chunks/D3BGmjiQ.js";import{a as zt,s as w,p as Ze,o as ia,c as n,g as s,h as Bt,d as a,j as t,i as e,t as F,l as W,n as tt,f as $e,ax as Ht,k as Ba,e as Sa,aw as Ca}from"../chunks/qPFz7rcR.js";import{i as x}from"../chunks/VWvnMYpw.js";import{h as qa}from"../chunks/DUkqxoKv.js";import{g as sa}from"../chunks/D3GNzYLJ.js";import{z as La,A as Aa,a4 as Ma,h as Pa,y as Oa,a5 as Ua,a6 as Ra,a7 as Ia}from"../chunks/EAXntHjR.js";import{e as Me,i as vt}from"../chunks/fEN5jtvK.js";import{h as Ha}from"../chunks/HeXKYDcw.js";import{r as Ae,b as xt}from"../chunks/D6lThKhy.js";import{s as na}from"../chunks/B1LnsfEN.js";import{s as ht}from"../chunks/DiFo9CWT.js";import{b as Xe}from"../chunks/DzkFo9Qc.js";import{b as kt,i as ra,s as la}from"../chunks/Dx7-pTgU.js";import{p as Ft}from"../chunks/DL3aSIGJ.js";import{Y as Ta}from"../chunks/CwaQo6hd.js";function oa(p,u){return 1+p.reduce((L,g)=>{const C=(g.potential_sg-1)*1e3,A=g.amount_kg*C*u.efficiency_percent/(u.batch_size_liters/100);return L+A},0)/1e3}function Da(p,u){return 1+(p-1)*1e3*(1-u/100)/1e3}function va(p,u,h="simple"){return h==="simple"?(p-u)*131.25:76.08*(p-u)/(1.775-p)*(u/.794)}function ua(p,u,h){if(p.use==="dry_hop"||p.boil_time_minutes<=0)return 0;const L=1.65*Math.pow(125e-6,u-1),g=(1-Math.exp(-.04*p.boil_time_minutes))/4.15;let C=L*g;p.form==="pellet"&&(C*=1.1),p.use==="first_wort"&&(C*=1.1),p.use==="whirlpool"&&(C*=.2);const A=p.alpha_acid_percent/100*p.amount_grams*C*1e3/(h*10);return Math.max(0,A)}function ca(p,u,h){return p.reduce((L,g)=>L+ua(g,u,h),0)}function da(p,u){const h=(u-1)*1e3;return h>0?p/h:0}function _a(p,u){const h=u*.264172,L=p.reduce((C,A)=>{const E=A.amount_kg*2.20462;return C+E*A.color_srm/h},0),g=1.4922*Math.pow(L,.6859);return Math.min(40,Math.max(0,g))}function Tt(p){const u=Math.max(1,Math.min(40,p)),h={1:"#FFE699",2:"#FFD878",3:"#FFCA5A",4:"#FFBF42",5:"#FBB123",6:"#F8A600",7:"#F39C00",8:"#EA8F00",9:"#E58500",10:"#DE7C00",11:"#D77200",12:"#CF6900",13:"#CB6200",14:"#C35900",15:"#BB5100",16:"#B54C00",17:"#B04500",18:"#A63E00",19:"#A13700",20:"#9B3200",25:"#7C2900",30:"#5E1E00",35:"#401500",40:"#261000"},L=Object.keys(h).map(Number).sort((C,A)=>C-A);let g=L[0];for(const C of L)if(C<=u)g=C;else break;return h[g]||"#261000"}function Ga(p){return p<2?"Pale Straw":p<3?"Straw":p<4?"Pale Gold":p<6?"Deep Gold":p<9?"Amber":p<12?"Copper":p<15?"Light Brown":p<18?"Brown":p<20?"Dark Brown":p<24?"Very Dark":p<30?"Black":"Opaque Black"}function Ea(p,u,h=330){const g=va(p,u)*.79*7*(h/100),C=(u-1)*1e3*.4*(h/100);return Math.round(g+C)}function ja(p,u,h,L){const g=oa(p,L),C=Da(g,h.attenuation_percent),A=va(g,C),E=ca(u,g,L.batch_size_liters),ee=_a(p,L.batch_size_liters);return{og:Math.round(g*1e3)/1e3,fg:Math.round(C*1e3)/1e3,abv:Math.round(A*10)/10,ibu:Math.round(E),srm:Math.round(ee*10)/10,color_hex:Tt(ee),calories_per_330ml:Ea(g,C,330)}}var Na=d('<span class="stats svelte-1qls65z"> <span class="color-swatch svelte-1qls65z"></span> </span>'),Va=d('<div class="empty-state svelte-1qls65z"><p class="svelte-1qls65z">No fermentables added yet.</p> <button type="button" class="browse-btn svelte-1qls65z">Browse Library</button></div>'),Ya=d('<span class="ferm-type svelte-1qls65z"> </span>'),Wa=d('<span class="detail svelte-1qls65z"> </span>'),Ja=d('<span class="detail svelte-1qls65z"> </span>'),Ka=d('<span class="detail svelte-1qls65z"> </span>'),Qa=d('<div class="ferm-item svelte-1qls65z"><div class="ferm-main svelte-1qls65z"><div class="ferm-info svelte-1qls65z"><span class="ferm-name svelte-1qls65z"> </span> <!></div> <div class="ferm-details svelte-1qls65z"><!> <!> <!></div></div> <div class="ferm-controls svelte-1qls65z"><div class="amount-input svelte-1qls65z"><input type="number" step="0.1" min="0" class="svelte-1qls65z"/> <span class="unit svelte-1qls65z">kg</span></div> <span class="percent svelte-1qls65z"> </span> <button type="button" class="remove-btn svelte-1qls65z">×</button></div></div>'),Xa=d('<div class="fermentables-list svelte-1qls65z"></div>'),$a=d('<div class="loading svelte-1qls65z"><div class="spinner svelte-1qls65z"></div> <p>Loading fermentables...</p></div>'),Za=d('<div class="error-box svelte-1qls65z"><p class="error-text svelte-1qls65z"> </p></div>'),es=d("<option> </option>"),ts=d("<option> </option>"),as=d('<span class="item-maltster svelte-1qls65z"> </span>'),ss=d('<span class="item-color svelte-1qls65z"><span class="color-dot svelte-1qls65z"></span> </span>'),rs=d('<span class="item-potential svelte-1qls65z"> </span>'),ls=d('<button type="button"><div class="item-main svelte-1qls65z"><span class="item-name svelte-1qls65z"> </span> <!></div> <div class="item-details svelte-1qls65z"><!> <!></div></button>'),is=d('<div class="type-group svelte-1qls65z"><h5 class="type-name svelte-1qls65z"> </h5> <!></div>'),ns=d('<div class="no-results svelte-1qls65z"><p class="svelte-1qls65z">No fermentables match your filters</p></div>'),os=d('<div class="filters svelte-1qls65z"><input type="text" placeholder="Search fermentables..." class="search-input svelte-1qls65z"/> <div class="filter-row svelte-1qls65z"><select class="filter-select svelte-1qls65z"><option>All Types</option><!></select> <select class="filter-select svelte-1qls65z"><option>All Origins</option><!></select></div></div> <div class="library-list svelte-1qls65z"><!> <!></div>',1),vs=d('<div class="browser-overlay svelte-1qls65z"><div class="browser-modal svelte-1qls65z"><div class="browser-header svelte-1qls65z"><h4 class="svelte-1qls65z">Add Fermentable</h4> <button type="button" class="close-btn svelte-1qls65z">×</button></div> <!></div></div>'),us=d('<div class="fermentable-selector svelte-1qls65z"><div class="selector-header svelte-1qls65z"><div class="header-left svelte-1qls65z"><h3 class="svelte-1qls65z">Grain Bill</h3> <!></div> <button type="button" class="add-btn svelte-1qls65z">+ Add Fermentable</button></div> <!> <!></div>');function cs(p,u){zt(u,!0);let h=Ft(u,"batchSizeLiters",3,20),L=Ft(u,"efficiencyPercent",3,72),g=w(Ze([])),C=w(Ze([])),A=w(Ze([])),E=w(!0),ee=w(null),j=w(""),_e=w(""),X=w(""),m=w(!1),N=W(()=>u.fermentables.reduce((c,r)=>c+r.amount_kg,0)),se=W(()=>()=>{if(u.fermentables.length===0)return{og:1,srm:0,color_hex:"#FFE699"};const c=u.fermentables.map(z=>({name:z.name,amount_kg:z.amount_kg,potential_sg:z.potential_sg||1.036,color_srm:z.color_srm||2})),r={batch_size_liters:h(),efficiency_percent:L()},i=oa(c,r),o=_a(c,h()),y=Tt(o);return{og:i,srm:o,color_hex:y}}),M=W(()=>()=>e(g).filter(c=>{const r=!e(j)||c.name.toLowerCase().includes(e(j).toLowerCase())||c.maltster?.toLowerCase().includes(e(j).toLowerCase())||c.origin?.toLowerCase().includes(e(j).toLowerCase()),i=!e(_e)||c.type===e(_e),o=!e(X)||c.origin===e(X);return r&&i&&o})),te=W(()=>()=>{const c={};for(const i of e(M)()){const o=i.type||"Other";c[o]||(c[o]=[]),c[o].push(i)}const r=["base","specialty","adjunct","sugar","extract","fruit","other"];return Object.fromEntries(Object.entries(c).sort(([i],[o])=>{const y=r.indexOf(i.toLowerCase()),z=r.indexOf(o.toLowerCase());return y>=0&&z>=0?y-z:y>=0?-1:z>=0?1:i.localeCompare(o)}))});ia(async()=>{try{const[c,r,i]=await Promise.all([La(),Aa(),Ma()]);n(g,c,!0),n(C,r.types||[],!0),n(A,i.origins||[],!0)}catch(c){n(ee,c instanceof Error?c.message:"Failed to load fermentables",!0),console.error("Failed to load fermentables:",c)}finally{n(E,!1)}});function De(c){if(u.fermentables.some(i=>i.id===c.id))return;const r={...c,amount_kg:.5};u.onUpdate([...u.fermentables,r]),n(m,!1)}function Pe(c){u.onUpdate(u.fermentables.filter(r=>r.id!==c))}function Ne(c,r){u.onUpdate(u.fermentables.map(i=>i.id===c?{...i,amount_kg:Math.max(0,r)}:i))}function Oe(c){return!c||!e(N)?"0%":(c/e(N)*100).toFixed(1)+"%"}function H(c){return c==null?"--":c.toFixed(0)+"°L"}function at(c){return c==null?"--":c.toFixed(3)}function ut(c){switch(c?.toLowerCase()){case"base":return"var(--positive)";case"specialty":return"var(--warning)";case"adjunct":return"var(--info)";case"sugar":return"var(--accent-primary)";case"extract":return"var(--text-secondary)";default:return"var(--text-tertiary)"}}var Je=us(),Ve=a(Je),Ye=a(Ve),et=s(a(Ye),2);{var ct=c=>{var r=Na(),i=a(r),o=s(i),y=s(o);t(r),F((z,J,ve,D)=>{f(i,`${z??""} kg · OG ${J??""} · `),ht(o,`background-color: ${ve??""}`),f(y,` ${D??""} SRM`)},[()=>e(N).toFixed(2),()=>e(se)().og.toFixed(3),()=>e(se)().color_hex,()=>e(se)().srm.toFixed(0)]),v(c,r)};x(et,c=>{u.fermentables.length>0&&c(ct)})}t(Ye);var dt=s(Ye,2);dt.__click=()=>n(m,!0),t(Ve);var st=s(Ve,2);{var rt=c=>{var r=Va(),i=s(a(r),2);i.__click=()=>n(m,!0),t(r),v(c,r)},_t=c=>{var r=Xa();Me(r,21,()=>u.fermentables,i=>i.id,(i,o)=>{var y=Qa(),z=a(y),J=a(z),ve=a(J),D=a(ve,!0);t(ve);var K=s(ve,2);{var ke=S=>{var O=Ya(),de=a(O,!0);t(O),F(fe=>{ht(O,`color: ${fe??""}`),f(de,e(o).type)},[()=>ut(e(o).type)]),v(S,O)};x(K,S=>{e(o).type&&S(ke)})}t(J);var Ue=s(J,2),be=a(Ue);{var B=S=>{var O=Wa(),de=a(O,!0);t(O),F(()=>f(de,e(o).maltster)),v(S,O)};x(be,S=>{e(o).maltster&&S(B)})}var R=s(be,2);{var Q=S=>{var O=Ja(),de=a(O,!0);t(O),F(fe=>f(de,fe),[()=>H(e(o).color_srm)]),v(S,O)};x(R,S=>{e(o).color_srm&&S(Q)})}var $=s(R,2);{var ue=S=>{var O=Ka(),de=a(O,!0);t(O),F(fe=>f(de,fe),[()=>at(e(o).potential_sg)]),v(S,O)};x($,S=>{e(o).potential_sg&&S(ue)})}t(Ue),t(z);var re=s(z,2),le=a(re),ge=a(le);Ae(ge),ge.__change=S=>Ne(e(o).id,parseFloat(S.currentTarget.value)||0),tt(2),t(le);var pe=s(le,2),me=a(pe,!0);t(pe);var Se=s(pe,2);Se.__click=()=>Pe(e(o).id),t(re),t(y),F(S=>{f(D,e(o).name),xt(ge,e(o).amount_kg),f(me,S)},[()=>Oe(e(o).amount_kg)]),v(i,y)}),t(r),v(c,r)};x(st,c=>{u.fermentables.length===0?c(rt):c(_t,!1)})}var pt=s(st,2);{var lt=c=>{var r=vs();r.__click=()=>n(m,!1);var i=a(r);i.__click=D=>D.stopPropagation();var o=a(i),y=s(a(o),2);y.__click=()=>n(m,!1),t(o);var z=s(o,2);{var J=D=>{var K=$a();v(D,K)},ve=D=>{var K=wt(),ke=$e(K);{var Ue=B=>{var R=Za(),Q=a(R),$=a(Q,!0);t(Q),t(R),F(()=>f($,e(ee))),v(B,R)},be=B=>{var R=os(),Q=$e(R),$=a(Q);Ae($);var ue=s($,2),re=a(ue),le=a(re);le.value=le.__value="";var ge=s(le);Me(ge,17,()=>e(C),vt,(I,Z)=>{var V=es(),U=a(V,!0);t(V);var G={};F(()=>{f(U,e(Z)),G!==(G=e(Z))&&(V.value=(V.__value=e(Z))??"")}),v(I,V)}),t(re);var pe=s(re,2),me=a(pe);me.value=me.__value="";var Se=s(me);Me(Se,17,()=>e(A),vt,(I,Z)=>{var V=ts(),U=a(V,!0);t(V);var G={};F(()=>{f(U,e(Z)),G!==(G=e(Z))&&(V.value=(V.__value=e(Z))??"")}),v(I,V)}),t(pe),t(ue),t(Q);var S=s(Q,2),O=a(S);Me(O,17,()=>Object.entries(e(te)()),([I,Z])=>I,(I,Z)=>{var V=W(()=>Ht(e(Z),2));let U=()=>e(V)[0],G=()=>e(V)[1];var ie=is(),xe=a(ie),Ge=a(xe,!0);t(xe);var Fe=s(xe,2);Me(Fe,17,G,ae=>ae.id,(ae,ne)=>{const he=W(()=>u.fermentables.some(k=>k.id===e(ne).id));var oe=ls();let ce;oe.__click=()=>De(e(ne));var ze=a(oe),Ce=a(ze),qe=a(Ce,!0);t(Ce);var ye=s(Ce,2);{var Re=k=>{var q=as(),Y=a(q,!0);t(q),F(()=>f(Y,e(ne).maltster)),v(k,q)};x(ye,k=>{e(ne).maltster&&k(Re)})}t(ze);var Ie=s(ze,2),Le=a(Ie);{var He=k=>{var q=ss(),Y=a(q),Te=s(Y);t(q),F((St,Ct)=>{ht(Y,`background-color: ${St??""}`),f(Te,` ${Ct??""}°L`)},[()=>Tt(e(ne).color_srm),()=>e(ne).color_srm.toFixed(0)]),v(k,q)};x(Le,k=>{e(ne).color_srm&&k(He)})}var Ke=s(Le,2);{var P=k=>{var q=rs(),Y=a(q,!0);t(q),F(Te=>f(Y,Te),[()=>e(ne).potential_sg.toFixed(3)]),v(k,q)};x(Ke,k=>{e(ne).potential_sg&&k(P)})}t(Ie),t(oe),F(()=>{ce=na(oe,1,"library-item svelte-1qls65z",null,ce,{added:e(he)}),oe.disabled=e(he),f(qe,e(ne).name)}),v(ae,oe)}),t(ie),F(()=>f(Ge,U())),v(I,ie)});var de=s(O,2);{var fe=I=>{var Z=ns();v(I,Z)};x(de,I=>{Object.keys(e(te)()).length===0&&I(fe)})}t(S),Xe($,()=>e(j),I=>n(j,I)),kt(re,()=>e(_e),I=>n(_e,I)),kt(pe,()=>e(X),I=>n(X,I)),v(B,R)};x(ke,B=>{e(ee)?B(Ue):B(be,!1)},!0)}v(D,K)};x(z,D=>{e(E)?D(J):D(ve,!1)})}t(i),t(r),v(c,r)};x(pt,c=>{e(m)&&c(lt)})}t(Je),v(p,Je),Bt()}Dt(["click","change"]);var ds=d('<span class="stats svelte-4wskud"> <span class="balance svelte-4wskud"> </span></span>'),_s=d('<div class="empty-state svelte-4wskud"><p class="svelte-4wskud">No hops added yet.</p> <button type="button" class="browse-btn svelte-4wskud">Browse Library</button></div>'),ps=d('<span class="hop-origin svelte-4wskud"> </span>'),ms=d('<span class="ibu-value svelte-4wskud"> </span>'),fs=d('<span class="ibu-zero svelte-4wskud">0 IBU</span>'),bs=d('<div class="control-group svelte-4wskud"><label class="svelte-4wskud">Time</label> <div class="input-with-unit svelte-4wskud"><input type="number" step="5" min="0" max="90" class="svelte-4wskud"/> <span class="unit svelte-4wskud">min</span></div></div>'),gs=d('<div class="hop-item svelte-4wskud"><div class="hop-main svelte-4wskud"><div class="hop-info svelte-4wskud"><span class="hop-name svelte-4wskud"> </span> <!></div> <div class="hop-ibu svelte-4wskud"><!></div></div> <div class="hop-controls svelte-4wskud"><div class="control-row svelte-4wskud"><div class="control-group svelte-4wskud"><label class="svelte-4wskud">Amount</label> <div class="input-with-unit svelte-4wskud"><input type="number" step="5" min="0" class="svelte-4wskud"/> <span class="unit svelte-4wskud">g</span></div></div> <div class="control-group svelte-4wskud"><label class="svelte-4wskud">AA%</label> <input type="number" step="0.1" min="0" max="25" class="aa-input svelte-4wskud"/></div> <!> <div class="control-group svelte-4wskud"><label class="svelte-4wskud">Use</label> <select class="svelte-4wskud"><option>Boil</option><option>First Wort</option><option>Whirlpool</option><option>Dry Hop</option><option>Mash</option></select></div> <div class="control-group svelte-4wskud"><label class="svelte-4wskud">Form</label> <select class="svelte-4wskud"><option>Pellet</option><option>Whole</option><option>Plug</option></select></div></div> <button type="button" class="remove-btn svelte-4wskud">×</button></div></div>'),xs=d('<div class="use-group svelte-4wskud"><h4 class="use-name svelte-4wskud"> </h4> <!></div>'),hs=d('<div class="hops-list svelte-4wskud"></div>'),ys=d('<div class="loading svelte-4wskud"><div class="spinner svelte-4wskud"></div> <p>Loading hops...</p></div>'),ws=d('<div class="error-box svelte-4wskud"><p class="error-text svelte-4wskud"> </p></div>'),ks=d("<option> </option>"),Fs=d('<span class="item-origin svelte-4wskud"> </span>'),zs=d('<span class="item-aroma svelte-4wskud"> </span>'),Bs=d('<button type="button" class="library-item svelte-4wskud"><div class="item-main svelte-4wskud"><span class="item-name svelte-4wskud"> </span> <!></div> <div class="item-details svelte-4wskud"><span class="item-aa svelte-4wskud"> </span> <!></div></button>'),Ss=d('<div class="purpose-group svelte-4wskud"><h5 class="purpose-name svelte-4wskud"> </h5> <!></div>'),Cs=d('<div class="no-results svelte-4wskud"><p class="svelte-4wskud">No hops match your filters</p></div>'),qs=d('<div class="filters svelte-4wskud"><input type="text" placeholder="Search hops..." class="search-input svelte-4wskud"/> <div class="filter-row svelte-4wskud"><select class="filter-select svelte-4wskud"><option>All Purposes</option><option>Bittering</option><option>Aroma</option><option>Dual Purpose</option></select> <select class="filter-select svelte-4wskud"><option>All Origins</option><!></select></div></div> <div class="library-list svelte-4wskud"><!> <!></div>',1),Ls=d('<div class="browser-overlay svelte-4wskud"><div class="browser-modal svelte-4wskud"><div class="browser-header svelte-4wskud"><h4 class="svelte-4wskud">Add Hop</h4> <button type="button" class="close-btn svelte-4wskud">×</button></div> <!></div></div>'),As=d('<div class="hop-selector svelte-4wskud"><div class="selector-header svelte-4wskud"><div class="header-left svelte-4wskud"><h3 class="svelte-4wskud">Hop Schedule</h3> <!></div> <button type="button" class="add-btn svelte-4wskud">+ Add Hop</button></div> <!> <!></div>');function Ms(p,u){zt(u,!0);let h=Ft(u,"og",3,1.05),L=Ft(u,"batchSizeLiters",3,20),g=w(Ze([])),C=w(Ze([])),A=w(!0),E=w(null),ee=w(""),j=w(""),_e=w(""),X=w(!1),m=W(()=>()=>{if(u.hops.length===0)return 0;const r=u.hops.map(i=>({name:i.name,amount_grams:i.amount_grams,alpha_acid_percent:i.alpha_acid_percent,boil_time_minutes:i.boil_time_minutes,form:i.form,use:i.use}));return ca(r,h(),L())}),N=W(()=>()=>da(e(m)(),h())),se=W(()=>()=>{const r=e(N)();return r<.3?"Very Sweet":r<.5?"Malty":r<.7?"Balanced":r<.9?"Hoppy":"Very Bitter"});function M(r){const i={name:r.name,amount_grams:r.amount_grams,alpha_acid_percent:r.alpha_acid_percent,boil_time_minutes:r.boil_time_minutes,form:r.form,use:r.use};return ua(i,h(),L())}let te=W(()=>()=>e(g).filter(r=>{const i=!e(ee)||r.name.toLowerCase().includes(e(ee).toLowerCase())||r.origin?.toLowerCase().includes(e(ee).toLowerCase())||r.aroma_profile?.toLowerCase().includes(e(ee).toLowerCase()),o=!e(j)||r.origin===e(j),y=!e(_e)||r.purpose===e(_e);return i&&o&&y})),De=W(()=>()=>{const r={};for(const o of e(te)()){const y=o.purpose||"Other";r[y]||(r[y]=[]),r[y].push(o)}const i=["dual","bittering","aroma"];return Object.fromEntries(Object.entries(r).sort(([o],[y])=>{const z=i.indexOf(o.toLowerCase()),J=i.indexOf(y.toLowerCase());return z>=0&&J>=0?z-J:z>=0?-1:J>=0?1:o.localeCompare(y)}))}),Pe=W(()=>()=>{const r={};for(const i of u.hops){const o=i.use||"boil";r[o]||(r[o]=[]),r[o].push(i)}return r.boil&&r.boil.sort((i,o)=>o.boil_time_minutes-i.boil_time_minutes),r});ia(async()=>{try{const[r,i]=await Promise.all([Pa(),Oa()]);n(g,r,!0),n(C,i.origins||[],!0)}catch(r){n(E,r instanceof Error?r.message:"Failed to load hops",!0),console.error("Failed to load hops:",r)}finally{n(A,!1)}});function Ne(r){const i=r.alpha_acid_low&&r.alpha_acid_high?(r.alpha_acid_low+r.alpha_acid_high)/2:r.alpha_acid_low||r.alpha_acid_high||10,o={...r,amount_grams:30,boil_time_minutes:60,use:"boil",form:"pellet",alpha_acid_percent:i};u.onUpdate([...u.hops,o]),n(X,!1)}function Oe(r){const i=[...u.hops];i.splice(r,1),u.onUpdate(i)}function H(r,i,o){const y=u.hops.map((z,J)=>J===r?{...z,[i]:o}:z);u.onUpdate(y)}function at(r,i){return r!=null&&i!=null?`${r.toFixed(1)}-${i.toFixed(1)}%`:r!=null?`${r.toFixed(1)}%+`:i!=null?`≤${i.toFixed(1)}%`:"--"}function ut(r){return{boil:"Boil",whirlpool:"Whirlpool",dry_hop:"Dry Hop",first_wort:"First Wort",mash:"Mash"}[r]||r}function Je(r){switch(r?.toLowerCase()){case"bittering":return"var(--warning)";case"aroma":return"var(--positive)";case"dual":return"var(--info)";default:return"var(--text-tertiary)"}}var Ve=As(),Ye=a(Ve),et=a(Ye),ct=s(a(et),2);{var dt=r=>{var i=ds(),o=a(i),y=s(o),z=a(y,!0);t(y),t(i),F((J,ve,D)=>{f(o,`${J??""} IBU · BU:GU ${ve??""} · `),f(z,D)},[()=>e(m)().toFixed(0),()=>e(N)().toFixed(2),()=>e(se)()]),v(r,i)};x(ct,r=>{u.hops.length>0&&r(dt)})}t(et);var st=s(et,2);st.__click=()=>n(X,!0),t(Ye);var rt=s(Ye,2);{var _t=r=>{var i=_s(),o=s(a(i),2);o.__click=()=>n(X,!0),t(i),v(r,i)},pt=r=>{var i=hs();Me(i,21,()=>Object.entries(e(Pe)()),vt,(o,y)=>{var z=W(()=>Ht(e(y),2));let J=()=>e(z)[0],ve=()=>e(z)[1];var D=xs(),K=a(D),ke=a(K,!0);t(K);var Ue=s(K,2);Me(Ue,19,ve,(be,B)=>be.id+"-"+B,(be,B)=>{const R=W(()=>u.hops.indexOf(e(B))),Q=W(()=>M(e(B)));var $=gs(),ue=a($),re=a(ue),le=a(re),ge=a(le,!0);t(le);var pe=s(le,2);{var me=P=>{var k=ps(),q=a(k,!0);t(k),F(()=>f(q,e(B).origin)),v(P,k)};x(pe,P=>{e(B).origin&&P(me)})}t(re);var Se=s(re,2),S=a(Se);{var O=P=>{var k=ms(),q=a(k);t(k),F(Y=>f(q,`+${Y??""} IBU`),[()=>e(Q).toFixed(0)]),v(P,k)},de=P=>{var k=fs();v(P,k)};x(S,P=>{e(Q)>0?P(O):P(de,!1)})}t(Se),t(ue);var fe=s(ue,2),I=a(fe),Z=a(I),V=s(a(Z),2),U=a(V);Ae(U),U.__change=P=>H(e(R),"amount_grams",parseFloat(P.currentTarget.value)||0),tt(2),t(V),t(Z);var G=s(Z,2),ie=s(a(G),2);Ae(ie),ie.__change=P=>H(e(R),"alpha_acid_percent",parseFloat(P.currentTarget.value)||0),t(G);var xe=s(G,2);{var Ge=P=>{var k=bs(),q=s(a(k),2),Y=a(q);Ae(Y),Y.__change=Te=>H(e(R),"boil_time_minutes",parseInt(Te.currentTarget.value)||0),tt(2),t(q),t(k),F(()=>xt(Y,e(B).boil_time_minutes)),v(P,k)};x(xe,P=>{e(B).use==="boil"&&P(Ge)})}var Fe=s(xe,2),ae=s(a(Fe),2);ae.__change=P=>H(e(R),"use",P.currentTarget.value);var ne=a(ae);ne.value=ne.__value="boil";var he=s(ne);he.value=he.__value="first_wort";var oe=s(he);oe.value=oe.__value="whirlpool";var ce=s(oe);ce.value=ce.__value="dry_hop";var ze=s(ce);ze.value=ze.__value="mash",t(ae);var Ce;ra(ae),t(Fe);var qe=s(Fe,2),ye=s(a(qe),2);ye.__change=P=>H(e(R),"form",P.currentTarget.value);var Re=a(ye);Re.value=Re.__value="pellet";var Ie=s(Re);Ie.value=Ie.__value="whole";var Le=s(Ie);Le.value=Le.__value="plug",t(ye);var He;ra(ye),t(qe),t(I);var Ke=s(I,2);Ke.__click=()=>Oe(e(R)),t(fe),t($),F(()=>{f(ge,e(B).name),xt(U,e(B).amount_grams),xt(ie,e(B).alpha_acid_percent),Ce!==(Ce=e(B).use)&&(ae.value=(ae.__value=e(B).use)??"",la(ae,e(B).use)),He!==(He=e(B).form)&&(ye.value=(ye.__value=e(B).form)??"",la(ye,e(B).form))}),v(be,$)}),t(D),F(be=>f(ke,be),[()=>ut(J())]),v(o,D)}),t(i),v(r,i)};x(rt,r=>{u.hops.length===0?r(_t):r(pt,!1)})}var lt=s(rt,2);{var c=r=>{var i=Ls();i.__click=()=>n(X,!1);var o=a(i);o.__click=K=>K.stopPropagation();var y=a(o),z=s(a(y),2);z.__click=()=>n(X,!1),t(y);var J=s(y,2);{var ve=K=>{var ke=ys();v(K,ke)},D=K=>{var ke=wt(),Ue=$e(ke);{var be=R=>{var Q=ws(),$=a(Q),ue=a($,!0);t($),t(Q),F(()=>f(ue,e(E))),v(R,Q)},B=R=>{var Q=qs(),$=$e(Q),ue=a($);Ae(ue);var re=s(ue,2),le=a(re),ge=a(le);ge.value=ge.__value="";var pe=s(ge);pe.value=pe.__value="bittering";var me=s(pe);me.value=me.__value="aroma";var Se=s(me);Se.value=Se.__value="dual",t(le);var S=s(le,2),O=a(S);O.value=O.__value="";var de=s(O);Me(de,17,()=>e(C),vt,(U,G)=>{var ie=ks(),xe=a(ie,!0);t(ie);var Ge={};F(()=>{f(xe,e(G)),Ge!==(Ge=e(G))&&(ie.value=(ie.__value=e(G))??"")}),v(U,ie)}),t(S),t(re),t($);var fe=s($,2),I=a(fe);Me(I,17,()=>Object.entries(e(De)()),([U,G])=>U,(U,G)=>{var ie=W(()=>Ht(e(G),2));let xe=()=>e(ie)[0],Ge=()=>e(ie)[1];var Fe=Ss(),ae=a(Fe),ne=a(ae,!0);t(ae);var he=s(ae,2);Me(he,17,Ge,oe=>oe.id,(oe,ce)=>{var ze=Bs();ze.__click=()=>Ne(e(ce));var Ce=a(ze),qe=a(Ce),ye=a(qe,!0);t(qe);var Re=s(qe,2);{var Ie=q=>{var Y=Fs(),Te=a(Y,!0);t(Y),F(()=>f(Te,e(ce).origin)),v(q,Y)};x(Re,q=>{e(ce).origin&&q(Ie)})}t(Ce);var Le=s(Ce,2),He=a(Le),Ke=a(He,!0);t(He);var P=s(He,2);{var k=q=>{var Y=zs(),Te=a(Y,!0);t(Y),F(()=>f(Te,e(ce).aroma_profile)),v(q,Y)};x(P,q=>{e(ce).aroma_profile&&q(k)})}t(Le),t(ze),F(q=>{f(ye,e(ce).name),f(Ke,q)},[()=>at(e(ce).alpha_acid_low,e(ce).alpha_acid_high)]),v(oe,ze)}),t(Fe),F(oe=>{ht(ae,`color: ${oe??""}`),f(ne,xe())},[()=>Je(xe())]),v(U,Fe)});var Z=s(I,2);{var V=U=>{var G=Cs();v(U,G)};x(Z,U=>{Object.keys(e(De)()).length===0&&U(V)})}t(fe),Xe(ue,()=>e(ee),U=>n(ee,U)),kt(le,()=>e(_e),U=>n(_e,U)),kt(S,()=>e(j),U=>n(j,U)),v(R,Q)};x(Ue,R=>{e(E)?R(be):R(B,!1)},!0)}v(K,ke)};x(J,K=>{e(A)?K(ve):K(D,!1)})}t(o),t(i),v(r,i)};x(lt,r=>{e(X)&&r(c)})}t(Ve),v(p,Ve),Bt()}Dt(["click","change"]);var Ps=d("<span> </span>"),Os=d('<div class="style-warnings svelte-1rtvxu4"><span class="warnings-label svelte-1rtvxu4">Style Guidelines:</span> <!></div>'),Us=d('<button type="button" class="btn-secondary svelte-1rtvxu4">Cancel</button>'),Rs=d('<span class="autocomplete-spinner svelte-1rtvxu4"></span>'),Is=d('<button type="button" class="clear-style svelte-1rtvxu4" aria-label="Clear style">&times;</button>'),Hs=d('<span class="style-category svelte-1rtvxu4"> </span>'),Ts=d('<li><button type="button" class="style-option svelte-1rtvxu4"><span class="style-name svelte-1rtvxu4"> </span> <!></button></li>'),Ds=d('<ul class="style-dropdown svelte-1rtvxu4"></ul>'),Gs=d('<div class="review-loading svelte-1rtvxu4"><div class="spinner svelte-1rtvxu4"></div> <p class="svelte-1rtvxu4"> </p></div>'),Es=d('<div class="review-error svelte-1rtvxu4"><p> </p></div>'),js=d('<span class="style-badge found svelte-1rtvxu4"> </span>'),Ns=d('<span class="style-badge not-found svelte-1rtvxu4">Style not in BJCP database</span>'),Vs=d('<div class="review-meta svelte-1rtvxu4"><!> <span class="model-badge svelte-1rtvxu4"> </span></div> <div class="review-content svelte-1rtvxu4"><!></div>',1),Ys=d('<div class="modal-overlay svelte-1rtvxu4" role="presentation"><div class="modal-content svelte-1rtvxu4" role="dialog" aria-modal="true" aria-labelledby="review-modal-title" tabindex="-1"><div class="modal-header svelte-1rtvxu4"><h2 id="review-modal-title" class="svelte-1rtvxu4">AI Recipe Review</h2> <button class="modal-close svelte-1rtvxu4" aria-label="Close">&times;</button></div> <div class="modal-body svelte-1rtvxu4"><!></div></div></div>'),Ws=d('<div class="recipe-builder svelte-1rtvxu4"><div class="stats-panel svelte-1rtvxu4"><div class="stat-group svelte-1rtvxu4"><div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">OG</span> <span class="stat-value svelte-1rtvxu4"> </span></div> <div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">FG</span> <span class="stat-value svelte-1rtvxu4"> </span></div> <div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">ABV</span> <span class="stat-value svelte-1rtvxu4"> </span></div></div> <div class="stat-group svelte-1rtvxu4"><div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">IBU</span> <span class="stat-value svelte-1rtvxu4"> </span></div> <div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">BU:GU</span> <span class="stat-value balance svelte-1rtvxu4"> </span> <span class="stat-sub svelte-1rtvxu4"> </span></div></div> <div class="stat-group svelte-1rtvxu4"><div class="stat color-stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">Color</span> <div class="color-display svelte-1rtvxu4"><span class="color-swatch svelte-1rtvxu4"></span> <span class="stat-value svelte-1rtvxu4"> </span></div> <span class="stat-sub svelte-1rtvxu4"> </span></div></div> <div class="stat-group svelte-1rtvxu4"><div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">Calories</span> <span class="stat-value svelte-1rtvxu4"> </span> <span class="stat-sub svelte-1rtvxu4">per 330ml</span></div></div></div> <!> <div class="actions top-actions svelte-1rtvxu4"><!> <button type="button" class="btn-ai svelte-1rtvxu4"><!></button> <button type="button" class="btn-primary svelte-1rtvxu4">Save Recipe</button></div> <div class="section metadata-section svelte-1rtvxu4"><h2 class="section-title svelte-1rtvxu4">Recipe Details</h2> <div class="form-grid svelte-1rtvxu4"><div class="form-field full-width svelte-1rtvxu4"><label for="recipe-name" class="svelte-1rtvxu4">Recipe Name *</label> <input id="recipe-name" type="text" placeholder="e.g., My Awesome IPA" class="form-input svelte-1rtvxu4"/></div> <div class="form-field svelte-1rtvxu4"><label for="author" class="svelte-1rtvxu4">Brewer</label> <input id="author" type="text" placeholder="Your name" class="form-input svelte-1rtvxu4"/></div> <div class="form-field style-autocomplete svelte-1rtvxu4"><label for="style" class="svelte-1rtvxu4">Style</label> <div class="autocomplete-container svelte-1rtvxu4"><input id="style" type="text" placeholder="Search BJCP styles..." class="form-input svelte-1rtvxu4" autocomplete="off"/> <!> <!></div> <!></div></div></div> <div class="section params-section svelte-1rtvxu4"><h2 class="section-title svelte-1rtvxu4">Batch Parameters</h2> <div class="params-grid svelte-1rtvxu4"><div class="param-field svelte-1rtvxu4"><label for="batch-size" class="svelte-1rtvxu4">Batch Size</label> <div class="input-with-unit svelte-1rtvxu4"><input id="batch-size" type="number" min="1" step="1" class="form-input svelte-1rtvxu4"/> <span class="unit svelte-1rtvxu4">L</span></div></div> <div class="param-field svelte-1rtvxu4"><label for="efficiency" class="svelte-1rtvxu4">Efficiency</label> <div class="input-with-unit svelte-1rtvxu4"><input id="efficiency" type="number" min="50" max="95" step="1" class="form-input svelte-1rtvxu4"/> <span class="unit svelte-1rtvxu4">%</span></div></div> <div class="param-field svelte-1rtvxu4"><label for="boil-time" class="svelte-1rtvxu4">Boil Time</label> <div class="input-with-unit svelte-1rtvxu4"><input id="boil-time" type="number" min="30" max="120" step="5" class="form-input svelte-1rtvxu4"/> <span class="unit svelte-1rtvxu4">min</span></div></div></div></div> <div class="section svelte-1rtvxu4"><!></div> <div class="section svelte-1rtvxu4"><!></div> <div class="section yeast-section svelte-1rtvxu4"><!></div> <div class="section notes-section svelte-1rtvxu4"><h2 class="section-title svelte-1rtvxu4">Notes</h2> <textarea placeholder="Brewing notes, tips, or variations..." rows="4" class="notes-input svelte-1rtvxu4"></textarea></div></div> <!>',1);function Js(p,u){zt(u,!0);let h=w(""),L=w(""),g=w(""),C=w(""),A=w(Ze([])),E=w(null),ee=w(!1),j=w(!1),_e=null,X=w(20),m=w(72),N=w(60),se=w(Ze([])),M=w(Ze([])),te=w(null),De=w(!1),Pe=w(null),Ne=w(!1),Oe=w(null),H=W(()=>()=>{if(e(se).length===0)return{og:1,fg:1,abv:0,ibu:0,srm:0,color_hex:"#FFE699",calories_per_330ml:0};const l=e(se).map(T=>({name:T.name,amount_kg:T.amount_kg,potential_sg:T.potential_sg||1.036,color_srm:T.color_srm||2})),_=e(M).map(T=>({name:T.name,amount_grams:T.amount_grams,alpha_acid_percent:T.alpha_acid_percent,boil_time_minutes:T.boil_time_minutes,form:T.form,use:T.use})),b={name:e(te)?.name||"Default Yeast",attenuation_percent:e(te)?.attenuation_low&&e(te)?.attenuation_high?(e(te).attenuation_low+e(te).attenuation_high)/2:75,temp_min_c:e(te)?.temp_low||18,temp_max_c:e(te)?.temp_high||22},we={batch_size_liters:e(X),efficiency_percent:e(m),boil_time_minutes:e(N)};return ja(l,_,b,we)}),at=W(()=>()=>da(e(H)().ibu,e(H)().og)),ut=W(()=>()=>{const l=e(at)();return l<.3?"Very Malty":l<.5?"Malty":l<.7?"Balanced":l<.9?"Hoppy":"Very Bitter"}),Je=W(()=>()=>{if(!e(E))return[];const l=e(H)(),_=[],b=e(E);return b.og_min!==void 0&&b.og_max!==void 0&&(l.og<b.og_min?_.push({stat:"OG",value:l.og.toFixed(3),range:`${b.og_min.toFixed(3)} - ${b.og_max.toFixed(3)}`,severity:"warning"}):l.og>b.og_max&&_.push({stat:"OG",value:l.og.toFixed(3),range:`${b.og_min.toFixed(3)} - ${b.og_max.toFixed(3)}`,severity:"warning"})),b.fg_min!==void 0&&b.fg_max!==void 0&&(l.fg<b.fg_min||l.fg>b.fg_max)&&_.push({stat:"FG",value:l.fg.toFixed(3),range:`${b.fg_min.toFixed(3)} - ${b.fg_max.toFixed(3)}`,severity:"warning"}),b.abv_min!==void 0&&b.abv_max!==void 0&&(l.abv<b.abv_min||l.abv>b.abv_max)&&_.push({stat:"ABV",value:`${l.abv.toFixed(1)}%`,range:`${b.abv_min.toFixed(1)}% - ${b.abv_max.toFixed(1)}%`,severity:"warning"}),b.ibu_min!==void 0&&b.ibu_max!==void 0&&(l.ibu<b.ibu_min||l.ibu>b.ibu_max)&&_.push({stat:"IBU",value:l.ibu.toFixed(0),range:`${b.ibu_min} - ${b.ibu_max}`,severity:"warning"}),b.srm_min!==void 0&&b.srm_max!==void 0&&(l.srm<b.srm_min||l.srm>b.srm_max)&&_.push({stat:"Color",value:`${l.srm.toFixed(0)} SRM`,range:`${b.srm_min} - ${b.srm_max} SRM`,severity:"warning"}),_});async function Ve(l){if(l.length<2){n(A,[],!0),n(j,!1);return}_e&&clearTimeout(_e),_e=setTimeout(async()=>{n(ee,!0);try{n(A,await Ra(l,8),!0),n(j,e(A).length>0)}catch(_){console.error("Failed to search styles:",_),n(A,[],!0)}finally{n(ee,!1)}},300)}function Ye(l){const _=l.target;n(g,_.value,!0),e(E)&&e(g)!==e(E).name&&n(E,null),Ve(e(g))}function et(l){n(E,l,!0),n(g,l.name,!0),n(j,!1),n(A,[],!0)}function ct(){n(E,null),n(g,""),n(A,[],!0),n(j,!1)}function dt(l){n(se,l,!0)}function st(l){n(M,l,!0)}function rt(l){n(te,l,!0)}function _t(){if(!e(h).trim()){alert("Please enter a recipe name");return}const l={name:e(h),author:e(L),type:e(g),batch_size_liters:e(X),efficiency_percent:e(m),boil_time_minutes:e(N),og:e(H)().og,fg:e(H)().fg,abv:e(H)().abv,ibu:e(H)().ibu,color_srm:e(H)().srm,fermentables:e(se),hops:e(M),yeast:e(te),notes:e(C)};u.onSave?.(l)}async function pt(){if(!e(g).trim()){n(Oe,"Please enter a beer style to get an AI review"),n(De,!0);return}if(e(se).length===0){n(Oe,"Please add at least one fermentable to get an AI review"),n(De,!0);return}n(Ne,!0),n(Oe,null),n(De,!0);try{const l=e(H)();n(Pe,await Ua({name:e(h)||"Untitled Recipe",style:e(g),og:l.og,fg:l.fg,abv:l.abv,ibu:l.ibu,color_srm:l.srm,fermentables:e(se).map(_=>({name:_.name,amount_kg:_.amount_kg,color_srm:_.color_srm,type:_.category})),hops:e(M).map(_=>({name:_.name,amount_grams:_.amount_grams,boil_time_minutes:_.boil_time_minutes,alpha_acid_percent:_.alpha_acid_percent,use:_.use})),yeast:e(te)?{name:e(te).name,producer:e(te).producer,attenuation:e(te).attenuation}:void 0}),!0)}catch(l){n(Oe,l instanceof Error?l.message:"Failed to get AI review",!0)}finally{n(Ne,!1)}}function lt(){n(De,!1),n(Pe,null),n(Oe,null)}var c=Ws(),r=$e(c),i=a(r),o=a(i),y=a(o),z=s(a(y),2),J=a(z,!0);t(z),t(y);var ve=s(y,2),D=s(a(ve),2),K=a(D,!0);t(D),t(ve);var ke=s(ve,2),Ue=s(a(ke),2),be=a(Ue);t(Ue),t(ke),t(o);var B=s(o,2),R=a(B),Q=s(a(R),2),$=a(Q,!0);t(Q),t(R);var ue=s(R,2),re=s(a(ue),2),le=a(re,!0);t(re);var ge=s(re,2),pe=a(ge,!0);t(ge),t(ue),t(B);var me=s(B,2),Se=a(me),S=s(a(Se),2),O=a(S),de=s(O,2),fe=a(de);t(de),t(S);var I=s(S,2),Z=a(I,!0);t(I),t(Se),t(me);var V=s(me,2),U=a(V),G=s(a(U),2),ie=a(G,!0);t(G),tt(2),t(U),t(V),t(i);var xe=s(i,2);{var Ge=l=>{var _=Os(),b=s(a(_),2);Me(b,17,()=>e(Je)(),vt,(we,T)=>{var Be=Ps(),We=a(Be);t(Be),F(()=>{na(Be,1,`warning-badge ${e(T).severity??""}`,"svelte-1rtvxu4"),f(We,`${e(T).stat??""}: ${e(T).value??""} (target: ${e(T).range??""})`)}),v(we,Be)}),t(_),v(l,_)};x(xe,l=>{e(Je)().length>0&&l(Ge)})}var Fe=s(xe,2),ae=a(Fe);{var ne=l=>{var _=Us();_.__click=function(...b){u.onCancel?.apply(this,b)},v(l,_)};x(ae,l=>{u.onCancel&&l(ne)})}var he=s(ae,2);he.__click=pt;var oe=a(he);{var ce=l=>{var _=aa("Analyzing...");v(l,_)},ze=l=>{var _=aa("AI Review");v(l,_)};x(oe,l=>{e(Ne)?l(ce):l(ze,!1)})}t(he);var Ce=s(he,2);Ce.__click=_t,t(Fe);var qe=s(Fe,2),ye=s(a(qe),2),Re=a(ye),Ie=s(a(Re),2);Ae(Ie),t(Re);var Le=s(Re,2),He=s(a(Le),2);Ae(He),t(Le);var Ke=s(Le,2),P=s(a(Ke),2),k=a(P);Ae(k),k.__input=Ye;var q=s(k,2);{var Y=l=>{var _=Rs();v(l,_)};x(q,l=>{e(ee)&&l(Y)})}var Te=s(q,2);{var St=l=>{var _=Is();_.__click=ct,v(l,_)};x(Te,l=>{e(E)&&l(St)})}t(P);var Ct=s(P,2);{var pa=l=>{var _=Ds();Me(_,21,()=>e(A),vt,(b,we)=>{var T=Ts(),Be=a(T);Be.__click=()=>et(e(we));var We=a(Be),mt=a(We,!0);t(We);var ft=s(We,2);{var Ee=je=>{var Qe=Hs(),bt=a(Qe,!0);t(Qe),F(()=>f(bt,e(we).category)),v(je,Qe)};x(ft,je=>{e(we).category&&je(Ee)})}t(Be),t(T),F(()=>f(mt,e(we).name)),v(b,T)}),t(_),v(l,_)};x(Ct,l=>{e(j)&&e(A).length>0&&l(pa)})}t(Ke),t(ye),t(qe);var qt=s(qe,2),Gt=s(a(qt),2),Lt=a(Gt),Et=s(a(Lt),2),jt=a(Et);Ae(jt),tt(2),t(Et),t(Lt);var At=s(Lt,2),Nt=s(a(At),2),Vt=a(Nt);Ae(Vt),tt(2),t(Nt),t(At);var Yt=s(At,2),Wt=s(a(Yt),2),Jt=a(Wt);Ae(Jt),tt(2),t(Wt),t(Yt),t(Gt),t(qt);var Mt=s(qt,2),ma=a(Mt);cs(ma,{get fermentables(){return e(se)},get batchSizeLiters(){return e(X)},get efficiencyPercent(){return e(m)},onUpdate:dt}),t(Mt);var Pt=s(Mt,2),fa=a(Pt);{let l=W(()=>e(H)().og);Ms(fa,{get hops(){return e(M)},get og(){return e(l)},get batchSizeLiters(){return e(X)},onUpdate:st})}t(Pt);var Ot=s(Pt,2),ba=a(Ot);{let l=W(()=>e(te)?.id);Ta(ba,{get selectedYeastId(){return e(l)},onSelect:rt,label:"Select Yeast Strain"})}t(Ot);var Kt=s(Ot,2),Qt=s(a(Kt),2);Ba(Qt),t(Kt),t(r);var ga=s(r,2);{var xa=l=>{var _=Ys();_.__click=lt;var b=a(_),we=a(b),T=s(a(we),2);T.__click=lt,t(we);var Be=s(we,2),We=a(Be);{var mt=Ee=>{var je=Gs(),Qe=s(a(je),2),bt=a(Qe);t(Qe),t(je),F(()=>f(bt,`Analyzing your recipe against ${(e(g)||"style guidelines")??""}...`)),v(Ee,je)},ft=Ee=>{var je=wt(),Qe=$e(je);{var bt=it=>{var nt=Es(),yt=a(nt),Ut=a(yt,!0);t(yt),t(nt),F(()=>f(Ut,e(Oe))),v(it,nt)},ha=it=>{var nt=wt(),yt=$e(nt);{var Ut=Rt=>{var Xt=Vs(),It=$e(Xt),$t=a(It);{var ya=ot=>{var gt=js(),za=a(gt);t(gt),F(()=>f(za,`BJCP Style: ${e(Pe).style_name??""}`)),v(ot,gt)},wa=ot=>{var gt=Ns();v(ot,gt)};x($t,ot=>{e(Pe).style_found?ot(ya):ot(wa,!1)})}var Zt=s($t,2),ka=a(Zt);t(Zt),t(It);var ea=s(It,2),Fa=a(ea);Ha(Fa,()=>e(Pe).review.replace(/\n/g,"<br>")),t(ea),F(()=>f(ka,`Model: ${e(Pe).model??""}`)),v(Rt,Xt)};x(yt,Rt=>{e(Pe)&&Rt(Ut)},!0)}v(it,nt)};x(Qe,it=>{e(Oe)?it(bt):it(ha,!1)},!0)}v(Ee,je)};x(We,Ee=>{e(Ne)?Ee(mt):Ee(ft,!1)})}t(Be),t(b),t(_),v(l,_)};x(ga,l=>{e(De)&&l(xa)})}F((l,_,b,we,T,Be,We,mt,ft,Ee)=>{f(J,l),f(K,_),f(be,`${b??""}%`),f($,we),f(le,T),f(pe,Be),ht(O,`background-color: ${We??""}`),f(fe,`${mt??""} SRM`),f(Z,ft),f(ie,Ee),he.disabled=e(Ne),xt(k,e(g))},[()=>e(H)().og.toFixed(3),()=>e(H)().fg.toFixed(3),()=>e(H)().abv.toFixed(1),()=>e(H)().ibu.toFixed(0),()=>e(at)().toFixed(2),()=>e(ut)(),()=>e(H)().color_hex,()=>e(H)().srm.toFixed(0),()=>Ga(e(H)().srm),()=>e(H)().calories_per_330ml]),Xe(Ie,()=>e(h),l=>n(h,l)),Xe(He,()=>e(L),l=>n(L,l)),ta("focus",k,()=>e(g).length>=2&&e(A).length>0&&n(j,!0)),ta("blur",k,()=>setTimeout(()=>n(j,!1),200)),Xe(jt,()=>e(X),l=>n(X,l)),Xe(Vt,()=>e(m),l=>n(m,l)),Xe(Jt,()=>e(N),l=>n(N,l)),Xe(Qt,()=>e(C),l=>n(C,l)),v(p,c),Bt()}Dt(["click","input"]);var Ks=d('<div class="error-banner svelte-1pes5m5"><svg class="error-icon svelte-1pes5m5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div>'),Qs=d('<div class="saving-overlay svelte-1pes5m5"><div class="spinner svelte-1pes5m5"></div> <span>Saving recipe...</span></div>'),Xs=d('<div class="page-container svelte-1pes5m5"><div class="back-link svelte-1pes5m5"><a href="/recipes" class="back-btn svelte-1pes5m5"><svg class="back-icon svelte-1pes5m5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg> Back to Recipes</a></div> <div class="page-header svelte-1pes5m5"><h1 class="page-title svelte-1pes5m5">Create New Recipe</h1> <p class="page-description svelte-1pes5m5">Build your recipe with real-time calculations, or <a href="/recipes/import" class="import-link svelte-1pes5m5">import from BeerXML/BeerJSON</a></p></div> <!> <!> <!></div>');function _r(p,u){zt(u,!0);let h=w(!1),L=w(null);async function g(m){n(h,!0),n(L,null);try{const N={name:m.name,author:m.author||void 0,type:m.type||void 0,batch_size_liters:m.batch_size_liters,efficiency_percent:m.efficiency_percent,boil_time_minutes:m.boil_time_minutes,og:m.og,fg:m.fg,abv:m.abv,ibu:m.ibu,color_srm:m.color_srm,notes:m.notes||void 0,yeast_name:m.yeast?.name,yeast_lab:m.yeast?.producer,yeast_product_id:m.yeast?.product_id,yeast_temp_min:m.yeast?.temp_low??void 0,yeast_temp_max:m.yeast?.temp_high??void 0,yeast_attenuation:m.yeast?.attenuation_low&&m.yeast?.attenuation_high?(m.yeast.attenuation_low+m.yeast.attenuation_high)/2:void 0,format_extensions:{fermentables:m.fermentables.map(M=>({id:M.id,name:M.name,amount_kg:M.amount_kg,color_lovibond:M.color_lovibond,potential_sg:M.potential_sg,type:M.type,origin:M.origin,maltster:M.maltster})),hops:m.hops.map(M=>({id:M.id,name:M.name,amount_grams:M.amount_grams,alpha_acid_percent:M.alpha_acid_percent,boil_time_minutes:M.boil_time_minutes,use:M.use,form:M.form,origin:M.origin,purpose:M.purpose}))}},se=await Ia(N);sa(`/recipes/${se.id}`)}catch(N){n(L,N instanceof Error?N.message:"Failed to create recipe",!0),n(h,!1)}}function C(){sa("/recipes")}var A=Xs();qa("1pes5m5",m=>{Sa(()=>{Ca.title="New Recipe | BrewSignal"})});var E=s(a(A),4);{var ee=m=>{var N=Ks(),se=s(a(N),2),M=a(se,!0);t(se),t(N),F(()=>f(M,e(L))),v(m,N)};x(E,m=>{e(L)&&m(ee)})}var j=s(E,2);{var _e=m=>{var N=Qs();v(m,N)};x(j,m=>{e(h)&&m(_e)})}var X=s(j,2);Js(X,{onSave:g,onCancel:C}),t(A),v(p,A),Bt()}export{_r as component};
