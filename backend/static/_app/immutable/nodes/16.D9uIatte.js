import{d as dt,f as _,a as u,s as m,c as ft}from"../chunks/DcIvJr9I.js";import{a as it,s as C,p as Ne,o as bt,c as f,g as r,h as ot,d as a,j as t,i as e,t as L,l as Y,n as Re,f as at,au as ct,k as zt,e as Ft,at as qt}from"../chunks/BdaV80yH.js";import{i as P}from"../chunks/62M37ttd.js";import{h as Bt}from"../chunks/Bk5z9r0e.js";import{g as _t}from"../chunks/p4ETl0pV.js";import{z as Ct,A as St,a4 as Lt,h as At,y as Mt,a5 as Pt}from"../chunks/BiYqSM5J.js";import{r as ye,b as tt}from"../chunks/CQd4zp0r.js";import{s as et}from"../chunks/DseQEzxc.js";import{b as Ue}from"../chunks/BLHfmNAk.js";import{e as Pe,i as st}from"../chunks/DHLEsWdT.js";import{s as Ot}from"../chunks/C-lu8EFC.js";import{b as rt,i as pt,s as mt}from"../chunks/CS921t7u.js";import{p as lt}from"../chunks/2LjR-7ep.js";import{Y as Ut}from"../chunks/DkGcLsz-.js";function gt(c,o){return 1+c.reduce((z,x)=>{const w=(x.potential_sg-1)*1e3,A=x.amount_kg*w*o.efficiency_percent/(o.batch_size_liters/100);return z+A},0)/1e3}function Ht(c,o){return 1+(c-1)*1e3*(1-o/100)/1e3}function ht(c,o,b="simple"){return b==="simple"?(c-o)*131.25:76.08*(c-o)/(1.775-c)*(o/.794)}function xt(c,o,b){if(c.use==="dry_hop"||c.boil_time_minutes<=0)return 0;const z=1.65*Math.pow(125e-6,o-1),x=(1-Math.exp(-.04*c.boil_time_minutes))/4.15;let w=z*x;c.form==="pellet"&&(w*=1.1),c.use==="first_wort"&&(w*=1.1),c.use==="whirlpool"&&(w*=.2);const A=c.alpha_acid_percent/100*c.amount_grams*w*1e3/(b*10);return Math.max(0,A)}function wt(c,o,b){return c.reduce((z,x)=>z+xt(x,o,b),0)}function yt(c,o){const b=(o-1)*1e3;return b>0?c/b:0}function kt(c,o){const b=o*.264172,z=c.reduce((w,A)=>{const $=A.amount_kg*2.20462;return w+$*A.color_srm/b},0),x=1.4922*Math.pow(z,.6859);return Math.min(40,Math.max(0,x))}function ut(c){const o=Math.max(1,Math.min(40,c)),b={1:"#FFE699",2:"#FFD878",3:"#FFCA5A",4:"#FFBF42",5:"#FBB123",6:"#F8A600",7:"#F39C00",8:"#EA8F00",9:"#E58500",10:"#DE7C00",11:"#D77200",12:"#CF6900",13:"#CB6200",14:"#C35900",15:"#BB5100",16:"#B54C00",17:"#B04500",18:"#A63E00",19:"#A13700",20:"#9B3200",25:"#7C2900",30:"#5E1E00",35:"#401500",40:"#261000"},z=Object.keys(b).map(Number).sort((w,A)=>w-A);let x=z[0];for(const w of z)if(w<=o)x=w;else break;return b[x]||"#261000"}function Dt(c){return c<2?"Pale Straw":c<3?"Straw":c<4?"Pale Gold":c<6?"Deep Gold":c<9?"Amber":c<12?"Copper":c<15?"Light Brown":c<18?"Brown":c<20?"Dark Brown":c<24?"Very Dark":c<30?"Black":"Opaque Black"}function It(c,o,b=330){const x=ht(c,o)*.79*7*(b/100),w=(o-1)*1e3*.4*(b/100);return Math.round(x+w)}function Tt(c,o,b,z){const x=gt(c,z),w=Ht(x,b.attenuation_percent),A=ht(x,w),$=wt(o,x,z.batch_size_liters),V=kt(c,z.batch_size_liters);return{og:Math.round(x*1e3)/1e3,fg:Math.round(w*1e3)/1e3,abv:Math.round(A*10)/10,ibu:Math.round($),srm:Math.round(V*10)/10,color_hex:ut(V),calories_per_330ml:It(x,w,330)}}var Gt=_('<span class="stats svelte-1qls65z"> <span class="color-swatch svelte-1qls65z"></span> </span>'),jt=_('<div class="empty-state svelte-1qls65z"><p class="svelte-1qls65z">No fermentables added yet.</p> <button type="button" class="browse-btn svelte-1qls65z">Browse Library</button></div>'),Et=_('<span class="ferm-type svelte-1qls65z"> </span>'),Rt=_('<span class="detail svelte-1qls65z"> </span>'),Nt=_('<span class="detail svelte-1qls65z"> </span>'),Yt=_('<span class="detail svelte-1qls65z"> </span>'),Vt=_('<div class="ferm-item svelte-1qls65z"><div class="ferm-main svelte-1qls65z"><div class="ferm-info svelte-1qls65z"><span class="ferm-name svelte-1qls65z"> </span> <!></div> <div class="ferm-details svelte-1qls65z"><!> <!> <!></div></div> <div class="ferm-controls svelte-1qls65z"><div class="amount-input svelte-1qls65z"><input type="number" step="0.1" min="0" class="svelte-1qls65z"/> <span class="unit svelte-1qls65z">kg</span></div> <span class="percent svelte-1qls65z"> </span> <button type="button" class="remove-btn svelte-1qls65z">×</button></div></div>'),Wt=_('<div class="fermentables-list svelte-1qls65z"></div>'),Kt=_('<div class="loading svelte-1qls65z"><div class="spinner svelte-1qls65z"></div> <p>Loading fermentables...</p></div>'),Qt=_('<div class="error-box svelte-1qls65z"><p class="error-text svelte-1qls65z"> </p></div>'),Jt=_("<option> </option>"),Xt=_("<option> </option>"),Zt=_('<span class="item-maltster svelte-1qls65z"> </span>'),$t=_('<span class="item-color svelte-1qls65z"><span class="color-dot svelte-1qls65z"></span> </span>'),ea=_('<span class="item-potential svelte-1qls65z"> </span>'),ta=_('<button type="button"><div class="item-main svelte-1qls65z"><span class="item-name svelte-1qls65z"> </span> <!></div> <div class="item-details svelte-1qls65z"><!> <!></div></button>'),aa=_('<div class="type-group svelte-1qls65z"><h5 class="type-name svelte-1qls65z"> </h5> <!></div>'),sa=_('<div class="no-results svelte-1qls65z"><p class="svelte-1qls65z">No fermentables match your filters</p></div>'),ra=_('<div class="filters svelte-1qls65z"><input type="text" placeholder="Search fermentables..." class="search-input svelte-1qls65z"/> <div class="filter-row svelte-1qls65z"><select class="filter-select svelte-1qls65z"><option>All Types</option><!></select> <select class="filter-select svelte-1qls65z"><option>All Origins</option><!></select></div></div> <div class="library-list svelte-1qls65z"><!> <!></div>',1),la=_('<div class="browser-overlay svelte-1qls65z"><div class="browser-modal svelte-1qls65z"><div class="browser-header svelte-1qls65z"><h4 class="svelte-1qls65z">Add Fermentable</h4> <button type="button" class="close-btn svelte-1qls65z">×</button></div> <!></div></div>'),ia=_('<div class="fermentable-selector svelte-1qls65z"><div class="selector-header svelte-1qls65z"><div class="header-left svelte-1qls65z"><h3 class="svelte-1qls65z">Grain Bill</h3> <!></div> <button type="button" class="add-btn svelte-1qls65z">+ Add Fermentable</button></div> <!> <!></div>');function oa(c,o){it(o,!0);let b=lt(o,"batchSizeLiters",3,20),z=lt(o,"efficiencyPercent",3,72),x=C(Ne([])),w=C(Ne([])),A=C(Ne([])),$=C(!0),V=C(null),W=C(""),ne=C(""),H=C(""),v=C(!1),K=Y(()=>o.fermentables.reduce((n,s)=>n+s.amount_kg,0)),he=Y(()=>()=>{if(o.fermentables.length===0)return{og:1,srm:0,color_hex:"#FFE699"};const n=o.fermentables.map(h=>({name:h.name,amount_kg:h.amount_kg,potential_sg:h.potential_sg||1.036,color_srm:h.color_srm||2})),s={batch_size_liters:b(),efficiency_percent:z()},l=gt(n,s),i=kt(n,b()),g=ut(i);return{og:l,srm:i,color_hex:g}}),O=Y(()=>()=>e(x).filter(n=>{const s=!e(W)||n.name.toLowerCase().includes(e(W).toLowerCase())||n.maltster?.toLowerCase().includes(e(W).toLowerCase())||n.origin?.toLowerCase().includes(e(W).toLowerCase()),l=!e(ne)||n.type===e(ne),i=!e(H)||n.origin===e(H);return s&&l&&i})),Ye=Y(()=>()=>{const n={};for(const l of e(O)()){const i=l.type||"Other";n[i]||(n[i]=[]),n[i].push(l)}const s=["base","specialty","adjunct","sugar","extract","fruit","other"];return Object.fromEntries(Object.entries(n).sort(([l],[i])=>{const g=s.indexOf(l.toLowerCase()),h=s.indexOf(i.toLowerCase());return g>=0&&h>=0?g-h:g>=0?-1:h>=0?1:l.localeCompare(i)}))});bt(async()=>{try{const[n,s,l]=await Promise.all([Ct(),St(),Lt()]);f(x,n,!0),f(w,s.types||[],!0),f(A,l.origins||[],!0)}catch(n){f(V,n instanceof Error?n.message:"Failed to load fermentables",!0),console.error("Failed to load fermentables:",n)}finally{f($,!1)}});function Ve(n){if(o.fermentables.some(l=>l.id===n.id))return;const s={...n,amount_kg:.5};o.onUpdate([...o.fermentables,s]),f(v,!1)}function Ze(n){o.onUpdate(o.fermentables.filter(s=>s.id!==n))}function De(n,s){o.onUpdate(o.fermentables.map(l=>l.id===n?{...l,amount_kg:Math.max(0,s)}:l))}function Ie(n){return!n||!e(K)?"0%":(n/e(K)*100).toFixed(1)+"%"}function ke(n){return n==null?"--":n.toFixed(0)+"°L"}function Te(n){return n==null?"--":n.toFixed(3)}function We(n){switch(n?.toLowerCase()){case"base":return"var(--positive)";case"specialty":return"var(--warning)";case"adjunct":return"var(--info)";case"sugar":return"var(--accent-primary)";case"extract":return"var(--text-secondary)";default:return"var(--text-tertiary)"}}var Ge=ia(),ze=a(Ge),Le=a(ze),je=r(a(Le),2);{var Ke=n=>{var s=Gt(),l=a(s),i=r(l),g=r(i);t(s),L((h,G,se,D)=>{m(l,`${h??""} kg · OG ${G??""} · `),et(i,`background-color: ${se??""}`),m(g,` ${D??""} SRM`)},[()=>e(K).toFixed(2),()=>e(he)().og.toFixed(3),()=>e(he)().color_hex,()=>e(he)().srm.toFixed(0)]),u(n,s)};P(je,n=>{o.fermentables.length>0&&n(Ke)})}t(Le);var Qe=r(Le,2);Qe.__click=()=>f(v,!0),t(ze);var Je=r(ze,2);{var He=n=>{var s=jt(),l=r(a(s),2);l.__click=()=>f(v,!0),t(s),u(n,s)},Ee=n=>{var s=Wt();Pe(s,21,()=>o.fermentables,l=>l.id,(l,i)=>{var g=Vt(),h=a(g),G=a(h),se=a(G),D=a(se,!0);t(se);var j=r(se,2);{var xe=k=>{var B=Et(),ve=a(B,!0);t(B),L(ie=>{et(B,`color: ${ie??""}`),m(ve,e(i).type)},[()=>We(e(i).type)]),u(k,B)};P(j,k=>{e(i).type&&k(xe)})}t(G);var Fe=r(G,2),de=a(Fe);{var y=k=>{var B=Rt(),ve=a(B,!0);t(B),L(()=>m(ve,e(i).maltster)),u(k,B)};P(de,k=>{e(i).maltster&&k(y)})}var U=r(de,2);{var R=k=>{var B=Nt(),ve=a(B,!0);t(B),L(ie=>m(ve,ie),[()=>ke(e(i).color_srm)]),u(k,B)};P(U,k=>{e(i).color_srm&&k(R)})}var Q=r(U,2);{var te=k=>{var B=Yt(),ve=a(B,!0);t(B),L(ie=>m(ve,ie),[()=>Te(e(i).potential_sg)]),u(k,B)};P(Q,k=>{e(i).potential_sg&&k(te)})}t(Fe),t(h);var re=r(h,2),J=a(re),_e=a(J);ye(_e),_e.__change=k=>De(e(i).id,parseFloat(k.currentTarget.value)||0),Re(2),t(J);var le=r(J,2),pe=a(le,!0);t(le);var we=r(le,2);we.__click=()=>Ze(e(i).id),t(re),t(g),L(k=>{m(D,e(i).name),tt(_e,e(i).amount_kg),m(pe,k)},[()=>Ie(e(i).amount_kg)]),u(l,g)}),t(s),u(n,s)};P(Je,n=>{o.fermentables.length===0?n(He):n(Ee,!1)})}var Xe=r(Je,2);{var $e=n=>{var s=la();s.__click=()=>f(v,!1);var l=a(s);l.__click=D=>D.stopPropagation();var i=a(l),g=r(a(i),2);g.__click=()=>f(v,!1),t(i);var h=r(i,2);{var G=D=>{var j=Kt();u(D,j)},se=D=>{var j=ft(),xe=at(j);{var Fe=y=>{var U=Qt(),R=a(U),Q=a(R,!0);t(R),t(U),L(()=>m(Q,e(V))),u(y,U)},de=y=>{var U=ra(),R=at(U),Q=a(R);ye(Q);var te=r(Q,2),re=a(te),J=a(re);J.value=J.__value="";var _e=r(J);Pe(_e,17,()=>e(w),st,(M,N)=>{var I=Jt(),S=a(I,!0);t(I);var T={};L(()=>{m(S,e(N)),T!==(T=e(N))&&(I.value=(I.__value=e(N))??"")}),u(M,I)}),t(re);var le=r(re,2),pe=a(le);pe.value=pe.__value="";var we=r(pe);Pe(we,17,()=>e(A),st,(M,N)=>{var I=Xt(),S=a(I,!0);t(I);var T={};L(()=>{m(S,e(N)),T!==(T=e(N))&&(I.value=(I.__value=e(N))??"")}),u(M,I)}),t(le),t(te),t(R);var k=r(R,2),B=a(k);Pe(B,17,()=>Object.entries(e(Ye)()),([M,N])=>M,(M,N)=>{var I=Y(()=>ct(e(N),2));let S=()=>e(I)[0],T=()=>e(I)[1];var ee=aa(),me=a(ee),qe=a(me,!0);t(me);var be=r(me,2);Pe(be,17,T,ae=>ae.id,(ae,X)=>{const Ae=Y(()=>o.fermentables.some(p=>p.id===e(X).id));var Z=ta();let oe;Z.__click=()=>Ve(e(X));var ce=a(Z),ge=a(ce),Be=a(ge,!0);t(ge);var fe=r(ge,2);{var Oe=p=>{var q=Zt(),E=a(q,!0);t(q),L(()=>m(E,e(X).maltster)),u(p,q)};P(fe,p=>{e(X).maltster&&p(Oe)})}t(ce);var Me=r(ce,2),d=a(Me);{var ue=p=>{var q=$t(),E=a(q),Se=r(E);t(q),L((nt,vt)=>{et(E,`background-color: ${nt??""}`),m(Se,` ${vt??""}°L`)},[()=>ut(e(X).color_srm),()=>e(X).color_srm.toFixed(0)]),u(p,q)};P(d,p=>{e(X).color_srm&&p(ue)})}var Ce=r(d,2);{var F=p=>{var q=ea(),E=a(q,!0);t(q),L(Se=>m(E,Se),[()=>e(X).potential_sg.toFixed(3)]),u(p,q)};P(Ce,p=>{e(X).potential_sg&&p(F)})}t(Me),t(Z),L(()=>{oe=Ot(Z,1,"library-item svelte-1qls65z",null,oe,{added:e(Ae)}),Z.disabled=e(Ae),m(Be,e(X).name)}),u(ae,Z)}),t(ee),L(()=>m(qe,S())),u(M,ee)});var ve=r(B,2);{var ie=M=>{var N=sa();u(M,N)};P(ve,M=>{Object.keys(e(Ye)()).length===0&&M(ie)})}t(k),Ue(Q,()=>e(W),M=>f(W,M)),rt(re,()=>e(ne),M=>f(ne,M)),rt(le,()=>e(H),M=>f(H,M)),u(y,U)};P(xe,y=>{e(V)?y(Fe):y(de,!1)},!0)}u(D,j)};P(h,D=>{e($)?D(G):D(se,!1)})}t(l),t(s),u(n,s)};P(Xe,n=>{e(v)&&n($e)})}t(Ge),u(c,Ge),ot()}dt(["click","change"]);var na=_('<span class="stats svelte-4wskud"> <span class="balance svelte-4wskud"> </span></span>'),va=_('<div class="empty-state svelte-4wskud"><p class="svelte-4wskud">No hops added yet.</p> <button type="button" class="browse-btn svelte-4wskud">Browse Library</button></div>'),ca=_('<span class="hop-origin svelte-4wskud"> </span>'),ua=_('<span class="ibu-value svelte-4wskud"> </span>'),da=_('<span class="ibu-zero svelte-4wskud">0 IBU</span>'),_a=_('<div class="control-group svelte-4wskud"><label class="svelte-4wskud">Time</label> <div class="input-with-unit svelte-4wskud"><input type="number" step="5" min="0" max="90" class="svelte-4wskud"/> <span class="unit svelte-4wskud">min</span></div></div>'),pa=_('<div class="hop-item svelte-4wskud"><div class="hop-main svelte-4wskud"><div class="hop-info svelte-4wskud"><span class="hop-name svelte-4wskud"> </span> <!></div> <div class="hop-ibu svelte-4wskud"><!></div></div> <div class="hop-controls svelte-4wskud"><div class="control-row svelte-4wskud"><div class="control-group svelte-4wskud"><label class="svelte-4wskud">Amount</label> <div class="input-with-unit svelte-4wskud"><input type="number" step="5" min="0" class="svelte-4wskud"/> <span class="unit svelte-4wskud">g</span></div></div> <div class="control-group svelte-4wskud"><label class="svelte-4wskud">AA%</label> <input type="number" step="0.1" min="0" max="25" class="aa-input svelte-4wskud"/></div> <!> <div class="control-group svelte-4wskud"><label class="svelte-4wskud">Use</label> <select class="svelte-4wskud"><option>Boil</option><option>First Wort</option><option>Whirlpool</option><option>Dry Hop</option><option>Mash</option></select></div> <div class="control-group svelte-4wskud"><label class="svelte-4wskud">Form</label> <select class="svelte-4wskud"><option>Pellet</option><option>Whole</option><option>Plug</option></select></div></div> <button type="button" class="remove-btn svelte-4wskud">×</button></div></div>'),ma=_('<div class="use-group svelte-4wskud"><h4 class="use-name svelte-4wskud"> </h4> <!></div>'),fa=_('<div class="hops-list svelte-4wskud"></div>'),ba=_('<div class="loading svelte-4wskud"><div class="spinner svelte-4wskud"></div> <p>Loading hops...</p></div>'),ga=_('<div class="error-box svelte-4wskud"><p class="error-text svelte-4wskud"> </p></div>'),ha=_("<option> </option>"),xa=_('<span class="item-origin svelte-4wskud"> </span>'),wa=_('<span class="item-aroma svelte-4wskud"> </span>'),ya=_('<button type="button" class="library-item svelte-4wskud"><div class="item-main svelte-4wskud"><span class="item-name svelte-4wskud"> </span> <!></div> <div class="item-details svelte-4wskud"><span class="item-aa svelte-4wskud"> </span> <!></div></button>'),ka=_('<div class="purpose-group svelte-4wskud"><h5 class="purpose-name svelte-4wskud"> </h5> <!></div>'),za=_('<div class="no-results svelte-4wskud"><p class="svelte-4wskud">No hops match your filters</p></div>'),Fa=_('<div class="filters svelte-4wskud"><input type="text" placeholder="Search hops..." class="search-input svelte-4wskud"/> <div class="filter-row svelte-4wskud"><select class="filter-select svelte-4wskud"><option>All Purposes</option><option>Bittering</option><option>Aroma</option><option>Dual Purpose</option></select> <select class="filter-select svelte-4wskud"><option>All Origins</option><!></select></div></div> <div class="library-list svelte-4wskud"><!> <!></div>',1),qa=_('<div class="browser-overlay svelte-4wskud"><div class="browser-modal svelte-4wskud"><div class="browser-header svelte-4wskud"><h4 class="svelte-4wskud">Add Hop</h4> <button type="button" class="close-btn svelte-4wskud">×</button></div> <!></div></div>'),Ba=_('<div class="hop-selector svelte-4wskud"><div class="selector-header svelte-4wskud"><div class="header-left svelte-4wskud"><h3 class="svelte-4wskud">Hop Schedule</h3> <!></div> <button type="button" class="add-btn svelte-4wskud">+ Add Hop</button></div> <!> <!></div>');function Ca(c,o){it(o,!0);let b=lt(o,"og",3,1.05),z=lt(o,"batchSizeLiters",3,20),x=C(Ne([])),w=C(Ne([])),A=C(!0),$=C(null),V=C(""),W=C(""),ne=C(""),H=C(!1),v=Y(()=>()=>{if(o.hops.length===0)return 0;const s=o.hops.map(l=>({name:l.name,amount_grams:l.amount_grams,alpha_acid_percent:l.alpha_acid_percent,boil_time_minutes:l.boil_time_minutes,form:l.form,use:l.use}));return wt(s,b(),z())}),K=Y(()=>()=>yt(e(v)(),b())),he=Y(()=>()=>{const s=e(K)();return s<.3?"Very Sweet":s<.5?"Malty":s<.7?"Balanced":s<.9?"Hoppy":"Very Bitter"});function O(s){const l={name:s.name,amount_grams:s.amount_grams,alpha_acid_percent:s.alpha_acid_percent,boil_time_minutes:s.boil_time_minutes,form:s.form,use:s.use};return xt(l,b(),z())}let Ye=Y(()=>()=>e(x).filter(s=>{const l=!e(V)||s.name.toLowerCase().includes(e(V).toLowerCase())||s.origin?.toLowerCase().includes(e(V).toLowerCase())||s.aroma_profile?.toLowerCase().includes(e(V).toLowerCase()),i=!e(W)||s.origin===e(W),g=!e(ne)||s.purpose===e(ne);return l&&i&&g})),Ve=Y(()=>()=>{const s={};for(const i of e(Ye)()){const g=i.purpose||"Other";s[g]||(s[g]=[]),s[g].push(i)}const l=["dual","bittering","aroma"];return Object.fromEntries(Object.entries(s).sort(([i],[g])=>{const h=l.indexOf(i.toLowerCase()),G=l.indexOf(g.toLowerCase());return h>=0&&G>=0?h-G:h>=0?-1:G>=0?1:i.localeCompare(g)}))}),Ze=Y(()=>()=>{const s={};for(const l of o.hops){const i=l.use||"boil";s[i]||(s[i]=[]),s[i].push(l)}return s.boil&&s.boil.sort((l,i)=>i.boil_time_minutes-l.boil_time_minutes),s});bt(async()=>{try{const[s,l]=await Promise.all([At(),Mt()]);f(x,s,!0),f(w,l.origins||[],!0)}catch(s){f($,s instanceof Error?s.message:"Failed to load hops",!0),console.error("Failed to load hops:",s)}finally{f(A,!1)}});function De(s){const l=s.alpha_acid_low&&s.alpha_acid_high?(s.alpha_acid_low+s.alpha_acid_high)/2:s.alpha_acid_low||s.alpha_acid_high||10,i={...s,amount_grams:30,boil_time_minutes:60,use:"boil",form:"pellet",alpha_acid_percent:l};o.onUpdate([...o.hops,i]),f(H,!1)}function Ie(s){const l=[...o.hops];l.splice(s,1),o.onUpdate(l)}function ke(s,l,i){const g=o.hops.map((h,G)=>G===s?{...h,[l]:i}:h);o.onUpdate(g)}function Te(s,l){return s!=null&&l!=null?`${s.toFixed(1)}-${l.toFixed(1)}%`:s!=null?`${s.toFixed(1)}%+`:l!=null?`≤${l.toFixed(1)}%`:"--"}function We(s){return{boil:"Boil",whirlpool:"Whirlpool",dry_hop:"Dry Hop",first_wort:"First Wort",mash:"Mash"}[s]||s}function Ge(s){switch(s?.toLowerCase()){case"bittering":return"var(--warning)";case"aroma":return"var(--positive)";case"dual":return"var(--info)";default:return"var(--text-tertiary)"}}var ze=Ba(),Le=a(ze),je=a(Le),Ke=r(a(je),2);{var Qe=s=>{var l=na(),i=a(l),g=r(i),h=a(g,!0);t(g),t(l),L((G,se,D)=>{m(i,`${G??""} IBU · BU:GU ${se??""} · `),m(h,D)},[()=>e(v)().toFixed(0),()=>e(K)().toFixed(2),()=>e(he)()]),u(s,l)};P(Ke,s=>{o.hops.length>0&&s(Qe)})}t(je);var Je=r(je,2);Je.__click=()=>f(H,!0),t(Le);var He=r(Le,2);{var Ee=s=>{var l=va(),i=r(a(l),2);i.__click=()=>f(H,!0),t(l),u(s,l)},Xe=s=>{var l=fa();Pe(l,21,()=>Object.entries(e(Ze)()),st,(i,g)=>{var h=Y(()=>ct(e(g),2));let G=()=>e(h)[0],se=()=>e(h)[1];var D=ma(),j=a(D),xe=a(j,!0);t(j);var Fe=r(j,2);Pe(Fe,19,se,(de,y)=>de.id+"-"+y,(de,y)=>{const U=Y(()=>o.hops.indexOf(e(y))),R=Y(()=>O(e(y)));var Q=pa(),te=a(Q),re=a(te),J=a(re),_e=a(J,!0);t(J);var le=r(J,2);{var pe=F=>{var p=ca(),q=a(p,!0);t(p),L(()=>m(q,e(y).origin)),u(F,p)};P(le,F=>{e(y).origin&&F(pe)})}t(re);var we=r(re,2),k=a(we);{var B=F=>{var p=ua(),q=a(p);t(p),L(E=>m(q,`+${E??""} IBU`),[()=>e(R).toFixed(0)]),u(F,p)},ve=F=>{var p=da();u(F,p)};P(k,F=>{e(R)>0?F(B):F(ve,!1)})}t(we),t(te);var ie=r(te,2),M=a(ie),N=a(M),I=r(a(N),2),S=a(I);ye(S),S.__change=F=>ke(e(U),"amount_grams",parseFloat(F.currentTarget.value)||0),Re(2),t(I),t(N);var T=r(N,2),ee=r(a(T),2);ye(ee),ee.__change=F=>ke(e(U),"alpha_acid_percent",parseFloat(F.currentTarget.value)||0),t(T);var me=r(T,2);{var qe=F=>{var p=_a(),q=r(a(p),2),E=a(q);ye(E),E.__change=Se=>ke(e(U),"boil_time_minutes",parseInt(Se.currentTarget.value)||0),Re(2),t(q),t(p),L(()=>tt(E,e(y).boil_time_minutes)),u(F,p)};P(me,F=>{e(y).use==="boil"&&F(qe)})}var be=r(me,2),ae=r(a(be),2);ae.__change=F=>ke(e(U),"use",F.currentTarget.value);var X=a(ae);X.value=X.__value="boil";var Ae=r(X);Ae.value=Ae.__value="first_wort";var Z=r(Ae);Z.value=Z.__value="whirlpool";var oe=r(Z);oe.value=oe.__value="dry_hop";var ce=r(oe);ce.value=ce.__value="mash",t(ae);var ge;pt(ae),t(be);var Be=r(be,2),fe=r(a(Be),2);fe.__change=F=>ke(e(U),"form",F.currentTarget.value);var Oe=a(fe);Oe.value=Oe.__value="pellet";var Me=r(Oe);Me.value=Me.__value="whole";var d=r(Me);d.value=d.__value="plug",t(fe);var ue;pt(fe),t(Be),t(M);var Ce=r(M,2);Ce.__click=()=>Ie(e(U)),t(ie),t(Q),L(()=>{m(_e,e(y).name),tt(S,e(y).amount_grams),tt(ee,e(y).alpha_acid_percent),ge!==(ge=e(y).use)&&(ae.value=(ae.__value=e(y).use)??"",mt(ae,e(y).use)),ue!==(ue=e(y).form)&&(fe.value=(fe.__value=e(y).form)??"",mt(fe,e(y).form))}),u(de,Q)}),t(D),L(de=>m(xe,de),[()=>We(G())]),u(i,D)}),t(l),u(s,l)};P(He,s=>{o.hops.length===0?s(Ee):s(Xe,!1)})}var $e=r(He,2);{var n=s=>{var l=qa();l.__click=()=>f(H,!1);var i=a(l);i.__click=j=>j.stopPropagation();var g=a(i),h=r(a(g),2);h.__click=()=>f(H,!1),t(g);var G=r(g,2);{var se=j=>{var xe=ba();u(j,xe)},D=j=>{var xe=ft(),Fe=at(xe);{var de=U=>{var R=ga(),Q=a(R),te=a(Q,!0);t(Q),t(R),L(()=>m(te,e($))),u(U,R)},y=U=>{var R=Fa(),Q=at(R),te=a(Q);ye(te);var re=r(te,2),J=a(re),_e=a(J);_e.value=_e.__value="";var le=r(_e);le.value=le.__value="bittering";var pe=r(le);pe.value=pe.__value="aroma";var we=r(pe);we.value=we.__value="dual",t(J);var k=r(J,2),B=a(k);B.value=B.__value="";var ve=r(B);Pe(ve,17,()=>e(w),st,(S,T)=>{var ee=ha(),me=a(ee,!0);t(ee);var qe={};L(()=>{m(me,e(T)),qe!==(qe=e(T))&&(ee.value=(ee.__value=e(T))??"")}),u(S,ee)}),t(k),t(re),t(Q);var ie=r(Q,2),M=a(ie);Pe(M,17,()=>Object.entries(e(Ve)()),([S,T])=>S,(S,T)=>{var ee=Y(()=>ct(e(T),2));let me=()=>e(ee)[0],qe=()=>e(ee)[1];var be=ka(),ae=a(be),X=a(ae,!0);t(ae);var Ae=r(ae,2);Pe(Ae,17,qe,Z=>Z.id,(Z,oe)=>{var ce=ya();ce.__click=()=>De(e(oe));var ge=a(ce),Be=a(ge),fe=a(Be,!0);t(Be);var Oe=r(Be,2);{var Me=q=>{var E=xa(),Se=a(E,!0);t(E),L(()=>m(Se,e(oe).origin)),u(q,E)};P(Oe,q=>{e(oe).origin&&q(Me)})}t(ge);var d=r(ge,2),ue=a(d),Ce=a(ue,!0);t(ue);var F=r(ue,2);{var p=q=>{var E=wa(),Se=a(E,!0);t(E),L(()=>m(Se,e(oe).aroma_profile)),u(q,E)};P(F,q=>{e(oe).aroma_profile&&q(p)})}t(d),t(ce),L(q=>{m(fe,e(oe).name),m(Ce,q)},[()=>Te(e(oe).alpha_acid_low,e(oe).alpha_acid_high)]),u(Z,ce)}),t(be),L(Z=>{et(ae,`color: ${Z??""}`),m(X,me())},[()=>Ge(me())]),u(S,be)});var N=r(M,2);{var I=S=>{var T=za();u(S,T)};P(N,S=>{Object.keys(e(Ve)()).length===0&&S(I)})}t(ie),Ue(te,()=>e(V),S=>f(V,S)),rt(J,()=>e(ne),S=>f(ne,S)),rt(k,()=>e(W),S=>f(W,S)),u(U,R)};P(Fe,U=>{e($)?U(de):U(y,!1)},!0)}u(j,xe)};P(G,j=>{e(A)?j(se):j(D,!1)})}t(i),t(l),u(s,l)};P($e,s=>{e(H)&&s(n)})}t(ze),u(c,ze),ot()}dt(["click","change"]);var Sa=_('<button type="button" class="btn-secondary svelte-1rtvxu4">Cancel</button>'),La=_('<div class="recipe-builder svelte-1rtvxu4"><div class="stats-panel svelte-1rtvxu4"><div class="stat-group svelte-1rtvxu4"><div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">OG</span> <span class="stat-value svelte-1rtvxu4"> </span></div> <div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">FG</span> <span class="stat-value svelte-1rtvxu4"> </span></div> <div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">ABV</span> <span class="stat-value svelte-1rtvxu4"> </span></div></div> <div class="stat-group svelte-1rtvxu4"><div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">IBU</span> <span class="stat-value svelte-1rtvxu4"> </span></div> <div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">BU:GU</span> <span class="stat-value balance svelte-1rtvxu4"> </span> <span class="stat-sub svelte-1rtvxu4"> </span></div></div> <div class="stat-group svelte-1rtvxu4"><div class="stat color-stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">Color</span> <div class="color-display svelte-1rtvxu4"><span class="color-swatch svelte-1rtvxu4"></span> <span class="stat-value svelte-1rtvxu4"> </span></div> <span class="stat-sub svelte-1rtvxu4"> </span></div></div> <div class="stat-group svelte-1rtvxu4"><div class="stat svelte-1rtvxu4"><span class="stat-label svelte-1rtvxu4">Calories</span> <span class="stat-value svelte-1rtvxu4"> </span> <span class="stat-sub svelte-1rtvxu4">per 330ml</span></div></div></div> <div class="section metadata-section svelte-1rtvxu4"><h2 class="section-title svelte-1rtvxu4">Recipe Details</h2> <div class="form-grid svelte-1rtvxu4"><div class="form-field full-width svelte-1rtvxu4"><label for="recipe-name" class="svelte-1rtvxu4">Recipe Name *</label> <input id="recipe-name" type="text" placeholder="e.g., My Awesome IPA" class="form-input svelte-1rtvxu4"/></div> <div class="form-field svelte-1rtvxu4"><label for="author" class="svelte-1rtvxu4">Brewer</label> <input id="author" type="text" placeholder="Your name" class="form-input svelte-1rtvxu4"/></div> <div class="form-field svelte-1rtvxu4"><label for="style" class="svelte-1rtvxu4">Style</label> <input id="style" type="text" placeholder="e.g., American IPA" class="form-input svelte-1rtvxu4"/></div></div></div> <div class="section params-section svelte-1rtvxu4"><h2 class="section-title svelte-1rtvxu4">Batch Parameters</h2> <div class="params-grid svelte-1rtvxu4"><div class="param-field svelte-1rtvxu4"><label for="batch-size" class="svelte-1rtvxu4">Batch Size</label> <div class="input-with-unit svelte-1rtvxu4"><input id="batch-size" type="number" min="1" step="1" class="form-input svelte-1rtvxu4"/> <span class="unit svelte-1rtvxu4">L</span></div></div> <div class="param-field svelte-1rtvxu4"><label for="efficiency" class="svelte-1rtvxu4">Efficiency</label> <div class="input-with-unit svelte-1rtvxu4"><input id="efficiency" type="number" min="50" max="95" step="1" class="form-input svelte-1rtvxu4"/> <span class="unit svelte-1rtvxu4">%</span></div></div> <div class="param-field svelte-1rtvxu4"><label for="boil-time" class="svelte-1rtvxu4">Boil Time</label> <div class="input-with-unit svelte-1rtvxu4"><input id="boil-time" type="number" min="30" max="120" step="5" class="form-input svelte-1rtvxu4"/> <span class="unit svelte-1rtvxu4">min</span></div></div></div></div> <div class="section svelte-1rtvxu4"><!></div> <div class="section svelte-1rtvxu4"><!></div> <div class="section yeast-section svelte-1rtvxu4"><!></div> <div class="section notes-section svelte-1rtvxu4"><h2 class="section-title svelte-1rtvxu4">Notes</h2> <textarea placeholder="Brewing notes, tips, or variations..." rows="4" class="notes-input svelte-1rtvxu4"></textarea></div> <div class="actions svelte-1rtvxu4"><!> <button type="button" class="btn-primary svelte-1rtvxu4">Save Recipe</button></div></div>');function Aa(c,o){it(o,!0);let b=C(""),z=C(""),x=C(""),w=C(""),A=C(20),$=C(72),V=C(60),W=C(Ne([])),ne=C(Ne([])),H=C(null),v=Y(()=>()=>{if(e(W).length===0)return{og:1,fg:1,abv:0,ibu:0,srm:0,color_hex:"#FFE699",calories_per_330ml:0};const d=e(W).map(p=>({name:p.name,amount_kg:p.amount_kg,potential_sg:p.potential_sg||1.036,color_srm:p.color_srm||2})),ue=e(ne).map(p=>({name:p.name,amount_grams:p.amount_grams,alpha_acid_percent:p.alpha_acid_percent,boil_time_minutes:p.boil_time_minutes,form:p.form,use:p.use})),Ce={name:e(H)?.name||"Default Yeast",attenuation_percent:e(H)?.attenuation_low&&e(H)?.attenuation_high?(e(H).attenuation_low+e(H).attenuation_high)/2:75,temp_min_c:e(H)?.temp_low||18,temp_max_c:e(H)?.temp_high||22},F={batch_size_liters:e(A),efficiency_percent:e($),boil_time_minutes:e(V)};return Tt(d,ue,Ce,F)}),K=Y(()=>()=>yt(e(v)().ibu,e(v)().og)),he=Y(()=>()=>{const d=e(K)();return d<.3?"Very Malty":d<.5?"Malty":d<.7?"Balanced":d<.9?"Hoppy":"Very Bitter"});function O(d){f(W,d,!0)}function Ye(d){f(ne,d,!0)}function Ve(d){f(H,d,!0)}function Ze(){if(!e(b).trim()){alert("Please enter a recipe name");return}const d={name:e(b),author:e(z),type:e(x),batch_size_liters:e(A),efficiency_percent:e($),boil_time_minutes:e(V),og:e(v)().og,fg:e(v)().fg,abv:e(v)().abv,ibu:e(v)().ibu,color_srm:e(v)().srm,fermentables:e(W),hops:e(ne),yeast:e(H),notes:e(w)};o.onSave?.(d)}var De=La(),Ie=a(De),ke=a(Ie),Te=a(ke),We=r(a(Te),2),Ge=a(We,!0);t(We),t(Te);var ze=r(Te,2),Le=r(a(ze),2),je=a(Le,!0);t(Le),t(ze);var Ke=r(ze,2),Qe=r(a(Ke),2),Je=a(Qe);t(Qe),t(Ke),t(ke);var He=r(ke,2),Ee=a(He),Xe=r(a(Ee),2),$e=a(Xe,!0);t(Xe),t(Ee);var n=r(Ee,2),s=r(a(n),2),l=a(s,!0);t(s);var i=r(s,2),g=a(i,!0);t(i),t(n),t(He);var h=r(He,2),G=a(h),se=r(a(G),2),D=a(se),j=r(D,2),xe=a(j);t(j),t(se);var Fe=r(se,2),de=a(Fe,!0);t(Fe),t(G),t(h);var y=r(h,2),U=a(y),R=r(a(U),2),Q=a(R,!0);t(R),Re(2),t(U),t(y),t(Ie);var te=r(Ie,2),re=r(a(te),2),J=a(re),_e=r(a(J),2);ye(_e),t(J);var le=r(J,2),pe=r(a(le),2);ye(pe),t(le);var we=r(le,2),k=r(a(we),2);ye(k),t(we),t(re),t(te);var B=r(te,2),ve=r(a(B),2),ie=a(ve),M=r(a(ie),2),N=a(M);ye(N),Re(2),t(M),t(ie);var I=r(ie,2),S=r(a(I),2),T=a(S);ye(T),Re(2),t(S),t(I);var ee=r(I,2),me=r(a(ee),2),qe=a(me);ye(qe),Re(2),t(me),t(ee),t(ve),t(B);var be=r(B,2),ae=a(be);oa(ae,{get fermentables(){return e(W)},get batchSizeLiters(){return e(A)},get efficiencyPercent(){return e($)},onUpdate:O}),t(be);var X=r(be,2),Ae=a(X);{let d=Y(()=>e(v)().og);Ca(Ae,{get hops(){return e(ne)},get og(){return e(d)},get batchSizeLiters(){return e(A)},onUpdate:Ye})}t(X);var Z=r(X,2),oe=a(Z);{let d=Y(()=>e(H)?.id);Ut(oe,{get selectedYeastId(){return e(d)},onSelect:Ve,label:"Select Yeast Strain"})}t(Z);var ce=r(Z,2),ge=r(a(ce),2);zt(ge),t(ce);var Be=r(ce,2),fe=a(Be);{var Oe=d=>{var ue=Sa();ue.__click=function(...Ce){o.onCancel?.apply(this,Ce)},u(d,ue)};P(fe,d=>{o.onCancel&&d(Oe)})}var Me=r(fe,2);Me.__click=Ze,t(Be),t(De),L((d,ue,Ce,F,p,q,E,Se,nt,vt)=>{m(Ge,d),m(je,ue),m(Je,`${Ce??""}%`),m($e,F),m(l,p),m(g,q),et(D,`background-color: ${E??""}`),m(xe,`${Se??""} SRM`),m(de,nt),m(Q,vt)},[()=>e(v)().og.toFixed(3),()=>e(v)().fg.toFixed(3),()=>e(v)().abv.toFixed(1),()=>e(v)().ibu.toFixed(0),()=>e(K)().toFixed(2),()=>e(he)(),()=>e(v)().color_hex,()=>e(v)().srm.toFixed(0),()=>Dt(e(v)().srm),()=>e(v)().calories_per_330ml]),Ue(_e,()=>e(b),d=>f(b,d)),Ue(pe,()=>e(z),d=>f(z,d)),Ue(k,()=>e(x),d=>f(x,d)),Ue(N,()=>e(A),d=>f(A,d)),Ue(T,()=>e($),d=>f($,d)),Ue(qe,()=>e(V),d=>f(V,d)),Ue(ge,()=>e(w),d=>f(w,d)),u(c,De),ot()}dt(["click"]);var Ma=_('<div class="error-banner svelte-1pes5m5"><svg class="error-icon svelte-1pes5m5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div>'),Pa=_('<div class="saving-overlay svelte-1pes5m5"><div class="spinner svelte-1pes5m5"></div> <span>Saving recipe...</span></div>'),Oa=_('<div class="page-container svelte-1pes5m5"><div class="back-link svelte-1pes5m5"><a href="/recipes" class="back-btn svelte-1pes5m5"><svg class="back-icon svelte-1pes5m5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg> Back to Recipes</a></div> <div class="page-header svelte-1pes5m5"><h1 class="page-title svelte-1pes5m5">Create New Recipe</h1> <p class="page-description svelte-1pes5m5">Build your recipe with real-time calculations, or <a href="/recipes/import" class="import-link svelte-1pes5m5">import from BeerXML/BeerJSON</a></p></div> <!> <!> <!></div>');function Qa(c,o){it(o,!0);let b=C(!1),z=C(null);async function x(v){f(b,!0),f(z,null);try{const K={name:v.name,author:v.author||void 0,type:v.type||void 0,batch_size_liters:v.batch_size_liters,efficiency_percent:v.efficiency_percent,boil_time_minutes:v.boil_time_minutes,og:v.og,fg:v.fg,abv:v.abv,ibu:v.ibu,color_srm:v.color_srm,notes:v.notes||void 0,yeast_name:v.yeast?.name,yeast_lab:v.yeast?.producer,yeast_product_id:v.yeast?.product_id,yeast_temp_min:v.yeast?.temp_low??void 0,yeast_temp_max:v.yeast?.temp_high??void 0,yeast_attenuation:v.yeast?.attenuation_low&&v.yeast?.attenuation_high?(v.yeast.attenuation_low+v.yeast.attenuation_high)/2:void 0,format_extensions:{fermentables:v.fermentables.map(O=>({id:O.id,name:O.name,amount_kg:O.amount_kg,color_lovibond:O.color_lovibond,potential_sg:O.potential_sg,type:O.type,origin:O.origin,maltster:O.maltster})),hops:v.hops.map(O=>({id:O.id,name:O.name,amount_grams:O.amount_grams,alpha_acid_percent:O.alpha_acid_percent,boil_time_minutes:O.boil_time_minutes,use:O.use,form:O.form,origin:O.origin,purpose:O.purpose}))}},he=await Pt(K);_t(`/recipes/${he.id}`)}catch(K){f(z,K instanceof Error?K.message:"Failed to create recipe",!0),f(b,!1)}}function w(){_t("/recipes")}var A=Oa();Bt("1pes5m5",v=>{Ft(()=>{qt.title="New Recipe | BrewSignal"})});var $=r(a(A),4);{var V=v=>{var K=Ma(),he=r(a(K),2),O=a(he,!0);t(he),t(K),L(()=>m(O,e(z))),u(v,K)};P($,v=>{e(z)&&v(V)})}var W=r($,2);{var ne=v=>{var K=Pa();u(v,K)};P(W,v=>{e(b)&&v(ne)})}var H=r(W,2);Aa(H,{onSave:x,onCancel:w}),t(A),u(c,A),ot()}export{Qa as component};
