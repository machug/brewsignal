import{d as q,f as u,a as i,h as G,t as H,s as K}from"../chunks/BPY3LF1i.js";import{a as P,az as Q,h as a,s as f,c as n,d as o,e as r,t as R,g as T,A as U,ax as V,r as l,n as y}from"../chunks/WzhiZOZ9.js";import{i as g}from"../chunks/DTo_ih-i.js";import{h as W}from"../chunks/BJzfFUzm.js";import{b as Y}from"../chunks/l7yICoyS.js";import{g as M}from"../chunks/cRfYOULp.js";import{J as Z}from"../chunks/K3YiLSbk.js";import{R as ee}from"../chunks/BksCZVP8.js";var se=u('<span class="btn-spinner svelte-1pes5m5"></span> Analyzing...',1),te=G('<svg class="btn-icon svelte-1pes5m5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456z"></path></svg> AI Review',1),ae=u('<span class="btn-spinner svelte-1pes5m5"></span> Saving...',1),re=u('<div class="error-banner svelte-1pes5m5"><svg class="error-icon svelte-1pes5m5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span class="error-message svelte-1pes5m5"> </span> <button class="error-dismiss svelte-1pes5m5" aria-label="Dismiss error"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" class="svelte-1pes5m5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg></button></div>'),ie=u('<div class="saving-overlay svelte-1pes5m5"><div class="spinner svelte-1pes5m5"></div> <span>Saving recipe...</span></div>'),ne=u('<div class="page-container svelte-1pes5m5"><div class="back-link svelte-1pes5m5"><a href="/recipes" class="back-btn svelte-1pes5m5"><svg class="back-icon svelte-1pes5m5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"></path></svg> Back to Recipes</a></div> <div class="page-header svelte-1pes5m5"><div class="header-content svelte-1pes5m5"><h1 class="page-title svelte-1pes5m5">Create New Recipe</h1> <p class="page-description svelte-1pes5m5">Build your recipe with real-time calculations, or <a href="/recipes/import" class="import-link svelte-1pes5m5">import from BeerXML/BeerJSON</a></p></div> <div class="header-actions svelte-1pes5m5"><button type="button" class="btn-ghost svelte-1pes5m5">Cancel</button> <span class="action-divider svelte-1pes5m5"></span> <button type="button" class="btn-review svelte-1pes5m5"><!></button> <button type="button" class="btn-save svelte-1pes5m5"><!></button></div></div> <!> <!> <!></div>');function de(z,S){P(S,!0);let c=f(!1),v=f(null),p=f(void 0),b=f(!1);Q(()=>{const e=setInterval(()=>{a(p)&&n(b,a(p).getReviewLoading(),!0)},100);return()=>clearInterval(e)});async function j(e){n(c,!0),n(v,null);try{const t={name:e.name,author:e.author||void 0,type:e.type||void 0,batch_size_liters:e.batch_size_liters,efficiency_percent:e.efficiency_percent,boil_time_minutes:e.boil_time_minutes,og:e.og,fg:e.fg,abv:e.abv,ibu:e.ibu,color_srm:e.color_srm,notes:e.notes||void 0,yeast_name:e.yeast?.name,yeast_lab:e.yeast?.producer,yeast_product_id:e.yeast?.product_id,yeast_temp_min:e.yeast?.temp_low??void 0,yeast_temp_max:e.yeast?.temp_high??void 0,yeast_attenuation:e.yeast?.attenuation_low&&e.yeast?.attenuation_high?(e.yeast.attenuation_low+e.yeast.attenuation_high)/2:void 0,format_extensions:{fermentables:e.fermentables.map(s=>({id:s.id,name:s.name,amount_kg:s.amount_kg,color_lovibond:s.color_lovibond,potential_sg:s.potential_sg,type:s.type,origin:s.origin,maltster:s.maltster})),hops:e.hops.map(s=>({id:s.id,name:s.name,amount_grams:s.amount_grams,alpha_acid_percent:s.alpha_acid_percent,boil_time_minutes:s.boil_time_minutes,use:s.use,form:s.form,origin:s.origin,purpose:s.purpose}))}},_=await Z(t);M(`/recipes/${_.id}`)}catch(t){n(v,t instanceof Error?t.message:"Failed to create recipe",!0),n(c,!1)}}function w(){M("/recipes")}var h=ne();W("1pes5m5",e=>{U(()=>{V.title="New Recipe | BrewSignal"})});var k=r(o(h),2),x=r(o(k),2),L=o(x);L.__click=w;var m=r(L,4);m.__click=()=>a(p)?.review();var A=o(m);{var I=e=>{var t=se();y(),i(e,t)},N=e=>{var t=te();y(),i(e,t)};g(A,e=>{a(b)?e(I):e(N,!1)})}l(m);var d=r(m,2);d.__click=()=>a(p)?.save();var J=o(d);{var D=e=>{var t=ae();y(),i(e,t)},E=e=>{var t=H("Save Recipe");i(e,t)};g(J,e=>{a(c)?e(D):e(E,!1)})}l(d),l(x),l(k);var B=r(k,2);{var F=e=>{var t=re(),_=r(o(t),2),s=o(_,!0);l(_);var $=r(_,2);$.__click=()=>n(v,null),l(t),R(()=>K(s,a(v))),i(e,t)};g(B,e=>{a(v)&&e(F)})}var C=r(B,2);{var O=e=>{var t=ie();i(e,t)};g(C,e=>{a(c)&&e(O)})}var X=r(C,2);Y(ee(X,{onSave:j,onCancel:w}),e=>n(p,e,!0),()=>a(p)),l(h),R(()=>{m.disabled=a(b),d.disabled=a(c)}),i(z,h),T()}q(["click"]);export{de as component};
