import{g as Ge,h as It,d as Mt,f as S,a as u,c as kt,s as L,b as be,t as Tt}from"../chunks/NSBYmcxh.js";import{ar as B,x as Je,M as Ke,h as Et,aF as xt,T as Xe,U as At,a6 as Lt,aG as Rt,aH as Nt,J as Ot,K as me,p as et,c as a,ai as oe,ah as Dt,aq as G,ao as Bt,ak as o,s as E,al as l,aj as $t,e as Ht,am as jt,an as r,as as ie,au as Pt,at as Ut}from"../chunks/DkBf6qYn.js";import{e as ge,i as Ft}from"../chunks/J4k8iyZ5.js";import{i as R}from"../chunks/S0lmOLxe.js";import{h as Gt}from"../chunks/Cdr2eubP.js";import{s as Jt,b as Ve,r as qe}from"../chunks/BSVWW4up.js";import{s as ee}from"../chunks/DiswNjmD.js";import{b as Kt}from"../chunks/B1-mw0d6.js";import{b as Xt}from"../chunks/BV-WNKgS.js";function We(e,n,y=!1,M=!1,_=!1){var k=e,m="";B(()=>{var w=Et;if(m===(m=n()??"")){Je&&Ke();return}if(w.nodes_start!==null&&(xt(w.nodes_start,w.nodes_end),w.nodes_start=w.nodes_end=null),m!==""){if(Je){Xe.data;for(var C=Ke(),i=C;C!==null&&(C.nodeType!==At||C.data!=="");)i=C,C=Lt(C);if(C===null)throw Rt(),Nt;Ge(Xe,i),k=Ot(C);return}var p=m+"";y?p=`<svg>${p}</svg>`:M&&(p=`<math>${p}</math>`);var s=It(p);if((y||M)&&(s=me(s)),Ge(me(s),s.lastChild),y||M)for(;me(s);)k.before(me(s));else k.before(s)}})}function Ye(e){if(!e.startsWith("data: "))return null;const n=e.slice(6).trim();if(n==="[DONE]")return null;try{return JSON.parse(n)}catch{return console.warn("Failed to parse SSE event:",n),null}}function Vt(){return`${Date.now()}-${Math.random().toString(36).slice(2,9)}`}function qt(){const e=et({status:"disconnected",error:null,threadId:null,runId:null,messages:[],streamingMessageId:null,streamingContent:"",toolCallsList:[],agentState:{},currentStep:null});function n(s){return e.toolCallsList.find(v=>v.id===s)}function y(s,v){const g=e.toolCallsList.findIndex(b=>b.id===s);g>=0&&(e.toolCallsList[g]={...e.toolCallsList[g],...v})}const M=oe(()=>e.streamingMessageId!==null),_=oe(()=>e.status==="connected"),k=oe(()=>e.status==="connecting"||a(M)),m=oe(()=>()=>{const s=[...e.messages];if(e.streamingMessageId&&e.streamingContent){const v=s.findIndex(g=>g.id===e.streamingMessageId);v>=0?s[v]={...s[v],content:e.streamingContent}:s.push({id:e.streamingMessageId,role:"assistant",content:e.streamingContent})}return s});function w(s){switch(s.type){case"RUN_STARTED":e.status="connected",e.threadId=s.threadId,e.runId=s.runId,e.error=null;break;case"RUN_FINISHED":if(e.status="connected",e.streamingMessageId&&e.streamingContent){const g=e.messages.findIndex(b=>b.id===e.streamingMessageId);g>=0?e.messages[g].content=e.streamingContent:e.messages.push({id:e.streamingMessageId,role:"assistant",content:e.streamingContent})}e.streamingMessageId=null,e.streamingContent="",e.currentStep=null;break;case"RUN_ERROR":e.status="error",e.error=s.message,e.streamingMessageId=null,e.streamingContent="";break;case"STEP_STARTED":e.currentStep=s.stepName;break;case"STEP_FINISHED":e.currentStep=null;break;case"TEXT_MESSAGE_START":e.streamingMessageId=s.messageId,e.streamingContent="";break;case"TEXT_MESSAGE_CONTENT":s.messageId===e.streamingMessageId&&(e.streamingContent+=s.delta);break;case"TEXT_MESSAGE_END":s.messageId===e.streamingMessageId&&(e.messages.push({id:e.streamingMessageId,role:"assistant",content:e.streamingContent}),e.streamingMessageId=null,e.streamingContent="");break;case"TEXT_MESSAGE_CHUNK":e.streamingMessageId||(e.streamingMessageId=s.messageId,e.streamingContent=""),e.streamingContent+=s.content;break;case"TOOL_CALL_START":e.toolCallsList=[...e.toolCallsList,{id:s.toolCallId,name:s.toolCallName||s.toolName||"unknown",args:"",status:"running"}];break;case"TOOL_CALL_ARGS":const v=n(s.toolCallId);v&&y(s.toolCallId,{args:v.args+s.delta});break;case"TOOL_CALL_END":y(s.toolCallId,{status:"completed"});break;case"TOOL_CALL_RESULT":case"TOOL_RESULT":y(s.toolCallId,{result:s.content||s.result,status:"completed"});break;case"STATE_SNAPSHOT":e.agentState=s.snapshot;break;case"STATE_DELTA":for(const g of s.delta){const b=g.path.split("/").filter(Boolean);if(g.op==="add"||g.op==="replace"){let O=e.agentState;for(let $=0;$<b.length-1;$++)b[$]in O||(O[b[$]]={}),O=O[b[$]];O[b[b.length-1]]=g.value}else if(g.op==="remove"){let O=e.agentState;for(let $=0;$<b.length-1;$++)O=O[b[$]];delete O[b[b.length-1]]}}break;case"MESSAGES_SNAPSHOT":e.messages=s.messages;break;case"CUSTOM":console.log("Custom event:",s.name,s.value);break}}function C(s){const v={id:Vt(),role:"user",content:s,createdAt:new Date().toISOString()};return e.messages.push(v),v}function i(){e.messages=[],e.streamingMessageId=null,e.streamingContent="",e.toolCallsList=[],e.agentState={},e.threadId=null,e.runId=null,e.error=null,e.currentStep=null}function p(){e.error=null,e.status==="error"&&(e.status="disconnected")}return{get status(){return e.status},get error(){return e.error},get threadId(){return e.threadId},get runId(){return e.runId},get messages(){return e.messages},get streamingMessageId(){return e.streamingMessageId},get streamingContent(){return e.streamingContent},get toolCalls(){return e.toolCallsList},get agentState(){return e.agentState},get currentStep(){return e.currentStep},get isStreaming(){return a(M)},get isConnected(){return a(_)},get isRunning(){return a(k)},get allMessages(){return a(m)()},handleEvent:w,addUserMessage:C,clear:i,clearError:p,_setStatus(s){e.status=s},_setError(s){e.error=s},_setThreadId(s){e.threadId=s},_addMessage(s){e.messages.push(s)}}}function Wt(e){let n=null;async function y(_,k){M(),n=new AbortController,_._setStatus("connecting"),_._setError(null);try{const m=await fetch(e.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream",...e.headers},body:JSON.stringify(k),signal:n.signal});if(!m.ok){const p=await m.text();throw new Error(`HTTP ${m.status}: ${p}`)}if(!m.body)throw new Error("No response body");const w=m.body.getReader(),C=new TextDecoder;let i="";for(;;){const{done:p,value:s}=await w.read();if(p)break;i+=C.decode(s,{stream:!0});const v=i.split(`
`);i=v.pop()||"";for(const g of v){const b=Ye(g);b&&_.handleEvent(b)}}if(i.trim()){const p=Ye(i);p&&_.handleEvent(p)}}catch(m){m instanceof Error&&m.name==="AbortError"?_._setStatus("disconnected"):(_._setStatus("error"),_._setError(m instanceof Error?m.message:"Unknown error"))}finally{n=null}}function M(){n&&(n.abort(),n=null)}return{run:y,abort:M}}function Yt(e){const n=qt(),y=Wt({url:e.url,headers:e.headers});let M=e.tools||[],_=e.initialState||{},k=e.threadId;async function m(v,g){n.addUserMessage(v);const O={threadId:g||k||n.threadId,messages:n.messages,tools:M.length>0?M:void 0,state:Object.keys(_).length>0?_:void 0};await y.run(n,O),n.threadId&&(k=n.threadId),n.error?e.onError?.(n.error):e.onComplete?.()}function w(v,g){n.clear(),k=g,n._setThreadId(g);for(const b of v)n._addMessage(b)}function C(){y.abort()}function i(){y.abort(),n.clear()}function p(v){_={..._,...v}}function s(v){M=v}return{get status(){return n.status},get error(){return n.error},get messages(){return n.allMessages},get isStreaming(){return n.isStreaming},get isRunning(){return n.isRunning},get threadId(){return n.threadId},get currentStep(){return n.currentStep},get toolCalls(){return n.toolCalls},get sharedState(){return _},get streamingContent(){return n.streamingContent},send:m,stop:C,clear:i,setState:p,setTools:s,loadMessages:w,_agentState:n,_client:y}}function Qe(e){try{const n=JSON.parse(e);return JSON.stringify(n,null,2)}catch{return e}}function Ze(e){if(!e)return"";let n=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return n=n.replace(/```(\w*)\n([\s\S]*?)```/g,'<pre><code class="language-$1">$2</code></pre>'),n=n.replace(/`([^`]+)`/g,"<code>$1</code>"),n=n.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>"),n=n.replace(/\*([^*]+)\*/g,"<em>$1</em>"),n=n.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener">$1</a>'),n=n.replace(/\n/g,"<br>"),n}var Qt=S('<div class="sidebar-loading svelte-12tm3zb">Loading...</div>'),Zt=S('<div class="sidebar-empty svelte-12tm3zb">No conversations yet</div>'),es=S('<div role="button" tabindex="0"><div class="thread-title svelte-12tm3zb"> </div> <div class="thread-meta svelte-12tm3zb"><span class="svelte-12tm3zb"> </span> <span class="svelte-12tm3zb"> </span></div> <button type="button" class="thread-delete svelte-12tm3zb" title="Delete conversation"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2" class="svelte-12tm3zb"></path></svg></button></div>'),ts=S('<div class="thread-list svelte-12tm3zb"></div>'),ss=S('<button type="button" class="prompt-chip svelte-12tm3zb"> </button>'),as=S('<div class="empty-state svelte-12tm3zb"><div class="empty-icon svelte-12tm3zb"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="svelte-12tm3zb"><path d="M12 2L2 7l10 5 10-5-10-5z" class="svelte-12tm3zb"></path><path d="M2 17l10 5 10-5" class="svelte-12tm3zb"></path><path d="M2 12l10 5 10-5" class="svelte-12tm3zb"></path></svg></div> <h2 class="svelte-12tm3zb">Start a conversation</h2> <p class="svelte-12tm3zb">Ask me about beer recipes, brewing techniques, or ingredient substitutions.</p> <div class="example-prompts svelte-12tm3zb"></div></div>'),rs=be('<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-12tm3zb"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z" class="svelte-12tm3zb"></path></svg>'),ns=be('<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-12tm3zb"><path d="M12 2L2 7l10 5 10-5-10-5z" class="svelte-12tm3zb"></path><path d="M2 17l10 5 10-5M2 12l10 5 10-5" stroke="currentColor" stroke-width="2" fill="none" class="svelte-12tm3zb"></path></svg>'),ls=S('<div class="message-text streaming svelte-12tm3zb"><!> <span class="cursor svelte-12tm3zb"></span></div>'),is=S('<div class="message-text svelte-12tm3zb"><!></div>'),os=S('<div><div class="message-avatar svelte-12tm3zb"><!></div> <div class="message-content svelte-12tm3zb"><!></div></div>'),ds=S('<div class="message assistant svelte-12tm3zb"><div class="message-avatar svelte-12tm3zb"><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-12tm3zb"><path d="M12 2L2 7l10 5 10-5-10-5z" class="svelte-12tm3zb"></path><path d="M2 17l10 5 10-5M2 12l10 5 10-5" stroke="currentColor" stroke-width="2" fill="none" class="svelte-12tm3zb"></path></svg></div> <div class="message-content svelte-12tm3zb"><div class="typing-indicator svelte-12tm3zb"><span class="svelte-12tm3zb"></span><span class="svelte-12tm3zb"></span><span class="svelte-12tm3zb"></span></div></div></div>'),vs=S('<div class="messages svelte-12tm3zb"><!> <!></div>'),cs=S('<div class="error-banner svelte-12tm3zb"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="svelte-12tm3zb"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" class="svelte-12tm3zb"></path></svg> <span class="svelte-12tm3zb"> </span> <button type="button" class="svelte-12tm3zb">Dismiss</button></div>'),us=S('<div class="debug-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb">Thread</div> <div class="debug-value mono svelte-12tm3zb"> </div></div>'),ms=S('<details class="tool-details svelte-12tm3zb"><summary class="svelte-12tm3zb">Arguments</summary> <pre class="tool-json svelte-12tm3zb"> </pre></details>'),gs=S('<details class="tool-details svelte-12tm3zb"><summary class="svelte-12tm3zb">Result</summary> <pre class="tool-json svelte-12tm3zb"> </pre></details>'),bs=S('<div><div class="tool-call-header svelte-12tm3zb"><span class="tool-name svelte-12tm3zb"> </span> <span class="tool-status svelte-12tm3zb"> </span></div> <!> <!></div>'),hs=S('<div class="debug-section tool-calls-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb"> </div> <div class="tool-calls-list svelte-12tm3zb"></div></div>'),_s=S('<div class="debug-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb">Shared State</div> <details class="tool-details svelte-12tm3zb"><summary class="svelte-12tm3zb"> </summary> <pre class="tool-json svelte-12tm3zb"> </pre></details></div>'),fs=S('<div class="debug-panel svelte-12tm3zb"><div class="debug-header svelte-12tm3zb"><h3 class="svelte-12tm3zb">Agent Debug</h3> <button type="button" class="debug-close svelte-12tm3zb">Ã—</button></div> <div class="debug-content svelte-12tm3zb"><div class="debug-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb">Status</div> <div class="debug-value svelte-12tm3zb"><span> <!></span></div></div> <!> <div class="debug-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb">Messages</div> <div class="debug-value svelte-12tm3zb"> </div></div> <!> <!></div></div>'),ps=be('<svg class="spinner svelte-12tm3zb" width="20" height="20" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none" stroke-dasharray="31.4" stroke-dashoffset="10" class="svelte-12tm3zb"></circle></svg>'),zs=be('<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" class="svelte-12tm3zb"></path></svg>'),Ss=S('<div><aside><div class="sidebar-header svelte-12tm3zb"><h2 class="svelte-12tm3zb">History</h2> <button type="button" class="new-chat-btn svelte-12tm3zb" title="New conversation"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M12 5v14M5 12h14" class="svelte-12tm3zb"></path></svg></button></div> <div class="sidebar-content svelte-12tm3zb"><!></div></aside> <div class="main-content svelte-12tm3zb"><header class="page-header svelte-12tm3zb"><div class="header-left svelte-12tm3zb"><button type="button" class="sidebar-toggle svelte-12tm3zb"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M3 12h18M3 6h18M3 18h18" class="svelte-12tm3zb"></path></svg></button> <div class="header-content svelte-12tm3zb"><h1 class="svelte-12tm3zb">Brewing Assistant</h1> <p class="subtitle svelte-12tm3zb">AI-powered recipe creation and brewing advice</p></div></div> <div class="settings svelte-12tm3zb"><label class="setting svelte-12tm3zb"><span class="svelte-12tm3zb">Batch Size</span> <input type="number" min="1" max="100" class="svelte-12tm3zb"/> L</label> <label class="setting svelte-12tm3zb"><span class="svelte-12tm3zb">Efficiency</span> <input type="number" min="50" max="100" class="svelte-12tm3zb"/> %</label> <button type="button" title="Toggle agent debug panel"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M12 20h9M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z" class="svelte-12tm3zb"></path></svg></button></div></header> <main class="chat-container svelte-12tm3zb"><!> <!> <!></main> <footer class="input-area svelte-12tm3zb"><div class="input-wrapper svelte-12tm3zb"><textarea placeholder="Ask about brewing..." rows="1" class="svelte-12tm3zb"></textarea> <button type="button" class="send-button svelte-12tm3zb"><!></button></div> <div class="input-hint svelte-12tm3zb">Press Enter to send, Shift+Enter for new line</div></footer></div></div>');function As(e,n){Dt(n,!0);let y=G(19),M=G(72),_=G(!1),k=G(!0),m=G(et([])),w=G(null),C=G(!1);const i=Yt({url:"/api/ag-ui/run",initialState:{batchSize:a(y),efficiency:a(M)},onStateChange:t=>{t.recipe&&console.log("Recipe extracted:",t.recipe)},onError:t=>{console.error("Agent error:",t)}});let p=oe(()=>i.toolCalls),s=G(""),v=G(null);async function g(){E(C,!0);try{const t=await fetch("/api/ag-ui/threads?limit=50");t.ok&&E(m,await t.json(),!0)}catch(t){console.error("Failed to fetch threads:",t)}finally{E(C,!1)}}async function b(t){try{const d=await fetch(`/api/ag-ui/threads/${t}`);if(d.ok){const z=await d.json();E(w,t,!0);const x=z.messages.filter(h=>h.role==="user"||h.role==="assistant").map(h=>({id:String(h.id),role:h.role,content:h.content,createdAt:h.created_at}));i.loadMessages(x,t)}}catch(d){console.error("Failed to load thread:",d)}}async function O(t){if(confirm("Delete this conversation?"))try{(await fetch(`/api/ag-ui/threads/${t}`,{method:"DELETE"})).ok&&(E(m,a(m).filter(z=>z.id!==t),!0),a(w)===t&&$())}catch(d){console.error("Failed to delete thread:",d)}}function $(){E(w,null),i.clear(),a(v)?.focus()}function tt(t){E(y,t,!0),i.setState({batchSize:t})}function st(t){E(M,t,!0),i.setState({efficiency:t})}function Te(t){t.style.height="auto",t.style.height=Math.min(t.scrollHeight,200)+"px"}async function Ee(){const t=a(s).trim();!t||i.isRunning||(E(s,""),a(v)&&(a(v).style.height="auto"),await i.send(t,a(w)||void 0),!a(w)&&i.threadId&&(E(w,i.threadId,!0),g()))}function at(t){t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),Ee())}const rt=["Help me create an American IPA recipe","What temperature should I ferment a Belgian Tripel?","Create a simple wheat beer recipe for summer","Explain the difference between ale and lager yeast"];function nt(t){E(s,t,!0),a(v)&&(a(v).focus(),Te(a(v)))}function lt(t){const d=new Date(t),x=new Date().getTime()-d.getTime(),h=Math.floor(x/6e4),c=Math.floor(x/36e5),f=Math.floor(x/864e5);return h<1?"just now":h<60?`${h}m ago`:c<24?`${c}h ago`:f<7?`${f}d ago`:d.toLocaleDateString()}Bt(()=>{a(v)?.focus(),g()});var de=Ss();Gt("12tm3zb",t=>{Ht(()=>{jt.title="AI Assistant | BrewSignal"})});let xe;var ve=l(de);let Ae;var he=l(ve),it=o(l(he),2);it.__click=$,r(he);var Le=o(he,2),ot=l(Le);{var dt=t=>{var d=Qt();u(t,d)},vt=t=>{var d=kt(),z=Ut(d);{var x=c=>{var f=Zt();u(c,f)},h=c=>{var f=ts();ge(f,21,()=>a(m),H=>H.id,(H,N)=>{var j=es();let te;j.__click=()=>b(a(N).id),j.__keydown=W=>W.key==="Enter"&&b(a(N).id);var K=l(j),X=l(K,!0);r(K);var V=o(K,2),U=l(V),se=l(U);r(U);var I=o(U,2),T=l(I,!0);r(I),r(V);var q=o(V,2);q.__click=W=>{W.stopPropagation(),O(a(N).id)},r(j),B(W=>{te=ee(j,1,"thread-item svelte-12tm3zb",null,te,{active:a(w)===a(N).id}),L(X,a(N).title||"Untitled"),L(se,`${a(N).message_count??""} msgs`),L(T,W)},[()=>lt(a(N).updated_at)]),u(H,j)}),r(f),u(c,f)};R(z,c=>{a(m).length===0?c(x):c(h,!1)},!0)}u(t,d)};R(ot,t=>{a(C)?t(dt):t(vt,!1)})}r(Le),r(ve);var Re=o(ve,2),_e=l(Re),fe=l(_e),Ne=l(fe);Ne.__click=()=>E(k,!a(k)),ie(2),r(fe);var Oe=o(fe,2),pe=l(Oe),ze=o(l(pe),2);qe(ze),ze.__change=t=>tt(Number(t.currentTarget.value)),ie(),r(pe);var Se=o(pe,2),we=o(l(Se),2);qe(we),we.__change=t=>st(Number(t.currentTarget.value)),ie(),r(Se);var De=o(Se,2);let Be;De.__click=()=>E(_,!a(_)),r(Oe),r(_e);var Ce=o(_e,2),$e=l(Ce);{var ct=t=>{var d=as(),z=o(l(d),6);ge(z,21,()=>rt,Ft,(x,h)=>{var c=ss();c.__click=()=>nt(a(h));var f=l(c,!0);r(c),B(()=>L(f,a(h))),u(x,c)}),r(z),r(d),u(t,d)},ut=t=>{var d=vs(),z=l(d);ge(z,17,()=>i.messages,c=>c.id,(c,f)=>{var H=os(),N=l(H),j=l(N);{var te=I=>{var T=rs();u(I,T)},K=I=>{var T=ns();u(I,T)};R(j,I=>{a(f).role==="user"?I(te):I(K,!1)})}r(N);var X=o(N,2),V=l(X);{var U=I=>{var T=ls(),q=l(T);We(q,()=>Ze(i.streamingContent||"")),ie(2),r(T),u(I,T)},se=I=>{var T=is(),q=l(T);We(q,()=>Ze(a(f).content)),r(T),u(I,T)};R(V,I=>{a(f).role==="assistant"&&i.isStreaming&&a(f).id===i._agentState.streamingMessageId?I(U):I(se,!1)})}r(X),r(H),B(()=>ee(H,1,`message ${a(f).role??""}`,"svelte-12tm3zb")),u(c,H)});var x=o(z,2);{var h=c=>{var f=ds();u(c,f)};R(x,c=>{i.isRunning&&!i.isStreaming&&c(h)})}r(d),u(t,d)};R($e,t=>{i.messages.length===0?t(ct):t(ut,!1)})}var He=o($e,2);{var mt=t=>{var d=cs(),z=o(l(d),2),x=l(z,!0);r(z);var h=o(z,2);h.__click=()=>i._agentState.clearError(),r(d),B(()=>L(x,i.error)),u(t,d)};R(He,t=>{i.error&&t(mt)})}var gt=o(He,2);{var bt=t=>{var d=fs(),z=l(d),x=o(l(z),2);x.__click=()=>E(_,!1),r(z);var h=o(z,2),c=l(h),f=o(l(c),2),H=l(f);let N;var j=l(H),te=o(j);{var K=A=>{var D=Tt("(streaming)");u(A,D)};R(te,A=>{i.isStreaming&&A(K)})}r(H),r(f),r(c);var X=o(c,2);{var V=A=>{var D=us(),F=o(l(D),2),Y=l(F);r(F),r(D),B(ae=>L(Y,`${ae??""}...`),[()=>i.threadId.slice(0,8)]),u(A,D)};R(X,A=>{i.threadId&&A(V)})}var U=o(X,2),se=o(l(U),2),I=l(se,!0);r(se),r(U);var T=o(U,2);{var q=A=>{var D=hs(),F=l(D),Y=l(F);r(F);var ae=o(F,2);ge(ae,21,()=>a(p),re=>re.id,(re,P)=>{var ne=bs();let ue;var ye=l(ne),Ie=l(ye),zt=l(Ie,!0);r(Ie);var Ue=o(Ie,2),St=l(Ue,!0);r(Ue),r(ye);var Fe=o(ye,2);{var wt=Q=>{var Z=ms(),le=o(l(Z),2),Me=l(le,!0);r(le),r(Z),B(ke=>L(Me,ke),[()=>Qe(a(P).args)]),u(Q,Z)};R(Fe,Q=>{a(P).args&&Q(wt)})}var Ct=o(Fe,2);{var yt=Q=>{var Z=gs(),le=o(l(Z),2),Me=l(le,!0);r(le),r(Z),B(ke=>L(Me,ke),[()=>Qe(a(P).result)]),u(Q,Z)};R(Ct,Q=>{a(P).result&&Q(yt)})}r(ne),B(()=>{ue=ee(ne,1,"tool-call svelte-12tm3zb",null,ue,{running:a(P).status==="running",completed:a(P).status==="completed"}),L(zt,a(P).name),L(St,a(P).status)}),u(re,ne)}),r(ae),r(D),B(()=>L(Y,`Tool Calls (${a(p).length??""})`)),u(A,D)};R(T,A=>{a(p).length>0&&A(q)})}var W=o(T,2);{var pt=A=>{var D=_s(),F=o(l(D),2),Y=l(F),ae=l(Y);r(Y);var re=o(Y,2),P=l(re,!0);r(re),r(F),r(D),B((ne,ue)=>{L(ae,`${ne??""} keys`),L(P,ue)},[()=>Object.keys(i.sharedState).length,()=>JSON.stringify(i.sharedState,null,2)]),u(A,D)};R(W,A=>{Object.keys(i.sharedState).length>0&&A(pt)})}r(h),r(d),B(()=>{N=ee(H,1,"status-badge svelte-12tm3zb",null,N,{running:i.isRunning,streaming:i.isStreaming}),L(j,`${i.status??""} `),L(I,i.messages.length)}),u(t,d)};R(gt,t=>{a(_)&&t(bt)})}r(Ce);var je=o(Ce,2),Pe=l(je),J=l(Pe);Pt(J),J.__input=t=>Te(t.currentTarget),J.__keydown=at,Xt(J,t=>E(v,t),()=>a(v));var ce=o(J,2);ce.__click=Ee;var ht=l(ce);{var _t=t=>{var d=ps();u(t,d)},ft=t=>{var d=zs();u(t,d)};R(ht,t=>{i.isRunning?t(_t):t(ft,!1)})}r(ce),r(Pe),ie(2),r(je),r(Re),r(de),B(t=>{xe=ee(de,1,"assistant-page svelte-12tm3zb",null,xe,{"sidebar-open":a(k)}),Ae=ee(ve,1,"sidebar svelte-12tm3zb",null,Ae,{open:a(k)}),Jt(Ne,"title",a(k)?"Hide sidebar":"Show sidebar"),Ve(ze,a(y)),Ve(we,a(M)),Be=ee(De,1,"debug-toggle svelte-12tm3zb",null,Be,{active:a(_)}),J.disabled=i.isRunning,ce.disabled=t},[()=>!a(s).trim()||i.isRunning]),Kt(J,()=>a(s),t=>E(s,t)),u(e,de),$t()}Mt(["click","keydown","change","input"]);export{As as component};
