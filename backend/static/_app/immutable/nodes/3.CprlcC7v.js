import{d as pt,f as S,a as c,c as ft,s as A,h as ge,t as _t}from"../chunks/Bkky6kvZ.js";import{p as Ke,h as a,u as ie,a as zt,s as G,az as St,o as wt,e as d,c as C,d as l,t as B,g as Ct,A as kt,ax as It,r as n,n as Ce,i as Mt,f as Tt}from"../chunks/813s5maz.js";import{e as me,i as yt}from"../chunks/j9QCVC2i.js";import{i as y}from"../chunks/Bf7HnLem.js";import{h as Ue}from"../chunks/DmKVr2i2.js";import{h as Et}from"../chunks/BgIwEmqo.js";import{s as xt}from"../chunks/UKAZQVVw.js";import{s as ee}from"../chunks/LBYG0Yba.js";import{b as At}from"../chunks/Bjks-vZK.js";import{b as Fe}from"../chunks/DjIcCduU.js";function Ge(e){if(!e.startsWith("data: "))return null;const s=e.slice(6).trim();if(s==="[DONE]")return null;try{return JSON.parse(s)}catch{return console.warn("Failed to parse SSE event:",s),null}}function Lt(){return`${Date.now()}-${Math.random().toString(36).slice(2,9)}`}function Rt(){const e=Ke({status:"disconnected",error:null,threadId:null,runId:null,messages:[],streamingMessageId:null,streamingContent:"",toolCallsList:[],agentState:{},currentStep:null});function s(r){return e.toolCallsList.find(v=>v.id===r)}function k(r,v){const m=e.toolCallsList.findIndex(f=>f.id===r);m>=0&&(e.toolCallsList[m]={...e.toolCallsList[m],...v})}const b=ie(()=>e.streamingMessageId!==null),_=ie(()=>e.status==="connected"),w=ie(()=>e.status==="connecting"||a(b)),p=ie(()=>()=>{const r=[...e.messages];if(e.streamingMessageId&&e.streamingContent){const v=r.findIndex(m=>m.id===e.streamingMessageId);v>=0?r[v]={...r[v],content:e.streamingContent}:r.push({id:e.streamingMessageId,role:"assistant",content:e.streamingContent})}return r});function P(r){switch(r.type){case"RUN_STARTED":e.status="connected",e.threadId=r.threadId,e.runId=r.runId,e.error=null;break;case"RUN_FINISHED":if(e.status="connected",e.streamingMessageId&&e.streamingContent){const m=e.messages.findIndex(f=>f.id===e.streamingMessageId);m>=0?e.messages[m].content=e.streamingContent:e.messages.push({id:e.streamingMessageId,role:"assistant",content:e.streamingContent})}e.streamingMessageId=null,e.streamingContent="",e.currentStep=null;break;case"RUN_ERROR":e.status="error",e.error=r.message,e.streamingMessageId=null,e.streamingContent="";break;case"STEP_STARTED":e.currentStep=r.stepName;break;case"STEP_FINISHED":e.currentStep=null;break;case"TEXT_MESSAGE_START":e.streamingMessageId=r.messageId,e.streamingContent="";break;case"TEXT_MESSAGE_CONTENT":r.messageId===e.streamingMessageId&&(e.streamingContent+=r.delta);break;case"TEXT_MESSAGE_END":r.messageId===e.streamingMessageId&&(e.messages.push({id:e.streamingMessageId,role:"assistant",content:e.streamingContent}),e.streamingMessageId=null,e.streamingContent="");break;case"TEXT_MESSAGE_CHUNK":e.streamingMessageId||(e.streamingMessageId=r.messageId,e.streamingContent=""),e.streamingContent+=r.content;break;case"TOOL_CALL_START":e.toolCallsList=[...e.toolCallsList,{id:r.toolCallId,name:r.toolCallName||r.toolName||"unknown",args:"",status:"running"}];break;case"TOOL_CALL_ARGS":const v=s(r.toolCallId);v&&k(r.toolCallId,{args:v.args+r.delta});break;case"TOOL_CALL_END":k(r.toolCallId,{status:"completed"});break;case"TOOL_CALL_RESULT":case"TOOL_RESULT":k(r.toolCallId,{result:r.content||r.result,status:"completed"});break;case"STATE_SNAPSHOT":e.agentState=r.snapshot;break;case"STATE_DELTA":for(const m of r.delta){const f=m.path.split("/").filter(Boolean);if(m.op==="add"||m.op==="replace"){let O=e.agentState;for(let N=0;N<f.length-1;N++)f[N]in O||(O[f[N]]={}),O=O[f[N]];O[f[f.length-1]]=m.value}else if(m.op==="remove"){let O=e.agentState;for(let N=0;N<f.length-1;N++)O=O[f[N]];delete O[f[f.length-1]]}}break;case"MESSAGES_SNAPSHOT":e.messages=r.messages;break;case"CUSTOM":console.log("Custom event:",r.name,r.value);break}}function o(r){const v={id:Lt(),role:"user",content:r,createdAt:new Date().toISOString()};return e.messages.push(v),v}function R(){e.messages=[],e.streamingMessageId=null,e.streamingContent="",e.toolCallsList=[],e.agentState={},e.threadId=null,e.runId=null,e.error=null,e.currentStep=null}function M(){e.error=null,e.status==="error"&&(e.status="disconnected")}return{get status(){return e.status},get error(){return e.error},get threadId(){return e.threadId},get runId(){return e.runId},get messages(){return e.messages},get streamingMessageId(){return e.streamingMessageId},get streamingContent(){return e.streamingContent},get toolCalls(){return e.toolCallsList},get agentState(){return e.agentState},get currentStep(){return e.currentStep},get isStreaming(){return a(b)},get isConnected(){return a(_)},get isRunning(){return a(w)},get allMessages(){return a(p)()},handleEvent:P,addUserMessage:o,clear:R,clearError:M,_setStatus(r){e.status=r},_setError(r){e.error=r},_setThreadId(r){e.threadId=r},_addMessage(r){e.messages.push(r)}}}function Ot(e){let s=null;async function k(_,w){b(),s=new AbortController,_._setStatus("connecting"),_._setError(null);try{const p=await fetch(e.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream",...e.headers},body:JSON.stringify(w),signal:s.signal});if(!p.ok){const M=await p.text();throw new Error(`HTTP ${p.status}: ${M}`)}if(!p.body)throw new Error("No response body");const P=p.body.getReader(),o=new TextDecoder;let R="";for(;;){const{done:M,value:r}=await P.read();if(M)break;R+=o.decode(r,{stream:!0});const v=R.split(`
`);R=v.pop()||"";for(const m of v){const f=Ge(m);f&&_.handleEvent(f)}}if(R.trim()){const M=Ge(R);M&&_.handleEvent(M)}}catch(p){p instanceof Error&&p.name==="AbortError"?_._setStatus("disconnected"):(_._setStatus("error"),_._setError(p instanceof Error?p.message:"Unknown error"))}finally{s=null}}function b(){s&&(s.abort(),s=null)}return{run:k,abort:b}}function $t(e){const s=Rt(),k=Ot({url:e.url,headers:e.headers});let b=e.tools||[],_=e.initialState||{},w=e.threadId;async function p(v,m){s.addUserMessage(v);const O={threadId:m||w||s.threadId,messages:s.messages,tools:b.length>0?b:void 0,state:Object.keys(_).length>0?_:void 0};await k.run(s,O),s.threadId&&(w=s.threadId),s.error?e.onError?.(s.error):e.onComplete?.()}function P(v,m){s.clear(),w=m,s._setThreadId(m);for(const f of v)s._addMessage(f)}function o(){k.abort()}function R(){k.abort(),s.clear()}function M(v){_={..._,...v}}function r(v){b=v}return{get status(){return s.status},get error(){return s.error},get messages(){return s.allMessages},get isStreaming(){return s.isStreaming},get isRunning(){return s.isRunning},get threadId(){return s.threadId},get currentStep(){return s.currentStep},get toolCalls(){return s.toolCalls},get sharedState(){return _},get streamingContent(){return s.streamingContent},send:p,stop:o,clear:R,setState:M,setTools:r,loadMessages:P,_agentState:s,_client:k}}function Je(e){try{const s=JSON.parse(e);return JSON.stringify(s,null,2)}catch{return e}}function Xe(e){if(!e)return"";let s=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return s=s.replace(/```(\w*)\n([\s\S]*?)```/g,'<pre><code class="language-$1">$2</code></pre>'),s=s.replace(/`([^`]+)`/g,"<code>$1</code>"),s=s.replace(/^### (.+)$/gm,"<h4>$1</h4>"),s=s.replace(/^## (.+)$/gm,"<h3>$1</h3>"),s=s.replace(/^# (.+)$/gm,"<h2>$1</h2>"),s=s.replace(/^---+$/gm,"<hr>"),s=s.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>"),s=s.replace(/\*([^*]+)\*/g,"<em>$1</em>"),s=s.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener">$1</a>'),s=s.replace(/(?:^|\n)((?:- .+\n?)+)/g,(k,b)=>`
<ul>`+b.trim().split(`
`).map(w=>w.replace(/^- (.+)$/,"<li>$1</li>")).join("")+`</ul>
`),s=s.replace(/(?:^|\n)((?:\d+\. .+\n?)+)/g,(k,b)=>`
<ol>`+b.trim().split(`
`).map(w=>w.replace(/^\d+\. (.+)$/,"<li>$1</li>")).join("")+`</ol>
`),s=s.replace(/\n(?!<\/?(ul|ol|li|pre|h[1-6]|hr))/g,"<br>"),s=s.replace(/<br><(ul|ol|pre|h[1-6]|hr)/g,"<$1"),s=s.replace(/<\/(ul|ol|pre|h[1-6])><br>/g,"</$1>"),s}var Nt=S('<button type="button" class="sidebar-backdrop svelte-12tm3zb" aria-label="Close sidebar"></button>'),Dt=S('<div class="sidebar-loading svelte-12tm3zb">Loading...</div>'),Bt=S('<div class="sidebar-empty svelte-12tm3zb">No conversations yet</div>'),jt=S('<div role="button" tabindex="0"><div class="thread-title svelte-12tm3zb"> </div> <div class="thread-meta svelte-12tm3zb"><span class="svelte-12tm3zb"> </span> <span class="svelte-12tm3zb"> </span></div> <button type="button" class="thread-delete svelte-12tm3zb" title="Delete conversation"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2" class="svelte-12tm3zb"></path></svg></button></div>'),Ht=S('<div class="thread-list svelte-12tm3zb"></div>'),Pt=S('<button type="button" class="prompt-chip svelte-12tm3zb"> </button>'),Ut=S('<div class="empty-state svelte-12tm3zb"><div class="empty-icon svelte-12tm3zb"><svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="svelte-12tm3zb"><path d="M12 2L2 7l10 5 10-5-10-5z" class="svelte-12tm3zb"></path><path d="M2 17l10 5 10-5" class="svelte-12tm3zb"></path><path d="M2 12l10 5 10-5" class="svelte-12tm3zb"></path></svg></div> <h2 class="svelte-12tm3zb">Start a conversation</h2> <p class="empty-description svelte-12tm3zb">Ask about recipes, techniques, or ingredients</p> <div class="example-prompts svelte-12tm3zb"></div></div>'),Ft=ge('<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-12tm3zb"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z" class="svelte-12tm3zb"></path></svg>'),Gt=ge('<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-12tm3zb"><path d="M12 2L2 7l10 5 10-5-10-5z" class="svelte-12tm3zb"></path><path d="M2 17l10 5 10-5M2 12l10 5 10-5" stroke="currentColor" stroke-width="2" fill="none" class="svelte-12tm3zb"></path></svg>'),Jt=S('<div class="message-text streaming svelte-12tm3zb"><!> <span class="cursor svelte-12tm3zb"></span></div>'),Xt=S('<div class="message-text svelte-12tm3zb"><!></div>'),Kt=S('<div><div class="message-avatar svelte-12tm3zb"><!></div> <div class="message-content svelte-12tm3zb"><!></div></div>'),Vt=S('<div class="message assistant svelte-12tm3zb"><div class="message-avatar svelte-12tm3zb"><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-12tm3zb"><path d="M12 2L2 7l10 5 10-5-10-5z" class="svelte-12tm3zb"></path><path d="M2 17l10 5 10-5M2 12l10 5 10-5" stroke="currentColor" stroke-width="2" fill="none" class="svelte-12tm3zb"></path></svg></div> <div class="message-content svelte-12tm3zb"><div class="typing-indicator svelte-12tm3zb"><span class="svelte-12tm3zb"></span><span class="svelte-12tm3zb"></span><span class="svelte-12tm3zb"></span></div></div></div>'),Wt=S('<div class="messages svelte-12tm3zb"><!> <!></div>'),qt=S('<div class="error-banner svelte-12tm3zb"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="svelte-12tm3zb"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" class="svelte-12tm3zb"></path></svg> <span class="svelte-12tm3zb"> </span> <button type="button" class="svelte-12tm3zb">Dismiss</button></div>'),Qt=S('<div class="debug-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb">Thread</div> <div class="debug-value mono svelte-12tm3zb"> </div></div>'),Yt=S('<details class="tool-details svelte-12tm3zb"><summary class="svelte-12tm3zb">Arguments</summary> <pre class="tool-json svelte-12tm3zb"> </pre></details>'),Zt=S('<details class="tool-details svelte-12tm3zb"><summary class="svelte-12tm3zb">Result</summary> <pre class="tool-json svelte-12tm3zb"> </pre></details>'),es=S('<div><div class="tool-call-header svelte-12tm3zb"><span class="tool-name svelte-12tm3zb"> </span> <span class="tool-status svelte-12tm3zb"> </span></div> <!> <!></div>'),ts=S('<div class="debug-section tool-calls-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb"> </div> <div class="tool-calls-list svelte-12tm3zb"></div></div>'),ss=S('<div class="debug-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb">Shared State</div> <details class="tool-details svelte-12tm3zb"><summary class="svelte-12tm3zb"> </summary> <pre class="tool-json svelte-12tm3zb"> </pre></details></div>'),as=S('<div class="debug-panel svelte-12tm3zb"><div class="debug-header svelte-12tm3zb"><h3 class="svelte-12tm3zb">Agent Debug</h3> <button type="button" class="debug-close svelte-12tm3zb">Ã—</button></div> <div class="debug-content svelte-12tm3zb"><div class="debug-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb">Status</div> <div class="debug-value svelte-12tm3zb"><span> <!></span></div></div> <!> <div class="debug-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb">Messages</div> <div class="debug-value svelte-12tm3zb"> </div></div> <!> <!></div></div>'),rs=ge('<svg class="spinner svelte-12tm3zb" width="20" height="20" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none" stroke-dasharray="31.4" stroke-dashoffset="10" class="svelte-12tm3zb"></circle></svg>'),ns=ge('<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" class="svelte-12tm3zb"></path></svg>'),ls=S('<div><!> <aside><div class="sidebar-header svelte-12tm3zb"><h2 class="svelte-12tm3zb">History</h2> <button type="button" class="new-chat-btn svelte-12tm3zb" title="New conversation"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M12 5v14M5 12h14" class="svelte-12tm3zb"></path></svg></button></div> <div class="sidebar-content svelte-12tm3zb"><!></div></aside> <div class="main-content svelte-12tm3zb"><header class="page-header svelte-12tm3zb"><div class="header-left svelte-12tm3zb"><button type="button" class="sidebar-toggle svelte-12tm3zb"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M3 12h18M3 6h18M3 18h18" class="svelte-12tm3zb"></path></svg></button> <div class="header-content svelte-12tm3zb"><h1 class="svelte-12tm3zb">Brewing Assistant</h1> <p class="subtitle svelte-12tm3zb">AI-powered recipe creation and brewing advice</p></div></div> <div class="settings svelte-12tm3zb"><button type="button" title="Toggle agent debug panel"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M12 20h9M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z" class="svelte-12tm3zb"></path></svg></button></div></header> <main class="chat-container svelte-12tm3zb"><!> <!> <!></main> <footer class="input-area svelte-12tm3zb"><div class="input-wrapper svelte-12tm3zb"><textarea placeholder="Ask about brewing..." rows="1" class="svelte-12tm3zb"></textarea> <button type="button" class="send-button svelte-12tm3zb"><!></button></div> <div class="input-hint svelte-12tm3zb">Press Enter to send, Shift+Enter for new line</div></footer></div></div>');function ps(e,s){zt(s,!0);let k=G(!1),b=G(!1),_=G(!1),w=G(Ke([])),p=G(null),P=G(!1);const o=$t({url:"/api/ag-ui/run",initialState:{},onStateChange:t=>{if(t.recipe&&console.log("Recipe extracted:",t.recipe),t.renamedThread){const i=t.renamedThread;C(w,a(w).map(g=>g.id===i.id?{...g,title:i.title}:g),!0)}},onError:t=>{console.error("Agent error:",t)}});let R=ie(()=>o.toolCalls),M=G(""),r=G(null),v=G(null);St(()=>{o.messages.length,o.streamingContent,a(v)&&requestAnimationFrame(()=>{a(v)?.scrollTo({top:a(v).scrollHeight,behavior:"smooth"})})});async function m(){C(P,!0);try{const t=await fetch("/api/ag-ui/threads?limit=50");t.ok&&C(w,await t.json(),!0)}catch(t){console.error("Failed to fetch threads:",t)}finally{C(P,!1)}}async function f(t){try{const i=await fetch(`/api/ag-ui/threads/${t}`);if(i.ok){const g=await i.json();C(p,t,!0);const E=g.messages.filter(h=>h.role==="user"||h.role==="assistant").map(h=>({id:String(h.id),role:h.role,content:h.content,createdAt:h.created_at}));o.loadMessages(E,t)}}catch(i){console.error("Failed to load thread:",i)}}async function O(t){if(confirm("Delete this conversation?"))try{(await fetch(`/api/ag-ui/threads/${t}`,{method:"DELETE"})).ok&&(C(w,a(w).filter(g=>g.id!==t),!0),a(p)===t&&N())}catch(i){console.error("Failed to delete thread:",i)}}function N(){C(p,null),o.clear(),a(r)?.focus()}function ke(t){t.style.height="auto",t.style.height=Math.min(t.scrollHeight,200)+"px"}async function Ie(){const t=a(M).trim();!t||o.isRunning||(C(M,""),a(r)&&(a(r).style.height="auto"),await o.send(t,a(p)||void 0),!a(p)&&o.threadId&&(C(p,o.threadId,!0),m()))}function Ve(t){t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),Ie())}const We=["Help me create an American IPA recipe","What temperature should I ferment a Belgian Tripel?","Create a simple wheat beer recipe for summer","Explain the difference between ale and lager yeast"];function qe(t){C(M,t,!0),a(r)&&(a(r).focus(),ke(a(r)))}function Qe(t){const i=new Date(t),E=new Date().getTime()-i.getTime(),h=Math.floor(E/6e4),u=Math.floor(E/36e5),z=Math.floor(E/864e5);return h<1?"just now":h<60?`${h}m ago`:u<24?`${u}h ago`:z<7?`${z}d ago`:i.toLocaleDateString()}function he(){C(_,window.innerWidth<768)}wt(()=>(a(r)?.focus(),m(),he(),window.addEventListener("resize",he),()=>window.removeEventListener("resize",he)));function Me(t){f(t),a(_)&&C(b,!1)}var oe=ls();Et("12tm3zb",t=>{kt(()=>{It.title="AI Assistant | BrewSignal"})});let Te;var ye=l(oe);{var Ye=t=>{var i=Nt();i.__click=()=>C(b,!1),c(t,i)};y(ye,t=>{a(b)&&a(_)&&t(Ye)})}var de=d(ye,2);let Ee;var be=l(de),Ze=d(l(be),2);Ze.__click=N,n(be);var xe=d(be,2),et=l(xe);{var tt=t=>{var i=Dt();c(t,i)},st=t=>{var i=ft(),g=Tt(i);{var E=u=>{var z=Bt();c(u,z)},h=u=>{var z=Ht();me(z,21,()=>a(w),D=>D.id,(D,L)=>{var j=jt();let te;j.__click=()=>Me(a(L).id),j.__keydown=q=>q.key==="Enter"&&Me(a(L).id);var X=l(j),K=l(X,!0);n(X);var V=d(X,2),U=l(V),se=l(U);n(U);var I=d(U,2),T=l(I,!0);n(I),n(V);var W=d(V,2);W.__click=q=>{q.stopPropagation(),O(a(L).id)},n(j),B(q=>{te=ee(j,1,"thread-item svelte-12tm3zb",null,te,{active:a(p)===a(L).id}),A(K,a(L).title||"Untitled"),A(se,`${a(L).message_count??""} msgs`),A(T,q)},[()=>Qe(a(L).updated_at)]),c(D,j)}),n(z),c(u,z)};y(g,u=>{a(w).length===0?u(E):u(h,!1)},!0)}c(t,i)};y(et,t=>{a(P)?t(tt):t(st,!1)})}n(xe),n(de);var Ae=d(de,2),pe=l(Ae),fe=l(pe),Le=l(fe);Le.__click=()=>C(b,!a(b)),Ce(2),n(fe);var Re=d(fe,2),Oe=l(Re);let $e;Oe.__click=()=>C(k,!a(k)),n(Re),n(pe);var ve=d(pe,2),Ne=l(ve);{var at=t=>{var i=Ut(),g=d(l(i),6);me(g,21,()=>We,yt,(E,h)=>{var u=Pt();u.__click=()=>qe(a(h));var z=l(u,!0);n(u),B(()=>A(z,a(h))),c(E,u)}),n(g),n(i),c(t,i)},rt=t=>{var i=Wt(),g=l(i);me(g,17,()=>o.messages,u=>u.id,(u,z)=>{var D=Kt(),L=l(D),j=l(L);{var te=I=>{var T=Ft();c(I,T)},X=I=>{var T=Gt();c(I,T)};y(j,I=>{a(z).role==="user"?I(te):I(X,!1)})}n(L);var K=d(L,2),V=l(K);{var U=I=>{var T=Jt(),W=l(T);Ue(W,()=>Xe(o.streamingContent||"")),Ce(2),n(T),c(I,T)},se=I=>{var T=Xt(),W=l(T);Ue(W,()=>Xe(a(z).content)),n(T),c(I,T)};y(V,I=>{a(z).role==="assistant"&&o.isStreaming&&a(z).id===o._agentState.streamingMessageId?I(U):I(se,!1)})}n(K),n(D),B(()=>ee(D,1,`message ${a(z).role??""}`,"svelte-12tm3zb")),c(u,D)});var E=d(g,2);{var h=u=>{var z=Vt();c(u,z)};y(E,u=>{o.isRunning&&!o.isStreaming&&u(h)})}n(i),c(t,i)};y(Ne,t=>{o.messages.length===0?t(at):t(rt,!1)})}var De=d(Ne,2);{var nt=t=>{var i=qt(),g=d(l(i),2),E=l(g,!0);n(g);var h=d(g,2);h.__click=()=>o._agentState.clearError(),n(i),B(()=>A(E,o.error)),c(t,i)};y(De,t=>{o.error&&t(nt)})}var lt=d(De,2);{var it=t=>{var i=as(),g=l(i),E=d(l(g),2);E.__click=()=>C(k,!1),n(g);var h=d(g,2),u=l(h),z=d(l(u),2),D=l(z);let L;var j=l(D),te=d(j);{var X=x=>{var $=_t("(streaming)");c(x,$)};y(te,x=>{o.isStreaming&&x(X)})}n(D),n(z),n(u);var K=d(u,2);{var V=x=>{var $=Qt(),F=d(l($),2),Q=l(F);n(F),n($),B(ae=>A(Q,`${ae??""}...`),[()=>o.threadId.slice(0,8)]),c(x,$)};y(K,x=>{o.threadId&&x(V)})}var U=d(K,2),se=d(l(U),2),I=l(se,!0);n(se),n(U);var T=d(U,2);{var W=x=>{var $=ts(),F=l($),Q=l(F);n(F);var ae=d(F,2);me(ae,21,()=>a(R),re=>re.id,(re,H)=>{var ne=es();let ue;var _e=l(ne),ze=l(_e),ut=l(ze,!0);n(ze);var He=d(ze,2),mt=l(He,!0);n(He),n(_e);var Pe=d(_e,2);{var gt=Y=>{var Z=Yt(),le=d(l(Z),2),Se=l(le,!0);n(le),n(Z),B(we=>A(Se,we),[()=>Je(a(H).args)]),c(Y,Z)};y(Pe,Y=>{a(H).args&&Y(gt)})}var ht=d(Pe,2);{var bt=Y=>{var Z=Zt(),le=d(l(Z),2),Se=l(le,!0);n(le),n(Z),B(we=>A(Se,we),[()=>Je(a(H).result)]),c(Y,Z)};y(ht,Y=>{a(H).result&&Y(bt)})}n(ne),B(()=>{ue=ee(ne,1,"tool-call svelte-12tm3zb",null,ue,{running:a(H).status==="running",completed:a(H).status==="completed"}),A(ut,a(H).name),A(mt,a(H).status)}),c(re,ne)}),n(ae),n($),B(()=>A(Q,`Tool Calls (${a(R).length??""})`)),c(x,$)};y(T,x=>{a(R).length>0&&x(W)})}var q=d(T,2);{var ct=x=>{var $=ss(),F=d(l($),2),Q=l(F),ae=l(Q);n(Q);var re=d(Q,2),H=l(re,!0);n(re),n(F),n($),B((ne,ue)=>{A(ae,`${ne??""} keys`),A(H,ue)},[()=>Object.keys(o.sharedState).length,()=>JSON.stringify(o.sharedState,null,2)]),c(x,$)};y(q,x=>{Object.keys(o.sharedState).length>0&&x(ct)})}n(h),n(i),B(()=>{L=ee(D,1,"status-badge svelte-12tm3zb",null,L,{running:o.isRunning,streaming:o.isStreaming}),A(j,`${o.status??""} `),A(I,o.messages.length)}),c(t,i)};y(lt,t=>{a(k)&&t(it)})}n(ve),Fe(ve,t=>C(v,t),()=>a(v));var Be=d(ve,2),je=l(Be),J=l(je);Mt(J),J.__input=t=>ke(t.currentTarget),J.__keydown=Ve,Fe(J,t=>C(r,t),()=>a(r));var ce=d(J,2);ce.__click=Ie;var ot=l(ce);{var dt=t=>{var i=rs();c(t,i)},vt=t=>{var i=ns();c(t,i)};y(ot,t=>{o.isRunning?t(dt):t(vt,!1)})}n(ce),n(je),Ce(2),n(Be),n(Ae),n(oe),B(t=>{Te=ee(oe,1,"assistant-page svelte-12tm3zb",null,Te,{"sidebar-open":a(b)}),Ee=ee(de,1,"sidebar svelte-12tm3zb",null,Ee,{open:a(b)}),xt(Le,"title",a(b)?"Hide sidebar":"Show sidebar"),$e=ee(Oe,1,"debug-toggle svelte-12tm3zb",null,$e,{active:a(k)}),J.disabled=o.isRunning,ce.disabled=t},[()=>!a(M).trim()||o.isRunning]),At(J,()=>a(M),t=>C(M,t)),c(e,oe),Ct()}pt(["click","keydown","input"]);export{ps as component};
