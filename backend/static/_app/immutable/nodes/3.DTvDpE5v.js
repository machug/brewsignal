import{g as Ve,h as xt,d as At,f as z,a as u,c as Lt,s as R,b as be,t as Rt}from"../chunks/NSBYmcxh.js";import{ar as B,x as We,M as qe,h as Nt,aF as Ot,T as Ye,U as Dt,a6 as Bt,aG as $t,aH as Ht,J as jt,K as me,p as rt,c as s,ai as oe,ah as Pt,aq as U,ao as Ut,ak as o,s as C,al as l,aj as Ft,e as Gt,am as Jt,an as r,as as ie,au as Kt,at as Xt}from"../chunks/DkBf6qYn.js";import{e as ge,i as Vt}from"../chunks/J4k8iyZ5.js";import{i as x}from"../chunks/S0lmOLxe.js";import{h as Wt}from"../chunks/Cdr2eubP.js";import{s as qt,b as Qe,r as Ze}from"../chunks/BSVWW4up.js";import{s as ee}from"../chunks/DiswNjmD.js";import{b as Yt}from"../chunks/B1-mw0d6.js";import{b as Qt}from"../chunks/BV-WNKgS.js";function et(e,n,y=!1,M=!1,_=!1){var S=e,g="";B(()=>{var I=Nt;if(g===(g=n()??"")){We&&qe();return}if(I.nodes_start!==null&&(Ot(I.nodes_start,I.nodes_end),I.nodes_start=I.nodes_end=null),g!==""){if(We){Ye.data;for(var b=qe(),T=b;b!==null&&(b.nodeType!==Dt||b.data!=="");)T=b,b=Bt(b);if(b===null)throw $t(),Ht;Ve(Ye,T),S=jt(b);return}var i=g+"";y?i=`<svg>${i}</svg>`:M&&(i=`<math>${i}</math>`);var a=xt(i);if((y||M)&&(a=me(a)),Ve(me(a),a.lastChild),y||M)for(;me(a);)S.before(me(a));else S.before(a)}})}function tt(e){if(!e.startsWith("data: "))return null;const n=e.slice(6).trim();if(n==="[DONE]")return null;try{return JSON.parse(n)}catch{return console.warn("Failed to parse SSE event:",n),null}}function Zt(){return`${Date.now()}-${Math.random().toString(36).slice(2,9)}`}function es(){const e=rt({status:"disconnected",error:null,threadId:null,runId:null,messages:[],streamingMessageId:null,streamingContent:"",toolCallsList:[],agentState:{},currentStep:null});function n(a){return e.toolCallsList.find(v=>v.id===a)}function y(a,v){const c=e.toolCallsList.findIndex(h=>h.id===a);c>=0&&(e.toolCallsList[c]={...e.toolCallsList[c],...v})}const M=oe(()=>e.streamingMessageId!==null),_=oe(()=>e.status==="connected"),S=oe(()=>e.status==="connecting"||s(M)),g=oe(()=>()=>{const a=[...e.messages];if(e.streamingMessageId&&e.streamingContent){const v=a.findIndex(c=>c.id===e.streamingMessageId);v>=0?a[v]={...a[v],content:e.streamingContent}:a.push({id:e.streamingMessageId,role:"assistant",content:e.streamingContent})}return a});function I(a){switch(a.type){case"RUN_STARTED":e.status="connected",e.threadId=a.threadId,e.runId=a.runId,e.error=null;break;case"RUN_FINISHED":if(e.status="connected",e.streamingMessageId&&e.streamingContent){const c=e.messages.findIndex(h=>h.id===e.streamingMessageId);c>=0?e.messages[c].content=e.streamingContent:e.messages.push({id:e.streamingMessageId,role:"assistant",content:e.streamingContent})}e.streamingMessageId=null,e.streamingContent="",e.currentStep=null;break;case"RUN_ERROR":e.status="error",e.error=a.message,e.streamingMessageId=null,e.streamingContent="";break;case"STEP_STARTED":e.currentStep=a.stepName;break;case"STEP_FINISHED":e.currentStep=null;break;case"TEXT_MESSAGE_START":e.streamingMessageId=a.messageId,e.streamingContent="";break;case"TEXT_MESSAGE_CONTENT":a.messageId===e.streamingMessageId&&(e.streamingContent+=a.delta);break;case"TEXT_MESSAGE_END":a.messageId===e.streamingMessageId&&(e.messages.push({id:e.streamingMessageId,role:"assistant",content:e.streamingContent}),e.streamingMessageId=null,e.streamingContent="");break;case"TEXT_MESSAGE_CHUNK":e.streamingMessageId||(e.streamingMessageId=a.messageId,e.streamingContent=""),e.streamingContent+=a.content;break;case"TOOL_CALL_START":e.toolCallsList=[...e.toolCallsList,{id:a.toolCallId,name:a.toolCallName||a.toolName||"unknown",args:"",status:"running"}];break;case"TOOL_CALL_ARGS":const v=n(a.toolCallId);v&&y(a.toolCallId,{args:v.args+a.delta});break;case"TOOL_CALL_END":y(a.toolCallId,{status:"completed"});break;case"TOOL_CALL_RESULT":case"TOOL_RESULT":y(a.toolCallId,{result:a.content||a.result,status:"completed"});break;case"STATE_SNAPSHOT":e.agentState=a.snapshot;break;case"STATE_DELTA":for(const c of a.delta){const h=c.path.split("/").filter(Boolean);if(c.op==="add"||c.op==="replace"){let O=e.agentState;for(let H=0;H<h.length-1;H++)h[H]in O||(O[h[H]]={}),O=O[h[H]];O[h[h.length-1]]=c.value}else if(c.op==="remove"){let O=e.agentState;for(let H=0;H<h.length-1;H++)O=O[h[H]];delete O[h[h.length-1]]}}break;case"MESSAGES_SNAPSHOT":e.messages=a.messages;break;case"CUSTOM":console.log("Custom event:",a.name,a.value);break}}function b(a){const v={id:Zt(),role:"user",content:a,createdAt:new Date().toISOString()};return e.messages.push(v),v}function T(){e.messages=[],e.streamingMessageId=null,e.streamingContent="",e.toolCallsList=[],e.agentState={},e.threadId=null,e.runId=null,e.error=null,e.currentStep=null}function i(){e.error=null,e.status==="error"&&(e.status="disconnected")}return{get status(){return e.status},get error(){return e.error},get threadId(){return e.threadId},get runId(){return e.runId},get messages(){return e.messages},get streamingMessageId(){return e.streamingMessageId},get streamingContent(){return e.streamingContent},get toolCalls(){return e.toolCallsList},get agentState(){return e.agentState},get currentStep(){return e.currentStep},get isStreaming(){return s(M)},get isConnected(){return s(_)},get isRunning(){return s(S)},get allMessages(){return s(g)()},handleEvent:I,addUserMessage:b,clear:T,clearError:i,_setStatus(a){e.status=a},_setError(a){e.error=a},_setThreadId(a){e.threadId=a},_addMessage(a){e.messages.push(a)}}}function ts(e){let n=null;async function y(_,S){M(),n=new AbortController,_._setStatus("connecting"),_._setError(null);try{const g=await fetch(e.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream",...e.headers},body:JSON.stringify(S),signal:n.signal});if(!g.ok){const i=await g.text();throw new Error(`HTTP ${g.status}: ${i}`)}if(!g.body)throw new Error("No response body");const I=g.body.getReader(),b=new TextDecoder;let T="";for(;;){const{done:i,value:a}=await I.read();if(i)break;T+=b.decode(a,{stream:!0});const v=T.split(`
`);T=v.pop()||"";for(const c of v){const h=tt(c);h&&_.handleEvent(h)}}if(T.trim()){const i=tt(T);i&&_.handleEvent(i)}}catch(g){g instanceof Error&&g.name==="AbortError"?_._setStatus("disconnected"):(_._setStatus("error"),_._setError(g instanceof Error?g.message:"Unknown error"))}finally{n=null}}function M(){n&&(n.abort(),n=null)}return{run:y,abort:M}}function ss(e){const n=es(),y=ts({url:e.url,headers:e.headers});let M=e.tools||[],_=e.initialState||{},S=e.threadId;async function g(v,c){n.addUserMessage(v);const O={threadId:c||S||n.threadId,messages:n.messages,tools:M.length>0?M:void 0,state:Object.keys(_).length>0?_:void 0};await y.run(n,O),n.threadId&&(S=n.threadId),n.error?e.onError?.(n.error):e.onComplete?.()}function I(v,c){n.clear(),S=c,n._setThreadId(c);for(const h of v)n._addMessage(h)}function b(){y.abort()}function T(){y.abort(),n.clear()}function i(v){_={..._,...v}}function a(v){M=v}return{get status(){return n.status},get error(){return n.error},get messages(){return n.allMessages},get isStreaming(){return n.isStreaming},get isRunning(){return n.isRunning},get threadId(){return n.threadId},get currentStep(){return n.currentStep},get toolCalls(){return n.toolCalls},get sharedState(){return _},get streamingContent(){return n.streamingContent},send:g,stop:b,clear:T,setState:i,setTools:a,loadMessages:I,_agentState:n,_client:y}}function st(e){try{const n=JSON.parse(e);return JSON.stringify(n,null,2)}catch{return e}}function at(e){if(!e)return"";let n=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return n=n.replace(/```(\w*)\n([\s\S]*?)```/g,'<pre><code class="language-$1">$2</code></pre>'),n=n.replace(/`([^`]+)`/g,"<code>$1</code>"),n=n.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>"),n=n.replace(/\*([^*]+)\*/g,"<em>$1</em>"),n=n.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener">$1</a>'),n=n.replace(/\n/g,"<br>"),n}var as=z('<button type="button" class="sidebar-backdrop svelte-12tm3zb" aria-label="Close sidebar"></button>'),rs=z('<div class="sidebar-loading svelte-12tm3zb">Loading...</div>'),ns=z('<div class="sidebar-empty svelte-12tm3zb">No conversations yet</div>'),ls=z('<div role="button" tabindex="0"><div class="thread-title svelte-12tm3zb"> </div> <div class="thread-meta svelte-12tm3zb"><span class="svelte-12tm3zb"> </span> <span class="svelte-12tm3zb"> </span></div> <button type="button" class="thread-delete svelte-12tm3zb" title="Delete conversation"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2" class="svelte-12tm3zb"></path></svg></button></div>'),is=z('<div class="thread-list svelte-12tm3zb"></div>'),os=z('<button type="button" class="prompt-chip svelte-12tm3zb"> </button>'),ds=z('<div class="empty-state svelte-12tm3zb"><div class="empty-icon svelte-12tm3zb"><svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="svelte-12tm3zb"><path d="M12 2L2 7l10 5 10-5-10-5z" class="svelte-12tm3zb"></path><path d="M2 17l10 5 10-5" class="svelte-12tm3zb"></path><path d="M2 12l10 5 10-5" class="svelte-12tm3zb"></path></svg></div> <h2 class="svelte-12tm3zb">Start a conversation</h2> <p class="empty-description svelte-12tm3zb">Ask about recipes, techniques, or ingredients</p> <div class="example-prompts svelte-12tm3zb"></div></div>'),vs=be('<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-12tm3zb"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z" class="svelte-12tm3zb"></path></svg>'),cs=be('<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-12tm3zb"><path d="M12 2L2 7l10 5 10-5-10-5z" class="svelte-12tm3zb"></path><path d="M2 17l10 5 10-5M2 12l10 5 10-5" stroke="currentColor" stroke-width="2" fill="none" class="svelte-12tm3zb"></path></svg>'),us=z('<div class="message-text streaming svelte-12tm3zb"><!> <span class="cursor svelte-12tm3zb"></span></div>'),ms=z('<div class="message-text svelte-12tm3zb"><!></div>'),gs=z('<div><div class="message-avatar svelte-12tm3zb"><!></div> <div class="message-content svelte-12tm3zb"><!></div></div>'),bs=z('<div class="message assistant svelte-12tm3zb"><div class="message-avatar svelte-12tm3zb"><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-12tm3zb"><path d="M12 2L2 7l10 5 10-5-10-5z" class="svelte-12tm3zb"></path><path d="M2 17l10 5 10-5M2 12l10 5 10-5" stroke="currentColor" stroke-width="2" fill="none" class="svelte-12tm3zb"></path></svg></div> <div class="message-content svelte-12tm3zb"><div class="typing-indicator svelte-12tm3zb"><span class="svelte-12tm3zb"></span><span class="svelte-12tm3zb"></span><span class="svelte-12tm3zb"></span></div></div></div>'),hs=z('<div class="messages svelte-12tm3zb"><!> <!></div>'),fs=z('<div class="error-banner svelte-12tm3zb"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="svelte-12tm3zb"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" class="svelte-12tm3zb"></path></svg> <span class="svelte-12tm3zb"> </span> <button type="button" class="svelte-12tm3zb">Dismiss</button></div>'),_s=z('<div class="debug-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb">Thread</div> <div class="debug-value mono svelte-12tm3zb"> </div></div>'),ps=z('<details class="tool-details svelte-12tm3zb"><summary class="svelte-12tm3zb">Arguments</summary> <pre class="tool-json svelte-12tm3zb"> </pre></details>'),zs=z('<details class="tool-details svelte-12tm3zb"><summary class="svelte-12tm3zb">Result</summary> <pre class="tool-json svelte-12tm3zb"> </pre></details>'),Ss=z('<div><div class="tool-call-header svelte-12tm3zb"><span class="tool-name svelte-12tm3zb"> </span> <span class="tool-status svelte-12tm3zb"> </span></div> <!> <!></div>'),ws=z('<div class="debug-section tool-calls-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb"> </div> <div class="tool-calls-list svelte-12tm3zb"></div></div>'),Cs=z('<div class="debug-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb">Shared State</div> <details class="tool-details svelte-12tm3zb"><summary class="svelte-12tm3zb"> </summary> <pre class="tool-json svelte-12tm3zb"> </pre></details></div>'),ys=z('<div class="debug-panel svelte-12tm3zb"><div class="debug-header svelte-12tm3zb"><h3 class="svelte-12tm3zb">Agent Debug</h3> <button type="button" class="debug-close svelte-12tm3zb">Ã—</button></div> <div class="debug-content svelte-12tm3zb"><div class="debug-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb">Status</div> <div class="debug-value svelte-12tm3zb"><span> <!></span></div></div> <!> <div class="debug-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb">Messages</div> <div class="debug-value svelte-12tm3zb"> </div></div> <!> <!></div></div>'),ks=be('<svg class="spinner svelte-12tm3zb" width="20" height="20" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none" stroke-dasharray="31.4" stroke-dashoffset="10" class="svelte-12tm3zb"></circle></svg>'),Ms=be('<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" class="svelte-12tm3zb"></path></svg>'),Is=z('<div><!> <aside><div class="sidebar-header svelte-12tm3zb"><h2 class="svelte-12tm3zb">History</h2> <button type="button" class="new-chat-btn svelte-12tm3zb" title="New conversation"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M12 5v14M5 12h14" class="svelte-12tm3zb"></path></svg></button></div> <div class="sidebar-content svelte-12tm3zb"><!></div></aside> <div class="main-content svelte-12tm3zb"><header class="page-header svelte-12tm3zb"><div class="header-left svelte-12tm3zb"><button type="button" class="sidebar-toggle svelte-12tm3zb"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M3 12h18M3 6h18M3 18h18" class="svelte-12tm3zb"></path></svg></button> <div class="header-content svelte-12tm3zb"><h1 class="svelte-12tm3zb">Brewing Assistant</h1> <p class="subtitle svelte-12tm3zb">AI-powered recipe creation and brewing advice</p></div></div> <div class="settings svelte-12tm3zb"><label class="setting svelte-12tm3zb"><span class="svelte-12tm3zb">Batch Size</span> <input type="number" min="1" max="100" class="svelte-12tm3zb"/> L</label> <label class="setting svelte-12tm3zb"><span class="svelte-12tm3zb">Efficiency</span> <input type="number" min="50" max="100" class="svelte-12tm3zb"/> %</label> <button type="button" title="Toggle agent debug panel"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M12 20h9M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z" class="svelte-12tm3zb"></path></svg></button></div></header> <main class="chat-container svelte-12tm3zb"><!> <!> <!></main> <footer class="input-area svelte-12tm3zb"><div class="input-wrapper svelte-12tm3zb"><textarea placeholder="Ask about brewing..." rows="1" class="svelte-12tm3zb"></textarea> <button type="button" class="send-button svelte-12tm3zb"><!></button></div> <div class="input-hint svelte-12tm3zb">Press Enter to send, Shift+Enter for new line</div></footer></div></div>');function Bs(e,n){Pt(n,!0);let y=U(19),M=U(72),_=U(!1),S=U(!1),g=U(!1),I=U(rt([])),b=U(null),T=U(!1);const i=ss({url:"/api/ag-ui/run",initialState:{batchSize:s(y),efficiency:s(M)},onStateChange:t=>{t.recipe&&console.log("Recipe extracted:",t.recipe)},onError:t=>{console.error("Agent error:",t)}});let a=oe(()=>i.toolCalls),v=U(""),c=U(null);async function h(){C(T,!0);try{const t=await fetch("/api/ag-ui/threads?limit=50");t.ok&&C(I,await t.json(),!0)}catch(t){console.error("Failed to fetch threads:",t)}finally{C(T,!1)}}async function O(t){try{const d=await fetch(`/api/ag-ui/threads/${t}`);if(d.ok){const w=await d.json();C(b,t,!0);const A=w.messages.filter(f=>f.role==="user"||f.role==="assistant").map(f=>({id:String(f.id),role:f.role,content:f.content,createdAt:f.created_at}));i.loadMessages(A,t)}}catch(d){console.error("Failed to load thread:",d)}}async function H(t){if(confirm("Delete this conversation?"))try{(await fetch(`/api/ag-ui/threads/${t}`,{method:"DELETE"})).ok&&(C(I,s(I).filter(w=>w.id!==t),!0),s(b)===t&&Ee())}catch(d){console.error("Failed to delete thread:",d)}}function Ee(){C(b,null),i.clear(),s(c)?.focus()}function nt(t){C(y,t,!0),i.setState({batchSize:t})}function lt(t){C(M,t,!0),i.setState({efficiency:t})}function xe(t){t.style.height="auto",t.style.height=Math.min(t.scrollHeight,200)+"px"}async function Ae(){const t=s(v).trim();!t||i.isRunning||(C(v,""),s(c)&&(s(c).style.height="auto"),await i.send(t,s(b)||void 0),!s(b)&&i.threadId&&(C(b,i.threadId,!0),h()))}function it(t){t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),Ae())}const ot=["Help me create an American IPA recipe","What temperature should I ferment a Belgian Tripel?","Create a simple wheat beer recipe for summer","Explain the difference between ale and lager yeast"];function dt(t){C(v,t,!0),s(c)&&(s(c).focus(),xe(s(c)))}function vt(t){const d=new Date(t),A=new Date().getTime()-d.getTime(),f=Math.floor(A/6e4),m=Math.floor(A/36e5),p=Math.floor(A/864e5);return f<1?"just now":f<60?`${f}m ago`:m<24?`${m}h ago`:p<7?`${p}d ago`:d.toLocaleDateString()}function he(){C(g,window.innerWidth<768)}Ut(()=>(s(c)?.focus(),h(),he(),window.addEventListener("resize",he),()=>window.removeEventListener("resize",he)));function Le(t){O(t),s(g)&&C(S,!1)}var de=Is();Wt("12tm3zb",t=>{Gt(()=>{Jt.title="AI Assistant | BrewSignal"})});let Re;var Ne=l(de);{var ct=t=>{var d=as();d.__click=()=>C(S,!1),u(t,d)};x(Ne,t=>{s(S)&&s(g)&&t(ct)})}var ve=o(Ne,2);let Oe;var fe=l(ve),ut=o(l(fe),2);ut.__click=Ee,r(fe);var De=o(fe,2),mt=l(De);{var gt=t=>{var d=rs();u(t,d)},bt=t=>{var d=Lt(),w=Xt(d);{var A=m=>{var p=ns();u(m,p)},f=m=>{var p=is();ge(p,21,()=>s(I),$=>$.id,($,N)=>{var j=ls();let te;j.__click=()=>Le(s(N).id),j.__keydown=q=>q.key==="Enter"&&Le(s(N).id);var K=l(j),X=l(K,!0);r(K);var V=o(K,2),F=l(V),se=l(F);r(F);var k=o(F,2),E=l(k,!0);r(k),r(V);var W=o(V,2);W.__click=q=>{q.stopPropagation(),H(s(N).id)},r(j),B(q=>{te=ee(j,1,"thread-item svelte-12tm3zb",null,te,{active:s(b)===s(N).id}),R(X,s(N).title||"Untitled"),R(se,`${s(N).message_count??""} msgs`),R(E,q)},[()=>vt(s(N).updated_at)]),u($,j)}),r(p),u(m,p)};x(w,m=>{s(I).length===0?m(A):m(f,!1)},!0)}u(t,d)};x(mt,t=>{s(T)?t(gt):t(bt,!1)})}r(De),r(ve);var Be=o(ve,2),_e=l(Be),pe=l(_e),$e=l(pe);$e.__click=()=>C(S,!s(S)),ie(2),r(pe);var He=o(pe,2),ze=l(He),Se=o(l(ze),2);Ze(Se),Se.__change=t=>nt(Number(t.currentTarget.value)),ie(),r(ze);var we=o(ze,2),Ce=o(l(we),2);Ze(Ce),Ce.__change=t=>lt(Number(t.currentTarget.value)),ie(),r(we);var je=o(we,2);let Pe;je.__click=()=>C(_,!s(_)),r(He),r(_e);var ye=o(_e,2),Ue=l(ye);{var ht=t=>{var d=ds(),w=o(l(d),6);ge(w,21,()=>ot,Vt,(A,f)=>{var m=os();m.__click=()=>dt(s(f));var p=l(m,!0);r(m),B(()=>R(p,s(f))),u(A,m)}),r(w),r(d),u(t,d)},ft=t=>{var d=hs(),w=l(d);ge(w,17,()=>i.messages,m=>m.id,(m,p)=>{var $=gs(),N=l($),j=l(N);{var te=k=>{var E=vs();u(k,E)},K=k=>{var E=cs();u(k,E)};x(j,k=>{s(p).role==="user"?k(te):k(K,!1)})}r(N);var X=o(N,2),V=l(X);{var F=k=>{var E=us(),W=l(E);et(W,()=>at(i.streamingContent||"")),ie(2),r(E),u(k,E)},se=k=>{var E=ms(),W=l(E);et(W,()=>at(s(p).content)),r(E),u(k,E)};x(V,k=>{s(p).role==="assistant"&&i.isStreaming&&s(p).id===i._agentState.streamingMessageId?k(F):k(se,!1)})}r(X),r($),B(()=>ee($,1,`message ${s(p).role??""}`,"svelte-12tm3zb")),u(m,$)});var A=o(w,2);{var f=m=>{var p=bs();u(m,p)};x(A,m=>{i.isRunning&&!i.isStreaming&&m(f)})}r(d),u(t,d)};x(Ue,t=>{i.messages.length===0?t(ht):t(ft,!1)})}var Fe=o(Ue,2);{var _t=t=>{var d=fs(),w=o(l(d),2),A=l(w,!0);r(w);var f=o(w,2);f.__click=()=>i._agentState.clearError(),r(d),B(()=>R(A,i.error)),u(t,d)};x(Fe,t=>{i.error&&t(_t)})}var pt=o(Fe,2);{var zt=t=>{var d=ys(),w=l(d),A=o(l(w),2);A.__click=()=>C(_,!1),r(w);var f=o(w,2),m=l(f),p=o(l(m),2),$=l(p);let N;var j=l($),te=o(j);{var K=L=>{var D=Rt("(streaming)");u(L,D)};x(te,L=>{i.isStreaming&&L(K)})}r($),r(p),r(m);var X=o(m,2);{var V=L=>{var D=_s(),G=o(l(D),2),Y=l(G);r(G),r(D),B(ae=>R(Y,`${ae??""}...`),[()=>i.threadId.slice(0,8)]),u(L,D)};x(X,L=>{i.threadId&&L(V)})}var F=o(X,2),se=o(l(F),2),k=l(se,!0);r(se),r(F);var E=o(F,2);{var W=L=>{var D=ws(),G=l(D),Y=l(G);r(G);var ae=o(G,2);ge(ae,21,()=>s(a),re=>re.id,(re,P)=>{var ne=Ss();let ue;var ke=l(ne),Me=l(ke),kt=l(Me,!0);r(Me);var Ke=o(Me,2),Mt=l(Ke,!0);r(Ke),r(ke);var Xe=o(ke,2);{var It=Q=>{var Z=ps(),le=o(l(Z),2),Ie=l(le,!0);r(le),r(Z),B(Te=>R(Ie,Te),[()=>st(s(P).args)]),u(Q,Z)};x(Xe,Q=>{s(P).args&&Q(It)})}var Tt=o(Xe,2);{var Et=Q=>{var Z=zs(),le=o(l(Z),2),Ie=l(le,!0);r(le),r(Z),B(Te=>R(Ie,Te),[()=>st(s(P).result)]),u(Q,Z)};x(Tt,Q=>{s(P).result&&Q(Et)})}r(ne),B(()=>{ue=ee(ne,1,"tool-call svelte-12tm3zb",null,ue,{running:s(P).status==="running",completed:s(P).status==="completed"}),R(kt,s(P).name),R(Mt,s(P).status)}),u(re,ne)}),r(ae),r(D),B(()=>R(Y,`Tool Calls (${s(a).length??""})`)),u(L,D)};x(E,L=>{s(a).length>0&&L(W)})}var q=o(E,2);{var yt=L=>{var D=Cs(),G=o(l(D),2),Y=l(G),ae=l(Y);r(Y);var re=o(Y,2),P=l(re,!0);r(re),r(G),r(D),B((ne,ue)=>{R(ae,`${ne??""} keys`),R(P,ue)},[()=>Object.keys(i.sharedState).length,()=>JSON.stringify(i.sharedState,null,2)]),u(L,D)};x(q,L=>{Object.keys(i.sharedState).length>0&&L(yt)})}r(f),r(d),B(()=>{N=ee($,1,"status-badge svelte-12tm3zb",null,N,{running:i.isRunning,streaming:i.isStreaming}),R(j,`${i.status??""} `),R(k,i.messages.length)}),u(t,d)};x(pt,t=>{s(_)&&t(zt)})}r(ye);var Ge=o(ye,2),Je=l(Ge),J=l(Je);Kt(J),J.__input=t=>xe(t.currentTarget),J.__keydown=it,Qt(J,t=>C(c,t),()=>s(c));var ce=o(J,2);ce.__click=Ae;var St=l(ce);{var wt=t=>{var d=ks();u(t,d)},Ct=t=>{var d=Ms();u(t,d)};x(St,t=>{i.isRunning?t(wt):t(Ct,!1)})}r(ce),r(Je),ie(2),r(Ge),r(Be),r(de),B(t=>{Re=ee(de,1,"assistant-page svelte-12tm3zb",null,Re,{"sidebar-open":s(S)}),Oe=ee(ve,1,"sidebar svelte-12tm3zb",null,Oe,{open:s(S)}),qt($e,"title",s(S)?"Hide sidebar":"Show sidebar"),Qe(Se,s(y)),Qe(Ce,s(M)),Pe=ee(je,1,"debug-toggle svelte-12tm3zb",null,Pe,{active:s(_)}),J.disabled=i.isRunning,ce.disabled=t},[()=>!s(v).trim()||i.isRunning]),Yt(J,()=>s(v),t=>C(v,t)),u(e,de),Ft()}At(["click","keydown","change","input"]);export{Bs as component};
