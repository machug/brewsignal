import{g as Ve,h as Lt,d as Rt,f as w,a as u,c as Nt,s as R,b as he,t as Ot}from"../chunks/DZ15WIaR.js";import{t as D,M as We,_ as qe,z as $t,aF as Dt,a3 as Ye,a4 as Bt,ai as jt,aG as Ht,aH as Pt,Y as Ut,Z as ge,p as nt,i as a,l as oe,a as Ft,s as P,au as Gt,o as Jt,g as o,c as k,d as l,h as Xt,e as Kt,at as Vt,j as n,n as ie,k as Wt,f as qt}from"../chunks/CdgKpHHH.js";import{e as be,i as Yt}from"../chunks/Xm3Ul2fO.js";import{i as x}from"../chunks/CiVu40Aa.js";import{h as Zt}from"../chunks/DwuO6wC8.js";import{s as Qt,b as Ze,r as Qe}from"../chunks/C7rhiFvF.js";import{s as ee}from"../chunks/CXy9Ft3Z.js";import{b as es}from"../chunks/DaMP4aMW.js";import{b as et}from"../chunks/DrVXGiO5.js";function tt(e,s,C=!1,z=!1,b=!1){var h=e,f="";D(()=>{var I=$t;if(f===(f=s()??"")){We&&qe();return}if(I.nodes_start!==null&&(Dt(I.nodes_start,I.nodes_end),I.nodes_start=I.nodes_end=null),f!==""){if(We){Ye.data;for(var p=qe(),T=p;p!==null&&(p.nodeType!==Bt||p.data!=="");)T=p,p=jt(p);if(p===null)throw Ht(),Pt;Ve(Ye,T),h=Ut(p);return}var i=f+"";C?i=`<svg>${i}</svg>`:z&&(i=`<math>${i}</math>`);var r=Lt(i);if((C||z)&&(r=ge(r)),Ve(ge(r),r.lastChild),C||z)for(;ge(r);)h.before(ge(r));else h.before(r)}})}function st(e){if(!e.startsWith("data: "))return null;const s=e.slice(6).trim();if(s==="[DONE]")return null;try{return JSON.parse(s)}catch{return console.warn("Failed to parse SSE event:",s),null}}function ts(){return`${Date.now()}-${Math.random().toString(36).slice(2,9)}`}function ss(){const e=nt({status:"disconnected",error:null,threadId:null,runId:null,messages:[],streamingMessageId:null,streamingContent:"",toolCallsList:[],agentState:{},currentStep:null});function s(r){return e.toolCallsList.find(c=>c.id===r)}function C(r,c){const v=e.toolCallsList.findIndex(m=>m.id===r);v>=0&&(e.toolCallsList[v]={...e.toolCallsList[v],...c})}const z=oe(()=>e.streamingMessageId!==null),b=oe(()=>e.status==="connected"),h=oe(()=>e.status==="connecting"||a(z)),f=oe(()=>()=>{const r=[...e.messages];if(e.streamingMessageId&&e.streamingContent){const c=r.findIndex(v=>v.id===e.streamingMessageId);c>=0?r[c]={...r[c],content:e.streamingContent}:r.push({id:e.streamingMessageId,role:"assistant",content:e.streamingContent})}return r});function I(r){switch(r.type){case"RUN_STARTED":e.status="connected",e.threadId=r.threadId,e.runId=r.runId,e.error=null;break;case"RUN_FINISHED":if(e.status="connected",e.streamingMessageId&&e.streamingContent){const v=e.messages.findIndex(m=>m.id===e.streamingMessageId);v>=0?e.messages[v].content=e.streamingContent:e.messages.push({id:e.streamingMessageId,role:"assistant",content:e.streamingContent})}e.streamingMessageId=null,e.streamingContent="",e.currentStep=null;break;case"RUN_ERROR":e.status="error",e.error=r.message,e.streamingMessageId=null,e.streamingContent="";break;case"STEP_STARTED":e.currentStep=r.stepName;break;case"STEP_FINISHED":e.currentStep=null;break;case"TEXT_MESSAGE_START":e.streamingMessageId=r.messageId,e.streamingContent="";break;case"TEXT_MESSAGE_CONTENT":r.messageId===e.streamingMessageId&&(e.streamingContent+=r.delta);break;case"TEXT_MESSAGE_END":r.messageId===e.streamingMessageId&&(e.messages.push({id:e.streamingMessageId,role:"assistant",content:e.streamingContent}),e.streamingMessageId=null,e.streamingContent="");break;case"TEXT_MESSAGE_CHUNK":e.streamingMessageId||(e.streamingMessageId=r.messageId,e.streamingContent=""),e.streamingContent+=r.content;break;case"TOOL_CALL_START":e.toolCallsList=[...e.toolCallsList,{id:r.toolCallId,name:r.toolCallName||r.toolName||"unknown",args:"",status:"running"}];break;case"TOOL_CALL_ARGS":const c=s(r.toolCallId);c&&C(r.toolCallId,{args:c.args+r.delta});break;case"TOOL_CALL_END":C(r.toolCallId,{status:"completed"});break;case"TOOL_CALL_RESULT":case"TOOL_RESULT":C(r.toolCallId,{result:r.content||r.result,status:"completed"});break;case"STATE_SNAPSHOT":e.agentState=r.snapshot;break;case"STATE_DELTA":for(const v of r.delta){const m=v.path.split("/").filter(Boolean);if(v.op==="add"||v.op==="replace"){let N=e.agentState;for(let j=0;j<m.length-1;j++)m[j]in N||(N[m[j]]={}),N=N[m[j]];N[m[m.length-1]]=v.value}else if(v.op==="remove"){let N=e.agentState;for(let j=0;j<m.length-1;j++)N=N[m[j]];delete N[m[m.length-1]]}}break;case"MESSAGES_SNAPSHOT":e.messages=r.messages;break;case"CUSTOM":console.log("Custom event:",r.name,r.value);break}}function p(r){const c={id:ts(),role:"user",content:r,createdAt:new Date().toISOString()};return e.messages.push(c),c}function T(){e.messages=[],e.streamingMessageId=null,e.streamingContent="",e.toolCallsList=[],e.agentState={},e.threadId=null,e.runId=null,e.error=null,e.currentStep=null}function i(){e.error=null,e.status==="error"&&(e.status="disconnected")}return{get status(){return e.status},get error(){return e.error},get threadId(){return e.threadId},get runId(){return e.runId},get messages(){return e.messages},get streamingMessageId(){return e.streamingMessageId},get streamingContent(){return e.streamingContent},get toolCalls(){return e.toolCallsList},get agentState(){return e.agentState},get currentStep(){return e.currentStep},get isStreaming(){return a(z)},get isConnected(){return a(b)},get isRunning(){return a(h)},get allMessages(){return a(f)()},handleEvent:I,addUserMessage:p,clear:T,clearError:i,_setStatus(r){e.status=r},_setError(r){e.error=r},_setThreadId(r){e.threadId=r},_addMessage(r){e.messages.push(r)}}}function as(e){let s=null;async function C(b,h){z(),s=new AbortController,b._setStatus("connecting"),b._setError(null);try{const f=await fetch(e.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream",...e.headers},body:JSON.stringify(h),signal:s.signal});if(!f.ok){const i=await f.text();throw new Error(`HTTP ${f.status}: ${i}`)}if(!f.body)throw new Error("No response body");const I=f.body.getReader(),p=new TextDecoder;let T="";for(;;){const{done:i,value:r}=await I.read();if(i)break;T+=p.decode(r,{stream:!0});const c=T.split(`
`);T=c.pop()||"";for(const v of c){const m=st(v);m&&b.handleEvent(m)}}if(T.trim()){const i=st(T);i&&b.handleEvent(i)}}catch(f){f instanceof Error&&f.name==="AbortError"?b._setStatus("disconnected"):(b._setStatus("error"),b._setError(f instanceof Error?f.message:"Unknown error"))}finally{s=null}}function z(){s&&(s.abort(),s=null)}return{run:C,abort:z}}function rs(e){const s=ss(),C=as({url:e.url,headers:e.headers});let z=e.tools||[],b=e.initialState||{},h=e.threadId;async function f(c,v){s.addUserMessage(c);const N={threadId:v||h||s.threadId,messages:s.messages,tools:z.length>0?z:void 0,state:Object.keys(b).length>0?b:void 0};await C.run(s,N),s.threadId&&(h=s.threadId),s.error?e.onError?.(s.error):e.onComplete?.()}function I(c,v){s.clear(),h=v,s._setThreadId(v);for(const m of c)s._addMessage(m)}function p(){C.abort()}function T(){C.abort(),s.clear()}function i(c){b={...b,...c}}function r(c){z=c}return{get status(){return s.status},get error(){return s.error},get messages(){return s.allMessages},get isStreaming(){return s.isStreaming},get isRunning(){return s.isRunning},get threadId(){return s.threadId},get currentStep(){return s.currentStep},get toolCalls(){return s.toolCalls},get sharedState(){return b},get streamingContent(){return s.streamingContent},send:f,stop:p,clear:T,setState:i,setTools:r,loadMessages:I,_agentState:s,_client:C}}function at(e){try{const s=JSON.parse(e);return JSON.stringify(s,null,2)}catch{return e}}function rt(e){if(!e)return"";let s=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return s=s.replace(/```(\w*)\n([\s\S]*?)```/g,'<pre><code class="language-$1">$2</code></pre>'),s=s.replace(/`([^`]+)`/g,"<code>$1</code>"),s=s.replace(/^### (.+)$/gm,"<h4>$1</h4>"),s=s.replace(/^## (.+)$/gm,"<h3>$1</h3>"),s=s.replace(/^# (.+)$/gm,"<h2>$1</h2>"),s=s.replace(/^---+$/gm,"<hr>"),s=s.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>"),s=s.replace(/\*([^*]+)\*/g,"<em>$1</em>"),s=s.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener">$1</a>'),s=s.replace(/(?:^|\n)((?:- .+\n?)+)/g,(C,z)=>`
<ul>`+z.trim().split(`
`).map(h=>h.replace(/^- (.+)$/,"<li>$1</li>")).join("")+`</ul>
`),s=s.replace(/(?:^|\n)((?:\d+\. .+\n?)+)/g,(C,z)=>`
<ol>`+z.trim().split(`
`).map(h=>h.replace(/^\d+\. (.+)$/,"<li>$1</li>")).join("")+`</ol>
`),s=s.replace(/\n(?!<\/?(ul|ol|li|pre|h[1-6]|hr))/g,"<br>"),s=s.replace(/<br><(ul|ol|pre|h[1-6]|hr)/g,"<$1"),s=s.replace(/<\/(ul|ol|pre|h[1-6])><br>/g,"</$1>"),s}var ns=w('<button type="button" class="sidebar-backdrop svelte-12tm3zb" aria-label="Close sidebar"></button>'),ls=w('<div class="sidebar-loading svelte-12tm3zb">Loading...</div>'),is=w('<div class="sidebar-empty svelte-12tm3zb">No conversations yet</div>'),os=w('<div role="button" tabindex="0"><div class="thread-title svelte-12tm3zb"> </div> <div class="thread-meta svelte-12tm3zb"><span class="svelte-12tm3zb"> </span> <span class="svelte-12tm3zb"> </span></div> <button type="button" class="thread-delete svelte-12tm3zb" title="Delete conversation"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2" class="svelte-12tm3zb"></path></svg></button></div>'),ds=w('<div class="thread-list svelte-12tm3zb"></div>'),cs=w('<button type="button" class="prompt-chip svelte-12tm3zb"> </button>'),vs=w('<div class="empty-state svelte-12tm3zb"><div class="empty-icon svelte-12tm3zb"><svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="svelte-12tm3zb"><path d="M12 2L2 7l10 5 10-5-10-5z" class="svelte-12tm3zb"></path><path d="M2 17l10 5 10-5" class="svelte-12tm3zb"></path><path d="M2 12l10 5 10-5" class="svelte-12tm3zb"></path></svg></div> <h2 class="svelte-12tm3zb">Start a conversation</h2> <p class="empty-description svelte-12tm3zb">Ask about recipes, techniques, or ingredients</p> <div class="example-prompts svelte-12tm3zb"></div></div>'),us=he('<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-12tm3zb"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z" class="svelte-12tm3zb"></path></svg>'),ms=he('<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-12tm3zb"><path d="M12 2L2 7l10 5 10-5-10-5z" class="svelte-12tm3zb"></path><path d="M2 17l10 5 10-5M2 12l10 5 10-5" stroke="currentColor" stroke-width="2" fill="none" class="svelte-12tm3zb"></path></svg>'),gs=w('<div class="message-text streaming svelte-12tm3zb"><!> <span class="cursor svelte-12tm3zb"></span></div>'),bs=w('<div class="message-text svelte-12tm3zb"><!></div>'),hs=w('<div><div class="message-avatar svelte-12tm3zb"><!></div> <div class="message-content svelte-12tm3zb"><!></div></div>'),fs=w('<div class="message assistant svelte-12tm3zb"><div class="message-avatar svelte-12tm3zb"><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-12tm3zb"><path d="M12 2L2 7l10 5 10-5-10-5z" class="svelte-12tm3zb"></path><path d="M2 17l10 5 10-5M2 12l10 5 10-5" stroke="currentColor" stroke-width="2" fill="none" class="svelte-12tm3zb"></path></svg></div> <div class="message-content svelte-12tm3zb"><div class="typing-indicator svelte-12tm3zb"><span class="svelte-12tm3zb"></span><span class="svelte-12tm3zb"></span><span class="svelte-12tm3zb"></span></div></div></div>'),ps=w('<div class="messages svelte-12tm3zb"><!> <!></div>'),_s=w('<div class="error-banner svelte-12tm3zb"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="svelte-12tm3zb"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" class="svelte-12tm3zb"></path></svg> <span class="svelte-12tm3zb"> </span> <button type="button" class="svelte-12tm3zb">Dismiss</button></div>'),zs=w('<div class="debug-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb">Thread</div> <div class="debug-value mono svelte-12tm3zb"> </div></div>'),Ss=w('<details class="tool-details svelte-12tm3zb"><summary class="svelte-12tm3zb">Arguments</summary> <pre class="tool-json svelte-12tm3zb"> </pre></details>'),ws=w('<details class="tool-details svelte-12tm3zb"><summary class="svelte-12tm3zb">Result</summary> <pre class="tool-json svelte-12tm3zb"> </pre></details>'),Cs=w('<div><div class="tool-call-header svelte-12tm3zb"><span class="tool-name svelte-12tm3zb"> </span> <span class="tool-status svelte-12tm3zb"> </span></div> <!> <!></div>'),ys=w('<div class="debug-section tool-calls-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb"> </div> <div class="tool-calls-list svelte-12tm3zb"></div></div>'),ks=w('<div class="debug-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb">Shared State</div> <details class="tool-details svelte-12tm3zb"><summary class="svelte-12tm3zb"> </summary> <pre class="tool-json svelte-12tm3zb"> </pre></details></div>'),Ms=w('<div class="debug-panel svelte-12tm3zb"><div class="debug-header svelte-12tm3zb"><h3 class="svelte-12tm3zb">Agent Debug</h3> <button type="button" class="debug-close svelte-12tm3zb">Ã—</button></div> <div class="debug-content svelte-12tm3zb"><div class="debug-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb">Status</div> <div class="debug-value svelte-12tm3zb"><span> <!></span></div></div> <!> <div class="debug-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb">Messages</div> <div class="debug-value svelte-12tm3zb"> </div></div> <!> <!></div></div>'),Is=he('<svg class="spinner svelte-12tm3zb" width="20" height="20" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none" stroke-dasharray="31.4" stroke-dashoffset="10" class="svelte-12tm3zb"></circle></svg>'),Ts=he('<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" class="svelte-12tm3zb"></path></svg>'),Es=w('<div><!> <aside><div class="sidebar-header svelte-12tm3zb"><h2 class="svelte-12tm3zb">History</h2> <button type="button" class="new-chat-btn svelte-12tm3zb" title="New conversation"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M12 5v14M5 12h14" class="svelte-12tm3zb"></path></svg></button></div> <div class="sidebar-content svelte-12tm3zb"><!></div></aside> <div class="main-content svelte-12tm3zb"><header class="page-header svelte-12tm3zb"><div class="header-left svelte-12tm3zb"><button type="button" class="sidebar-toggle svelte-12tm3zb"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M3 12h18M3 6h18M3 18h18" class="svelte-12tm3zb"></path></svg></button> <div class="header-content svelte-12tm3zb"><h1 class="svelte-12tm3zb">Brewing Assistant</h1> <p class="subtitle svelte-12tm3zb">AI-powered recipe creation and brewing advice</p></div></div> <div class="settings svelte-12tm3zb"><label class="setting svelte-12tm3zb"><span class="svelte-12tm3zb">Batch Size</span> <input type="number" min="1" max="100" class="svelte-12tm3zb"/> L</label> <label class="setting svelte-12tm3zb"><span class="svelte-12tm3zb">Efficiency</span> <input type="number" min="50" max="100" class="svelte-12tm3zb"/> %</label> <button type="button" title="Toggle agent debug panel"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M12 20h9M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z" class="svelte-12tm3zb"></path></svg></button></div></header> <main class="chat-container svelte-12tm3zb"><!> <!> <!></main> <footer class="input-area svelte-12tm3zb"><div class="input-wrapper svelte-12tm3zb"><textarea placeholder="Ask about brewing..." rows="1" class="svelte-12tm3zb"></textarea> <button type="button" class="send-button svelte-12tm3zb"><!></button></div> <div class="input-hint svelte-12tm3zb">Press Enter to send, Shift+Enter for new line</div></footer></div></div>');function js(e,s){Ft(s,!0);let C=P(19),z=P(72),b=P(!1),h=P(!1),f=P(!1),I=P(nt([])),p=P(null),T=P(!1);const i=rs({url:"/api/ag-ui/run",initialState:{batchSize:a(C),efficiency:a(z)},onStateChange:t=>{t.recipe&&console.log("Recipe extracted:",t.recipe)},onError:t=>{console.error("Agent error:",t)}});let r=oe(()=>i.toolCalls),c=P(""),v=P(null),m=P(null);Gt(()=>{i.messages.length,i.streamingContent,a(m)&&requestAnimationFrame(()=>{a(m)?.scrollTo({top:a(m).scrollHeight,behavior:"smooth"})})});async function N(){k(T,!0);try{const t=await fetch("/api/ag-ui/threads?limit=50");t.ok&&k(I,await t.json(),!0)}catch(t){console.error("Failed to fetch threads:",t)}finally{k(T,!1)}}async function j(t){try{const d=await fetch(`/api/ag-ui/threads/${t}`);if(d.ok){const y=await d.json();k(p,t,!0);const A=y.messages.filter(_=>_.role==="user"||_.role==="assistant").map(_=>({id:String(_.id),role:_.role,content:_.content,createdAt:_.created_at}));i.loadMessages(A,t)}}catch(d){console.error("Failed to load thread:",d)}}async function lt(t){if(confirm("Delete this conversation?"))try{(await fetch(`/api/ag-ui/threads/${t}`,{method:"DELETE"})).ok&&(k(I,a(I).filter(y=>y.id!==t),!0),a(p)===t&&Ee())}catch(d){console.error("Failed to delete thread:",d)}}function Ee(){k(p,null),i.clear(),a(v)?.focus()}function it(t){k(C,t,!0),i.setState({batchSize:t})}function ot(t){k(z,t,!0),i.setState({efficiency:t})}function xe(t){t.style.height="auto",t.style.height=Math.min(t.scrollHeight,200)+"px"}async function Ae(){const t=a(c).trim();!t||i.isRunning||(k(c,""),a(v)&&(a(v).style.height="auto"),await i.send(t,a(p)||void 0),!a(p)&&i.threadId&&(k(p,i.threadId,!0),N()))}function dt(t){t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),Ae())}const ct=["Help me create an American IPA recipe","What temperature should I ferment a Belgian Tripel?","Create a simple wheat beer recipe for summer","Explain the difference between ale and lager yeast"];function vt(t){k(c,t,!0),a(v)&&(a(v).focus(),xe(a(v)))}function ut(t){const d=new Date(t),A=new Date().getTime()-d.getTime(),_=Math.floor(A/6e4),g=Math.floor(A/36e5),S=Math.floor(A/864e5);return _<1?"just now":_<60?`${_}m ago`:g<24?`${g}h ago`:S<7?`${S}d ago`:d.toLocaleDateString()}function fe(){k(f,window.innerWidth<768)}Jt(()=>(a(v)?.focus(),N(),fe(),window.addEventListener("resize",fe),()=>window.removeEventListener("resize",fe)));function Le(t){j(t),a(f)&&k(h,!1)}var de=Es();Zt("12tm3zb",t=>{Kt(()=>{Vt.title="AI Assistant | BrewSignal"})});let Re;var Ne=l(de);{var mt=t=>{var d=ns();d.__click=()=>k(h,!1),u(t,d)};x(Ne,t=>{a(h)&&a(f)&&t(mt)})}var ce=o(Ne,2);let Oe;var pe=l(ce),gt=o(l(pe),2);gt.__click=Ee,n(pe);var $e=o(pe,2),bt=l($e);{var ht=t=>{var d=ls();u(t,d)},ft=t=>{var d=Nt(),y=qt(d);{var A=g=>{var S=is();u(g,S)},_=g=>{var S=ds();be(S,21,()=>a(I),B=>B.id,(B,O)=>{var H=os();let te;H.__click=()=>Le(a(O).id),H.__keydown=q=>q.key==="Enter"&&Le(a(O).id);var X=l(H),K=l(X,!0);n(X);var V=o(X,2),F=l(V),se=l(F);n(F);var M=o(F,2),E=l(M,!0);n(M),n(V);var W=o(V,2);W.__click=q=>{q.stopPropagation(),lt(a(O).id)},n(H),D(q=>{te=ee(H,1,"thread-item svelte-12tm3zb",null,te,{active:a(p)===a(O).id}),R(K,a(O).title||"Untitled"),R(se,`${a(O).message_count??""} msgs`),R(E,q)},[()=>ut(a(O).updated_at)]),u(B,H)}),n(S),u(g,S)};x(y,g=>{a(I).length===0?g(A):g(_,!1)},!0)}u(t,d)};x(bt,t=>{a(T)?t(ht):t(ft,!1)})}n($e),n(ce);var De=o(ce,2),_e=l(De),ze=l(_e),Be=l(ze);Be.__click=()=>k(h,!a(h)),ie(2),n(ze);var je=o(ze,2),Se=l(je),we=o(l(Se),2);Qe(we),we.__change=t=>it(Number(t.currentTarget.value)),ie(),n(Se);var Ce=o(Se,2),ye=o(l(Ce),2);Qe(ye),ye.__change=t=>ot(Number(t.currentTarget.value)),ie(),n(Ce);var He=o(Ce,2);let Pe;He.__click=()=>k(b,!a(b)),n(je),n(_e);var ve=o(_e,2),Ue=l(ve);{var pt=t=>{var d=vs(),y=o(l(d),6);be(y,21,()=>ct,Yt,(A,_)=>{var g=cs();g.__click=()=>vt(a(_));var S=l(g,!0);n(g),D(()=>R(S,a(_))),u(A,g)}),n(y),n(d),u(t,d)},_t=t=>{var d=ps(),y=l(d);be(y,17,()=>i.messages,g=>g.id,(g,S)=>{var B=hs(),O=l(B),H=l(O);{var te=M=>{var E=us();u(M,E)},X=M=>{var E=ms();u(M,E)};x(H,M=>{a(S).role==="user"?M(te):M(X,!1)})}n(O);var K=o(O,2),V=l(K);{var F=M=>{var E=gs(),W=l(E);tt(W,()=>rt(i.streamingContent||"")),ie(2),n(E),u(M,E)},se=M=>{var E=bs(),W=l(E);tt(W,()=>rt(a(S).content)),n(E),u(M,E)};x(V,M=>{a(S).role==="assistant"&&i.isStreaming&&a(S).id===i._agentState.streamingMessageId?M(F):M(se,!1)})}n(K),n(B),D(()=>ee(B,1,`message ${a(S).role??""}`,"svelte-12tm3zb")),u(g,B)});var A=o(y,2);{var _=g=>{var S=fs();u(g,S)};x(A,g=>{i.isRunning&&!i.isStreaming&&g(_)})}n(d),u(t,d)};x(Ue,t=>{i.messages.length===0?t(pt):t(_t,!1)})}var Fe=o(Ue,2);{var zt=t=>{var d=_s(),y=o(l(d),2),A=l(y,!0);n(y);var _=o(y,2);_.__click=()=>i._agentState.clearError(),n(d),D(()=>R(A,i.error)),u(t,d)};x(Fe,t=>{i.error&&t(zt)})}var St=o(Fe,2);{var wt=t=>{var d=Ms(),y=l(d),A=o(l(y),2);A.__click=()=>k(b,!1),n(y);var _=o(y,2),g=l(_),S=o(l(g),2),B=l(S);let O;var H=l(B),te=o(H);{var X=L=>{var $=Ot("(streaming)");u(L,$)};x(te,L=>{i.isStreaming&&L(X)})}n(B),n(S),n(g);var K=o(g,2);{var V=L=>{var $=zs(),G=o(l($),2),Y=l(G);n(G),n($),D(ae=>R(Y,`${ae??""}...`),[()=>i.threadId.slice(0,8)]),u(L,$)};x(K,L=>{i.threadId&&L(V)})}var F=o(K,2),se=o(l(F),2),M=l(se,!0);n(se),n(F);var E=o(F,2);{var W=L=>{var $=ys(),G=l($),Y=l(G);n(G);var ae=o(G,2);be(ae,21,()=>a(r),re=>re.id,(re,U)=>{var ne=Cs();let me;var ke=l(ne),Me=l(ke),It=l(Me,!0);n(Me);var Xe=o(Me,2),Tt=l(Xe,!0);n(Xe),n(ke);var Ke=o(ke,2);{var Et=Z=>{var Q=Ss(),le=o(l(Q),2),Ie=l(le,!0);n(le),n(Q),D(Te=>R(Ie,Te),[()=>at(a(U).args)]),u(Z,Q)};x(Ke,Z=>{a(U).args&&Z(Et)})}var xt=o(Ke,2);{var At=Z=>{var Q=ws(),le=o(l(Q),2),Ie=l(le,!0);n(le),n(Q),D(Te=>R(Ie,Te),[()=>at(a(U).result)]),u(Z,Q)};x(xt,Z=>{a(U).result&&Z(At)})}n(ne),D(()=>{me=ee(ne,1,"tool-call svelte-12tm3zb",null,me,{running:a(U).status==="running",completed:a(U).status==="completed"}),R(It,a(U).name),R(Tt,a(U).status)}),u(re,ne)}),n(ae),n($),D(()=>R(Y,`Tool Calls (${a(r).length??""})`)),u(L,$)};x(E,L=>{a(r).length>0&&L(W)})}var q=o(E,2);{var Mt=L=>{var $=ks(),G=o(l($),2),Y=l(G),ae=l(Y);n(Y);var re=o(Y,2),U=l(re,!0);n(re),n(G),n($),D((ne,me)=>{R(ae,`${ne??""} keys`),R(U,me)},[()=>Object.keys(i.sharedState).length,()=>JSON.stringify(i.sharedState,null,2)]),u(L,$)};x(q,L=>{Object.keys(i.sharedState).length>0&&L(Mt)})}n(_),n(d),D(()=>{O=ee(B,1,"status-badge svelte-12tm3zb",null,O,{running:i.isRunning,streaming:i.isStreaming}),R(H,`${i.status??""} `),R(M,i.messages.length)}),u(t,d)};x(St,t=>{a(b)&&t(wt)})}n(ve),et(ve,t=>k(m,t),()=>a(m));var Ge=o(ve,2),Je=l(Ge),J=l(Je);Wt(J),J.__input=t=>xe(t.currentTarget),J.__keydown=dt,et(J,t=>k(v,t),()=>a(v));var ue=o(J,2);ue.__click=Ae;var Ct=l(ue);{var yt=t=>{var d=Is();u(t,d)},kt=t=>{var d=Ts();u(t,d)};x(Ct,t=>{i.isRunning?t(yt):t(kt,!1)})}n(ue),n(Je),ie(2),n(Ge),n(De),n(de),D(t=>{Re=ee(de,1,"assistant-page svelte-12tm3zb",null,Re,{"sidebar-open":a(h)}),Oe=ee(ce,1,"sidebar svelte-12tm3zb",null,Oe,{open:a(h)}),Qt(Be,"title",a(h)?"Hide sidebar":"Show sidebar"),Ze(we,a(C)),Ze(ye,a(z)),Pe=ee(He,1,"debug-toggle svelte-12tm3zb",null,Pe,{active:a(b)}),J.disabled=i.isRunning,ue.disabled=t},[()=>!a(c).trim()||i.isRunning]),es(J,()=>a(c),t=>k(c,t)),u(e,de),Xt()}Rt(["click","keydown","change","input"]);export{js as component};
