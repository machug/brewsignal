import{g as Fe,h as wt,d as Ct,f as C,a as u,c as kt,s as R,b as he,t as Mt}from"../chunks/_XOVx4lj.js";import{t as D,M as Ge,_ as Je,z as yt,aG as It,a3 as Xe,a4 as Tt,ai as Et,aH as xt,aI as At,Y as Lt,Z as me,p as Ze,i as r,l as ie,a as Rt,s as G,av as Ot,o as Nt,g as d,c as y,d as l,h as $t,e as Dt,at as jt,j as n,n as ke,k as Bt,f as Ht}from"../chunks/DB-qchCW.js";import{e as ge,i as Pt}from"../chunks/BGNkgO3t.js";import{i as E}from"../chunks/CxlJqsN3.js";import{h as Ut}from"../chunks/D33WWFu2.js";import{s as Ft}from"../chunks/N6Y6k7Jx.js";import{s as ee}from"../chunks/D_MCKjsL.js";import{b as Gt}from"../chunks/BAqk-K3z.js";import{b as Ke}from"../chunks/DPOFs90J.js";function Ve(e,s,f=!1,m=!1,p=!1){var S=e,c="";D(()=>{var x=yt;if(c===(c=s()??"")){Ge&&Je();return}if(x.nodes_start!==null&&(It(x.nodes_start,x.nodes_end),x.nodes_start=x.nodes_end=null),c!==""){if(Ge){Xe.data;for(var i=Je(),I=i;i!==null&&(i.nodeType!==Tt||i.data!=="");)I=i,i=Et(i);if(i===null)throw xt(),At;Fe(Xe,I),S=Lt(i);return}var b=c+"";f?b=`<svg>${b}</svg>`:m&&(b=`<math>${b}</math>`);var a=wt(b);if((f||m)&&(a=me(a)),Fe(me(a),a.lastChild),f||m)for(;me(a);)S.before(me(a));else S.before(a)}})}function We(e){if(!e.startsWith("data: "))return null;const s=e.slice(6).trim();if(s==="[DONE]")return null;try{return JSON.parse(s)}catch{return console.warn("Failed to parse SSE event:",s),null}}function Jt(){return`${Date.now()}-${Math.random().toString(36).slice(2,9)}`}function Xt(){const e=Ze({status:"disconnected",error:null,threadId:null,runId:null,messages:[],streamingMessageId:null,streamingContent:"",toolCallsList:[],agentState:{},currentStep:null});function s(a){return e.toolCallsList.find(v=>v.id===a)}function f(a,v){const h=e.toolCallsList.findIndex(z=>z.id===a);h>=0&&(e.toolCallsList[h]={...e.toolCallsList[h],...v})}const m=ie(()=>e.streamingMessageId!==null),p=ie(()=>e.status==="connected"),S=ie(()=>e.status==="connecting"||r(m)),c=ie(()=>()=>{const a=[...e.messages];if(e.streamingMessageId&&e.streamingContent){const v=a.findIndex(h=>h.id===e.streamingMessageId);v>=0?a[v]={...a[v],content:e.streamingContent}:a.push({id:e.streamingMessageId,role:"assistant",content:e.streamingContent})}return a});function x(a){switch(a.type){case"RUN_STARTED":e.status="connected",e.threadId=a.threadId,e.runId=a.runId,e.error=null;break;case"RUN_FINISHED":if(e.status="connected",e.streamingMessageId&&e.streamingContent){const h=e.messages.findIndex(z=>z.id===e.streamingMessageId);h>=0?e.messages[h].content=e.streamingContent:e.messages.push({id:e.streamingMessageId,role:"assistant",content:e.streamingContent})}e.streamingMessageId=null,e.streamingContent="",e.currentStep=null;break;case"RUN_ERROR":e.status="error",e.error=a.message,e.streamingMessageId=null,e.streamingContent="";break;case"STEP_STARTED":e.currentStep=a.stepName;break;case"STEP_FINISHED":e.currentStep=null;break;case"TEXT_MESSAGE_START":e.streamingMessageId=a.messageId,e.streamingContent="";break;case"TEXT_MESSAGE_CONTENT":a.messageId===e.streamingMessageId&&(e.streamingContent+=a.delta);break;case"TEXT_MESSAGE_END":a.messageId===e.streamingMessageId&&(e.messages.push({id:e.streamingMessageId,role:"assistant",content:e.streamingContent}),e.streamingMessageId=null,e.streamingContent="");break;case"TEXT_MESSAGE_CHUNK":e.streamingMessageId||(e.streamingMessageId=a.messageId,e.streamingContent=""),e.streamingContent+=a.content;break;case"TOOL_CALL_START":e.toolCallsList=[...e.toolCallsList,{id:a.toolCallId,name:a.toolCallName||a.toolName||"unknown",args:"",status:"running"}];break;case"TOOL_CALL_ARGS":const v=s(a.toolCallId);v&&f(a.toolCallId,{args:v.args+a.delta});break;case"TOOL_CALL_END":f(a.toolCallId,{status:"completed"});break;case"TOOL_CALL_RESULT":case"TOOL_RESULT":f(a.toolCallId,{result:a.content||a.result,status:"completed"});break;case"STATE_SNAPSHOT":e.agentState=a.snapshot;break;case"STATE_DELTA":for(const h of a.delta){const z=h.path.split("/").filter(Boolean);if(h.op==="add"||h.op==="replace"){let N=e.agentState;for(let j=0;j<z.length-1;j++)z[j]in N||(N[z[j]]={}),N=N[z[j]];N[z[z.length-1]]=h.value}else if(h.op==="remove"){let N=e.agentState;for(let j=0;j<z.length-1;j++)N=N[z[j]];delete N[z[z.length-1]]}}break;case"MESSAGES_SNAPSHOT":e.messages=a.messages;break;case"CUSTOM":console.log("Custom event:",a.name,a.value);break}}function i(a){const v={id:Jt(),role:"user",content:a,createdAt:new Date().toISOString()};return e.messages.push(v),v}function I(){e.messages=[],e.streamingMessageId=null,e.streamingContent="",e.toolCallsList=[],e.agentState={},e.threadId=null,e.runId=null,e.error=null,e.currentStep=null}function b(){e.error=null,e.status==="error"&&(e.status="disconnected")}return{get status(){return e.status},get error(){return e.error},get threadId(){return e.threadId},get runId(){return e.runId},get messages(){return e.messages},get streamingMessageId(){return e.streamingMessageId},get streamingContent(){return e.streamingContent},get toolCalls(){return e.toolCallsList},get agentState(){return e.agentState},get currentStep(){return e.currentStep},get isStreaming(){return r(m)},get isConnected(){return r(p)},get isRunning(){return r(S)},get allMessages(){return r(c)()},handleEvent:x,addUserMessage:i,clear:I,clearError:b,_setStatus(a){e.status=a},_setError(a){e.error=a},_setThreadId(a){e.threadId=a},_addMessage(a){e.messages.push(a)}}}function Kt(e){let s=null;async function f(p,S){m(),s=new AbortController,p._setStatus("connecting"),p._setError(null);try{const c=await fetch(e.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream",...e.headers},body:JSON.stringify(S),signal:s.signal});if(!c.ok){const b=await c.text();throw new Error(`HTTP ${c.status}: ${b}`)}if(!c.body)throw new Error("No response body");const x=c.body.getReader(),i=new TextDecoder;let I="";for(;;){const{done:b,value:a}=await x.read();if(b)break;I+=i.decode(a,{stream:!0});const v=I.split(`
`);I=v.pop()||"";for(const h of v){const z=We(h);z&&p.handleEvent(z)}}if(I.trim()){const b=We(I);b&&p.handleEvent(b)}}catch(c){c instanceof Error&&c.name==="AbortError"?p._setStatus("disconnected"):(p._setStatus("error"),p._setError(c instanceof Error?c.message:"Unknown error"))}finally{s=null}}function m(){s&&(s.abort(),s=null)}return{run:f,abort:m}}function Vt(e){const s=Xt(),f=Kt({url:e.url,headers:e.headers});let m=e.tools||[],p=e.initialState||{},S=e.threadId;async function c(v,h){s.addUserMessage(v);const N={threadId:h||S||s.threadId,messages:s.messages,tools:m.length>0?m:void 0,state:Object.keys(p).length>0?p:void 0};await f.run(s,N),s.threadId&&(S=s.threadId),s.error?e.onError?.(s.error):e.onComplete?.()}function x(v,h){s.clear(),S=h,s._setThreadId(h);for(const z of v)s._addMessage(z)}function i(){f.abort()}function I(){f.abort(),s.clear()}function b(v){p={...p,...v}}function a(v){m=v}return{get status(){return s.status},get error(){return s.error},get messages(){return s.allMessages},get isStreaming(){return s.isStreaming},get isRunning(){return s.isRunning},get threadId(){return s.threadId},get currentStep(){return s.currentStep},get toolCalls(){return s.toolCalls},get sharedState(){return p},get streamingContent(){return s.streamingContent},send:c,stop:i,clear:I,setState:b,setTools:a,loadMessages:x,_agentState:s,_client:f}}function qe(e){try{const s=JSON.parse(e);return JSON.stringify(s,null,2)}catch{return e}}function Ye(e){if(!e)return"";let s=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return s=s.replace(/```(\w*)\n([\s\S]*?)```/g,'<pre><code class="language-$1">$2</code></pre>'),s=s.replace(/`([^`]+)`/g,"<code>$1</code>"),s=s.replace(/^### (.+)$/gm,"<h4>$1</h4>"),s=s.replace(/^## (.+)$/gm,"<h3>$1</h3>"),s=s.replace(/^# (.+)$/gm,"<h2>$1</h2>"),s=s.replace(/^---+$/gm,"<hr>"),s=s.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>"),s=s.replace(/\*([^*]+)\*/g,"<em>$1</em>"),s=s.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener">$1</a>'),s=s.replace(/(?:^|\n)((?:- .+\n?)+)/g,(f,m)=>`
<ul>`+m.trim().split(`
`).map(S=>S.replace(/^- (.+)$/,"<li>$1</li>")).join("")+`</ul>
`),s=s.replace(/(?:^|\n)((?:\d+\. .+\n?)+)/g,(f,m)=>`
<ol>`+m.trim().split(`
`).map(S=>S.replace(/^\d+\. (.+)$/,"<li>$1</li>")).join("")+`</ol>
`),s=s.replace(/\n(?!<\/?(ul|ol|li|pre|h[1-6]|hr))/g,"<br>"),s=s.replace(/<br><(ul|ol|pre|h[1-6]|hr)/g,"<$1"),s=s.replace(/<\/(ul|ol|pre|h[1-6])><br>/g,"</$1>"),s}var Wt=C('<button type="button" class="sidebar-backdrop svelte-12tm3zb" aria-label="Close sidebar"></button>'),qt=C('<div class="sidebar-loading svelte-12tm3zb">Loading...</div>'),Yt=C('<div class="sidebar-empty svelte-12tm3zb">No conversations yet</div>'),Zt=C('<div role="button" tabindex="0"><div class="thread-title svelte-12tm3zb"> </div> <div class="thread-meta svelte-12tm3zb"><span class="svelte-12tm3zb"> </span> <span class="svelte-12tm3zb"> </span></div> <button type="button" class="thread-delete svelte-12tm3zb" title="Delete conversation"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2" class="svelte-12tm3zb"></path></svg></button></div>'),Qt=C('<div class="thread-list svelte-12tm3zb"></div>'),es=C('<button type="button" class="prompt-chip svelte-12tm3zb"> </button>'),ts=C('<div class="empty-state svelte-12tm3zb"><div class="empty-icon svelte-12tm3zb"><svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="svelte-12tm3zb"><path d="M12 2L2 7l10 5 10-5-10-5z" class="svelte-12tm3zb"></path><path d="M2 17l10 5 10-5" class="svelte-12tm3zb"></path><path d="M2 12l10 5 10-5" class="svelte-12tm3zb"></path></svg></div> <h2 class="svelte-12tm3zb">Start a conversation</h2> <p class="empty-description svelte-12tm3zb">Ask about recipes, techniques, or ingredients</p> <div class="example-prompts svelte-12tm3zb"></div></div>'),ss=he('<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-12tm3zb"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z" class="svelte-12tm3zb"></path></svg>'),as=he('<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-12tm3zb"><path d="M12 2L2 7l10 5 10-5-10-5z" class="svelte-12tm3zb"></path><path d="M2 17l10 5 10-5M2 12l10 5 10-5" stroke="currentColor" stroke-width="2" fill="none" class="svelte-12tm3zb"></path></svg>'),rs=C('<div class="message-text streaming svelte-12tm3zb"><!> <span class="cursor svelte-12tm3zb"></span></div>'),ns=C('<div class="message-text svelte-12tm3zb"><!></div>'),ls=C('<div><div class="message-avatar svelte-12tm3zb"><!></div> <div class="message-content svelte-12tm3zb"><!></div></div>'),is=C('<div class="message assistant svelte-12tm3zb"><div class="message-avatar svelte-12tm3zb"><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-12tm3zb"><path d="M12 2L2 7l10 5 10-5-10-5z" class="svelte-12tm3zb"></path><path d="M2 17l10 5 10-5M2 12l10 5 10-5" stroke="currentColor" stroke-width="2" fill="none" class="svelte-12tm3zb"></path></svg></div> <div class="message-content svelte-12tm3zb"><div class="typing-indicator svelte-12tm3zb"><span class="svelte-12tm3zb"></span><span class="svelte-12tm3zb"></span><span class="svelte-12tm3zb"></span></div></div></div>'),os=C('<div class="messages svelte-12tm3zb"><!> <!></div>'),ds=C('<div class="error-banner svelte-12tm3zb"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="svelte-12tm3zb"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" class="svelte-12tm3zb"></path></svg> <span class="svelte-12tm3zb"> </span> <button type="button" class="svelte-12tm3zb">Dismiss</button></div>'),vs=C('<div class="debug-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb">Thread</div> <div class="debug-value mono svelte-12tm3zb"> </div></div>'),cs=C('<details class="tool-details svelte-12tm3zb"><summary class="svelte-12tm3zb">Arguments</summary> <pre class="tool-json svelte-12tm3zb"> </pre></details>'),us=C('<details class="tool-details svelte-12tm3zb"><summary class="svelte-12tm3zb">Result</summary> <pre class="tool-json svelte-12tm3zb"> </pre></details>'),ms=C('<div><div class="tool-call-header svelte-12tm3zb"><span class="tool-name svelte-12tm3zb"> </span> <span class="tool-status svelte-12tm3zb"> </span></div> <!> <!></div>'),gs=C('<div class="debug-section tool-calls-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb"> </div> <div class="tool-calls-list svelte-12tm3zb"></div></div>'),hs=C('<div class="debug-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb">Shared State</div> <details class="tool-details svelte-12tm3zb"><summary class="svelte-12tm3zb"> </summary> <pre class="tool-json svelte-12tm3zb"> </pre></details></div>'),bs=C('<div class="debug-panel svelte-12tm3zb"><div class="debug-header svelte-12tm3zb"><h3 class="svelte-12tm3zb">Agent Debug</h3> <button type="button" class="debug-close svelte-12tm3zb">Ã—</button></div> <div class="debug-content svelte-12tm3zb"><div class="debug-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb">Status</div> <div class="debug-value svelte-12tm3zb"><span> <!></span></div></div> <!> <div class="debug-section svelte-12tm3zb"><div class="debug-label svelte-12tm3zb">Messages</div> <div class="debug-value svelte-12tm3zb"> </div></div> <!> <!></div></div>'),_s=he('<svg class="spinner svelte-12tm3zb" width="20" height="20" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none" stroke-dasharray="31.4" stroke-dashoffset="10" class="svelte-12tm3zb"></circle></svg>'),fs=he('<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" class="svelte-12tm3zb"></path></svg>'),ps=C('<div><!> <aside><div class="sidebar-header svelte-12tm3zb"><h2 class="svelte-12tm3zb">History</h2> <button type="button" class="new-chat-btn svelte-12tm3zb" title="New conversation"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M12 5v14M5 12h14" class="svelte-12tm3zb"></path></svg></button></div> <div class="sidebar-content svelte-12tm3zb"><!></div></aside> <div class="main-content svelte-12tm3zb"><header class="page-header svelte-12tm3zb"><div class="header-left svelte-12tm3zb"><button type="button" class="sidebar-toggle svelte-12tm3zb"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M3 12h18M3 6h18M3 18h18" class="svelte-12tm3zb"></path></svg></button> <div class="header-content svelte-12tm3zb"><h1 class="svelte-12tm3zb">Brewing Assistant</h1> <p class="subtitle svelte-12tm3zb">AI-powered recipe creation and brewing advice</p></div></div> <div class="settings svelte-12tm3zb"><button type="button" title="Toggle agent debug panel"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-12tm3zb"><path d="M12 20h9M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z" class="svelte-12tm3zb"></path></svg></button></div></header> <main class="chat-container svelte-12tm3zb"><!> <!> <!></main> <footer class="input-area svelte-12tm3zb"><div class="input-wrapper svelte-12tm3zb"><textarea placeholder="Ask about brewing..." rows="1" class="svelte-12tm3zb"></textarea> <button type="button" class="send-button svelte-12tm3zb"><!></button></div> <div class="input-hint svelte-12tm3zb">Press Enter to send, Shift+Enter for new line</div></footer></div></div>');function Es(e,s){Rt(s,!0);let f=G(!1),m=G(!1),p=G(!1),S=G(Ze([])),c=G(null),x=G(!1);const i=Vt({url:"/api/ag-ui/run",initialState:{},onStateChange:t=>{t.recipe&&console.log("Recipe extracted:",t.recipe)},onError:t=>{console.error("Agent error:",t)}});let I=ie(()=>i.toolCalls),b=G(""),a=G(null),v=G(null);Ot(()=>{i.messages.length,i.streamingContent,r(v)&&requestAnimationFrame(()=>{r(v)?.scrollTo({top:r(v).scrollHeight,behavior:"smooth"})})});async function h(){y(x,!0);try{const t=await fetch("/api/ag-ui/threads?limit=50");t.ok&&y(S,await t.json(),!0)}catch(t){console.error("Failed to fetch threads:",t)}finally{y(x,!1)}}async function z(t){try{const o=await fetch(`/api/ag-ui/threads/${t}`);if(o.ok){const k=await o.json();y(c,t,!0);const A=k.messages.filter(_=>_.role==="user"||_.role==="assistant").map(_=>({id:String(_.id),role:_.role,content:_.content,createdAt:_.created_at}));i.loadMessages(A,t)}}catch(o){console.error("Failed to load thread:",o)}}async function N(t){if(confirm("Delete this conversation?"))try{(await fetch(`/api/ag-ui/threads/${t}`,{method:"DELETE"})).ok&&(y(S,r(S).filter(k=>k.id!==t),!0),r(c)===t&&j())}catch(o){console.error("Failed to delete thread:",o)}}function j(){y(c,null),i.clear(),r(a)?.focus()}function Me(t){t.style.height="auto",t.style.height=Math.min(t.scrollHeight,200)+"px"}async function ye(){const t=r(b).trim();!t||i.isRunning||(y(b,""),r(a)&&(r(a).style.height="auto"),await i.send(t,r(c)||void 0),!r(c)&&i.threadId&&(y(c,i.threadId,!0),h()))}function Qe(t){t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),ye())}const et=["Help me create an American IPA recipe","What temperature should I ferment a Belgian Tripel?","Create a simple wheat beer recipe for summer","Explain the difference between ale and lager yeast"];function tt(t){y(b,t,!0),r(a)&&(r(a).focus(),Me(r(a)))}function st(t){const o=new Date(t),A=new Date().getTime()-o.getTime(),_=Math.floor(A/6e4),g=Math.floor(A/36e5),w=Math.floor(A/864e5);return _<1?"just now":_<60?`${_}m ago`:g<24?`${g}h ago`:w<7?`${w}d ago`:o.toLocaleDateString()}function be(){y(p,window.innerWidth<768)}Nt(()=>(r(a)?.focus(),h(),be(),window.addEventListener("resize",be),()=>window.removeEventListener("resize",be)));function Ie(t){z(t),r(p)&&y(m,!1)}var oe=ps();Ut("12tm3zb",t=>{Dt(()=>{jt.title="AI Assistant | BrewSignal"})});let Te;var Ee=l(oe);{var at=t=>{var o=Wt();o.__click=()=>y(m,!1),u(t,o)};E(Ee,t=>{r(m)&&r(p)&&t(at)})}var de=d(Ee,2);let xe;var _e=l(de),rt=d(l(_e),2);rt.__click=j,n(_e);var Ae=d(_e,2),nt=l(Ae);{var lt=t=>{var o=qt();u(t,o)},it=t=>{var o=kt(),k=Ht(o);{var A=g=>{var w=Yt();u(g,w)},_=g=>{var w=Qt();ge(w,21,()=>r(S),B=>B.id,(B,O)=>{var H=Zt();let te;H.__click=()=>Ie(r(O).id),H.__keydown=q=>q.key==="Enter"&&Ie(r(O).id);var X=l(H),K=l(X,!0);n(X);var V=d(X,2),U=l(V),se=l(U);n(U);var M=d(U,2),T=l(M,!0);n(M),n(V);var W=d(V,2);W.__click=q=>{q.stopPropagation(),N(r(O).id)},n(H),D(q=>{te=ee(H,1,"thread-item svelte-12tm3zb",null,te,{active:r(c)===r(O).id}),R(K,r(O).title||"Untitled"),R(se,`${r(O).message_count??""} msgs`),R(T,q)},[()=>st(r(O).updated_at)]),u(B,H)}),n(w),u(g,w)};E(k,g=>{r(S).length===0?g(A):g(_,!1)},!0)}u(t,o)};E(nt,t=>{r(x)?t(lt):t(it,!1)})}n(Ae),n(de);var Le=d(de,2),fe=l(Le),pe=l(fe),Re=l(pe);Re.__click=()=>y(m,!r(m)),ke(2),n(pe);var Oe=d(pe,2),Ne=l(Oe);let $e;Ne.__click=()=>y(f,!r(f)),n(Oe),n(fe);var ve=d(fe,2),De=l(ve);{var ot=t=>{var o=ts(),k=d(l(o),6);ge(k,21,()=>et,Pt,(A,_)=>{var g=es();g.__click=()=>tt(r(_));var w=l(g,!0);n(g),D(()=>R(w,r(_))),u(A,g)}),n(k),n(o),u(t,o)},dt=t=>{var o=os(),k=l(o);ge(k,17,()=>i.messages,g=>g.id,(g,w)=>{var B=ls(),O=l(B),H=l(O);{var te=M=>{var T=ss();u(M,T)},X=M=>{var T=as();u(M,T)};E(H,M=>{r(w).role==="user"?M(te):M(X,!1)})}n(O);var K=d(O,2),V=l(K);{var U=M=>{var T=rs(),W=l(T);Ve(W,()=>Ye(i.streamingContent||"")),ke(2),n(T),u(M,T)},se=M=>{var T=ns(),W=l(T);Ve(W,()=>Ye(r(w).content)),n(T),u(M,T)};E(V,M=>{r(w).role==="assistant"&&i.isStreaming&&r(w).id===i._agentState.streamingMessageId?M(U):M(se,!1)})}n(K),n(B),D(()=>ee(B,1,`message ${r(w).role??""}`,"svelte-12tm3zb")),u(g,B)});var A=d(k,2);{var _=g=>{var w=is();u(g,w)};E(A,g=>{i.isRunning&&!i.isStreaming&&g(_)})}n(o),u(t,o)};E(De,t=>{i.messages.length===0?t(ot):t(dt,!1)})}var je=d(De,2);{var vt=t=>{var o=ds(),k=d(l(o),2),A=l(k,!0);n(k);var _=d(k,2);_.__click=()=>i._agentState.clearError(),n(o),D(()=>R(A,i.error)),u(t,o)};E(je,t=>{i.error&&t(vt)})}var ct=d(je,2);{var ut=t=>{var o=bs(),k=l(o),A=d(l(k),2);A.__click=()=>y(f,!1),n(k);var _=d(k,2),g=l(_),w=d(l(g),2),B=l(w);let O;var H=l(B),te=d(H);{var X=L=>{var $=Mt("(streaming)");u(L,$)};E(te,L=>{i.isStreaming&&L(X)})}n(B),n(w),n(g);var K=d(g,2);{var V=L=>{var $=vs(),F=d(l($),2),Y=l(F);n(F),n($),D(ae=>R(Y,`${ae??""}...`),[()=>i.threadId.slice(0,8)]),u(L,$)};E(K,L=>{i.threadId&&L(V)})}var U=d(K,2),se=d(l(U),2),M=l(se,!0);n(se),n(U);var T=d(U,2);{var W=L=>{var $=gs(),F=l($),Y=l(F);n(F);var ae=d(F,2);ge(ae,21,()=>r(I),re=>re.id,(re,P)=>{var ne=ms();let ue;var ze=l(ne),Se=l(ze),_t=l(Se,!0);n(Se);var Pe=d(Se,2),ft=l(Pe,!0);n(Pe),n(ze);var Ue=d(ze,2);{var pt=Z=>{var Q=cs(),le=d(l(Q),2),we=l(le,!0);n(le),n(Q),D(Ce=>R(we,Ce),[()=>qe(r(P).args)]),u(Z,Q)};E(Ue,Z=>{r(P).args&&Z(pt)})}var zt=d(Ue,2);{var St=Z=>{var Q=us(),le=d(l(Q),2),we=l(le,!0);n(le),n(Q),D(Ce=>R(we,Ce),[()=>qe(r(P).result)]),u(Z,Q)};E(zt,Z=>{r(P).result&&Z(St)})}n(ne),D(()=>{ue=ee(ne,1,"tool-call svelte-12tm3zb",null,ue,{running:r(P).status==="running",completed:r(P).status==="completed"}),R(_t,r(P).name),R(ft,r(P).status)}),u(re,ne)}),n(ae),n($),D(()=>R(Y,`Tool Calls (${r(I).length??""})`)),u(L,$)};E(T,L=>{r(I).length>0&&L(W)})}var q=d(T,2);{var bt=L=>{var $=hs(),F=d(l($),2),Y=l(F),ae=l(Y);n(Y);var re=d(Y,2),P=l(re,!0);n(re),n(F),n($),D((ne,ue)=>{R(ae,`${ne??""} keys`),R(P,ue)},[()=>Object.keys(i.sharedState).length,()=>JSON.stringify(i.sharedState,null,2)]),u(L,$)};E(q,L=>{Object.keys(i.sharedState).length>0&&L(bt)})}n(_),n(o),D(()=>{O=ee(B,1,"status-badge svelte-12tm3zb",null,O,{running:i.isRunning,streaming:i.isStreaming}),R(H,`${i.status??""} `),R(M,i.messages.length)}),u(t,o)};E(ct,t=>{r(f)&&t(ut)})}n(ve),Ke(ve,t=>y(v,t),()=>r(v));var Be=d(ve,2),He=l(Be),J=l(He);Bt(J),J.__input=t=>Me(t.currentTarget),J.__keydown=Qe,Ke(J,t=>y(a,t),()=>r(a));var ce=d(J,2);ce.__click=ye;var mt=l(ce);{var gt=t=>{var o=_s();u(t,o)},ht=t=>{var o=fs();u(t,o)};E(mt,t=>{i.isRunning?t(gt):t(ht,!1)})}n(ce),n(He),ke(2),n(Be),n(Le),n(oe),D(t=>{Te=ee(oe,1,"assistant-page svelte-12tm3zb",null,Te,{"sidebar-open":r(m)}),xe=ee(de,1,"sidebar svelte-12tm3zb",null,xe,{open:r(m)}),Ft(Re,"title",r(m)?"Hide sidebar":"Show sidebar"),$e=ee(Ne,1,"debug-toggle svelte-12tm3zb",null,$e,{active:r(f)}),J.disabled=i.isRunning,ce.disabled=t},[()=>!r(b).trim()||i.isRunning]),Gt(J,()=>r(b),t=>y(b,t)),u(e,oe),$t()}Ct(["click","keydown","input"]);export{Es as component};
