import{d as st,f as n,s as v,a as l,c as ke}from"../chunks/CsQfwH0S.js";import{al as a,ak as s,an as t,ar as _,ah as Ve,at as Q,c as e,ai as L,as as Ge,aj as He,aq as _e,p as St,ao as qt,s as f,aL as aa,ay as sa,am as ra}from"../chunks/fKkNMI8q.js";import{e as Mt,i as Pt}from"../chunks/COk1ZY4R.js";import{i as d}from"../chunks/BvBRaQNg.js";import{h as ia}from"../chunks/DLseniaC.js";import{s as Dt}from"../chunks/DbN3nGCc.js";import{s as Le}from"../chunks/BDI2zAFW.js";import{s as Ke}from"../chunks/CcRNvR1k.js";import{i as la,s as va}from"../chunks/C8srtpii.js";import{s as na,a as oa}from"../chunks/C51ud8ec.js";import{p as da}from"../chunks/vrRy15tG.js";import{g as ca}from"../chunks/VqGwNigN.js";import{z as ua,A as _a,q as ga,j as Ft,B as tt,k as fa,x as Tt,C as ut}from"../chunks/i8VL_lOf.js";import{b as pa,g as Lt,d as rt,e as Gt,c as at}from"../chunks/CPwbAm-l.js";import{t as Bt}from"../chunks/C8NDSE1R.js";import{B as ma}from"../chunks/DTfC6M4H.js";import{s as ba}from"../chunks/Bdaed-dN.js";import{p as _t}from"../chunks/CllCHKBI.js";const ha=!1,tr=Object.freeze(Object.defineProperty({__proto__:null,prerender:ha},Symbol.toStringTag,{value:"Module"}));function ja(I){return I>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:I>=-60?{bars:3,color:"var(--positive)",label:"Good"}:I>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function Ot(I){const i=Math.floor((Date.now()-new Date(I).getTime())/1e3);if(i<10)return"just now";if(i<60)return`${i}s ago`;const g=Math.floor(i/60);if(g<60)return`${g}m ago`;const T=Math.floor(g/60);return T<24?`${T}h ago`:`${Math.floor(T/24)}d ago`}var ya=n('<div class="accent-bar svelte-1oyrwd9"></div>'),xa=n('<span class="card-icon svelte-1oyrwd9"> </span>'),ka=n('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),wa=n('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function Qe(I,i){let g=_t(i,"highlight",3,!1),T=_t(i,"collapsible",3,!1),p=_t(i,"expanded",3,!1);var b=wa();let y;var r=a(b);{var P=m=>{var C=ya();l(m,C)};d(r,m=>{g()&&m(P)})}var u=s(r,2),O=a(u),D=a(O);{var G=m=>{var C=xa(),Y=a(C,!0);t(C),_(()=>v(Y,i.icon)),l(m,C)};d(D,m=>{i.icon&&m(G)})}var h=s(D,2),o=a(h,!0);t(h),t(O);var w=s(O,2);{var x=m=>{var C=ka();C.__click=function(...F){i.onToggle?.apply(this,F)};var Y=a(C);let ee;t(C),_(()=>{Dt(C,"aria-label",p()?"Collapse":"Expand"),ee=Le(Y,0,"expand-icon svelte-1oyrwd9",null,ee,{"rotate-180":p()})}),l(m,C)};d(w,m=>{T()&&i.onToggle&&m(x)})}t(u);var z=s(u,2);let j;var k=a(z);ba(k,()=>i.children),t(z),t(b),_(()=>{y=Le(b,1,"batch-card svelte-1oyrwd9",null,y,{highlight:g()}),v(o,i.title),j=Le(z,1,"card-content svelte-1oyrwd9",null,j,{collapsed:T()&&!p()})}),l(I,b)}st(["click"]);var za=n('<span class="unit svelte-lzskfi"> </span>'),Ca=n('<div class="raw-values svelte-lzskfi"><span class="raw-label svelte-lzskfi">Raw:</span> <span class="raw-value svelte-lzskfi"> </span> <span class="raw-separator svelte-lzskfi">¬∑</span> <span class="raw-value svelte-lzskfi"> </span></div>'),Ra=n('<div class="last-seen svelte-lzskfi"> </div>'),Fa=n('<div class="live-badge svelte-lzskfi"><span class="live-dot svelte-lzskfi"></span> <span class="live-text svelte-lzskfi">LIVE</span></div> <div class="readings-grid svelte-lzskfi"><div class="reading svelte-lzskfi"><div class="reading-value svelte-lzskfi"> <!></div> <div class="reading-label svelte-lzskfi"> </div></div> <div class="reading svelte-lzskfi"><div class="reading-value temp svelte-lzskfi"> <span class="unit svelte-lzskfi"> </span></div> <div class="reading-label svelte-lzskfi">Temperature</div></div></div> <!> <!>',1);function Ta(I,i){Ve(i,!0);let g=L(()=>i.liveReading?.sg??i.currentSg),T=L(()=>i.liveReading?.temp??i.currentTemp),p=L(()=>i.liveReading?.sg_raw),b=L(()=>i.liveReading?.temp_raw),y=L(()=>i.liveReading?.last_seen),r=L(()=>i.liveReading&&(i.liveReading.sg!==i.liveReading.sg_raw||i.liveReading.temp!==i.liveReading.temp_raw)),P=L(pa),u=L(Lt);function O(h){return h==null?"--":rt(h)}function D(h){return h==null?"--":Gt(h)}let G=L(()=>e(y)?Ot(e(y)):null);Qe(I,{title:"Live Readings",highlight:!0,children:(h,o)=>{var w=Fa(),x=s(Q(w),2),z=a(x),j=a(z),k=a(j),m=s(k);{var C=V=>{var H=za(),ae=a(H,!0);t(H),_(()=>v(ae,e(P))),l(V,H)};d(m,V=>{e(P)!=="SG"&&V(C)})}t(j);var Y=s(j,2),ee=a(Y,!0);t(Y),t(z);var F=s(z,2),A=a(F),B=a(A),K=s(B),ge=a(K,!0);t(K),t(A),Ge(2),t(F),t(x);var ve=s(x,2);{var fe=V=>{var H=Ca(),ae=s(a(H),2),Oe=a(ae,!0);t(ae);var Ce=s(ae,4),S=a(Ce);t(Ce),t(H),_((q,E)=>{v(Oe,q),v(S,`${E??""}${e(u)??""}`)},[()=>O(e(p)),()=>D(e(b))]),l(V,H)};d(ve,V=>{e(r)&&V(fe)})}var re=s(ve,2);{var ne=V=>{var H=Ra(),ae=a(H);t(H),_(()=>v(ae,`Updated ${e(G)??""}`)),l(V,H)};d(re,V=>{e(G)&&V(ne)})}_((V,H)=>{v(k,`${V??""} `),v(ee,e(P)==="SG"?"Gravity":e(P)==="¬∞P"?"Plato":"Brix"),v(B,`${H??""} `),v(ge,e(u))},[()=>O(e(g)),()=>D(e(T))]),l(h,w)},$$slots:{default:!0}}),He()}var Ba=n('<div class="gravity-point target svelte-t80j9z"><div class="point-marker svelte-t80j9z"></div> <div class="point-label svelte-t80j9z">Target FG</div> <div class="point-value svelte-t80j9z"> </div></div>'),Sa=n('<div class="progress-remaining svelte-t80j9z"> </div>'),qa=n('<div class="progress-section svelte-t80j9z"><div class="progress-header svelte-t80j9z"><span class="progress-label svelte-t80j9z">Fermentation Progress</span> <span class="progress-percent svelte-t80j9z"> </span></div> <div class="progress-bar-container svelte-t80j9z"><div class="progress-bar-bg svelte-t80j9z"></div> <div class="progress-bar-fill svelte-t80j9z"></div> <div class="progress-bar-shine svelte-t80j9z"></div></div> <!></div>'),Ma=n('<div class="current-sg svelte-t80j9z"><div class="sg-label svelte-t80j9z">Current Specific Gravity</div> <div class="sg-value svelte-t80j9z"> <span class="fermenting-badge svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> Fermenting</span></div></div> <div class="gravity-timeline svelte-t80j9z"><div class="timeline-line svelte-t80j9z"></div> <div class="gravity-point start svelte-t80j9z"><div class="point-marker svelte-t80j9z"></div> <div class="point-label svelte-t80j9z">Original Gravity</div> <div class="point-value svelte-t80j9z"> </div></div> <!> <div class="gravity-point current svelte-t80j9z"><div class="point-marker pulsing svelte-t80j9z"></div> <div class="point-label svelte-t80j9z">Current FG</div> <div class="point-value svelte-t80j9z"> </div></div></div> <div class="metrics-grid svelte-t80j9z"><div class="metric abv-metric svelte-t80j9z"><div class="metric-icon svelte-t80j9z">%</div> <div class="metric-content svelte-t80j9z"><div class="metric-label svelte-t80j9z">Alcohol by Volume</div> <div class="metric-value svelte-t80j9z"> <span class="live-indicator svelte-t80j9z">LIVE</span></div></div></div> <div class="metric attenuation-metric svelte-t80j9z"><div class="metric-icon svelte-t80j9z">‚Üì</div> <div class="metric-content svelte-t80j9z"><div class="metric-label svelte-t80j9z">Apparent Attenuation</div> <div class="metric-value svelte-t80j9z"> <span class="live-indicator svelte-t80j9z">LIVE</span></div></div></div></div> <!>',1),Pa=n('<div class="measurements-grid svelte-t80j9z"><div class="measurement svelte-t80j9z"><div class="measurement-label svelte-t80j9z">Original Gravity</div> <div class="measurement-value svelte-t80j9z"> </div></div> <div class="measurement svelte-t80j9z"><div class="measurement-label svelte-t80j9z">Final Gravity</div> <div class="measurement-value svelte-t80j9z"> </div></div> <div class="measurement svelte-t80j9z"><div class="measurement-label svelte-t80j9z">ABV</div> <div class="measurement-value svelte-t80j9z"> </div></div> <div class="measurement svelte-t80j9z"><div class="measurement-label svelte-t80j9z">Attenuation</div> <div class="measurement-value svelte-t80j9z"> </div></div></div>'),Da=n('<div class="no-data svelte-t80j9z"><div class="no-data-icon svelte-t80j9z">‚óã</div> <p class="no-data-text svelte-t80j9z">Set Original Gravity to begin tracking fermentation metrics</p></div>');function La(I,i){Ve(i,!0);let g=L(()=>{if(!i.batch.measured_og)return null;const y=i.currentSg??i.progress?.measured?.current_sg;if(!y)return null;const r=(i.batch.measured_og-y)*131.25,P=i.batch.measured_og-1,u=P!==0?(i.batch.measured_og-y)/P*100:0;return{currentSg:y,abv:Math.max(0,r),attenuation:Math.max(0,Math.min(100,u)),isFermenting:i.batch.status==="fermenting"||i.batch.status==="conditioning"}}),T=L(()=>e(g)?.isFermenting??!1);function p(y){return y==null?"--":rt(y)}function b(y){return y==null?"--":`${y.toFixed(1)}%`}{let y=L(()=>e(T)?"Fermentation Progress":"Fermentation Measurements");Qe(I,{get title(){return e(y)},children:(r,P)=>{var u=ke(),O=Q(u);{var D=h=>{var o=Ma(),w=Q(o),x=s(a(w),2),z=a(x);Ge(),t(x),t(w);var j=s(w,2),k=s(a(j),2),m=s(a(k),4),C=a(m,!0);t(m),t(k);var Y=s(k,2);{var ee=S=>{var q=Ba(),E=s(a(q),4),$=a(E,!0);t(E),t(q),_(de=>v($,de),[()=>p(i.batch.recipe.fg)]),l(S,q)};d(Y,S=>{i.batch.recipe?.fg&&S(ee)})}var F=s(Y,2),A=s(a(F),4),B=a(A,!0);t(A),t(F),t(j);var K=s(j,2),ge=a(K),ve=s(a(ge),2),fe=s(a(ve),2),re=a(fe);Ge(),t(fe),t(ve),t(ge);var ne=s(ge,2),V=s(a(ne),2),H=s(a(V),2),ae=a(H);Ge(),t(H),t(V),t(ne),t(K);var Oe=s(K,2);{var Ce=S=>{var q=qa(),E=a(q),$=s(a(E),2),de=a($);t($),t(E);var c=s(E,2),M=s(a(c),2);Ge(2),t(c);var N=s(c,2);{var U=we=>{var pe=Sa(),ye=a(pe);t(pe),_(xe=>v(ye,`${xe??""} gravity points remaining`),[()=>i.progress.progress.sg_remaining.toFixed(3)]),l(we,pe)};d(N,we=>{i.progress.progress.sg_remaining!=null&&we(U)})}t(q),_(we=>{v(de,`${we??""}%`),Ke(M,`width: ${i.progress.progress.percent_complete??""}%`)},[()=>i.progress.progress.percent_complete.toFixed(0)]),l(S,q)};d(Oe,S=>{i.progress?.progress?.percent_complete!=null&&S(Ce)})}_((S,q,E,$,de)=>{v(z,`${S??""} `),v(C,q),v(B,E),v(re,`${$??""} `),v(ae,`${de??""} `)},[()=>p(e(g).currentSg),()=>p(i.batch.measured_og),()=>p(e(g).currentSg),()=>b(e(g).abv),()=>b(e(g).attenuation)]),l(h,o)},G=h=>{var o=ke(),w=Q(o);{var x=j=>{var k=Pa(),m=a(k),C=s(a(m),2),Y=a(C,!0);t(C),t(m);var ee=s(m,2),F=s(a(ee),2),A=a(F,!0);t(F),t(ee);var B=s(ee,2),K=s(a(B),2),ge=a(K,!0);t(K),t(B);var ve=s(B,2),fe=s(a(ve),2),re=a(fe,!0);t(fe),t(ve),t(k),_((ne,V,H,ae)=>{v(Y,ne),v(A,V),v(ge,H),v(re,ae)},[()=>p(i.batch.measured_og),()=>p(i.batch.measured_fg),()=>i.batch.measured_abv!=null?b(i.batch.measured_abv):"--",()=>i.batch.measured_attenuation!=null?b(i.batch.measured_attenuation):"--"]),l(j,k)},z=j=>{var k=Da();l(j,k)};d(w,j=>{i.batch.measured_og?j(x):j(z,!1)},!0)}l(h,o)};d(O,h=>{e(g)&&e(T)?h(D):h(G,!1)})}l(r,u)},$$slots:{default:!0}})}He()}var Ga=n('<div class="timeline svelte-yskb8i"><div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Brew Date</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Started</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Ended</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Created</span> <span class="timeline-value svelte-yskb8i"> </span></div></div>');function Oa(I,i){Ve(i,!0);function g(p){return p?new Date(p).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"}):"--"}function T(p){return p?new Date(p).toLocaleString("en-GB",{day:"numeric",month:"short",hour:"numeric",minute:"2-digit"}):"--"}Qe(I,{title:"Timeline",children:(p,b)=>{var y=Ga(),r=a(y),P=s(a(r),2),u=a(P,!0);t(P),t(r);var O=s(r,2),D=s(a(O),2),G=a(D,!0);t(D),t(O);var h=s(O,2),o=s(a(h),2),w=a(o,!0);t(o),t(h);var x=s(h,2),z=s(a(x),2),j=a(z,!0);t(z),t(x),t(y),_((k,m,C,Y)=>{v(u,k),v(G,m),v(w,C),v(j,Y)},[()=>g(i.batch.brew_date),()=>T(i.batch.start_time),()=>T(i.batch.end_time),()=>T(i.batch.created_at)]),l(p,y)},$$slots:{default:!0}}),He()}var Aa=n('<div class="signal-bar svelte-1kdxwtz"></div>'),Ea=n('<div class="signal-details svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="signal-text svelte-1kdxwtz"> </span></div>'),Ua=n('<div class="device-last-seen svelte-1kdxwtz"> </div>'),Na=n('<div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!> <!>',1),Ia=n('<div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <div class="device-last-seen svelte-1kdxwtz">Not receiving data</div>',1),Va=n('<div class="device-info svelte-1kdxwtz"><!></div>'),Ha=n('<button type="button" class="link-btn svelte-1kdxwtz">Link a device</button>'),Wa=n('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function Ja(I,i){Ve(i,!0);let g=L(()=>i.liveReading?.rssi?ja(i.liveReading.rssi):null),T=L(()=>i.liveReading?.last_seen?Ot(i.liveReading.last_seen):null),p=L(()=>{if(!i.liveReading)return i.batch.device_id||"Unknown";const b=i.liveReading.device_type;return b==="tilt"?`${i.liveReading.color} Tilt`:b==="gravitymon"?`GravityMon (${i.liveReading.id})`:b==="ispindel"?`iSpindel (${i.liveReading.id})`:b==="floaty"?`Floaty (${i.liveReading.id})`:i.liveReading.color||i.liveReading.id});Qe(I,{title:"Tracking Device",children:(b,y)=>{var r=ke(),P=Q(r);{var u=D=>{var G=Va(),h=a(G);{var o=x=>{var z=Na(),j=Q(z),k=s(a(j));t(j);var m=s(j,2);{var C=F=>{var A=Ea(),B=a(A);Mt(B,20,()=>Array(4),Pt,(ve,fe,re)=>{var ne=Aa();_(()=>Ke(ne,`
										height: ${6+re*3}px;
										background: ${(re<e(g).bars?e(g).color:"var(--bg-hover)")??""};
										opacity: ${re<e(g).bars?1:.4};
									`)),l(ve,ne)}),t(B);var K=s(B,2),ge=a(K);t(K),t(A),_(()=>{Ke(K,`color: ${e(g).color??""}`),v(ge,`${e(g).label??""} (${i.liveReading.rssi??""} dBm)`)}),l(F,A)};d(m,F=>{e(g)&&F(C)})}var Y=s(m,2);{var ee=F=>{var A=Ua(),B=a(A);t(A),_(()=>v(B,`Updated ${e(T)??""}`)),l(F,A)};d(Y,F=>{e(T)&&F(ee)})}_(()=>v(k,` ${e(p)??""} - Connected`)),l(x,z)},w=x=>{var z=Ia(),j=Q(z),k=s(a(j));t(j),Ge(2),_(()=>v(k,` Device: ${i.batch.device_id??""}`)),l(x,z)};d(h,x=>{i.liveReading?x(o):x(w,!1)})}t(G),l(D,G)},O=D=>{var G=Wa(),h=s(a(G),2);{var o=w=>{var x=Ha();x.__click=function(...z){i.onEdit?.apply(this,z)},l(w,x)};d(h,w=>{i.onEdit&&w(o)})}t(G),l(D,G)};d(P,D=>{i.batch.device_id?D(u):D(O,!1)})}l(b,r)},$$slots:{default:!0}}),He()}st(["click"]);const Ya=131.25;var Ka=n('<div class="target wide svelte-19u9n31"><span class="target-label svelte-19u9n31">Yeast</span> <span class="target-value svelte-19u9n31"> </span></div>'),Qa=n('<div class="targets-grid svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div> <!></div>');function Xa(I,i){Ve(i,!0);function g(p){return p==null?"--":rt(p)}let T=L(()=>i.recipe.abv!=null?i.recipe.abv*100:i.recipe.og&&i.recipe.fg?(i.recipe.og-i.recipe.fg)*Ya:null);Qe(I,{title:"Recipe Targets",children:(p,b)=>{var y=Qa(),r=a(y),P=s(a(r),2),u=a(P,!0);t(P),t(r);var O=s(r,2),D=s(a(O),2),G=a(D,!0);t(D),t(O);var h=s(O,2),o=s(a(h),2),w=a(o,!0);t(o),t(h);var x=s(h,2);{var z=j=>{var k=Ka(),m=s(a(k),2),C=a(m,!0);t(m),t(k),_(()=>v(C,i.recipe.yeast_name)),l(j,k)};d(x,j=>{i.recipe.yeast_name&&j(z)})}t(y),_((j,k,m)=>{v(u,j),v(G,k),v(w,m)},[()=>g(i.recipe.og),()=>g(i.recipe.fg),()=>e(T)!=null?`${e(T).toFixed(1)}%`:"--"]),l(p,y)},$$slots:{default:!0}}),He()}var Za=n('<p class="notes-content svelte-hkv31i"> </p>');function $a(I,i){Qe(I,{title:"Notes",children:(g,T)=>{var p=Za(),b=a(p,!0);t(p),_(()=>v(b,i.notes)),l(g,p)},$$slots:{default:!0}})}var es=n('<div class="ml-panel loading svelte-1xs394q"><p>Loading predictions...</p></div>'),ts=n('<div class="ml-panel error svelte-1xs394q"><p class="error-text svelte-1xs394q"> </p></div>'),as=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Predicted FG:</span> <span class="value svelte-1xs394q"> </span></div>'),ss=n('<span class="days svelte-1xs394q"> </span>'),rs=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Est. Completion:</span> <span class="value svelte-1xs394q"> <!></span></div>'),is=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Model Fit (R¬≤):</span> <div class="progress-wrapper svelte-1xs394q"><div class="progress-bar svelte-1xs394q"><div class="fill svelte-1xs394q"></div></div> <span class="percentage svelte-1xs394q"> </span></div></div>'),ls=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Readings:</span> <span class="value svelte-1xs394q"> </span></div>'),vs=n('<div class="ml-panel svelte-1xs394q"><div class="panel-header svelte-1xs394q"><h3 class="panel-title svelte-1xs394q">ML Predictions</h3> <button type="button" class="reload-btn svelte-1xs394q" title="Recalculate predictions from database history"> </button></div> <div class="metrics svelte-1xs394q"><!> <!> <!> <!></div></div>'),ns=n('<div class="ml-panel disabled svelte-1xs394q"><p class="unavailable-text svelte-1xs394q">ML predictions unavailable (insufficient data)</p></div>');function os(I,i){Ve(i,!0);let g=_e(St({available:!1})),T=_e(!0),p=_e(!1),b=_e(null);async function y(){f(T,!0),f(b,null);try{f(g,await ua(i.batchId),!0)}catch(o){f(b,o instanceof Error?o.message:"Failed to load predictions",!0),console.error("Failed to load ML predictions:",o)}finally{f(T,!1)}}async function r(){f(p,!0),f(b,null);try{const o=await _a(i.batchId);console.log("Reloaded predictions:",o.message),await y()}catch(o){f(b,o instanceof Error?o.message:"Failed to reload predictions",!0),console.error("Failed to reload predictions:",o)}finally{f(p,!1)}}qt(y);function P(o){return o?new Date(o).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}):"N/A"}function u(o){if(!o)return null;const w=new Date(o),x=new Date,z=w.getTime()-x.getTime();return Math.ceil(z/(1e3*60*60*24))}var O=ke(),D=Q(O);{var G=o=>{var w=es();l(o,w)},h=o=>{var w=ke(),x=Q(w);{var z=k=>{var m=ts(),C=a(m),Y=a(C);t(C),t(m),_(()=>v(Y,`‚ö†Ô∏è ${e(b)??""}`)),l(k,m)},j=k=>{var m=ke(),C=Q(m);{var Y=F=>{var A=vs(),B=a(A),K=s(a(B),2);K.__click=r;var ge=a(K,!0);t(K),t(B);var ve=s(B,2),fe=a(ve);{var re=S=>{var q=as(),E=s(a(q),2),$=a(E,!0);t(E),t(q),_(de=>v($,de),[()=>rt(e(g).predicted_fg)]),l(S,q)};d(fe,S=>{e(g).predicted_fg&&S(re)})}var ne=s(fe,2);{var V=S=>{const q=L(()=>u(e(g).estimated_completion));var E=rs(),$=s(a(E),2),de=a($),c=s(de);{var M=N=>{var U=ss(),we=a(U);t(U),_(()=>v(we,`(${e(q)??""} ${e(q)===1?"day":"days"})`)),l(N,U)};d(c,N=>{e(q)!==null&&N(M)})}t($),t(E),_(N=>v(de,`${N??""} `),[()=>P(e(g).estimated_completion)]),l(S,E)};d(ne,S=>{e(g).estimated_completion&&S(V)})}var H=s(ne,2);{var ae=S=>{var q=is(),E=s(a(q),2),$=a(E),de=a($);t($);var c=s($,2),M=a(c);t(c),t(E),t(q),_(N=>{Ke(de,`width: ${e(g).r_squared*100}%`),v(M,`${N??""}%`)},[()=>(e(g).r_squared*100).toFixed(0)]),l(S,q)};d(H,S=>{e(g).r_squared!==void 0&&S(ae)})}var Oe=s(H,2);{var Ce=S=>{var q=ls(),E=s(a(q),2),$=a(E);t(E),t(q),_(()=>v($,`${e(g).num_readings??""} points`)),l(S,q)};d(Oe,S=>{e(g).num_readings&&S(Ce)})}t(ve),t(A),_(()=>{K.disabled=e(p)||e(T),v(ge,e(p)?"Reloading...":"‚Üª Reload")}),l(F,A)},ee=F=>{var A=ns();l(F,A)};d(C,F=>{e(g).available?F(Y):F(ee,!1)},!0)}l(k,m)};d(x,k=>{e(b)?k(z):k(j,!1)},!0)}l(o,w)};d(D,o=>{e(T)?o(G):o(h,!1)})}l(I,O),He()}st(["click"]);var ds=n('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),cs=n('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),us=n('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),_s=n('<span class="recipe-type svelte-g5au2j"> </span>'),gs=n('<a class="recipe-link svelte-g5au2j"> <!></a>'),fs=n('<option class="svelte-g5au2j"> </option>'),ps=n('<span class="chilling-icon svelte-g5au2j">üç∫</span> <h3 class="chilling-title svelte-g5au2j">Ready to Pitch!</h3>',1),ms=n('<span class="chilling-icon svelte-g5au2j">‚ùÑÔ∏è</span> <h3 class="chilling-title svelte-g5au2j">Chilling to Pitch Temperature</h3>',1),bs=n('<div class="progress-section svelte-g5au2j"><div class="progress-bar svelte-g5au2j"><div class="progress-fill svelte-g5au2j"></div></div> <span class="progress-text svelte-g5au2j"> </span></div>'),hs=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è No cooler configured - set a cooler entity to enable automated chilling</span>'),js=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è Temperature control disabled in settings</span>'),ys=n('<span class="status-ready svelte-g5au2j">Wort has reached pitch temperature - ready to add yeast!</span>'),xs=n('<span class="status-active svelte-g5au2j">Cooler will run automatically when temp exceeds target + hysteresis</span>'),ks=n('<div><div class="chilling-header svelte-g5au2j"><!></div> <div class="chilling-content svelte-g5au2j"><div class="temp-display svelte-g5au2j"><div class="temp-current svelte-g5au2j"><span class="temp-label svelte-g5au2j">Current</span> <span class="temp-value svelte-g5au2j"> </span></div> <div class="temp-arrow svelte-g5au2j">‚Üí</div> <div class="temp-target svelte-g5au2j"><span class="temp-label svelte-g5au2j">Target</span> <span class="temp-value svelte-g5au2j"> </span></div></div> <!> <div class="chilling-status svelte-g5au2j"><!></div></div></div>'),ws=n('<div class="device-status heater svelte-g5au2j"><div>üî•</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Heater</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),zs=n('<div class="device-status cooler svelte-g5au2j"><div>‚ùÑÔ∏è</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Cooler</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Cs=n('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">‚ö°</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),Rs=n('<button type="button" class="override-btn heat-on svelte-g5au2j">Force Heat ON</button> <button type="button" class="override-btn heat-off svelte-g5au2j">Force Heat OFF</button>',1),Fs=n('<button type="button" class="override-btn cool-on svelte-g5au2j">Force Cool ON</button> <button type="button" class="override-btn cool-off svelte-g5au2j">Force Cool OFF</button>',1),Ts=n('<div class="control-details svelte-g5au2j"><div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns-grid svelte-g5au2j"><!> <!> <button type="button" class="override-btn auto-mode svelte-g5au2j">Auto Mode</button></div></div>',1),Bs=n('<div><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="device-status-grid svelte-g5au2j"><!> <!></div> <!></div>'),Ss=n('<span class="svelte-g5au2j"> </span>'),qs=n('<span class="svelte-g5au2j"> </span>'),Ms=n('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><!> <!> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),Ps=n('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j" aria-label="Delete batch"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <!> <div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!> <!></div></div>',1),Ds=n('<div class="modal-overlay svelte-g5au2j"><div class="modal svelte-g5au2j"><h2 class="modal-title svelte-g5au2j">Delete Batch?</h2> <p class="modal-text svelte-g5au2j"> </p> <div class="modal-actions svelte-g5au2j"><button type="button" class="modal-btn cancel svelte-g5au2j">Cancel</button> <button type="button" class="modal-btn delete svelte-g5au2j"> </button></div></div></div>'),Ls=n('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div> <!>',1);function ar(I,i){Ve(i,!0);const g=()=>oa(da,"$page",T),[T,p]=na();let b=null,y=null,r=_e(null),P=_e(null),u=_e(null);St([]);let O=_e(!0),D=_e(null),G=_e(!1),h=_e(!1),o=_e(!1),w=_e(!1),x=_e(!1),z=L(()=>parseInt(g().params.id??"0"));const j={planning:{label:"Planning",color:"var(--text-secondary)",bg:"var(--bg-elevated)"},fermenting:{label:"Fermenting",color:"#f59e0b",bg:"rgba(245, 158, 11, 0.12)"},conditioning:{label:"Conditioning",color:"#8b5cf6",bg:"rgba(139, 92, 246, 0.12)"},completed:{label:"Completed",color:"var(--positive)",bg:"rgba(34, 197, 94, 0.12)"},archived:{label:"Archived",color:"var(--text-muted)",bg:"var(--bg-elevated)"}},k=["planning","fermenting","conditioning","completed","archived"];let m=L(()=>e(r)?j[e(r).status]:j.planning),C=L(Lt),Y=L(()=>at.config.ha_enabled&&at.config.temp_control_enabled&&(e(r)?.heater_entity_id||e(r)?.cooler_entity_id)),ee=L(()=>e(r)?.status==="planning"&&e(r)?.temp_target!=null),F=L(()=>!e(ee)||!e(B)?.temp||!e(r)?.temp_target?!1:e(B).temp<=e(r).temp_target),A=L(()=>{if(!e(ee)||!e(B)?.temp||!e(r)?.temp_target)return null;const c=e(r).temp_target+30,M=e(B).temp,N=e(r).temp_target;if(M<=N)return 100;if(M>=c)return 0;const U=(c-M)/(c-N)*100;return Math.min(100,Math.max(0,U))}),B=L(()=>{if(!e(r)?.device_id)return null;const c=Bt.tilts.get(e(r).device_id);if(c)return c;const M=e(r).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!M?.[1])return null;const N=M[1].toUpperCase();for(const U of Bt.tilts.values())if(U.color&&U.color.toUpperCase()===N)return U;return null});async function K(){f(O,!0),f(D,null);try{if(f(r,await ga(e(z)),!0),e(r).status==="fermenting"||e(r).status==="conditioning")try{f(P,await Ft(e(z)),!0)}catch{}if(e(r).heater_entity_id||e(r).cooler_entity_id)try{f(u,await tt(e(z)),!0)}catch{}}catch(c){f(D,c instanceof Error?c.message:"Failed to load batch",!0)}finally{f(O,!1)}}async function ge(c){if(!(!e(r)||e(h))&&!(c==="conditioning"&&e(r).status==="fermenting"&&!confirm(`üí° Entering Conditioning Phase

Reminder: Adjust target temperature if cold crashing.
Temperature control will continue during conditioning.

Continue?`))){f(h,!0);try{f(r,await Tt(e(r).id,{status:c}),!0),(c==="fermenting"||c==="conditioning")&&f(P,await Ft(e(r).id),!0)}catch(M){console.error("Failed to update status:",M)}finally{f(h,!1)}}}async function ve(c){if(e(r)&&(f(r,await Tt(e(r).id,c),!0),f(G,!1),e(r).heater_entity_id||e(r).cooler_entity_id))try{f(u,await tt(e(r).id),!0)}catch{}}async function fe(){if(e(r)){f(x,!0);try{await fa(e(r).id),ca("/batches")}catch(c){f(D,c instanceof Error?c.message:"Failed to delete batch",!0),f(x,!1),f(w,!1)}}}async function re(c,M){if(!(!e(r)||e(o))){f(o,!0);try{await ut(e(r).id,M,60,c),f(u,await tt(e(r).id),!0)}catch(N){console.error("Failed to set override:",N)}finally{f(o,!1)}}}async function ne(){if(!(!e(r)||e(o))){f(o,!0);try{e(r).heater_entity_id&&await ut(e(r).id,null,60,"heater"),e(r).cooler_entity_id&&await ut(e(r).id,null,60,"cooler"),f(u,await tt(e(r).id),!0)}catch(c){console.error("Failed to clear overrides:",c)}finally{f(o,!1)}}}function V(){if(b?.readyState===WebSocket.OPEN)return;const M=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;b=new WebSocket(M),b.onmessage=async N=>{try{const U=JSON.parse(N.data);U.type==="control_event"&&U.batch_id===e(z)&&e(u)&&(U.action==="heat_on"?f(u,{...e(u),heater_state:"on"},!0):U.action==="heat_off"?f(u,{...e(u),heater_state:"off"},!0):U.action==="cool_on"?f(u,{...e(u),cooler_state:"on"},!0):U.action==="cool_off"&&f(u,{...e(u),cooler_state:"off"},!0))}catch{}},b.onclose=()=>{b=null,y=setTimeout(V,3e3)},b.onerror=()=>{b?.close()}}function H(){y&&(clearTimeout(y),y=null),b?.close(),b=null}function ae(c){return c==null?"--":Gt(c)}qt(()=>{K(),V()}),aa(()=>{H()});var Oe=Ls();ia("g5au2j",c=>{sa(()=>{ra.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var Ce=Q(Oe),S=s(a(Ce),2);{var q=c=>{var M=ds();l(c,M)},E=c=>{var M=ke(),N=Q(M);{var U=pe=>{var ye=cs(),xe=s(a(ye),2),Xe=a(xe,!0);t(xe);var Ze=s(xe,2);Ze.__click=K,t(ye),_(()=>v(Xe,e(D))),l(pe,ye)},we=pe=>{var ye=ke(),xe=Q(ye);{var Xe=We=>{var et=us();l(We,et)},Ze=We=>{var et=ke(),At=Q(et);{var Et=Je=>{ma(Je,{get batch(){return e(r)},onSubmit:ve,onCancel:()=>f(G,!1)})},Ut=Je=>{var gt=Ps(),it=Q(gt),lt=a(it),vt=a(lt),Nt=a(vt);t(vt);var ft=s(vt,2),nt=a(ft),It=a(nt,!0);t(nt);var Vt=s(nt,2);{var Ht=R=>{var W=gs(),te=a(W),me=s(te);{var be=ze=>{var Re=_s(),qe=a(Re);t(Re),_(()=>v(qe,`(${e(r).recipe.type??""})`)),l(ze,Re)};d(me,ze=>{e(r).recipe.type&&ze(be)})}t(W),_(()=>{Dt(W,"href",`/recipes/${e(r).recipe.id??""}`),v(te,`${e(r).recipe.name??""} `)}),l(R,W)};d(Vt,R=>{e(r).recipe&&R(Ht)})}t(ft),t(lt);var pt=s(lt,2),ot=a(pt),Se=a(ot);Se.__change=R=>ge(R.currentTarget.value),Mt(Se,21,()=>k,Pt,(R,W)=>{var te=fs(),me=a(te,!0);t(te);var be={};_(()=>{v(me,j[e(W)].label),be!==(be=e(W))&&(te.value=(te.__value=e(W))??"")}),l(R,te)}),t(Se);var mt;la(Se),t(ot);var bt=s(ot,2);bt.__click=()=>f(G,!0);var Wt=s(bt,2);Wt.__click=()=>f(w,!0),t(pt),t(it);var ht=s(it,2);{var Jt=R=>{var W=ks();let te;var me=a(W),be=a(me);{var ze=J=>{var se=ps();Ge(2),l(J,se)},Re=J=>{var se=ms();Ge(2),l(J,se)};d(be,J=>{e(F)?J(ze):J(Re,!1)})}t(me);var qe=s(me,2),Ue=a(qe),Ne=a(Ue),ie=s(a(Ne),2),X=a(ie,!0);t(ie),t(Ne);var Z=s(Ne,4),le=s(a(Z),2),Fe=a(le,!0);t(le),t(Z),t(Ue);var ce=s(Ue,2);{var Te=J=>{var se=bs(),Ee=a(se),$e=a(Ee);t(Ee);var Ie=s(Ee,2),Be=a(Ie);t(Ie),t(se),_(De=>{Ke($e,`width: ${e(A)??""}%`),v(Be,`${De??""}% to target`)},[()=>Math.round(e(A))]),l(J,se)};d(ce,J=>{e(A)!=null&&!e(F)&&J(Te)})}var Me=s(ce,2),Pe=a(Me);{var Ae=J=>{var se=hs();l(J,se)},ct=J=>{var se=ke(),Ee=Q(se);{var $e=Be=>{var De=js();l(Be,De)},Ie=Be=>{var De=ke(),oe=Q(De);{var he=ue=>{var Ye=ys();l(ue,Ye)},je=ue=>{var Ye=xs();l(ue,Ye)};d(oe,ue=>{e(F)?ue(he):ue(je,!1)},!0)}l(Be,De)};d(Ee,Be=>{!at.config.ha_enabled||!at.config.temp_control_enabled?Be($e):Be(Ie,!1)},!0)}l(J,se)};d(Pe,J=>{e(r).cooler_entity_id?J(ct,!1):J(Ae)})}t(Me),t(qe),t(W),_((J,se)=>{te=Le(W,1,"chilling-banner svelte-g5au2j",null,te,{ready:e(F)}),v(X,J),v(Fe,se)},[()=>e(B)?.temp!=null?ae(e(B).temp):"--",()=>e(r).temp_target!=null?ae(e(r).temp_target):"--"]),l(R,W)};d(ht,R=>{e(ee)&&R(Jt)})}var jt=s(ht,2),dt=a(jt),yt=a(dt);{var Yt=R=>{{let W=L(()=>e(P)?.measured?.current_sg),te=L(()=>e(P)?.temperature?.current);Ta(R,{get liveReading(){return e(B)},get currentSg(){return e(W)},get currentTemp(){return e(te)}})}};d(yt,R=>{(e(B)||e(P)?.measured?.current_sg!=null)&&R(Yt)})}var xt=s(yt,2);{let R=L(()=>e(B)?.sg??e(P)?.measured?.current_sg);La(xt,{get batch(){return e(r)},get currentSg(){return e(R)},get progress(){return e(P)}})}var Kt=s(xt,2);{var Qt=R=>{Xa(R,{get recipe(){return e(r).recipe}})};d(Kt,R=>{e(r).recipe&&R(Qt)})}t(dt);var kt=s(dt,2),wt=a(kt);Oa(wt,{get batch(){return e(r)}});var zt=s(wt,2);Ja(zt,{get batch(){return e(r)},get liveReading(){return e(B)},onEdit:()=>f(G,!0)});var Ct=s(zt,2);os(Ct,{get batchId(){return e(r).id}});var Rt=s(Ct,2);{var Xt=R=>{var W=Bs();let te;var me=s(a(W),2),be=a(me);{var ze=ie=>{var X=ws(),Z=a(X);let le;var Fe=s(Z,2),ce=s(a(Fe),2);let Te;var Me=a(ce,!0);t(ce);var Pe=s(ce,2),Ae=a(Pe,!0);t(Pe),t(Fe),t(X),_(()=>{le=Le(Z,1,"device-icon-wrap svelte-g5au2j",null,le,{active:e(u)?.heater_state==="on"}),Te=Le(ce,1,"device-state svelte-g5au2j",null,Te,{on:e(u)?.heater_state==="on"}),v(Me,e(u)?.heater_state==="on"?"ON":"OFF"),v(Ae,e(r).heater_entity_id)}),l(ie,X)};d(be,ie=>{e(r).heater_entity_id&&ie(ze)})}var Re=s(be,2);{var qe=ie=>{var X=zs(),Z=a(X);let le;var Fe=s(Z,2),ce=s(a(Fe),2);let Te;var Me=a(ce,!0);t(ce);var Pe=s(ce,2),Ae=a(Pe,!0);t(Pe),t(Fe),t(X),_(()=>{le=Le(Z,1,"device-icon-wrap svelte-g5au2j",null,le,{active:e(u)?.cooler_state==="on"}),Te=Le(ce,1,"device-state svelte-g5au2j",null,Te,{on:e(u)?.cooler_state==="on"}),v(Me,e(u)?.cooler_state==="on"?"ON":"OFF"),v(Ae,e(r).cooler_entity_id)}),l(ie,X)};d(Re,ie=>{e(r).cooler_entity_id&&ie(qe)})}t(me);var Ue=s(me,2);{var Ne=ie=>{var X=Ts(),Z=Q(X),le=a(Z),Fe=s(a(le),2),ce=a(Fe);t(Fe),t(le);var Te=s(le,2),Me=s(a(Te),2),Pe=a(Me);t(Me),t(Te),t(Z);var Ae=s(Z,2);{var ct=oe=>{var he=Cs(),je=s(a(he),2),ue=a(je);t(je);var Ye=s(je,2);Ye.__click=()=>ne(),t(he),_(ta=>{v(ue,`Override active: ${ta??""}`),Ye.disabled=e(o)},[()=>e(u).override_state?.toUpperCase()]),l(oe,he)};d(Ae,oe=>{e(u).override_active&&oe(ct)})}var J=s(Ae,2),se=s(a(J),2),Ee=a(se);{var $e=oe=>{var he=Rs(),je=Q(he);je.__click=()=>re("heater","on");var ue=s(je,2);ue.__click=()=>re("heater","off"),_(()=>{je.disabled=e(o),ue.disabled=e(o)}),l(oe,he)};d(Ee,oe=>{e(r).heater_entity_id&&oe($e)})}var Ie=s(Ee,2);{var Be=oe=>{var he=Fs(),je=Q(he);je.__click=()=>re("cooler","on");var ue=s(je,2);ue.__click=()=>re("cooler","off"),_(()=>{je.disabled=e(o),ue.disabled=e(o)}),l(oe,he)};d(Ie,oe=>{e(r).cooler_entity_id&&oe(Be)})}var De=s(Ie,2);De.__click=()=>ne(),t(se),t(J),_((oe,he)=>{v(ce,`${oe??""}${e(C)??""}`),v(Pe,`¬±${he??""}${e(C)??""}`),De.disabled=e(o)},[()=>ae(e(u).target_temp),()=>e(u).hysteresis?.toFixed(1)||"--"]),l(ie,X)};d(Ue,ie=>{e(u)&&ie(Ne)})}t(W),_(()=>te=Le(W,1,"info-card temp-control-card svelte-g5au2j",null,te,{"heater-on":e(u)?.heater_state==="on","cooler-on":e(u)?.cooler_state==="on"})),l(R,W)},Zt=R=>{var W=ke(),te=Q(W);{var me=be=>{var ze=Ms(),Re=s(a(ze),2),qe=a(Re);{var Ue=X=>{var Z=Ss(),le=a(Z);t(Z),_(()=>v(le,`Heater: ${e(r).heater_entity_id??""}`)),l(X,Z)};d(qe,X=>{e(r).heater_entity_id&&X(Ue)})}var Ne=s(qe,2);{var ie=X=>{var Z=qs(),le=a(Z);t(Z),_(()=>v(le,`Cooler: ${e(r).cooler_entity_id??""}`)),l(X,Z)};d(Ne,X=>{e(r).cooler_entity_id&&X(ie)})}Ge(2),t(Re),t(ze),l(be,ze)};d(te,be=>{(e(r).heater_entity_id||e(r).cooler_entity_id)&&e(r).status!=="fermenting"&&be(me)},!0)}l(R,W)};d(Rt,R=>{e(Y)&&(e(r).status==="fermenting"||e(r).status==="conditioning")?R(Xt):R(Zt,!1)})}var $t=s(Rt,2);{var ea=R=>{$a(R,{get notes(){return e(r).notes}})};d($t,R=>{e(r).notes&&R(ea)})}t(kt),t(jt),_(()=>{v(Nt,`#${(e(r).batch_number||"?")??""}`),v(It,e(r).name||e(r).recipe?.name||"Unnamed Batch"),Se.disabled=e(h),Ke(Se,`color: ${e(m).color??""}; background: ${e(m).bg??""};`),mt!==(mt=e(r).status)&&(Se.value=(Se.__value=e(r).status)??"",va(Se,e(r).status))}),l(Je,gt)};d(At,Je=>{e(G)?Je(Et):Je(Ut,!1)},!0)}l(We,et)};d(xe,We=>{e(r)?We(Ze,!1):We(Xe)},!0)}l(pe,ye)};d(N,pe=>{e(D)?pe(U):pe(we,!1)},!0)}l(c,M)};d(S,c=>{e(O)?c(q):c(E,!1)})}t(Ce);var $=s(Ce,2);{var de=c=>{var M=Ds();M.__click=()=>f(w,!1);var N=a(M);N.__click=Ze=>Ze.stopPropagation();var U=s(a(N),2),we=a(U);t(U);var pe=s(U,2),ye=a(pe);ye.__click=()=>f(w,!1);var xe=s(ye,2);xe.__click=fe;var Xe=a(xe,!0);t(xe),t(pe),t(N),t(M),_(()=>{v(we,`Are you sure you want to delete "${(e(r)?.name||"this batch")??""}"? This cannot be undone.`),ye.disabled=e(x),xe.disabled=e(x),v(Xe,e(x)?"Deleting...":"Delete Batch")}),l(c,M)};d($,c=>{e(w)&&c(de)})}l(I,Oe),He(),p()}st(["click","change"]);export{ar as component,tr as universal};
