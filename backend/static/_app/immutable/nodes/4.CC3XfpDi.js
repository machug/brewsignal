import{d as st,f as n,s as v,a as l,c as ke}from"../chunks/CsQfwH0S.js";import{al as a,ak as s,an as t,ar as _,ah as Ve,at as Q,c as e,ai as P,as as Ge,aj as He,aq as ge,p as St,ao as qt,s as f,aL as aa,ay as sa,am as ra}from"../chunks/fKkNMI8q.js";import{e as Mt,i as Pt}from"../chunks/COk1ZY4R.js";import{i as d}from"../chunks/BvBRaQNg.js";import{h as ia}from"../chunks/DLseniaC.js";import{s as Dt}from"../chunks/DbN3nGCc.js";import{s as Le}from"../chunks/BDI2zAFW.js";import{s as Ke}from"../chunks/CcRNvR1k.js";import{i as la,s as va}from"../chunks/C8srtpii.js";import{s as na,a as oa}from"../chunks/C51ud8ec.js";import{p as da}from"../chunks/ChKDHi9H.js";import{g as ca}from"../chunks/Bdw0az_j.js";import{z as ua,A as _a,q as ga,j as Ft,B as tt,k as fa,x as Tt,C as ut}from"../chunks/i8VL_lOf.js";import{b as pa,g as Lt,d as rt,e as Gt,c as at}from"../chunks/CPwbAm-l.js";import{t as Bt}from"../chunks/C8NDSE1R.js";import{B as ma}from"../chunks/DTfC6M4H.js";import{s as ba}from"../chunks/Bdaed-dN.js";import{p as _t}from"../chunks/CllCHKBI.js";const ha=!1,tr=Object.freeze(Object.defineProperty({__proto__:null,prerender:ha},Symbol.toStringTag,{value:"Module"}));function ja(I){return I>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:I>=-60?{bars:3,color:"var(--positive)",label:"Good"}:I>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function Ot(I){const i=Math.floor((Date.now()-new Date(I).getTime())/1e3);if(i<10)return"just now";if(i<60)return`${i}s ago`;const h=Math.floor(i/60);if(h<60)return`${h}m ago`;const w=Math.floor(h/60);return w<24?`${w}h ago`:`${Math.floor(w/24)}d ago`}var ya=n('<div class="accent-bar svelte-1oyrwd9"></div>'),xa=n('<span class="card-icon svelte-1oyrwd9"> </span>'),ka=n('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),wa=n('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function Qe(I,i){let h=_t(i,"highlight",3,!1),w=_t(i,"collapsible",3,!1),m=_t(i,"expanded",3,!1);var k=wa();let g;var r=a(k);{var B=b=>{var z=ya();l(b,z)};d(r,b=>{h()&&b(B)})}var u=s(r,2),L=a(u),V=a(L);{var G=b=>{var z=xa(),K=a(z,!0);t(z),_(()=>v(K,i.icon)),l(b,z)};d(V,b=>{i.icon&&b(G)})}var p=s(V,2),o=a(p,!0);t(p),t(L);var R=s(L,2);{var F=b=>{var z=ka();z.__click=function(...U){i.onToggle?.apply(this,U)};var K=a(z);let ee;t(z),_(()=>{Dt(z,"aria-label",m()?"Collapse":"Expand"),ee=Le(K,0,"expand-icon svelte-1oyrwd9",null,ee,{"rotate-180":m()})}),l(b,z)};d(R,b=>{w()&&i.onToggle&&b(F)})}t(u);var x=s(u,2);let j;var y=a(x);ba(y,()=>i.children),t(x),t(k),_(()=>{g=Le(k,1,"batch-card svelte-1oyrwd9",null,g,{highlight:h()}),v(o,i.title),j=Le(x,1,"card-content svelte-1oyrwd9",null,j,{collapsed:w()&&!m()})}),l(I,k)}st(["click"]);var za=n('<span class="unit svelte-lzskfi"> </span>'),Ra=n('<div class="raw-values svelte-lzskfi"><span class="raw-label svelte-lzskfi">Raw:</span> <span class="raw-value svelte-lzskfi"> </span> <span class="raw-separator svelte-lzskfi">¬∑</span> <span class="raw-value svelte-lzskfi"> </span></div>'),Ca=n('<div class="last-seen svelte-lzskfi"> </div>'),Fa=n('<div class="live-badge svelte-lzskfi"><span class="live-dot svelte-lzskfi"></span> <span class="live-text svelte-lzskfi">LIVE</span></div> <div class="readings-grid svelte-lzskfi"><div class="reading svelte-lzskfi"><div class="reading-value svelte-lzskfi"> <!></div> <div class="reading-label svelte-lzskfi"> </div></div> <div class="reading svelte-lzskfi"><div class="reading-value temp svelte-lzskfi"> <span class="unit svelte-lzskfi"> </span></div> <div class="reading-label svelte-lzskfi">Temperature</div></div></div> <!> <!>',1);function Ta(I,i){Ve(i,!0);let h=P(()=>i.liveReading?.sg??i.currentSg),w=P(()=>i.liveReading?.temp??i.currentTemp),m=P(()=>i.liveReading?.sg_raw),k=P(()=>i.liveReading?.temp_raw),g=P(()=>i.liveReading?.last_seen),r=P(()=>i.liveReading&&(i.liveReading.sg!==i.liveReading.sg_raw||i.liveReading.temp!==i.liveReading.temp_raw)),B=P(pa),u=P(Lt);function L(p){return p==null?"--":rt(p)}function V(p){return p==null?"--":Gt(p)}let G=P(()=>e(g)?Ot(e(g)):null);Qe(I,{title:"Live Readings",highlight:!0,children:(p,o)=>{var R=Fa(),F=s(Q(R),2),x=a(F),j=a(x),y=a(j),b=s(y);{var z=D=>{var W=za(),ae=a(W,!0);t(W),_(()=>v(ae,e(B))),l(D,W)};d(b,D=>{e(B)!=="SG"&&D(z)})}t(j);var K=s(j,2),ee=a(K,!0);t(K),t(x);var U=s(x,2),O=a(U),T=a(O),H=s(T),ve=a(H,!0);t(H),t(O),Ge(2),t(U),t(F);var ne=s(F,2);{var de=D=>{var W=Ra(),ae=s(a(W),2),Oe=a(ae,!0);t(ae);var Re=s(ae,4),S=a(Re);t(Re),t(W),_((q,A)=>{v(Oe,q),v(S,`${A??""}${e(u)??""}`)},[()=>L(e(m)),()=>V(e(k))]),l(D,W)};d(ne,D=>{e(r)&&D(de)})}var fe=s(ne,2);{var re=D=>{var W=Ca(),ae=a(W);t(W),_(()=>v(ae,`Updated ${e(G)??""}`)),l(D,W)};d(fe,D=>{e(G)&&D(re)})}_((D,W)=>{v(y,`${D??""} `),v(ee,e(B)==="SG"?"Gravity":e(B)==="¬∞P"?"Plato":"Brix"),v(T,`${W??""} `),v(ve,e(u))},[()=>L(e(h)),()=>V(e(w))]),l(p,R)},$$slots:{default:!0}}),He()}var Ba=n('<div class="gravity-point target svelte-t80j9z"><div class="point-marker svelte-t80j9z"></div> <div class="point-label svelte-t80j9z">Target FG</div> <div class="point-value svelte-t80j9z"> </div></div>'),Sa=n('<div class="progress-remaining svelte-t80j9z"> </div>'),qa=n('<div class="progress-section svelte-t80j9z"><div class="progress-header svelte-t80j9z"><span class="progress-label svelte-t80j9z">Fermentation Progress</span> <span class="progress-percent svelte-t80j9z"> </span></div> <div class="progress-bar-container svelte-t80j9z"><div class="progress-bar-bg svelte-t80j9z"></div> <div class="progress-bar-fill svelte-t80j9z"></div> <div class="progress-bar-shine svelte-t80j9z"></div></div> <!></div>'),Ma=n('<div class="current-sg svelte-t80j9z"><div class="sg-label svelte-t80j9z">Current Specific Gravity</div> <div class="sg-value svelte-t80j9z"> <span class="fermenting-badge svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> Fermenting</span></div></div> <div class="gravity-timeline svelte-t80j9z"><div class="timeline-line svelte-t80j9z"></div> <div class="gravity-point start svelte-t80j9z"><div class="point-marker svelte-t80j9z"></div> <div class="point-label svelte-t80j9z">Original Gravity</div> <div class="point-value svelte-t80j9z"> </div></div> <!> <div class="gravity-point current svelte-t80j9z"><div class="point-marker pulsing svelte-t80j9z"></div> <div class="point-label svelte-t80j9z">Current FG</div> <div class="point-value svelte-t80j9z"> </div></div></div> <div class="metrics-grid svelte-t80j9z"><div class="metric abv-metric svelte-t80j9z"><div class="metric-icon svelte-t80j9z">%</div> <div class="metric-content svelte-t80j9z"><div class="metric-label svelte-t80j9z">Alcohol by Volume</div> <div class="metric-value svelte-t80j9z"> <span class="live-indicator svelte-t80j9z">LIVE</span></div></div></div> <div class="metric attenuation-metric svelte-t80j9z"><div class="metric-icon svelte-t80j9z">‚Üì</div> <div class="metric-content svelte-t80j9z"><div class="metric-label svelte-t80j9z">Apparent Attenuation</div> <div class="metric-value svelte-t80j9z"> <span class="live-indicator svelte-t80j9z">LIVE</span></div></div></div></div> <!>',1),Pa=n('<div class="measurements-grid svelte-t80j9z"><div class="measurement svelte-t80j9z"><div class="measurement-label svelte-t80j9z">Original Gravity</div> <div class="measurement-value svelte-t80j9z"> </div></div> <div class="measurement svelte-t80j9z"><div class="measurement-label svelte-t80j9z">Final Gravity</div> <div class="measurement-value svelte-t80j9z"> </div></div> <div class="measurement svelte-t80j9z"><div class="measurement-label svelte-t80j9z">ABV</div> <div class="measurement-value svelte-t80j9z"> </div></div> <div class="measurement svelte-t80j9z"><div class="measurement-label svelte-t80j9z">Attenuation</div> <div class="measurement-value svelte-t80j9z"> </div></div></div>'),Da=n('<div class="no-data svelte-t80j9z"><div class="no-data-icon svelte-t80j9z">‚óã</div> <p class="no-data-text svelte-t80j9z">Set Original Gravity to begin tracking fermentation metrics</p></div>');function La(I,i){Ve(i,!0);let h=P(()=>{if(!i.batch.measured_og)return null;const g=i.currentSg??i.progress?.measured?.current_sg;if(!g)return null;const r=(i.batch.measured_og-g)*131.25,B=i.batch.measured_og-1,u=B!==0?(i.batch.measured_og-g)/B*100:0;return{currentSg:g,abv:Math.max(0,r),attenuation:Math.max(0,Math.min(100,u)),isFermenting:i.batch.status==="fermenting"||i.batch.status==="conditioning"}}),w=P(()=>e(h)?.isFermenting??!1);function m(g){return g==null?"--":rt(g)}function k(g){return g==null?"--":`${g.toFixed(1)}%`}{let g=P(()=>e(w)?"Fermentation Progress":"Fermentation Measurements");Qe(I,{get title(){return e(g)},children:(r,B)=>{var u=ke(),L=Q(u);{var V=p=>{var o=Ma(),R=Q(o),F=s(a(R),2),x=a(F);Ge(),t(F),t(R);var j=s(R,2),y=s(a(j),2),b=s(a(y),4),z=a(b,!0);t(b),t(y);var K=s(y,2);{var ee=S=>{var q=Ba(),A=s(a(q),4),$=a(A,!0);t(A),t(q),_(ce=>v($,ce),[()=>m(i.batch.recipe.fg)]),l(S,q)};d(K,S=>{i.batch.recipe?.fg&&S(ee)})}var U=s(K,2),O=s(a(U),4),T=a(O,!0);t(O),t(U),t(j);var H=s(j,2),ve=a(H),ne=s(a(ve),2),de=s(a(ne),2),fe=a(de);Ge(),t(de),t(ne),t(ve);var re=s(ve,2),D=s(a(re),2),W=s(a(D),2),ae=a(W);Ge(),t(W),t(D),t(re),t(H);var Oe=s(H,2);{var Re=S=>{var q=qa(),A=a(q),$=s(a(A),2),ce=a($);t($),t(A);var c=s(A,2),M=s(a(c),2);Ge(2),t(c);var N=s(c,2);{var E=we=>{var pe=Sa(),ye=a(pe);t(pe),_(xe=>v(ye,`${xe??""} gravity points remaining`),[()=>i.progress.progress.sg_remaining.toFixed(3)]),l(we,pe)};d(N,we=>{i.progress.progress.sg_remaining!=null&&we(E)})}t(q),_(we=>{v(ce,`${we??""}%`),Ke(M,`width: ${i.progress.progress.percent_complete??""}%`)},[()=>i.progress.progress.percent_complete.toFixed(0)]),l(S,q)};d(Oe,S=>{i.progress?.progress?.percent_complete!=null&&S(Re)})}_((S,q,A,$,ce)=>{v(x,`${S??""} `),v(z,q),v(T,A),v(fe,`${$??""} `),v(ae,`${ce??""} `)},[()=>m(e(h).currentSg),()=>m(i.batch.measured_og),()=>m(e(h).currentSg),()=>k(e(h).abv),()=>k(e(h).attenuation)]),l(p,o)},G=p=>{var o=ke(),R=Q(o);{var F=j=>{var y=Pa(),b=a(y),z=s(a(b),2),K=a(z,!0);t(z),t(b);var ee=s(b,2),U=s(a(ee),2),O=a(U,!0);t(U),t(ee);var T=s(ee,2),H=s(a(T),2),ve=a(H,!0);t(H),t(T);var ne=s(T,2),de=s(a(ne),2),fe=a(de,!0);t(de),t(ne),t(y),_((re,D,W,ae)=>{v(K,re),v(O,D),v(ve,W),v(fe,ae)},[()=>m(i.batch.measured_og),()=>m(i.batch.measured_fg),()=>i.batch.measured_abv!=null?k(i.batch.measured_abv):"--",()=>i.batch.measured_attenuation!=null?k(i.batch.measured_attenuation):"--"]),l(j,y)},x=j=>{var y=Da();l(j,y)};d(R,j=>{i.batch.measured_og?j(F):j(x,!1)},!0)}l(p,o)};d(L,p=>{e(h)&&e(w)?p(V):p(G,!1)})}l(r,u)},$$slots:{default:!0}})}He()}var Ga=n('<div class="timeline svelte-yskb8i"><div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Brew Date</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Started</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Ended</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Created</span> <span class="timeline-value svelte-yskb8i"> </span></div></div>');function Oa(I,i){Ve(i,!0);function h(m){return m?new Date(m).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"}):"--"}function w(m){return m?new Date(m).toLocaleString("en-GB",{day:"numeric",month:"short",hour:"numeric",minute:"2-digit"}):"--"}Qe(I,{title:"Timeline",children:(m,k)=>{var g=Ga(),r=a(g),B=s(a(r),2),u=a(B,!0);t(B),t(r);var L=s(r,2),V=s(a(L),2),G=a(V,!0);t(V),t(L);var p=s(L,2),o=s(a(p),2),R=a(o,!0);t(o),t(p);var F=s(p,2),x=s(a(F),2),j=a(x,!0);t(x),t(F),t(g),_((y,b,z,K)=>{v(u,y),v(G,b),v(R,z),v(j,K)},[()=>h(i.batch.brew_date),()=>w(i.batch.start_time),()=>w(i.batch.end_time),()=>w(i.batch.created_at)]),l(m,g)},$$slots:{default:!0}}),He()}var Aa=n('<div class="signal-bar svelte-1kdxwtz"></div>'),Ea=n('<div class="signal-details svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="signal-text svelte-1kdxwtz"> </span></div>'),Ua=n('<div class="device-last-seen svelte-1kdxwtz"> </div>'),Na=n('<div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!> <!>',1),Ia=n('<div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <div class="device-last-seen svelte-1kdxwtz">Not receiving data</div>',1),Va=n('<div class="device-info svelte-1kdxwtz"><!></div>'),Ha=n('<button type="button" class="link-btn svelte-1kdxwtz">Link a device</button>'),Wa=n('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function Ja(I,i){Ve(i,!0);let h=P(()=>i.liveReading?.device_type==="tilt"),w=P(()=>e(h)&&i.liveReading?.rssi?ja(i.liveReading.rssi):null),m=P(()=>i.liveReading?.last_seen?Ot(i.liveReading.last_seen):null),k=P(()=>{if(!i.liveReading)return i.batch.device_id||"Unknown";const g=i.liveReading.device_type;return g==="tilt"?`${i.liveReading.color} Tilt`:g==="gravitymon"?`GravityMon (${i.liveReading.id})`:g==="ispindel"?`iSpindel (${i.liveReading.id})`:g==="floaty"?`Floaty (${i.liveReading.id})`:i.liveReading.color||i.liveReading.id});Qe(I,{title:"Tracking Device",children:(g,r)=>{var B=ke(),u=Q(B);{var L=G=>{var p=Va(),o=a(p);{var R=x=>{var j=Na(),y=Q(j),b=s(a(y));t(y);var z=s(y,2);{var K=O=>{var T=Ea(),H=a(T);Mt(H,20,()=>Array(4),Pt,(de,fe,re)=>{var D=Aa();_(()=>Ke(D,`
										height: ${6+re*3}px;
										background: ${(re<e(w).bars?e(w).color:"var(--bg-hover)")??""};
										opacity: ${re<e(w).bars?1:.4};
									`)),l(de,D)}),t(H);var ve=s(H,2),ne=a(ve);t(ve),t(T),_(()=>{Ke(ve,`color: ${e(w).color??""}`),v(ne,`${e(w).label??""} (${i.liveReading.rssi??""} dBm)`)}),l(O,T)};d(z,O=>{e(w)&&O(K)})}var ee=s(z,2);{var U=O=>{var T=Ua(),H=a(T);t(T),_(()=>v(H,`Updated ${e(m)??""}`)),l(O,T)};d(ee,O=>{e(m)&&O(U)})}_(()=>v(b,` ${e(k)??""} - Connected`)),l(x,j)},F=x=>{var j=Ia(),y=Q(j),b=s(a(y));t(y),Ge(2),_(()=>v(b,` Device: ${i.batch.device_id??""}`)),l(x,j)};d(o,x=>{i.liveReading?x(R):x(F,!1)})}t(p),l(G,p)},V=G=>{var p=Wa(),o=s(a(p),2);{var R=F=>{var x=Ha();x.__click=function(...j){i.onEdit?.apply(this,j)},l(F,x)};d(o,F=>{i.onEdit&&F(R)})}t(p),l(G,p)};d(u,G=>{i.batch.device_id?G(L):G(V,!1)})}l(g,B)},$$slots:{default:!0}}),He()}st(["click"]);const Ya=131.25;var Ka=n('<div class="target wide svelte-19u9n31"><span class="target-label svelte-19u9n31">Yeast</span> <span class="target-value svelte-19u9n31"> </span></div>'),Qa=n('<div class="targets-grid svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div> <!></div>');function Xa(I,i){Ve(i,!0);function h(m){return m==null?"--":rt(m)}let w=P(()=>i.recipe.abv!=null?i.recipe.abv:i.recipe.og&&i.recipe.fg?(i.recipe.og-i.recipe.fg)*Ya:null);Qe(I,{title:"Recipe Targets",children:(m,k)=>{var g=Qa(),r=a(g),B=s(a(r),2),u=a(B,!0);t(B),t(r);var L=s(r,2),V=s(a(L),2),G=a(V,!0);t(V),t(L);var p=s(L,2),o=s(a(p),2),R=a(o,!0);t(o),t(p);var F=s(p,2);{var x=j=>{var y=Ka(),b=s(a(y),2),z=a(b,!0);t(b),t(y),_(()=>v(z,i.recipe.yeast_name)),l(j,y)};d(F,j=>{i.recipe.yeast_name&&j(x)})}t(g),_((j,y,b)=>{v(u,j),v(G,y),v(R,b)},[()=>h(i.recipe.og),()=>h(i.recipe.fg),()=>e(w)!=null?`${e(w).toFixed(1)}%`:"--"]),l(m,g)},$$slots:{default:!0}}),He()}var Za=n('<p class="notes-content svelte-hkv31i"> </p>');function $a(I,i){Qe(I,{title:"Notes",children:(h,w)=>{var m=Za(),k=a(m,!0);t(m),_(()=>v(k,i.notes)),l(h,m)},$$slots:{default:!0}})}var es=n('<div class="ml-panel loading svelte-1xs394q"><p>Loading predictions...</p></div>'),ts=n('<div class="ml-panel error svelte-1xs394q"><p class="error-text svelte-1xs394q"> </p></div>'),as=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Predicted FG:</span> <span class="value svelte-1xs394q"> </span></div>'),ss=n('<span class="days svelte-1xs394q"> </span>'),rs=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Est. Completion:</span> <span class="value svelte-1xs394q"> <!></span></div>'),is=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Model Fit (R¬≤):</span> <div class="progress-wrapper svelte-1xs394q"><div class="progress-bar svelte-1xs394q"><div class="fill svelte-1xs394q"></div></div> <span class="percentage svelte-1xs394q"> </span></div></div>'),ls=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Readings:</span> <span class="value svelte-1xs394q"> </span></div>'),vs=n('<div class="ml-panel svelte-1xs394q"><div class="panel-header svelte-1xs394q"><h3 class="panel-title svelte-1xs394q">ML Predictions</h3> <button type="button" class="reload-btn svelte-1xs394q" title="Recalculate predictions from database history"> </button></div> <div class="metrics svelte-1xs394q"><!> <!> <!> <!></div></div>'),ns=n('<div class="ml-panel disabled svelte-1xs394q"><p class="unavailable-text svelte-1xs394q">ML predictions unavailable (insufficient data)</p></div>');function os(I,i){Ve(i,!0);let h=ge(St({available:!1})),w=ge(!0),m=ge(!1),k=ge(null);async function g(){f(w,!0),f(k,null);try{f(h,await ua(i.batchId),!0)}catch(o){f(k,o instanceof Error?o.message:"Failed to load predictions",!0),console.error("Failed to load ML predictions:",o)}finally{f(w,!1)}}async function r(){f(m,!0),f(k,null);try{const o=await _a(i.batchId);console.log("Reloaded predictions:",o.message),await g()}catch(o){f(k,o instanceof Error?o.message:"Failed to reload predictions",!0),console.error("Failed to reload predictions:",o)}finally{f(m,!1)}}qt(g);function B(o){return o?new Date(o).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}):"N/A"}function u(o){if(!o)return null;const R=new Date(o),F=new Date,x=R.getTime()-F.getTime();return Math.ceil(x/(1e3*60*60*24))}var L=ke(),V=Q(L);{var G=o=>{var R=es();l(o,R)},p=o=>{var R=ke(),F=Q(R);{var x=y=>{var b=ts(),z=a(b),K=a(z);t(z),t(b),_(()=>v(K,`‚ö†Ô∏è ${e(k)??""}`)),l(y,b)},j=y=>{var b=ke(),z=Q(b);{var K=U=>{var O=vs(),T=a(O),H=s(a(T),2);H.__click=r;var ve=a(H,!0);t(H),t(T);var ne=s(T,2),de=a(ne);{var fe=S=>{var q=as(),A=s(a(q),2),$=a(A,!0);t(A),t(q),_(ce=>v($,ce),[()=>rt(e(h).predicted_fg)]),l(S,q)};d(de,S=>{e(h).predicted_fg&&S(fe)})}var re=s(de,2);{var D=S=>{const q=P(()=>u(e(h).estimated_completion));var A=rs(),$=s(a(A),2),ce=a($),c=s(ce);{var M=N=>{var E=ss(),we=a(E);t(E),_(()=>v(we,`(${e(q)??""} ${e(q)===1?"day":"days"})`)),l(N,E)};d(c,N=>{e(q)!==null&&N(M)})}t($),t(A),_(N=>v(ce,`${N??""} `),[()=>B(e(h).estimated_completion)]),l(S,A)};d(re,S=>{e(h).estimated_completion&&S(D)})}var W=s(re,2);{var ae=S=>{var q=is(),A=s(a(q),2),$=a(A),ce=a($);t($);var c=s($,2),M=a(c);t(c),t(A),t(q),_(N=>{Ke(ce,`width: ${e(h).r_squared*100}%`),v(M,`${N??""}%`)},[()=>(e(h).r_squared*100).toFixed(0)]),l(S,q)};d(W,S=>{e(h).r_squared!==void 0&&S(ae)})}var Oe=s(W,2);{var Re=S=>{var q=ls(),A=s(a(q),2),$=a(A);t(A),t(q),_(()=>v($,`${e(h).num_readings??""} points`)),l(S,q)};d(Oe,S=>{e(h).num_readings&&S(Re)})}t(ne),t(O),_(()=>{H.disabled=e(m)||e(w),v(ve,e(m)?"Reloading...":"‚Üª Reload")}),l(U,O)},ee=U=>{var O=ns();l(U,O)};d(z,U=>{e(h).available?U(K):U(ee,!1)},!0)}l(y,b)};d(F,y=>{e(k)?y(x):y(j,!1)},!0)}l(o,R)};d(V,o=>{e(w)?o(G):o(p,!1)})}l(I,L),He()}st(["click"]);var ds=n('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),cs=n('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),us=n('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),_s=n('<span class="recipe-type svelte-g5au2j"> </span>'),gs=n('<a class="recipe-link svelte-g5au2j"> <!></a>'),fs=n('<option class="svelte-g5au2j"> </option>'),ps=n('<span class="chilling-icon svelte-g5au2j">üç∫</span> <h3 class="chilling-title svelte-g5au2j">Ready to Pitch!</h3>',1),ms=n('<span class="chilling-icon svelte-g5au2j">‚ùÑÔ∏è</span> <h3 class="chilling-title svelte-g5au2j">Chilling to Pitch Temperature</h3>',1),bs=n('<div class="progress-section svelte-g5au2j"><div class="progress-bar svelte-g5au2j"><div class="progress-fill svelte-g5au2j"></div></div> <span class="progress-text svelte-g5au2j"> </span></div>'),hs=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è No cooler configured - set a cooler entity to enable automated chilling</span>'),js=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è Temperature control disabled in settings</span>'),ys=n('<span class="status-ready svelte-g5au2j">Wort has reached pitch temperature - ready to add yeast!</span>'),xs=n('<span class="status-active svelte-g5au2j">Cooler will run automatically when temp exceeds target + hysteresis</span>'),ks=n('<div><div class="chilling-header svelte-g5au2j"><!></div> <div class="chilling-content svelte-g5au2j"><div class="temp-display svelte-g5au2j"><div class="temp-current svelte-g5au2j"><span class="temp-label svelte-g5au2j">Current</span> <span class="temp-value svelte-g5au2j"> </span></div> <div class="temp-arrow svelte-g5au2j">‚Üí</div> <div class="temp-target svelte-g5au2j"><span class="temp-label svelte-g5au2j">Target</span> <span class="temp-value svelte-g5au2j"> </span></div></div> <!> <div class="chilling-status svelte-g5au2j"><!></div></div></div>'),ws=n('<div class="device-status heater svelte-g5au2j"><div>üî•</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Heater</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),zs=n('<div class="device-status cooler svelte-g5au2j"><div>‚ùÑÔ∏è</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Cooler</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Rs=n('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">‚ö°</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),Cs=n('<button type="button" class="override-btn heat-on svelte-g5au2j">Force Heat ON</button> <button type="button" class="override-btn heat-off svelte-g5au2j">Force Heat OFF</button>',1),Fs=n('<button type="button" class="override-btn cool-on svelte-g5au2j">Force Cool ON</button> <button type="button" class="override-btn cool-off svelte-g5au2j">Force Cool OFF</button>',1),Ts=n('<div class="control-details svelte-g5au2j"><div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns-grid svelte-g5au2j"><!> <!> <button type="button" class="override-btn auto-mode svelte-g5au2j">Auto Mode</button></div></div>',1),Bs=n('<div><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="device-status-grid svelte-g5au2j"><!> <!></div> <!></div>'),Ss=n('<span class="svelte-g5au2j"> </span>'),qs=n('<span class="svelte-g5au2j"> </span>'),Ms=n('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><!> <!> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),Ps=n('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j" aria-label="Delete batch"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <!> <div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!> <!></div></div>',1),Ds=n('<div class="modal-overlay svelte-g5au2j"><div class="modal svelte-g5au2j"><h2 class="modal-title svelte-g5au2j">Delete Batch?</h2> <p class="modal-text svelte-g5au2j"> </p> <div class="modal-actions svelte-g5au2j"><button type="button" class="modal-btn cancel svelte-g5au2j">Cancel</button> <button type="button" class="modal-btn delete svelte-g5au2j"> </button></div></div></div>'),Ls=n('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div> <!>',1);function ar(I,i){Ve(i,!0);const h=()=>oa(da,"$page",w),[w,m]=na();let k=null,g=null,r=ge(null),B=ge(null),u=ge(null);St([]);let L=ge(!0),V=ge(null),G=ge(!1),p=ge(!1),o=ge(!1),R=ge(!1),F=ge(!1),x=P(()=>parseInt(h().params.id??"0"));const j={planning:{label:"Planning",color:"var(--text-secondary)",bg:"var(--bg-elevated)"},fermenting:{label:"Fermenting",color:"#f59e0b",bg:"rgba(245, 158, 11, 0.12)"},conditioning:{label:"Conditioning",color:"#8b5cf6",bg:"rgba(139, 92, 246, 0.12)"},completed:{label:"Completed",color:"var(--positive)",bg:"rgba(34, 197, 94, 0.12)"},archived:{label:"Archived",color:"var(--text-muted)",bg:"var(--bg-elevated)"}},y=["planning","fermenting","conditioning","completed","archived"];let b=P(()=>e(r)?j[e(r).status]:j.planning),z=P(Lt),K=P(()=>at.config.ha_enabled&&at.config.temp_control_enabled&&(e(r)?.heater_entity_id||e(r)?.cooler_entity_id)),ee=P(()=>e(r)?.status==="planning"&&e(r)?.temp_target!=null),U=P(()=>!e(ee)||!e(T)?.temp||!e(r)?.temp_target?!1:e(T).temp<=e(r).temp_target),O=P(()=>{if(!e(ee)||!e(T)?.temp||!e(r)?.temp_target)return null;const c=e(r).temp_target+30,M=e(T).temp,N=e(r).temp_target;if(M<=N)return 100;if(M>=c)return 0;const E=(c-M)/(c-N)*100;return Math.min(100,Math.max(0,E))}),T=P(()=>{if(!e(r)?.device_id)return null;const c=Bt.tilts.get(e(r).device_id);if(c)return c;const M=e(r).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!M?.[1])return null;const N=M[1].toUpperCase();for(const E of Bt.tilts.values())if(E.color&&E.color.toUpperCase()===N)return E;return null});async function H(){f(L,!0),f(V,null);try{if(f(r,await ga(e(x)),!0),e(r).status==="fermenting"||e(r).status==="conditioning")try{f(B,await Ft(e(x)),!0)}catch{}if(e(r).heater_entity_id||e(r).cooler_entity_id)try{f(u,await tt(e(x)),!0)}catch{}}catch(c){f(V,c instanceof Error?c.message:"Failed to load batch",!0)}finally{f(L,!1)}}async function ve(c){if(!(!e(r)||e(p))&&!(c==="conditioning"&&e(r).status==="fermenting"&&!confirm(`üí° Entering Conditioning Phase

Reminder: Adjust target temperature if cold crashing.
Temperature control will continue during conditioning.

Continue?`))){f(p,!0);try{f(r,await Tt(e(r).id,{status:c}),!0),(c==="fermenting"||c==="conditioning")&&f(B,await Ft(e(r).id),!0)}catch(M){console.error("Failed to update status:",M)}finally{f(p,!1)}}}async function ne(c){if(e(r)&&(f(r,await Tt(e(r).id,c),!0),f(G,!1),e(r).heater_entity_id||e(r).cooler_entity_id))try{f(u,await tt(e(r).id),!0)}catch{}}async function de(){if(e(r)){f(F,!0);try{await fa(e(r).id),ca("/batches")}catch(c){f(V,c instanceof Error?c.message:"Failed to delete batch",!0),f(F,!1),f(R,!1)}}}async function fe(c,M){if(!(!e(r)||e(o))){f(o,!0);try{await ut(e(r).id,M,60,c),f(u,await tt(e(r).id),!0)}catch(N){console.error("Failed to set override:",N)}finally{f(o,!1)}}}async function re(){if(!(!e(r)||e(o))){f(o,!0);try{e(r).heater_entity_id&&await ut(e(r).id,null,60,"heater"),e(r).cooler_entity_id&&await ut(e(r).id,null,60,"cooler"),f(u,await tt(e(r).id),!0)}catch(c){console.error("Failed to clear overrides:",c)}finally{f(o,!1)}}}function D(){if(k?.readyState===WebSocket.OPEN)return;const M=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;k=new WebSocket(M),k.onmessage=async N=>{try{const E=JSON.parse(N.data);E.type==="control_event"&&E.batch_id===e(x)&&e(u)&&(E.action==="heat_on"?f(u,{...e(u),heater_state:"on"},!0):E.action==="heat_off"?f(u,{...e(u),heater_state:"off"},!0):E.action==="cool_on"?f(u,{...e(u),cooler_state:"on"},!0):E.action==="cool_off"&&f(u,{...e(u),cooler_state:"off"},!0))}catch{}},k.onclose=()=>{k=null,g=setTimeout(D,3e3)},k.onerror=()=>{k?.close()}}function W(){g&&(clearTimeout(g),g=null),k?.close(),k=null}function ae(c){return c==null?"--":Gt(c)}qt(()=>{H(),D()}),aa(()=>{W()});var Oe=Ls();ia("g5au2j",c=>{sa(()=>{ra.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var Re=Q(Oe),S=s(a(Re),2);{var q=c=>{var M=ds();l(c,M)},A=c=>{var M=ke(),N=Q(M);{var E=pe=>{var ye=cs(),xe=s(a(ye),2),Xe=a(xe,!0);t(xe);var Ze=s(xe,2);Ze.__click=H,t(ye),_(()=>v(Xe,e(V))),l(pe,ye)},we=pe=>{var ye=ke(),xe=Q(ye);{var Xe=We=>{var et=us();l(We,et)},Ze=We=>{var et=ke(),At=Q(et);{var Et=Je=>{ma(Je,{get batch(){return e(r)},onSubmit:ne,onCancel:()=>f(G,!1)})},Ut=Je=>{var gt=Ps(),it=Q(gt),lt=a(it),vt=a(lt),Nt=a(vt);t(vt);var ft=s(vt,2),nt=a(ft),It=a(nt,!0);t(nt);var Vt=s(nt,2);{var Ht=C=>{var J=gs(),te=a(J),me=s(te);{var be=ze=>{var Ce=_s(),qe=a(Ce);t(Ce),_(()=>v(qe,`(${e(r).recipe.type??""})`)),l(ze,Ce)};d(me,ze=>{e(r).recipe.type&&ze(be)})}t(J),_(()=>{Dt(J,"href",`/recipes/${e(r).recipe.id??""}`),v(te,`${e(r).recipe.name??""} `)}),l(C,J)};d(Vt,C=>{e(r).recipe&&C(Ht)})}t(ft),t(lt);var pt=s(lt,2),ot=a(pt),Se=a(ot);Se.__change=C=>ve(C.currentTarget.value),Mt(Se,21,()=>y,Pt,(C,J)=>{var te=fs(),me=a(te,!0);t(te);var be={};_(()=>{v(me,j[e(J)].label),be!==(be=e(J))&&(te.value=(te.__value=e(J))??"")}),l(C,te)}),t(Se);var mt;la(Se),t(ot);var bt=s(ot,2);bt.__click=()=>f(G,!0);var Wt=s(bt,2);Wt.__click=()=>f(R,!0),t(pt),t(it);var ht=s(it,2);{var Jt=C=>{var J=ks();let te;var me=a(J),be=a(me);{var ze=Y=>{var se=ps();Ge(2),l(Y,se)},Ce=Y=>{var se=ms();Ge(2),l(Y,se)};d(be,Y=>{e(U)?Y(ze):Y(Ce,!1)})}t(me);var qe=s(me,2),Ue=a(qe),Ne=a(Ue),ie=s(a(Ne),2),X=a(ie,!0);t(ie),t(Ne);var Z=s(Ne,4),le=s(a(Z),2),Fe=a(le,!0);t(le),t(Z),t(Ue);var ue=s(Ue,2);{var Te=Y=>{var se=bs(),Ee=a(se),$e=a(Ee);t(Ee);var Ie=s(Ee,2),Be=a(Ie);t(Ie),t(se),_(De=>{Ke($e,`width: ${e(O)??""}%`),v(Be,`${De??""}% to target`)},[()=>Math.round(e(O))]),l(Y,se)};d(ue,Y=>{e(O)!=null&&!e(U)&&Y(Te)})}var Me=s(ue,2),Pe=a(Me);{var Ae=Y=>{var se=hs();l(Y,se)},ct=Y=>{var se=ke(),Ee=Q(se);{var $e=Be=>{var De=js();l(Be,De)},Ie=Be=>{var De=ke(),oe=Q(De);{var he=_e=>{var Ye=ys();l(_e,Ye)},je=_e=>{var Ye=xs();l(_e,Ye)};d(oe,_e=>{e(U)?_e(he):_e(je,!1)},!0)}l(Be,De)};d(Ee,Be=>{!at.config.ha_enabled||!at.config.temp_control_enabled?Be($e):Be(Ie,!1)},!0)}l(Y,se)};d(Pe,Y=>{e(r).cooler_entity_id?Y(ct,!1):Y(Ae)})}t(Me),t(qe),t(J),_((Y,se)=>{te=Le(J,1,"chilling-banner svelte-g5au2j",null,te,{ready:e(U)}),v(X,Y),v(Fe,se)},[()=>e(T)?.temp!=null?ae(e(T).temp):"--",()=>e(r).temp_target!=null?ae(e(r).temp_target):"--"]),l(C,J)};d(ht,C=>{e(ee)&&C(Jt)})}var jt=s(ht,2),dt=a(jt),yt=a(dt);{var Yt=C=>{{let J=P(()=>e(B)?.measured?.current_sg),te=P(()=>e(B)?.temperature?.current);Ta(C,{get liveReading(){return e(T)},get currentSg(){return e(J)},get currentTemp(){return e(te)}})}};d(yt,C=>{(e(T)||e(B)?.measured?.current_sg!=null)&&C(Yt)})}var xt=s(yt,2);{let C=P(()=>e(T)?.sg??e(B)?.measured?.current_sg);La(xt,{get batch(){return e(r)},get currentSg(){return e(C)},get progress(){return e(B)}})}var Kt=s(xt,2);{var Qt=C=>{Xa(C,{get recipe(){return e(r).recipe}})};d(Kt,C=>{e(r).recipe&&C(Qt)})}t(dt);var kt=s(dt,2),wt=a(kt);Oa(wt,{get batch(){return e(r)}});var zt=s(wt,2);Ja(zt,{get batch(){return e(r)},get liveReading(){return e(T)},onEdit:()=>f(G,!0)});var Rt=s(zt,2);os(Rt,{get batchId(){return e(r).id}});var Ct=s(Rt,2);{var Xt=C=>{var J=Bs();let te;var me=s(a(J),2),be=a(me);{var ze=ie=>{var X=ws(),Z=a(X);let le;var Fe=s(Z,2),ue=s(a(Fe),2);let Te;var Me=a(ue,!0);t(ue);var Pe=s(ue,2),Ae=a(Pe,!0);t(Pe),t(Fe),t(X),_(()=>{le=Le(Z,1,"device-icon-wrap svelte-g5au2j",null,le,{active:e(u)?.heater_state==="on"}),Te=Le(ue,1,"device-state svelte-g5au2j",null,Te,{on:e(u)?.heater_state==="on"}),v(Me,e(u)?.heater_state==="on"?"ON":"OFF"),v(Ae,e(r).heater_entity_id)}),l(ie,X)};d(be,ie=>{e(r).heater_entity_id&&ie(ze)})}var Ce=s(be,2);{var qe=ie=>{var X=zs(),Z=a(X);let le;var Fe=s(Z,2),ue=s(a(Fe),2);let Te;var Me=a(ue,!0);t(ue);var Pe=s(ue,2),Ae=a(Pe,!0);t(Pe),t(Fe),t(X),_(()=>{le=Le(Z,1,"device-icon-wrap svelte-g5au2j",null,le,{active:e(u)?.cooler_state==="on"}),Te=Le(ue,1,"device-state svelte-g5au2j",null,Te,{on:e(u)?.cooler_state==="on"}),v(Me,e(u)?.cooler_state==="on"?"ON":"OFF"),v(Ae,e(r).cooler_entity_id)}),l(ie,X)};d(Ce,ie=>{e(r).cooler_entity_id&&ie(qe)})}t(me);var Ue=s(me,2);{var Ne=ie=>{var X=Ts(),Z=Q(X),le=a(Z),Fe=s(a(le),2),ue=a(Fe);t(Fe),t(le);var Te=s(le,2),Me=s(a(Te),2),Pe=a(Me);t(Me),t(Te),t(Z);var Ae=s(Z,2);{var ct=oe=>{var he=Rs(),je=s(a(he),2),_e=a(je);t(je);var Ye=s(je,2);Ye.__click=()=>re(),t(he),_(ta=>{v(_e,`Override active: ${ta??""}`),Ye.disabled=e(o)},[()=>e(u).override_state?.toUpperCase()]),l(oe,he)};d(Ae,oe=>{e(u).override_active&&oe(ct)})}var Y=s(Ae,2),se=s(a(Y),2),Ee=a(se);{var $e=oe=>{var he=Cs(),je=Q(he);je.__click=()=>fe("heater","on");var _e=s(je,2);_e.__click=()=>fe("heater","off"),_(()=>{je.disabled=e(o),_e.disabled=e(o)}),l(oe,he)};d(Ee,oe=>{e(r).heater_entity_id&&oe($e)})}var Ie=s(Ee,2);{var Be=oe=>{var he=Fs(),je=Q(he);je.__click=()=>fe("cooler","on");var _e=s(je,2);_e.__click=()=>fe("cooler","off"),_(()=>{je.disabled=e(o),_e.disabled=e(o)}),l(oe,he)};d(Ie,oe=>{e(r).cooler_entity_id&&oe(Be)})}var De=s(Ie,2);De.__click=()=>re(),t(se),t(Y),_((oe,he)=>{v(ue,`${oe??""}${e(z)??""}`),v(Pe,`¬±${he??""}${e(z)??""}`),De.disabled=e(o)},[()=>ae(e(u).target_temp),()=>e(u).hysteresis?.toFixed(1)||"--"]),l(ie,X)};d(Ue,ie=>{e(u)&&ie(Ne)})}t(J),_(()=>te=Le(J,1,"info-card temp-control-card svelte-g5au2j",null,te,{"heater-on":e(u)?.heater_state==="on","cooler-on":e(u)?.cooler_state==="on"})),l(C,J)},Zt=C=>{var J=ke(),te=Q(J);{var me=be=>{var ze=Ms(),Ce=s(a(ze),2),qe=a(Ce);{var Ue=X=>{var Z=Ss(),le=a(Z);t(Z),_(()=>v(le,`Heater: ${e(r).heater_entity_id??""}`)),l(X,Z)};d(qe,X=>{e(r).heater_entity_id&&X(Ue)})}var Ne=s(qe,2);{var ie=X=>{var Z=qs(),le=a(Z);t(Z),_(()=>v(le,`Cooler: ${e(r).cooler_entity_id??""}`)),l(X,Z)};d(Ne,X=>{e(r).cooler_entity_id&&X(ie)})}Ge(2),t(Ce),t(ze),l(be,ze)};d(te,be=>{(e(r).heater_entity_id||e(r).cooler_entity_id)&&e(r).status!=="fermenting"&&be(me)},!0)}l(C,J)};d(Ct,C=>{e(K)&&(e(r).status==="fermenting"||e(r).status==="conditioning")?C(Xt):C(Zt,!1)})}var $t=s(Ct,2);{var ea=C=>{$a(C,{get notes(){return e(r).notes}})};d($t,C=>{e(r).notes&&C(ea)})}t(kt),t(jt),_(()=>{v(Nt,`#${(e(r).batch_number||"?")??""}`),v(It,e(r).name||e(r).recipe?.name||"Unnamed Batch"),Se.disabled=e(p),Ke(Se,`color: ${e(b).color??""}; background: ${e(b).bg??""};`),mt!==(mt=e(r).status)&&(Se.value=(Se.__value=e(r).status)??"",va(Se,e(r).status))}),l(Je,gt)};d(At,Je=>{e(G)?Je(Et):Je(Ut,!1)},!0)}l(We,et)};d(xe,We=>{e(r)?We(Ze,!1):We(Xe)},!0)}l(pe,ye)};d(N,pe=>{e(V)?pe(E):pe(we,!1)},!0)}l(c,M)};d(S,c=>{e(L)?c(q):c(A,!1)})}t(Re);var $=s(Re,2);{var ce=c=>{var M=Ds();M.__click=()=>f(R,!1);var N=a(M);N.__click=Ze=>Ze.stopPropagation();var E=s(a(N),2),we=a(E);t(E);var pe=s(E,2),ye=a(pe);ye.__click=()=>f(R,!1);var xe=s(ye,2);xe.__click=de;var Xe=a(xe,!0);t(xe),t(pe),t(N),t(M),_(()=>{v(we,`Are you sure you want to delete "${(e(r)?.name||"this batch")??""}"? This cannot be undone.`),ye.disabled=e(F),xe.disabled=e(F),v(Xe,e(F)?"Deleting...":"Delete Batch")}),l(c,M)};d($,c=>{e(R)&&c(ce)})}l(I,Oe),He(),m()}st(["click","change"]);export{ar as component,tr as universal};
