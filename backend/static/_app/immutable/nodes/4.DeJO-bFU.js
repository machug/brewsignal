import{d as kt,f as n,s as o,a as i,c as Re,t as Ht}from"../chunks/CsQfwH0S.js";import{al as a,ak as s,an as t,ar as c,ah as mt,at as Q,c as e,ai as z,as as ke,aj as ht,aq as ye,p as Kt,ao as Qt,s as _,aL as _a,ay as ga,am as pa}from"../chunks/fKkNMI8q.js";import{e as Xt,i as Zt}from"../chunks/COk1ZY4R.js";import{i as d}from"../chunks/BvBRaQNg.js";import{h as fa}from"../chunks/DLseniaC.js";import{s as ft}from"../chunks/DbN3nGCc.js";import{s as Ae}from"../chunks/BDI2zAFW.js";import{s as Qe}from"../chunks/CcRNvR1k.js";import{i as ma,s as ha}from"../chunks/C8srtpii.js";import{s as ba,a as xa}from"../chunks/C51ud8ec.js";import{p as ja}from"../chunks/BAnr8q-R.js";import{g as ya}from"../chunks/oCR4yVQp.js";import{z as ka,A as wa,q as za,j as Wt,B as jt,k as qa,x as Jt,C as Ft}from"../chunks/i8VL_lOf.js";import{d as bt,e as $t,g as ea,c as yt}from"../chunks/CPwbAm-l.js";import{t as Yt}from"../chunks/C8NDSE1R.js";import{B as Ca}from"../chunks/DTfC6M4H.js";import{s as Ra}from"../chunks/Bdaed-dN.js";import{p as dt}from"../chunks/CllCHKBI.js";const Fa=!1,xr=Object.freeze(Object.defineProperty({__proto__:null,prerender:Fa},Symbol.toStringTag,{value:"Module"}));function Ba($){return $>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:$>=-60?{bars:3,color:"var(--positive)",label:"Good"}:$>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function ta($){const l=Math.floor((Date.now()-new Date($).getTime())/1e3);if(l<10)return"just now";if(l<60)return`${l}s ago`;const T=Math.floor(l/60);if(T<60)return`${T}m ago`;const P=Math.floor(T/60);return P<24?`${P}h ago`:`${Math.floor(P/24)}d ago`}var Ta=n('<div class="accent-bar svelte-1oyrwd9"></div>'),Ma=n('<span class="card-icon svelte-1oyrwd9"> </span>'),Da=n('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),Sa=n('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function xt($,l){let T=dt(l,"highlight",3,!1),P=dt(l,"compact",3,!1),x=dt(l,"collapsible",3,!1),p=dt(l,"expanded",3,!1);var q=Sa();let r;var F=a(q);{var g=b=>{var v=Ta();i(b,v)};d(F,b=>{T()&&b(g)})}var C=s(F,2),X=a(C),le=a(X);{var f=b=>{var v=Ma(),j=a(v,!0);t(v),c(()=>o(j,l.icon)),i(b,v)};d(le,b=>{l.icon&&b(f)})}var w=s(le,2),L=a(w,!0);t(w),t(X);var N=s(X,2);{var I=b=>{var v=Da();v.__click=function(...Y){l.onToggle?.apply(this,Y)};var j=a(v);let R;t(v),c(()=>{ft(v,"aria-label",p()?"Collapse":"Expand"),R=Ae(j,0,"expand-icon svelte-1oyrwd9",null,R,{"rotate-180":p()})}),i(b,v)};d(N,b=>{x()&&l.onToggle&&b(I)})}t(C);var V=s(C,2);let G;var J=a(V);Ra(J,()=>l.children),t(V),t(q),c(()=>{r=Ae(q,1,"batch-card svelte-1oyrwd9",null,r,{highlight:T(),compact:P()}),o(L,l.title),G=Ae(V,1,"card-content svelte-1oyrwd9",null,G,{collapsed:x()&&!p()})}),i($,q)}kt(["click"]);var Oa=n('<span class="updated-text svelte-t80j9z"> </span>'),Pa=n('<div class="hero-divider svelte-t80j9z"></div> <div class="hero-metric temperature svelte-t80j9z"><span class="hero-value svelte-t80j9z"> <span class="hero-unit svelte-t80j9z"> </span></span> <span class="hero-label svelte-t80j9z">Temperature</span></div>',1),Aa=n('<div class="remaining-text svelte-t80j9z"> </div>'),Ga=n('<div class="progress-section svelte-t80j9z"><div class="progress-labels svelte-t80j9z"><div class="progress-endpoint start svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">OG</span></div> <div class="progress-current svelte-t80j9z"><span class="current-percent svelte-t80j9z"> </span></div> <div class="progress-endpoint end svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">Target FG</span></div></div> <div class="progress-track svelte-t80j9z"><div class="progress-fill svelte-t80j9z"></div> <div><div class="marker-dot svelte-t80j9z"></div> <div class="marker-value svelte-t80j9z"> </div></div></div> <!></div>'),Ea=n('<div class="metrics-row svelte-t80j9z"><div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">ABV</span></div> <div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">Attenuation</span></div></div>'),La=n('<div class="status-row svelte-t80j9z"><div class="live-indicator svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> <span class="status-text svelte-t80j9z">LIVE</span></div> <!></div> <div class="hero-section svelte-t80j9z"><div class="hero-metric gravity svelte-t80j9z"><span class="hero-value svelte-t80j9z"> </span> <span class="hero-label svelte-t80j9z">Gravity</span></div> <!></div> <!> <!>',1),Na=n('<div class="completed-grid svelte-t80j9z"><div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Original Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Final Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">ABV</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Attenuation</span></div></div>'),Ua=n('<div class="empty-state svelte-t80j9z"><div class="empty-icon svelte-t80j9z">‚óé</div> <p class="empty-text svelte-t80j9z">Set Original Gravity to track fermentation</p></div>');function Ia($,l){mt(l,!0);let T=z(()=>l.currentSg??l.progress?.measured?.current_sg),P=z(()=>l.liveReading?.temp??l.progress?.temperature?.current),x=z(()=>l.liveReading?.last_seen),p=z(()=>e(x)?ta(e(x)):null),q=z(ea),r=z(()=>{if(!l.batch.measured_og||!e(T))return null;const f=Math.max(0,(l.batch.measured_og-e(T))*131.25),w=l.batch.measured_og-1,L=w!==0?Math.max(0,Math.min(100,(l.batch.measured_og-e(T))/w*100)):0;return{abv:f,attenuation:L}}),F=z(()=>{const f=l.batch.measured_og,w=l.batch.recipe?.fg;if(!f||!w||!e(T))return null;const L=f-w,N=f-e(T);return L<=0?null:Math.max(0,Math.min(100,N/L*100))}),g=z(()=>l.batch.status==="fermenting"||l.batch.status==="conditioning");function C(f){return f==null?"--":bt(f)}function X(f){return f==null?"--":`${f.toFixed(1)}%`}function le(f){return f==null?"--":$t(f)}xt($,{title:"Fermentation",children:(f,w)=>{var L=Re(),N=Q(L);{var I=G=>{var J=La(),b=Q(J),v=s(a(b),2);{var j=M=>{var D=Oa(),k=a(D);t(D),c(()=>o(k,`Updated ${e(p)??""}`)),i(M,D)};d(v,M=>{e(p)&&M(j)})}t(b);var R=s(b,2),Y=a(R),pe=a(Y),E=a(pe,!0);t(pe),ke(2),t(Y);var fe=s(Y,2);{var we=M=>{var D=Pa(),k=s(Q(D),2),K=a(k),H=a(K,!0),ee=s(H),ne=a(ee,!0);t(ee),t(K),ke(2),t(k),c(ce=>{o(H,ce),o(ne,e(q))},[()=>le(e(P))]),i(M,D)};d(fe,M=>{e(P)!=null&&M(we)})}t(R);var ie=s(R,2);{var me=M=>{var D=Ga(),k=a(D),K=a(k),H=a(K),ee=a(H,!0);t(H),ke(2),t(K);var ne=s(K,2),ce=a(ne),Ge=a(ce);t(ce),t(ne);var he=s(ne,2),u=a(he),y=a(u,!0);t(u),ke(2),t(he),t(k);var U=s(k,2),O=a(U),Se=s(O,2);let ve;var oe=s(a(Se),2),ue=a(oe,!0);t(oe),t(Se),t(U);var Ve=s(U,2);{var He=m=>{var h=Aa(),A=a(h);t(h),c(se=>o(A,`${se??""} points to go`),[()=>l.progress.progress.sg_remaining.toFixed(3)]),i(m,h)};d(Ve,m=>{l.progress?.progress?.sg_remaining!=null&&l.progress.progress.sg_remaining>0&&m(He)})}t(D),c((m,h,A,se)=>{o(ee,m),o(Ge,`${h??""}%`),o(y,A),Qe(O,`width: ${e(F)??""}%`),ve=Ae(Se,1,"progress-marker svelte-t80j9z",null,ve,{"at-start":e(F)<3}),Qe(Se,`left: ${e(F)??""}%`),o(ue,se)},[()=>C(l.batch.measured_og),()=>e(F).toFixed(0),()=>C(l.batch.recipe.fg),()=>C(e(T))]),i(M,D)};d(ie,M=>{e(F)!==null&&l.batch.measured_og&&l.batch.recipe?.fg&&M(me)})}var Z=s(ie,2);{var de=M=>{var D=Ea(),k=a(D),K=a(k),H=a(K,!0);t(K),ke(2),t(k);var ee=s(k,2),ne=a(ee),ce=a(ne,!0);t(ne),ke(2),t(ee),t(D),c((Ge,he)=>{o(H,Ge),o(ce,he)},[()=>X(e(r).abv),()=>X(e(r).attenuation)]),i(M,D)};d(Z,M=>{e(r)&&M(de)})}c(M=>o(E,M),[()=>C(e(T))]),i(G,J)},V=G=>{var J=Re(),b=Q(J);{var v=R=>{var Y=Na(),pe=a(Y),E=a(pe),fe=a(E,!0);t(E),ke(2),t(pe);var we=s(pe,2),ie=a(we),me=a(ie,!0);t(ie),ke(2),t(we);var Z=s(we,2),de=a(Z),M=a(de,!0);t(de),ke(2),t(Z);var D=s(Z,2),k=a(D),K=a(k,!0);t(k),ke(2),t(D),t(Y),c((H,ee,ne,ce)=>{o(fe,H),o(me,ee),o(M,ne),o(K,ce)},[()=>C(l.batch.measured_og),()=>C(l.batch.measured_fg),()=>l.batch.measured_abv!=null?X(l.batch.measured_abv):"--",()=>l.batch.measured_attenuation!=null?X(l.batch.measured_attenuation):"--"]),i(R,Y)},j=R=>{var Y=Ua();i(R,Y)};d(b,R=>{l.batch.measured_og?R(v):R(j,!1)},!0)}i(G,J)};d(N,G=>{e(T)&&e(g)?G(I):G(V,!1)})}i(f,L)},$$slots:{default:!0}}),ht()}var Va=n('<div class="timeline svelte-yskb8i"><div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Brew Date</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Started</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Ended</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Created</span> <span class="timeline-value svelte-yskb8i"> </span></div></div>');function Ha($,l){mt(l,!0);function T(x){return x?new Date(x).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"}):"--"}function P(x){return x?new Date(x).toLocaleString("en-GB",{day:"numeric",month:"short",hour:"numeric",minute:"2-digit"}):"--"}xt($,{title:"Timeline",children:(x,p)=>{var q=Va(),r=a(q),F=s(a(r),2),g=a(F,!0);t(F),t(r);var C=s(r,2),X=s(a(C),2),le=a(X,!0);t(X),t(C);var f=s(C,2),w=s(a(f),2),L=a(w,!0);t(w),t(f);var N=s(f,2),I=s(a(N),2),V=a(I,!0);t(I),t(N),t(q),c((G,J,b,v)=>{o(g,G),o(le,J),o(L,b),o(V,v)},[()=>T(l.batch.brew_date),()=>P(l.batch.start_time),()=>P(l.batch.end_time),()=>P(l.batch.created_at)]),i(x,q)},$$slots:{default:!0}}),ht()}var Wa=n('<span class="device-last-seen svelte-1kdxwtz"> </span>'),Ja=n('<div class="signal-bar svelte-1kdxwtz"></div>'),Ya=n('<div class="metric-item svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="metric-text svelte-1kdxwtz"> </span></div>'),Ka=n('<div class="metric-item battery svelte-1kdxwtz"><svg class="battery-icon svelte-1kdxwtz" viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="2" y="7" width="18" height="10" rx="2"></rect><rect x="4" y="9" height="6" stroke="none" rx="1"></rect><path d="M20 10v4h2v-4z" stroke="none"></path></svg> <span class="metric-text svelte-1kdxwtz"><!></span></div>'),Qa=n('<div class="device-metrics svelte-1kdxwtz"><!> <!></div>'),Xa=n('<div class="device-row svelte-1kdxwtz"><div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!></div> <!>',1),Za=n('<div class="device-row svelte-1kdxwtz"><div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <span class="device-last-seen svelte-1kdxwtz">No data</span></div>'),$a=n('<div class="device-info svelte-1kdxwtz"><!></div>'),es=n('<button type="button" class="link-btn svelte-1kdxwtz">Link device</button>'),ts=n('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function as($,l){mt(l,!0);let T=z(()=>l.liveReading?.device_type==="tilt"),P=z(()=>e(T)&&l.liveReading?.rssi?Ba(l.liveReading.rssi):null),x=z(()=>l.liveReading?.last_seen?ta(l.liveReading.last_seen):null),p=z(()=>l.liveReading?.battery_percent!=null||l.liveReading?.battery_voltage!=null),q=z(()=>l.liveReading?.battery_percent),r=z(()=>l.liveReading?.battery_voltage),F=z(()=>e(q)?e(q)>50?"var(--positive)":e(q)>20?"#f59e0b":"var(--negative)":"var(--text-muted)"),g=z(()=>{if(!l.liveReading)return l.batch.device_id||"Unknown";const C=l.liveReading.device_type;return C==="tilt"?`${l.liveReading.color} Tilt`:C==="gravitymon"?`GravityMon (${l.liveReading.id})`:C==="ispindel"?`iSpindel (${l.liveReading.id})`:C==="floaty"?`Floaty (${l.liveReading.id})`:l.liveReading.color||l.liveReading.id});xt($,{title:"Tracking Device",compact:!0,children:(C,X)=>{var le=Re(),f=Q(le);{var w=N=>{var I=$a(),V=a(I);{var G=b=>{var v=Xa(),j=Q(v),R=a(j),Y=s(a(R));t(R);var pe=s(R,2);{var E=ie=>{var me=Wa(),Z=a(me,!0);t(me),c(()=>o(Z,e(x))),i(ie,me)};d(pe,ie=>{e(x)&&ie(E)})}t(j);var fe=s(j,2);{var we=ie=>{var me=Qa(),Z=a(me);{var de=k=>{var K=Ya(),H=a(K);Xt(H,20,()=>Array(4),Zt,(ce,Ge,he)=>{var u=Ja();c(()=>Qe(u,`height: ${4+he*2}px; background: ${(he<e(P).bars?e(P).color:"var(--bg-hover)")??""}; opacity: ${he<e(P).bars?1:.4};`)),i(ce,u)}),t(H);var ee=s(H,2),ne=a(ee);t(ee),t(K),c(()=>{Qe(ee,`color: ${e(P).color??""}`),o(ne,`${l.liveReading.rssi??""}dBm`)}),i(k,K)};d(Z,k=>{e(P)&&k(de)})}var M=s(Z,2);{var D=k=>{var K=Ka(),H=a(K),ee=s(a(H)),ne=s(ee);t(H);var ce=s(H,2),Ge=a(ce);{var he=y=>{var U=Ht();c(O=>o(U,`${O??""}%`),[()=>e(q).toFixed(0)]),i(y,U)},u=y=>{var U=Re(),O=Q(U);{var Se=ve=>{var oe=Ht();c(ue=>o(oe,`${ue??""}V`),[()=>e(r).toFixed(2)]),i(ve,oe)};d(O,ve=>{e(r)!=null&&ve(Se)},!0)}i(y,U)};d(Ge,y=>{e(q)!=null?y(he):y(u,!1)})}t(ce),t(K),c(()=>{ft(H,"stroke",e(F)),ft(ee,"width",(e(q)??50)*.14),ft(ee,"fill",e(F)),ft(ne,"fill",e(F)),Qe(ce,`color: ${e(F)??""}`)}),i(k,K)};d(M,k=>{e(p)&&k(D)})}t(me),i(ie,me)};d(fe,ie=>{(e(P)||e(p))&&ie(we)})}c(()=>o(Y,` ${e(g)??""}`)),i(b,v)},J=b=>{var v=Za(),j=a(v),R=s(a(j));t(j),ke(2),t(v),c(()=>o(R,` ${l.batch.device_id??""}`)),i(b,v)};d(V,b=>{l.liveReading?b(G):b(J,!1)})}t(I),i(N,I)},L=N=>{var I=ts(),V=s(a(I),2);{var G=J=>{var b=es();b.__click=function(...v){l.onEdit?.apply(this,v)},i(J,b)};d(V,J=>{l.onEdit&&J(G)})}t(I),i(N,I)};d(f,N=>{l.batch.device_id?N(w):N(L,!1)})}i(C,le)},$$slots:{default:!0}}),ht()}kt(["click"]);const ss=131.25;var rs=n('<div class="target wide svelte-19u9n31"><span class="target-label svelte-19u9n31">Yeast</span> <span class="target-value svelte-19u9n31"> </span></div>'),ls=n('<div class="targets-grid svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div> <!></div>');function is($,l){mt(l,!0);function T(x){return x==null?"--":bt(x)}let P=z(()=>l.recipe.abv!=null?l.recipe.abv:l.recipe.og&&l.recipe.fg?(l.recipe.og-l.recipe.fg)*ss:null);xt($,{title:"Recipe Targets",children:(x,p)=>{var q=ls(),r=a(q),F=s(a(r),2),g=a(F,!0);t(F),t(r);var C=s(r,2),X=s(a(C),2),le=a(X,!0);t(X),t(C);var f=s(C,2),w=s(a(f),2),L=a(w,!0);t(w),t(f);var N=s(f,2);{var I=V=>{var G=rs(),J=s(a(G),2),b=a(J,!0);t(J),t(G),c(()=>o(b,l.recipe.yeast_name)),i(V,G)};d(N,V=>{l.recipe.yeast_name&&V(I)})}t(q),c((V,G,J)=>{o(g,V),o(le,G),o(L,J)},[()=>T(l.recipe.og),()=>T(l.recipe.fg),()=>e(P)!=null?`${e(P).toFixed(1)}%`:"--"]),i(x,q)},$$slots:{default:!0}}),ht()}var ns=n('<p class="notes-content svelte-hkv31i"> </p>');function vs($,l){xt($,{title:"Notes",children:(T,P)=>{var x=ns(),p=a(x,!0);t(x),c(()=>o(p,l.notes)),i(T,x)},$$slots:{default:!0}})}var os=n('<div class="ml-panel loading svelte-1xs394q"><p>Loading predictions...</p></div>'),ds=n('<div class="ml-panel error svelte-1xs394q"><p class="error-text svelte-1xs394q"> </p></div>'),cs=n('<span class="anomaly-reasons svelte-1xs394q"> </span>'),us=n('<div class="anomaly-banner svelte-1xs394q"><span class="anomaly-icon svelte-1xs394q">‚ö†Ô∏è</span> <div class="anomaly-content svelte-1xs394q"><span class="anomaly-label svelte-1xs394q">Anomaly Detected</span> <!></div></div>'),_s=n('<span class="activity-badge svelte-1xs394q"> </span>'),gs=n('<div class="progress-section svelte-1xs394q"><div class="progress-header svelte-1xs394q"><span class="progress-label svelte-1xs394q">Fermentation Progress</span> <!></div> <div class="fermentation-progress-bar svelte-1xs394q"><div class="fermentation-fill svelte-1xs394q"></div></div> <div class="progress-labels svelte-1xs394q"><span class="og-label svelte-1xs394q"> </span> <span class="progress-percent svelte-1xs394q"> </span> <span class="fg-label svelte-1xs394q"> </span></div></div>'),ps=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Predicted FG:</span> <span class="value svelte-1xs394q"> </span></div>'),fs=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Attenuation:</span> <span class="value attenuation svelte-1xs394q"> </span></div>'),ms=n('<span class="complete-now svelte-1xs394q">Ready now!</span>'),hs=n('<span class="days svelte-1xs394q"> </span>'),bs=n(" <!>",1),xs=n('<div class="metric completion-metric svelte-1xs394q"><span class="label svelte-1xs394q">Est. Completion:</span> <span class="value svelte-1xs394q"><!></span></div>'),js=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),ys=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Data points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),ks=n('<div><div class="panel-header svelte-1xs394q"><h3 class="panel-title svelte-1xs394q">Fermentation Intelligence</h3> <button type="button" class="reload-btn svelte-1xs394q" title="Recalculate predictions from database history"> </button></div> <!> <!> <div class="metrics svelte-1xs394q"><!> <!> <!> <div class="model-info svelte-1xs394q"><!> <!></div></div></div>'),ws=n('<div class="ml-panel disabled svelte-1xs394q"><div class="disabled-header svelte-1xs394q"><p class="unavailable-text svelte-1xs394q">ML predictions unavailable</p> <button type="button" class="reload-btn svelte-1xs394q" title="Reload predictions from database"> </button></div> <p class="unavailable-hint svelte-1xs394q">Predictions require at least 10 readings over 2+ hours</p></div>');function zs($,l){mt(l,!0);let T=dt(l,"measuredOg",3,null),P=dt(l,"currentSg",3,null),x=dt(l,"liveReading",3,null),p=ye(Kt({available:!1})),q=ye(!0),r=ye(!1),F=ye(null);async function g(){_(q,!0),_(F,null);try{_(p,await ka(l.batchId),!0)}catch(v){_(F,v instanceof Error?v.message:"Failed to load predictions",!0),console.error("Failed to load ML predictions:",v)}finally{_(q,!1)}}async function C(){_(r,!0),_(F,null);try{const v=await wa(l.batchId);console.log("Reloaded predictions:",v.message),await g()}catch(v){_(F,v instanceof Error?v.message:"Failed to reload predictions",!0),console.error("Failed to reload predictions:",v)}finally{_(r,!1)}}Qt(g);function X(v){return v?new Date(v).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}):"N/A"}function le(v){if(!v)return null;const j=new Date(v),R=new Date,Y=j.getTime()-R.getTime();return Math.ceil(Y/(1e3*60*60*24))}let f=z(()=>{const v=T()??e(p).predicted_og,j=e(p).predicted_fg,R=P()??x()?.sg;if(!v||!j||!R||v<=j)return null;const Y=v-j,E=(v-R)/Y*100;return Math.min(100,Math.max(0,E))}),w=z(()=>{const v=T()??e(p).predicted_og,j=P()??x()?.sg;if(!v||!j||v<=1)return null;const R=(v-j)/(v-1)*100;return Math.min(100,Math.max(0,R))}),L=z(()=>{const v=x()?.sg_rate;if(v==null)return null;const j=Math.abs(v);return j>.002?{label:"Very Active",color:"#22c55e",emoji:"üî•"}:j>5e-4?{label:"Active",color:"#84cc16",emoji:"‚ú®"}:j>1e-4?{label:"Slowing",color:"#eab308",emoji:"üê¢"}:{label:"Complete",color:"#6b7280",emoji:"‚úì"}}),N=z(()=>x()?.is_anomaly??!1),I=z(()=>x()?.anomaly_reasons??[]);var V=Re(),G=Q(V);{var J=v=>{var j=os();i(v,j)},b=v=>{var j=Re(),R=Q(j);{var Y=E=>{var fe=ds(),we=a(fe),ie=a(we);t(we),t(fe),c(()=>o(ie,`‚ö†Ô∏è ${e(F)??""}`)),i(E,fe)},pe=E=>{var fe=Re(),we=Q(fe);{var ie=Z=>{var de=ks();let M;var D=a(de),k=s(a(D),2);k.__click=C;var K=a(k,!0);t(k),t(D);var H=s(D,2);{var ee=m=>{var h=us(),A=s(a(h),2),se=s(a(A),2);{var Fe=_e=>{var Ue=cs(),be=a(Ue,!0);t(Ue),c(ze=>o(be,ze),[()=>e(I).join(", ")]),i(_e,Ue)};d(se,_e=>{e(I).length>0&&_e(Fe)})}t(A),t(h),i(m,h)};d(H,m=>{e(N)&&m(ee)})}var ne=s(H,2);{var ce=m=>{var h=gs(),A=a(h),se=s(a(A),2);{var Fe=We=>{var Ze=_s(),ut=a(Ze);t(Ze),c(()=>{Qe(Ze,`color: ${e(L).color??""}`),o(ut,`${e(L).emoji??""} ${e(L).label??""}`)}),i(We,Ze)};d(se,We=>{e(L)&&We(Fe)})}t(A);var _e=s(A,2),Ue=a(_e);t(_e);var be=s(_e,2),ze=a(be),Xe=a(ze);t(ze);var st=s(ze,2),ct=a(st);t(st);var Oe=s(st,2),rt=a(Oe);t(Oe),t(be),t(h),c((We,Ze,ut)=>{Qe(Ue,`width: ${e(f)??""}%`),o(Xe,`OG: ${We??""}`),o(ct,`${Ze??""}%`),o(rt,`FG: ${ut??""}`)},[()=>bt(T()??e(p).predicted_og??0),()=>e(f).toFixed(0),()=>bt(e(p).predicted_fg??0)]),i(m,h)};d(ne,m=>{e(f)!==null&&m(ce)})}var Ge=s(ne,2),he=a(Ge);{var u=m=>{var h=ps(),A=s(a(h),2),se=a(A,!0);t(A),t(h),c(Fe=>o(se,Fe),[()=>bt(e(p).predicted_fg)]),i(m,h)};d(he,m=>{e(p).predicted_fg&&m(u)})}var y=s(he,2);{var U=m=>{var h=fs(),A=s(a(h),2),se=a(A);t(A),t(h),c(Fe=>o(se,`${Fe??""}%`),[()=>e(w).toFixed(1)]),i(m,h)};d(y,m=>{e(w)!==null&&m(U)})}var O=s(y,2);{var Se=m=>{const h=z(()=>le(e(p).estimated_completion));var A=xs(),se=s(a(A),2),Fe=a(se);{var _e=be=>{var ze=ms();i(be,ze)},Ue=be=>{var ze=bs(),Xe=Q(ze),st=s(Xe);{var ct=Oe=>{var rt=hs(),We=a(rt);t(rt),c(()=>o(We,`(${e(h)??""} ${e(h)===1?"day":"days"})`)),i(Oe,rt)};d(st,Oe=>{e(h)!==null&&Oe(ct)})}c(Oe=>o(Xe,`${Oe??""} `),[()=>X(e(p).estimated_completion)]),i(be,ze)};d(Fe,be=>{e(h)!==null&&e(h)<=0?be(_e):be(Ue,!1)})}t(se),t(A),i(m,A)};d(O,m=>{e(p).estimated_completion&&m(Se)})}var ve=s(O,2),oe=a(ve);{var ue=m=>{var h=js(),A=s(a(h),2),se=a(A);t(A),t(h),c(Fe=>o(se,`${Fe??""}%`),[()=>(e(p).r_squared*100).toFixed(0)]),i(m,h)};d(oe,m=>{e(p).r_squared!==void 0&&m(ue)})}var Ve=s(oe,2);{var He=m=>{var h=ys(),A=s(a(h),2),se=a(A,!0);t(A),t(h),c(()=>o(se,e(p).num_readings)),i(m,h)};d(Ve,m=>{e(p).num_readings&&m(He)})}t(ve),t(Ge),t(de),c(()=>{M=Ae(de,1,"ml-panel svelte-1xs394q",null,M,{"has-anomaly":e(N)}),k.disabled=e(r)||e(q),o(K,e(r)?"Reloading...":"‚Üª Reload")}),i(Z,de)},me=Z=>{var de=ws(),M=a(de),D=s(a(M),2);D.__click=C;var k=a(D,!0);t(D),t(M),ke(2),t(de),c(()=>{D.disabled=e(r)||e(q),o(k,e(r)?"Reloading...":"‚Üª Reload")}),i(Z,de)};d(we,Z=>{e(p).available?Z(ie):Z(me,!1)},!0)}i(E,fe)};d(R,E=>{e(F)?E(Y):E(pe,!1)},!0)}i(v,j)};d(G,v=>{e(q)?v(J):v(b,!1)})}i($,V),ht()}kt(["click"]);var qs=n('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),Cs=n('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),Rs=n('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),Fs=n('<span class="recipe-type svelte-g5au2j"> </span>'),Bs=n('<a class="recipe-link svelte-g5au2j"> <!></a>'),Ts=n('<option class="svelte-g5au2j"> </option>'),Ms=n('<span class="chilling-icon svelte-g5au2j">üç∫</span> <h3 class="chilling-title svelte-g5au2j">Ready to Pitch!</h3>',1),Ds=n('<span class="chilling-icon svelte-g5au2j">‚ùÑÔ∏è</span> <h3 class="chilling-title svelte-g5au2j">Chilling to Pitch Temperature</h3>',1),Ss=n('<div class="progress-section svelte-g5au2j"><div class="progress-bar svelte-g5au2j"><div class="progress-fill svelte-g5au2j"></div></div> <span class="progress-text svelte-g5au2j"> </span></div>'),Os=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è No cooler configured - set a cooler entity to enable automated chilling</span>'),Ps=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è Temperature control disabled in settings</span>'),As=n('<span class="status-ready svelte-g5au2j">Wort has reached pitch temperature - ready to add yeast!</span>'),Gs=n('<span class="status-active svelte-g5au2j">Cooler will run automatically when temp exceeds target + hysteresis</span>'),Es=n('<div><div class="chilling-header svelte-g5au2j"><!></div> <div class="chilling-content svelte-g5au2j"><div class="temp-display svelte-g5au2j"><div class="temp-current svelte-g5au2j"><span class="temp-label svelte-g5au2j">Current</span> <span class="temp-value svelte-g5au2j"> </span></div> <div class="temp-arrow svelte-g5au2j">‚Üí</div> <div class="temp-target svelte-g5au2j"><span class="temp-label svelte-g5au2j">Target</span> <span class="temp-value svelte-g5au2j"> </span></div></div> <!> <div class="chilling-status svelte-g5au2j"><!></div></div></div>'),Ls=n('<span class="status-badge heater svelte-g5au2j">üî• ON</span>'),Ns=n('<span class="status-badge cooler svelte-g5au2j">‚ùÑÔ∏è ON</span>'),Us=n('<div class="device-status heater svelte-g5au2j"><div>üî•</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Heater</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Is=n('<div class="device-status cooler svelte-g5au2j"><div>‚ùÑÔ∏è</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Cooler</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Vs=n('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">‚ö°</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),Hs=n('<button type="button" class="override-btn heat-on svelte-g5au2j">Force Heat ON</button> <button type="button" class="override-btn heat-off svelte-g5au2j">Force Heat OFF</button>',1),Ws=n('<button type="button" class="override-btn cool-on svelte-g5au2j">Force Cool ON</button> <button type="button" class="override-btn cool-off svelte-g5au2j">Force Cool OFF</button>',1),Js=n('<div class="control-details svelte-g5au2j"><div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns-grid svelte-g5au2j"><!> <!> <button type="button" class="override-btn auto-mode svelte-g5au2j">Auto Mode</button></div></div>',1),Ys=n('<div class="device-status-grid svelte-g5au2j"><!> <!></div> <!>',1),Ks=n('<div><button type="button" class="collapsible-header svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="collapse-indicator svelte-g5au2j"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" class="svelte-g5au2j"></path></svg></div></button> <!></div>'),Qs=n('<span class="svelte-g5au2j"> </span>'),Xs=n('<span class="svelte-g5au2j"> </span>'),Zs=n('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><!> <!> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),$s=n('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j" aria-label="Delete batch"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <!> <div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!> <!></div></div>',1),er=n('<div class="modal-overlay svelte-g5au2j"><div class="modal svelte-g5au2j"><h2 class="modal-title svelte-g5au2j">Delete Batch?</h2> <p class="modal-text svelte-g5au2j"> </p> <div class="modal-actions svelte-g5au2j"><button type="button" class="modal-btn cancel svelte-g5au2j">Cancel</button> <button type="button" class="modal-btn delete svelte-g5au2j"> </button></div></div></div>'),tr=n('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div> <!>',1);function jr($,l){mt(l,!0);const T=()=>xa(ja,"$page",P),[P,x]=ba();let p=null,q=null,r=ye(null),F=ye(null),g=ye(null);Kt([]);let C=ye(!0),X=ye(null),le=ye(!1),f=ye(!1),w=ye(!1),L=ye(!1),N=ye(!1),I=ye(!1),V=z(()=>parseInt(T().params.id??"0"));const G={planning:{label:"Planning",color:"var(--text-secondary)",bg:"var(--bg-elevated)"},fermenting:{label:"Fermenting",color:"#f59e0b",bg:"rgba(245, 158, 11, 0.12)"},conditioning:{label:"Conditioning",color:"#8b5cf6",bg:"rgba(139, 92, 246, 0.12)"},completed:{label:"Completed",color:"var(--positive)",bg:"rgba(34, 197, 94, 0.12)"},archived:{label:"Archived",color:"var(--text-muted)",bg:"var(--bg-elevated)"}},J=["planning","fermenting","conditioning","completed","archived"];let b=z(()=>e(r)?G[e(r).status]:G.planning),v=z(ea),j=z(()=>yt.config.ha_enabled&&yt.config.temp_control_enabled&&(e(r)?.heater_entity_id||e(r)?.cooler_entity_id)),R=z(()=>e(r)?.status==="planning"&&e(r)?.temp_target!=null),Y=z(()=>!e(R)||!e(E)?.temp||!e(r)?.temp_target?!1:e(E).temp<=e(r).temp_target),pe=z(()=>{if(!e(R)||!e(E)?.temp||!e(r)?.temp_target)return null;const u=e(r).temp_target+30,y=e(E).temp,U=e(r).temp_target;if(y<=U)return 100;if(y>=u)return 0;const O=(u-y)/(u-U)*100;return Math.min(100,Math.max(0,O))}),E=z(()=>{if(!e(r)?.device_id)return null;const u=Yt.tilts.get(e(r).device_id);if(u)return u;const y=e(r).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!y?.[1])return null;const U=y[1].toUpperCase();for(const O of Yt.tilts.values())if(O.color&&O.color.toUpperCase()===U)return O;return null});async function fe(){_(C,!0),_(X,null);try{if(_(r,await za(e(V)),!0),e(r).status==="fermenting"||e(r).status==="conditioning")try{_(F,await Wt(e(V)),!0)}catch{}if(e(r).heater_entity_id||e(r).cooler_entity_id)try{_(g,await jt(e(V)),!0)}catch{}}catch(u){_(X,u instanceof Error?u.message:"Failed to load batch",!0)}finally{_(C,!1)}}async function we(u){if(!(!e(r)||e(f))&&!(u==="conditioning"&&e(r).status==="fermenting"&&!confirm(`üí° Entering Conditioning Phase

Reminder: Adjust target temperature if cold crashing.
Temperature control will continue during conditioning.

Continue?`))){_(f,!0);try{_(r,await Jt(e(r).id,{status:u}),!0),(u==="fermenting"||u==="conditioning")&&_(F,await Wt(e(r).id),!0)}catch(y){console.error("Failed to update status:",y)}finally{_(f,!1)}}}async function ie(u){if(e(r)&&(_(r,await Jt(e(r).id,u),!0),_(le,!1),e(r).heater_entity_id||e(r).cooler_entity_id))try{_(g,await jt(e(r).id),!0)}catch{}}async function me(){if(e(r)){_(N,!0);try{await qa(e(r).id),ya("/batches")}catch(u){_(X,u instanceof Error?u.message:"Failed to delete batch",!0),_(N,!1),_(L,!1)}}}async function Z(u,y){if(!(!e(r)||e(w))){_(w,!0);try{await Ft(e(r).id,y,60,u),_(g,await jt(e(r).id),!0)}catch(U){console.error("Failed to set override:",U)}finally{_(w,!1)}}}async function de(){if(!(!e(r)||e(w))){_(w,!0);try{e(r).heater_entity_id&&await Ft(e(r).id,null,60,"heater"),e(r).cooler_entity_id&&await Ft(e(r).id,null,60,"cooler"),_(g,await jt(e(r).id),!0)}catch(u){console.error("Failed to clear overrides:",u)}finally{_(w,!1)}}}function M(){if(p?.readyState===WebSocket.OPEN)return;const y=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;p=new WebSocket(y),p.onmessage=async U=>{try{const O=JSON.parse(U.data);O.type==="control_event"&&O.batch_id===e(V)&&e(g)&&(O.action==="heat_on"?_(g,{...e(g),heater_state:"on"},!0):O.action==="heat_off"?_(g,{...e(g),heater_state:"off"},!0):O.action==="cool_on"?_(g,{...e(g),cooler_state:"on"},!0):O.action==="cool_off"&&_(g,{...e(g),cooler_state:"off"},!0))}catch{}},p.onclose=()=>{p=null,q=setTimeout(M,3e3)},p.onerror=()=>{p?.close()}}function D(){q&&(clearTimeout(q),q=null),p?.close(),p=null}function k(u){return u==null?"--":$t(u)}Qt(()=>{fe(),M()}),_a(()=>{D()});var K=tr();fa("g5au2j",u=>{ga(()=>{pa.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var H=Q(K),ee=s(a(H),2);{var ne=u=>{var y=qs();i(u,y)},ce=u=>{var y=Re(),U=Q(y);{var O=ve=>{var oe=Cs(),ue=s(a(oe),2),Ve=a(ue,!0);t(ue);var He=s(ue,2);He.__click=fe,t(oe),c(()=>o(Ve,e(X))),i(ve,oe)},Se=ve=>{var oe=Re(),ue=Q(oe);{var Ve=m=>{var h=Rs();i(m,h)},He=m=>{var h=Re(),A=Q(h);{var se=_e=>{Ca(_e,{get batch(){return e(r)},onSubmit:ie,onCancel:()=>_(le,!1)})},Fe=_e=>{var Ue=$s(),be=Q(Ue),ze=a(be),Xe=a(ze),st=a(Xe);t(Xe);var ct=s(Xe,2),Oe=a(ct),rt=a(Oe,!0);t(Oe);var We=s(Oe,2);{var Ze=S=>{var te=Bs(),ge=a(te),qe=s(ge);{var Be=Pe=>{var Ie=Fs(),Ye=a(Ie);t(Ie),c(()=>o(Ye,`(${e(r).recipe.type??""})`)),i(Pe,Ie)};d(qe,Pe=>{e(r).recipe.type&&Pe(Be)})}t(te),c(()=>{ft(te,"href",`/recipes/${e(r).recipe.id??""}`),o(ge,`${e(r).recipe.name??""} `)}),i(S,te)};d(We,S=>{e(r).recipe&&S(Ze)})}t(ct),t(ze);var ut=s(ze,2),wt=a(ut),Je=a(wt);Je.__change=S=>we(S.currentTarget.value),Xt(Je,21,()=>J,Zt,(S,te)=>{var ge=Ts(),qe=a(ge,!0);t(ge);var Be={};c(()=>{o(qe,G[e(te)].label),Be!==(Be=e(te))&&(ge.value=(ge.__value=e(te))??"")}),i(S,ge)}),t(Je);var Bt;ma(Je),t(wt);var Tt=s(wt,2);Tt.__click=()=>_(le,!0);var aa=s(Tt,2);aa.__click=()=>_(L,!0),t(ut),t(be);var Mt=s(be,2);{var sa=S=>{var te=Es();let ge;var qe=a(te),Be=a(qe);{var Pe=B=>{var W=Ms();ke(2),i(B,W)},Ie=B=>{var W=Ds();ke(2),i(B,W)};d(Be,B=>{e(Y)?B(Pe):B(Ie,!1)})}t(qe);var Ye=s(qe,2),lt=a(Ye),$e=a(lt),_t=s(a($e),2),Ee=a(_t,!0);t(_t),t($e);var ae=s($e,4),Ce=s(a(ae),2),it=a(Ce,!0);t(Ce),t(ae),t(lt);var nt=s(lt,2);{var vt=B=>{var W=Ss(),xe=a(W),Te=a(xe);t(xe);var Me=s(xe,2),re=a(Me);t(Me),t(W),c(je=>{Qe(Te,`width: ${e(pe)??""}%`),o(re,`${je??""}% to target`)},[()=>Math.round(e(pe))]),i(B,W)};d(nt,B=>{e(pe)!=null&&!e(Y)&&B(vt)})}var gt=s(nt,2),qt=a(gt);{var Ct=B=>{var W=Os();i(B,W)},Rt=B=>{var W=Re(),xe=Q(W);{var Te=re=>{var je=Ps();i(re,je)},Me=re=>{var je=Re(),et=Q(je);{var Ke=at=>{var pt=As();i(at,pt)},tt=at=>{var pt=Gs();i(at,pt)};d(et,at=>{e(Y)?at(Ke):at(tt,!1)},!0)}i(re,je)};d(xe,re=>{!yt.config.ha_enabled||!yt.config.temp_control_enabled?re(Te):re(Me,!1)},!0)}i(B,W)};d(qt,B=>{e(r).cooler_entity_id?B(Rt,!1):B(Ct)})}t(gt),t(Ye),t(te),c((B,W)=>{ge=Ae(te,1,"chilling-banner svelte-g5au2j",null,ge,{ready:e(Y)}),o(Ee,B),o(it,W)},[()=>e(E)?.temp!=null?k(e(E).temp):"--",()=>e(r).temp_target!=null?k(e(r).temp_target):"--"]),i(S,te)};d(Mt,S=>{e(R)&&S(sa)})}var Dt=s(Mt,2),zt=a(Dt),St=a(zt);{let S=z(()=>e(E)?.sg??e(F)?.measured?.current_sg);Ia(St,{get batch(){return e(r)},get currentSg(){return e(S)},get progress(){return e(F)},get liveReading(){return e(E)}})}var ra=s(St,2);{var la=S=>{is(S,{get recipe(){return e(r).recipe}})};d(ra,S=>{e(r).recipe&&S(la)})}t(zt);var Ot=s(zt,2),Pt=a(Ot);Ha(Pt,{get batch(){return e(r)}});var At=s(Pt,2);as(At,{get batch(){return e(r)},get liveReading(){return e(E)},onEdit:()=>_(le,!0)});var Gt=s(At,2);{let S=z(()=>e(E)?.sg);zs(Gt,{get batchId(){return e(r).id},get measuredOg(){return e(r).measured_og},get currentSg(){return e(S)},get liveReading(){return e(E)}})}var Et=s(Gt,2);{var ia=S=>{var te=Ks();let ge;var qe=a(te);qe.__click=()=>_(I,!e(I));var Be=s(a(qe),2),Pe=a(Be);{var Ie=ae=>{var Ce=Ls();i(ae,Ce)},Ye=ae=>{var Ce=Re(),it=Q(Ce);{var nt=vt=>{var gt=Ns();i(vt,gt)};d(it,vt=>{e(g)?.cooler_state==="on"&&vt(nt)},!0)}i(ae,Ce)};d(Pe,ae=>{e(g)?.heater_state==="on"?ae(Ie):ae(Ye,!1)})}var lt=s(Pe,2);let $e;t(Be),t(qe);var _t=s(qe,2);{var Ee=ae=>{var Ce=Ys(),it=Q(Ce),nt=a(it);{var vt=B=>{var W=Us(),xe=a(W);let Te;var Me=s(xe,2),re=s(a(Me),2);let je;var et=a(re,!0);t(re);var Ke=s(re,2),tt=a(Ke,!0);t(Ke),t(Me),t(W),c(()=>{Te=Ae(xe,1,"device-icon-wrap svelte-g5au2j",null,Te,{active:e(g)?.heater_state==="on"}),je=Ae(re,1,"device-state svelte-g5au2j",null,je,{on:e(g)?.heater_state==="on"}),o(et,e(g)?.heater_state==="on"?"ON":"OFF"),o(tt,e(r).heater_entity_id)}),i(B,W)};d(nt,B=>{e(r).heater_entity_id&&B(vt)})}var gt=s(nt,2);{var qt=B=>{var W=Is(),xe=a(W);let Te;var Me=s(xe,2),re=s(a(Me),2);let je;var et=a(re,!0);t(re);var Ke=s(re,2),tt=a(Ke,!0);t(Ke),t(Me),t(W),c(()=>{Te=Ae(xe,1,"device-icon-wrap svelte-g5au2j",null,Te,{active:e(g)?.cooler_state==="on"}),je=Ae(re,1,"device-state svelte-g5au2j",null,je,{on:e(g)?.cooler_state==="on"}),o(et,e(g)?.cooler_state==="on"?"ON":"OFF"),o(tt,e(r).cooler_entity_id)}),i(B,W)};d(gt,B=>{e(r).cooler_entity_id&&B(qt)})}t(it);var Ct=s(it,2);{var Rt=B=>{var W=Js(),xe=Q(W),Te=a(xe),Me=s(a(Te),2),re=a(Me);t(Me),t(Te);var je=s(Te,2),et=s(a(je),2),Ke=a(et);t(et),t(je),t(xe);var tt=s(xe,2);{var at=De=>{var Le=Vs(),Ne=s(a(Le),2),ot=a(Ne);t(Ne);var Vt=s(Ne,2);Vt.__click=()=>de(),t(Le),c(ua=>{o(ot,`Override active: ${ua??""}`),Vt.disabled=e(w)},[()=>e(g).override_state?.toUpperCase()]),i(De,Le)};d(tt,De=>{e(g).override_active&&De(at)})}var pt=s(tt,2),Lt=s(a(pt),2),Nt=a(Lt);{var da=De=>{var Le=Hs(),Ne=Q(Le);Ne.__click=()=>Z("heater","on");var ot=s(Ne,2);ot.__click=()=>Z("heater","off"),c(()=>{Ne.disabled=e(w),ot.disabled=e(w)}),i(De,Le)};d(Nt,De=>{e(r).heater_entity_id&&De(da)})}var Ut=s(Nt,2);{var ca=De=>{var Le=Ws(),Ne=Q(Le);Ne.__click=()=>Z("cooler","on");var ot=s(Ne,2);ot.__click=()=>Z("cooler","off"),c(()=>{Ne.disabled=e(w),ot.disabled=e(w)}),i(De,Le)};d(Ut,De=>{e(r).cooler_entity_id&&De(ca)})}var It=s(Ut,2);It.__click=()=>de(),t(Lt),t(pt),c((De,Le)=>{o(re,`${De??""}${e(v)??""}`),o(Ke,`¬±${Le??""}${e(v)??""}`),It.disabled=e(w)},[()=>k(e(g).target_temp),()=>e(g).hysteresis?.toFixed(1)||"--"]),i(B,W)};d(Ct,B=>{e(g)&&B(Rt)})}i(ae,Ce)};d(_t,ae=>{e(I)||ae(Ee)})}t(te),c(()=>{ge=Ae(te,1,"info-card temp-control-card svelte-g5au2j",null,ge,{"heater-on":e(g)?.heater_state==="on","cooler-on":e(g)?.cooler_state==="on",collapsed:e(I)}),$e=Ae(lt,0,"chevron svelte-g5au2j",null,$e,{rotated:!e(I)})}),i(S,te)},na=S=>{var te=Re(),ge=Q(te);{var qe=Be=>{var Pe=Zs(),Ie=s(a(Pe),2),Ye=a(Ie);{var lt=Ee=>{var ae=Qs(),Ce=a(ae);t(ae),c(()=>o(Ce,`Heater: ${e(r).heater_entity_id??""}`)),i(Ee,ae)};d(Ye,Ee=>{e(r).heater_entity_id&&Ee(lt)})}var $e=s(Ye,2);{var _t=Ee=>{var ae=Xs(),Ce=a(ae);t(ae),c(()=>o(Ce,`Cooler: ${e(r).cooler_entity_id??""}`)),i(Ee,ae)};d($e,Ee=>{e(r).cooler_entity_id&&Ee(_t)})}ke(2),t(Ie),t(Pe),i(Be,Pe)};d(ge,Be=>{(e(r).heater_entity_id||e(r).cooler_entity_id)&&e(r).status!=="fermenting"&&Be(qe)},!0)}i(S,te)};d(Et,S=>{e(j)&&(e(r).status==="fermenting"||e(r).status==="conditioning")?S(ia):S(na,!1)})}var va=s(Et,2);{var oa=S=>{vs(S,{get notes(){return e(r).notes}})};d(va,S=>{e(r).notes&&S(oa)})}t(Ot),t(Dt),c(()=>{o(st,`#${(e(r).batch_number||"?")??""}`),o(rt,e(r).name||e(r).recipe?.name||"Unnamed Batch"),Je.disabled=e(f),Qe(Je,`color: ${e(b).color??""}; background: ${e(b).bg??""};`),Bt!==(Bt=e(r).status)&&(Je.value=(Je.__value=e(r).status)??"",ha(Je,e(r).status))}),i(_e,Ue)};d(A,_e=>{e(le)?_e(se):_e(Fe,!1)},!0)}i(m,h)};d(ue,m=>{e(r)?m(He,!1):m(Ve)},!0)}i(ve,oe)};d(U,ve=>{e(X)?ve(O):ve(Se,!1)},!0)}i(u,y)};d(ee,u=>{e(C)?u(ne):u(ce,!1)})}t(H);var Ge=s(H,2);{var he=u=>{var y=er();y.__click=()=>_(L,!1);var U=a(y);U.__click=He=>He.stopPropagation();var O=s(a(U),2),Se=a(O);t(O);var ve=s(O,2),oe=a(ve);oe.__click=()=>_(L,!1);var ue=s(oe,2);ue.__click=me;var Ve=a(ue,!0);t(ue),t(ve),t(U),t(y),c(()=>{o(Se,`Are you sure you want to delete "${(e(r)?.name||"this batch")??""}"? This cannot be undone.`),oe.disabled=e(N),ue.disabled=e(N),o(Ve,e(N)?"Deleting...":"Delete Batch")}),i(u,y)};d(Ge,u=>{e(L)&&u(he)})}i($,K),ht(),x()}kt(["click","change"]);export{jr as component,xr as universal};
