import{d as yt,f as i,s as v,a as n,c as Be}from"../chunks/CsQfwH0S.js";import{al as a,ak as s,an as t,ar as c,ah as ft,at as J,c as e,ai as M,as as me,aj as mt,aq as fe,p as Jt,ao as Yt,s as g,aL as ua,ay as _a,am as ga}from"../chunks/fKkNMI8q.js";import{e as Kt,i as Qt}from"../chunks/COk1ZY4R.js";import{i as o}from"../chunks/BvBRaQNg.js";import{h as pa}from"../chunks/DLseniaC.js";import{s as Xt}from"../chunks/DbN3nGCc.js";import{s as Se}from"../chunks/BDI2zAFW.js";import{s as at}from"../chunks/CcRNvR1k.js";import{i as fa,s as ma}from"../chunks/C8srtpii.js";import{s as ha,a as ba}from"../chunks/C51ud8ec.js";import{p as ja}from"../chunks/lJ59omcr.js";import{g as xa}from"../chunks/CTI8DtiU.js";import{z as ya,A as ka,q as wa,j as Ht,B as jt,k as za,x as Vt,C as Ft}from"../chunks/i8VL_lOf.js";import{d as ht,e as Zt,g as $t,c as xt}from"../chunks/CPwbAm-l.js";import{t as Wt}from"../chunks/C8NDSE1R.js";import{B as qa}from"../chunks/DTfC6M4H.js";import{s as Ca}from"../chunks/Bdaed-dN.js";import{p as pt}from"../chunks/CllCHKBI.js";const Fa=!1,mr=Object.freeze(Object.defineProperty({__proto__:null,prerender:Fa},Symbol.toStringTag,{value:"Module"}));function Ra(Q){return Q>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:Q>=-60?{bars:3,color:"var(--positive)",label:"Good"}:Q>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function ea(Q){const l=Math.floor((Date.now()-new Date(Q).getTime())/1e3);if(l<10)return"just now";if(l<60)return`${l}s ago`;const w=Math.floor(l/60);if(w<60)return`${w}m ago`;const C=Math.floor(w/60);return C<24?`${C}h ago`:`${Math.floor(C/24)}d ago`}var Ba=i('<div class="accent-bar svelte-1oyrwd9"></div>'),Ta=i('<span class="card-icon svelte-1oyrwd9"> </span>'),Ma=i('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),Da=i('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function bt(Q,l){let w=pt(l,"highlight",3,!1),C=pt(l,"collapsible",3,!1),b=pt(l,"expanded",3,!1);var f=Da();let z;var r=a(f);{var D=x=>{var B=Ba();n(x,B)};o(r,x=>{w()&&x(D)})}var p=s(r,2),N=a(p),Y=a(N);{var K=x=>{var B=Ta(),d=a(B,!0);t(B),c(()=>v(d,l.icon)),n(x,B)};o(Y,x=>{l.icon&&x(K)})}var u=s(Y,2),j=a(u,!0);t(u),t(N);var S=s(N,2);{var H=x=>{var B=Ma();B.__click=function(...U){l.onToggle?.apply(this,U)};var d=a(B);let T;t(B),c(()=>{Xt(B,"aria-label",b()?"Collapse":"Expand"),T=Se(d,0,"expand-icon svelte-1oyrwd9",null,T,{"rotate-180":b()})}),n(x,B)};o(S,x=>{C()&&l.onToggle&&x(H)})}t(p);var F=s(p,2);let O;var R=a(F);Ca(R,()=>l.children),t(F),t(f),c(()=>{z=Se(f,1,"batch-card svelte-1oyrwd9",null,z,{highlight:w()}),v(j,l.title),O=Se(F,1,"card-content svelte-1oyrwd9",null,O,{collapsed:C()&&!b()})}),n(Q,f)}yt(["click"]);var Sa=i('<span class="updated-text svelte-t80j9z"> </span>'),Oa=i('<div class="hero-divider svelte-t80j9z"></div> <div class="hero-metric temperature svelte-t80j9z"><span class="hero-value svelte-t80j9z"> <span class="hero-unit svelte-t80j9z"> </span></span> <span class="hero-label svelte-t80j9z">Temperature</span></div>',1),Pa=i('<div class="remaining-text svelte-t80j9z"> </div>'),Aa=i('<div class="progress-section svelte-t80j9z"><div class="progress-labels svelte-t80j9z"><div class="progress-endpoint start svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">OG</span></div> <div class="progress-current svelte-t80j9z"><span class="current-percent svelte-t80j9z"> </span></div> <div class="progress-endpoint end svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">Target FG</span></div></div> <div class="progress-track svelte-t80j9z"><div class="progress-fill svelte-t80j9z"></div> <div><div class="marker-dot svelte-t80j9z"></div> <div class="marker-value svelte-t80j9z"> </div></div></div> <!></div>'),Ga=i('<div class="metrics-row svelte-t80j9z"><div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">ABV</span></div> <div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">Attenuation</span></div></div>'),Ea=i('<div class="status-row svelte-t80j9z"><div class="live-indicator svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> <span class="status-text svelte-t80j9z">LIVE</span></div> <!></div> <div class="hero-section svelte-t80j9z"><div class="hero-metric gravity svelte-t80j9z"><span class="hero-value svelte-t80j9z"> </span> <span class="hero-label svelte-t80j9z">Gravity</span></div> <!></div> <!> <!>',1),La=i('<div class="completed-grid svelte-t80j9z"><div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Original Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Final Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">ABV</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Attenuation</span></div></div>'),Na=i('<div class="empty-state svelte-t80j9z"><div class="empty-icon svelte-t80j9z">‚óé</div> <p class="empty-text svelte-t80j9z">Set Original Gravity to track fermentation</p></div>');function Ua(Q,l){ft(l,!0);let w=M(()=>l.currentSg??l.progress?.measured?.current_sg),C=M(()=>l.liveReading?.temp??l.progress?.temperature?.current),b=M(()=>l.liveReading?.last_seen),f=M(()=>e(b)?ea(e(b)):null),z=M($t),r=M(()=>{if(!l.batch.measured_og||!e(w))return null;const u=Math.max(0,(l.batch.measured_og-e(w))*131.25),j=l.batch.measured_og-1,S=j!==0?Math.max(0,Math.min(100,(l.batch.measured_og-e(w))/j*100)):0;return{abv:u,attenuation:S}}),D=M(()=>{const u=l.batch.measured_og,j=l.batch.recipe?.fg;if(!u||!j||!e(w))return null;const S=u-j,H=u-e(w);return S<=0?null:Math.max(0,Math.min(100,H/S*100))}),p=M(()=>l.batch.status==="fermenting"||l.batch.status==="conditioning");function N(u){return u==null?"--":ht(u)}function Y(u){return u==null?"--":`${u.toFixed(1)}%`}function K(u){return u==null?"--":Zt(u)}bt(Q,{title:"Fermentation",children:(u,j)=>{var S=Be(),H=J(S);{var F=R=>{var x=Ea(),B=J(x),d=s(a(B),2);{var T=A=>{var G=Sa(),I=a(G);t(G),c(()=>v(I,`Updated ${e(f)??""}`)),n(A,G)};o(d,A=>{e(f)&&A(T)})}t(B);var U=s(B,2),P=a(U),X=a(P),y=a(X,!0);t(X),me(2),t(P);var le=s(P,2);{var he=A=>{var G=Oa(),I=s(J(G),2),ne=a(I),ie=a(ne,!0),we=s(ie),ce=a(we,!0);t(we),t(ne),me(2),t(I),c(Te=>{v(ie,Te),v(ce,e(z))},[()=>K(e(C))]),n(A,G)};o(le,A=>{e(C)!=null&&A(he)})}t(U);var ke=s(U,2);{var Ye=A=>{var G=Aa(),I=a(G),ne=a(I),ie=a(ne),we=a(ie,!0);t(ie),me(2),t(ne);var ce=s(ne,2),Te=a(ce),Ke=a(Te);t(Te),t(ce);var Ne=s(ce,2),_=a(Ne),E=a(_,!0);t(_),me(2),t(Ne),t(I);var te=s(I,2),V=a(te),Ge=s(V,2);let ue;var ve=s(a(Ge),2),be=a(ve,!0);t(ve),t(Ge),t(te);var Ue=s(te,2);{var Ie=m=>{var h=Pa(),L=a(h);t(h),c(ae=>v(L,`${ae??""} points to go`),[()=>l.progress.progress.sg_remaining.toFixed(3)]),n(m,h)};o(Ue,m=>{l.progress?.progress?.sg_remaining!=null&&l.progress.progress.sg_remaining>0&&m(Ie)})}t(G),c((m,h,L,ae)=>{v(we,m),v(Ke,`${h??""}%`),v(E,L),at(V,`width: ${e(D)??""}%`),ue=Se(Ge,1,"progress-marker svelte-t80j9z",null,ue,{"at-start":e(D)<3}),at(Ge,`left: ${e(D)??""}%`),v(be,ae)},[()=>N(l.batch.measured_og),()=>e(D).toFixed(0),()=>N(l.batch.recipe.fg),()=>N(e(w))]),n(A,G)};o(ke,A=>{e(D)!==null&&l.batch.measured_og&&l.batch.recipe?.fg&&A(Ye)})}var Z=s(ke,2);{var re=A=>{var G=Ga(),I=a(G),ne=a(I),ie=a(ne,!0);t(ne),me(2),t(I);var we=s(I,2),ce=a(we),Te=a(ce,!0);t(ce),me(2),t(we),t(G),c((Ke,Ne)=>{v(ie,Ke),v(Te,Ne)},[()=>Y(e(r).abv),()=>Y(e(r).attenuation)]),n(A,G)};o(Z,A=>{e(r)&&A(re)})}c(A=>v(y,A),[()=>N(e(w))]),n(R,x)},O=R=>{var x=Be(),B=J(x);{var d=U=>{var P=La(),X=a(P),y=a(X),le=a(y,!0);t(y),me(2),t(X);var he=s(X,2),ke=a(he),Ye=a(ke,!0);t(ke),me(2),t(he);var Z=s(he,2),re=a(Z),A=a(re,!0);t(re),me(2),t(Z);var G=s(Z,2),I=a(G),ne=a(I,!0);t(I),me(2),t(G),t(P),c((ie,we,ce,Te)=>{v(le,ie),v(Ye,we),v(A,ce),v(ne,Te)},[()=>N(l.batch.measured_og),()=>N(l.batch.measured_fg),()=>l.batch.measured_abv!=null?Y(l.batch.measured_abv):"--",()=>l.batch.measured_attenuation!=null?Y(l.batch.measured_attenuation):"--"]),n(U,P)},T=U=>{var P=Na();n(U,P)};o(B,U=>{l.batch.measured_og?U(d):U(T,!1)},!0)}n(R,x)};o(H,R=>{e(w)&&e(p)?R(F):R(O,!1)})}n(u,S)},$$slots:{default:!0}}),mt()}var Ia=i('<div class="timeline svelte-yskb8i"><div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Brew Date</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Started</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Ended</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Created</span> <span class="timeline-value svelte-yskb8i"> </span></div></div>');function Ha(Q,l){ft(l,!0);function w(b){return b?new Date(b).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"}):"--"}function C(b){return b?new Date(b).toLocaleString("en-GB",{day:"numeric",month:"short",hour:"numeric",minute:"2-digit"}):"--"}bt(Q,{title:"Timeline",children:(b,f)=>{var z=Ia(),r=a(z),D=s(a(r),2),p=a(D,!0);t(D),t(r);var N=s(r,2),Y=s(a(N),2),K=a(Y,!0);t(Y),t(N);var u=s(N,2),j=s(a(u),2),S=a(j,!0);t(j),t(u);var H=s(u,2),F=s(a(H),2),O=a(F,!0);t(F),t(H),t(z),c((R,x,B,d)=>{v(p,R),v(K,x),v(S,B),v(O,d)},[()=>w(l.batch.brew_date),()=>C(l.batch.start_time),()=>C(l.batch.end_time),()=>C(l.batch.created_at)]),n(b,z)},$$slots:{default:!0}}),mt()}var Va=i('<div class="signal-bar svelte-1kdxwtz"></div>'),Wa=i('<div class="signal-details svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="signal-text svelte-1kdxwtz"> </span></div>'),Ja=i('<div class="device-last-seen svelte-1kdxwtz"> </div>'),Ya=i('<div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!> <!>',1),Ka=i('<div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <div class="device-last-seen svelte-1kdxwtz">Not receiving data</div>',1),Qa=i('<div class="device-info svelte-1kdxwtz"><!></div>'),Xa=i('<button type="button" class="link-btn svelte-1kdxwtz">Link a device</button>'),Za=i('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function $a(Q,l){ft(l,!0);let w=M(()=>l.liveReading?.device_type==="tilt"),C=M(()=>e(w)&&l.liveReading?.rssi?Ra(l.liveReading.rssi):null),b=M(()=>l.liveReading?.last_seen?ea(l.liveReading.last_seen):null),f=M(()=>{if(!l.liveReading)return l.batch.device_id||"Unknown";const z=l.liveReading.device_type;return z==="tilt"?`${l.liveReading.color} Tilt`:z==="gravitymon"?`GravityMon (${l.liveReading.id})`:z==="ispindel"?`iSpindel (${l.liveReading.id})`:z==="floaty"?`Floaty (${l.liveReading.id})`:l.liveReading.color||l.liveReading.id});bt(Q,{title:"Tracking Device",children:(z,r)=>{var D=Be(),p=J(D);{var N=K=>{var u=Qa(),j=a(u);{var S=F=>{var O=Ya(),R=J(O),x=s(a(R));t(R);var B=s(R,2);{var d=P=>{var X=Wa(),y=a(X);Kt(y,20,()=>Array(4),Qt,(ke,Ye,Z)=>{var re=Va();c(()=>at(re,`
										height: ${6+Z*3}px;
										background: ${(Z<e(C).bars?e(C).color:"var(--bg-hover)")??""};
										opacity: ${Z<e(C).bars?1:.4};
									`)),n(ke,re)}),t(y);var le=s(y,2),he=a(le);t(le),t(X),c(()=>{at(le,`color: ${e(C).color??""}`),v(he,`${e(C).label??""} (${l.liveReading.rssi??""} dBm)`)}),n(P,X)};o(B,P=>{e(C)&&P(d)})}var T=s(B,2);{var U=P=>{var X=Ja(),y=a(X);t(X),c(()=>v(y,`Updated ${e(b)??""}`)),n(P,X)};o(T,P=>{e(b)&&P(U)})}c(()=>v(x,` ${e(f)??""} - Connected`)),n(F,O)},H=F=>{var O=Ka(),R=J(O),x=s(a(R));t(R),me(2),c(()=>v(x,` Device: ${l.batch.device_id??""}`)),n(F,O)};o(j,F=>{l.liveReading?F(S):F(H,!1)})}t(u),n(K,u)},Y=K=>{var u=Za(),j=s(a(u),2);{var S=H=>{var F=Xa();F.__click=function(...O){l.onEdit?.apply(this,O)},n(H,F)};o(j,H=>{l.onEdit&&H(S)})}t(u),n(K,u)};o(p,K=>{l.batch.device_id?K(N):K(Y,!1)})}n(z,D)},$$slots:{default:!0}}),mt()}yt(["click"]);const es=131.25;var ts=i('<div class="target wide svelte-19u9n31"><span class="target-label svelte-19u9n31">Yeast</span> <span class="target-value svelte-19u9n31"> </span></div>'),as=i('<div class="targets-grid svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div> <!></div>');function ss(Q,l){ft(l,!0);function w(b){return b==null?"--":ht(b)}let C=M(()=>l.recipe.abv!=null?l.recipe.abv:l.recipe.og&&l.recipe.fg?(l.recipe.og-l.recipe.fg)*es:null);bt(Q,{title:"Recipe Targets",children:(b,f)=>{var z=as(),r=a(z),D=s(a(r),2),p=a(D,!0);t(D),t(r);var N=s(r,2),Y=s(a(N),2),K=a(Y,!0);t(Y),t(N);var u=s(N,2),j=s(a(u),2),S=a(j,!0);t(j),t(u);var H=s(u,2);{var F=O=>{var R=ts(),x=s(a(R),2),B=a(x,!0);t(x),t(R),c(()=>v(B,l.recipe.yeast_name)),n(O,R)};o(H,O=>{l.recipe.yeast_name&&O(F)})}t(z),c((O,R,x)=>{v(p,O),v(K,R),v(S,x)},[()=>w(l.recipe.og),()=>w(l.recipe.fg),()=>e(C)!=null?`${e(C).toFixed(1)}%`:"--"]),n(b,z)},$$slots:{default:!0}}),mt()}var rs=i('<p class="notes-content svelte-hkv31i"> </p>');function ls(Q,l){bt(Q,{title:"Notes",children:(w,C)=>{var b=rs(),f=a(b,!0);t(b),c(()=>v(f,l.notes)),n(w,b)},$$slots:{default:!0}})}var ns=i('<div class="ml-panel loading svelte-1xs394q"><p>Loading predictions...</p></div>'),is=i('<div class="ml-panel error svelte-1xs394q"><p class="error-text svelte-1xs394q"> </p></div>'),vs=i('<span class="anomaly-reasons svelte-1xs394q"> </span>'),os=i('<div class="anomaly-banner svelte-1xs394q"><span class="anomaly-icon svelte-1xs394q">‚ö†Ô∏è</span> <div class="anomaly-content svelte-1xs394q"><span class="anomaly-label svelte-1xs394q">Anomaly Detected</span> <!></div></div>'),ds=i('<span class="activity-badge svelte-1xs394q"> </span>'),cs=i('<div class="progress-section svelte-1xs394q"><div class="progress-header svelte-1xs394q"><span class="progress-label svelte-1xs394q">Fermentation Progress</span> <!></div> <div class="fermentation-progress-bar svelte-1xs394q"><div class="fermentation-fill svelte-1xs394q"></div></div> <div class="progress-labels svelte-1xs394q"><span class="og-label svelte-1xs394q"> </span> <span class="progress-percent svelte-1xs394q"> </span> <span class="fg-label svelte-1xs394q"> </span></div></div>'),us=i('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Predicted FG:</span> <span class="value svelte-1xs394q"> </span></div>'),_s=i('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Attenuation:</span> <span class="value attenuation svelte-1xs394q"> </span></div>'),gs=i('<span class="complete-now svelte-1xs394q">Ready now!</span>'),ps=i('<span class="days svelte-1xs394q"> </span>'),fs=i(" <!>",1),ms=i('<div class="metric completion-metric svelte-1xs394q"><span class="label svelte-1xs394q">Est. Completion:</span> <span class="value svelte-1xs394q"><!></span></div>'),hs=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),bs=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Data points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),js=i('<div><div class="panel-header svelte-1xs394q"><h3 class="panel-title svelte-1xs394q">Fermentation Intelligence</h3> <button type="button" class="reload-btn svelte-1xs394q" title="Recalculate predictions from database history"> </button></div> <!> <!> <div class="metrics svelte-1xs394q"><!> <!> <!> <div class="model-info svelte-1xs394q"><!> <!></div></div></div>'),xs=i('<div class="ml-panel disabled svelte-1xs394q"><div class="disabled-header svelte-1xs394q"><p class="unavailable-text svelte-1xs394q">ML predictions unavailable</p> <button type="button" class="reload-btn svelte-1xs394q" title="Reload predictions from database"> </button></div> <p class="unavailable-hint svelte-1xs394q">Predictions require at least 10 readings over 2+ hours</p></div>');function ys(Q,l){ft(l,!0);let w=pt(l,"measuredOg",3,null),C=pt(l,"currentSg",3,null),b=pt(l,"liveReading",3,null),f=fe(Jt({available:!1})),z=fe(!0),r=fe(!1),D=fe(null);async function p(){g(z,!0),g(D,null);try{g(f,await ya(l.batchId),!0)}catch(d){g(D,d instanceof Error?d.message:"Failed to load predictions",!0),console.error("Failed to load ML predictions:",d)}finally{g(z,!1)}}async function N(){g(r,!0),g(D,null);try{const d=await ka(l.batchId);console.log("Reloaded predictions:",d.message),await p()}catch(d){g(D,d instanceof Error?d.message:"Failed to reload predictions",!0),console.error("Failed to reload predictions:",d)}finally{g(r,!1)}}Yt(p);function Y(d){return d?new Date(d).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}):"N/A"}function K(d){if(!d)return null;const T=new Date(d),U=new Date,P=T.getTime()-U.getTime();return Math.ceil(P/(1e3*60*60*24))}let u=M(()=>{const d=w()??e(f).predicted_og,T=e(f).predicted_fg,U=C()??b()?.sg;if(!d||!T||!U||d<=T)return null;const P=d-T,y=(d-U)/P*100;return Math.min(100,Math.max(0,y))}),j=M(()=>{const d=w()??e(f).predicted_og,T=C()??b()?.sg;if(!d||!T||d<=1)return null;const U=(d-T)/(d-1)*100;return Math.min(100,Math.max(0,U))}),S=M(()=>{const d=b()?.sg_rate;if(d==null)return null;const T=Math.abs(d);return T>.002?{label:"Very Active",color:"#22c55e",emoji:"üî•"}:T>5e-4?{label:"Active",color:"#84cc16",emoji:"‚ú®"}:T>1e-4?{label:"Slowing",color:"#eab308",emoji:"üê¢"}:{label:"Complete",color:"#6b7280",emoji:"‚úì"}}),H=M(()=>b()?.is_anomaly??!1),F=M(()=>b()?.anomaly_reasons??[]);var O=Be(),R=J(O);{var x=d=>{var T=ns();n(d,T)},B=d=>{var T=Be(),U=J(T);{var P=y=>{var le=is(),he=a(le),ke=a(he);t(he),t(le),c(()=>v(ke,`‚ö†Ô∏è ${e(D)??""}`)),n(y,le)},X=y=>{var le=Be(),he=J(le);{var ke=Z=>{var re=js();let A;var G=a(re),I=s(a(G),2);I.__click=N;var ne=a(I,!0);t(I),t(G);var ie=s(G,2);{var we=m=>{var h=os(),L=s(a(h),2),ae=s(a(L),2);{var ze=oe=>{var Ee=vs(),_e=a(Ee,!0);t(Ee),c(je=>v(_e,je),[()=>e(F).join(", ")]),n(oe,Ee)};o(ae,oe=>{e(F).length>0&&oe(ze)})}t(L),t(h),n(m,h)};o(ie,m=>{e(H)&&m(we)})}var ce=s(ie,2);{var Te=m=>{var h=cs(),L=a(h),ae=s(a(L),2);{var ze=He=>{var Xe=ds(),ct=a(Xe);t(Xe),c(()=>{at(Xe,`color: ${e(S).color??""}`),v(ct,`${e(S).emoji??""} ${e(S).label??""}`)}),n(He,Xe)};o(ae,He=>{e(S)&&He(ze)})}t(L);var oe=s(L,2),Ee=a(oe);t(oe);var _e=s(oe,2),je=a(_e),Qe=a(je);t(je);var st=s(je,2),dt=a(st);t(st);var Me=s(st,2),rt=a(Me);t(Me),t(_e),t(h),c((He,Xe,ct)=>{at(Ee,`width: ${e(u)??""}%`),v(Qe,`OG: ${He??""}`),v(dt,`${Xe??""}%`),v(rt,`FG: ${ct??""}`)},[()=>ht(w()??e(f).predicted_og??0),()=>e(u).toFixed(0),()=>ht(e(f).predicted_fg??0)]),n(m,h)};o(ce,m=>{e(u)!==null&&m(Te)})}var Ke=s(ce,2),Ne=a(Ke);{var _=m=>{var h=us(),L=s(a(h),2),ae=a(L,!0);t(L),t(h),c(ze=>v(ae,ze),[()=>ht(e(f).predicted_fg)]),n(m,h)};o(Ne,m=>{e(f).predicted_fg&&m(_)})}var E=s(Ne,2);{var te=m=>{var h=_s(),L=s(a(h),2),ae=a(L);t(L),t(h),c(ze=>v(ae,`${ze??""}%`),[()=>e(j).toFixed(1)]),n(m,h)};o(E,m=>{e(j)!==null&&m(te)})}var V=s(E,2);{var Ge=m=>{const h=M(()=>K(e(f).estimated_completion));var L=ms(),ae=s(a(L),2),ze=a(ae);{var oe=_e=>{var je=gs();n(_e,je)},Ee=_e=>{var je=fs(),Qe=J(je),st=s(Qe);{var dt=Me=>{var rt=ps(),He=a(rt);t(rt),c(()=>v(He,`(${e(h)??""} ${e(h)===1?"day":"days"})`)),n(Me,rt)};o(st,Me=>{e(h)!==null&&Me(dt)})}c(Me=>v(Qe,`${Me??""} `),[()=>Y(e(f).estimated_completion)]),n(_e,je)};o(ze,_e=>{e(h)!==null&&e(h)<=0?_e(oe):_e(Ee,!1)})}t(ae),t(L),n(m,L)};o(V,m=>{e(f).estimated_completion&&m(Ge)})}var ue=s(V,2),ve=a(ue);{var be=m=>{var h=hs(),L=s(a(h),2),ae=a(L);t(L),t(h),c(ze=>v(ae,`${ze??""}%`),[()=>(e(f).r_squared*100).toFixed(0)]),n(m,h)};o(ve,m=>{e(f).r_squared!==void 0&&m(be)})}var Ue=s(ve,2);{var Ie=m=>{var h=bs(),L=s(a(h),2),ae=a(L,!0);t(L),t(h),c(()=>v(ae,e(f).num_readings)),n(m,h)};o(Ue,m=>{e(f).num_readings&&m(Ie)})}t(ue),t(Ke),t(re),c(()=>{A=Se(re,1,"ml-panel svelte-1xs394q",null,A,{"has-anomaly":e(H)}),I.disabled=e(r)||e(z),v(ne,e(r)?"Reloading...":"‚Üª Reload")}),n(Z,re)},Ye=Z=>{var re=xs(),A=a(re),G=s(a(A),2);G.__click=N;var I=a(G,!0);t(G),t(A),me(2),t(re),c(()=>{G.disabled=e(r)||e(z),v(I,e(r)?"Reloading...":"‚Üª Reload")}),n(Z,re)};o(he,Z=>{e(f).available?Z(ke):Z(Ye,!1)},!0)}n(y,le)};o(U,y=>{e(D)?y(P):y(X,!1)},!0)}n(d,T)};o(R,d=>{e(z)?d(x):d(B,!1)})}n(Q,O),mt()}yt(["click"]);var ks=i('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),ws=i('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),zs=i('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),qs=i('<span class="recipe-type svelte-g5au2j"> </span>'),Cs=i('<a class="recipe-link svelte-g5au2j"> <!></a>'),Fs=i('<option class="svelte-g5au2j"> </option>'),Rs=i('<span class="chilling-icon svelte-g5au2j">üç∫</span> <h3 class="chilling-title svelte-g5au2j">Ready to Pitch!</h3>',1),Bs=i('<span class="chilling-icon svelte-g5au2j">‚ùÑÔ∏è</span> <h3 class="chilling-title svelte-g5au2j">Chilling to Pitch Temperature</h3>',1),Ts=i('<div class="progress-section svelte-g5au2j"><div class="progress-bar svelte-g5au2j"><div class="progress-fill svelte-g5au2j"></div></div> <span class="progress-text svelte-g5au2j"> </span></div>'),Ms=i('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è No cooler configured - set a cooler entity to enable automated chilling</span>'),Ds=i('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è Temperature control disabled in settings</span>'),Ss=i('<span class="status-ready svelte-g5au2j">Wort has reached pitch temperature - ready to add yeast!</span>'),Os=i('<span class="status-active svelte-g5au2j">Cooler will run automatically when temp exceeds target + hysteresis</span>'),Ps=i('<div><div class="chilling-header svelte-g5au2j"><!></div> <div class="chilling-content svelte-g5au2j"><div class="temp-display svelte-g5au2j"><div class="temp-current svelte-g5au2j"><span class="temp-label svelte-g5au2j">Current</span> <span class="temp-value svelte-g5au2j"> </span></div> <div class="temp-arrow svelte-g5au2j">‚Üí</div> <div class="temp-target svelte-g5au2j"><span class="temp-label svelte-g5au2j">Target</span> <span class="temp-value svelte-g5au2j"> </span></div></div> <!> <div class="chilling-status svelte-g5au2j"><!></div></div></div>'),As=i('<span class="status-badge heater svelte-g5au2j">üî• ON</span>'),Gs=i('<span class="status-badge cooler svelte-g5au2j">‚ùÑÔ∏è ON</span>'),Es=i('<div class="device-status heater svelte-g5au2j"><div>üî•</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Heater</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Ls=i('<div class="device-status cooler svelte-g5au2j"><div>‚ùÑÔ∏è</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Cooler</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Ns=i('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">‚ö°</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),Us=i('<button type="button" class="override-btn heat-on svelte-g5au2j">Force Heat ON</button> <button type="button" class="override-btn heat-off svelte-g5au2j">Force Heat OFF</button>',1),Is=i('<button type="button" class="override-btn cool-on svelte-g5au2j">Force Cool ON</button> <button type="button" class="override-btn cool-off svelte-g5au2j">Force Cool OFF</button>',1),Hs=i('<div class="control-details svelte-g5au2j"><div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns-grid svelte-g5au2j"><!> <!> <button type="button" class="override-btn auto-mode svelte-g5au2j">Auto Mode</button></div></div>',1),Vs=i('<div class="device-status-grid svelte-g5au2j"><!> <!></div> <!>',1),Ws=i('<div><button type="button" class="collapsible-header svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="collapse-indicator svelte-g5au2j"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" class="svelte-g5au2j"></path></svg></div></button> <!></div>'),Js=i('<span class="svelte-g5au2j"> </span>'),Ys=i('<span class="svelte-g5au2j"> </span>'),Ks=i('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><!> <!> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),Qs=i('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j" aria-label="Delete batch"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <!> <div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!> <!></div></div>',1),Xs=i('<div class="modal-overlay svelte-g5au2j"><div class="modal svelte-g5au2j"><h2 class="modal-title svelte-g5au2j">Delete Batch?</h2> <p class="modal-text svelte-g5au2j"> </p> <div class="modal-actions svelte-g5au2j"><button type="button" class="modal-btn cancel svelte-g5au2j">Cancel</button> <button type="button" class="modal-btn delete svelte-g5au2j"> </button></div></div></div>'),Zs=i('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div> <!>',1);function hr(Q,l){ft(l,!0);const w=()=>ba(ja,"$page",C),[C,b]=ha();let f=null,z=null,r=fe(null),D=fe(null),p=fe(null);Jt([]);let N=fe(!0),Y=fe(null),K=fe(!1),u=fe(!1),j=fe(!1),S=fe(!1),H=fe(!1),F=fe(!1),O=M(()=>parseInt(w().params.id??"0"));const R={planning:{label:"Planning",color:"var(--text-secondary)",bg:"var(--bg-elevated)"},fermenting:{label:"Fermenting",color:"#f59e0b",bg:"rgba(245, 158, 11, 0.12)"},conditioning:{label:"Conditioning",color:"#8b5cf6",bg:"rgba(139, 92, 246, 0.12)"},completed:{label:"Completed",color:"var(--positive)",bg:"rgba(34, 197, 94, 0.12)"},archived:{label:"Archived",color:"var(--text-muted)",bg:"var(--bg-elevated)"}},x=["planning","fermenting","conditioning","completed","archived"];let B=M(()=>e(r)?R[e(r).status]:R.planning),d=M($t),T=M(()=>xt.config.ha_enabled&&xt.config.temp_control_enabled&&(e(r)?.heater_entity_id||e(r)?.cooler_entity_id)),U=M(()=>e(r)?.status==="planning"&&e(r)?.temp_target!=null),P=M(()=>!e(U)||!e(y)?.temp||!e(r)?.temp_target?!1:e(y).temp<=e(r).temp_target),X=M(()=>{if(!e(U)||!e(y)?.temp||!e(r)?.temp_target)return null;const _=e(r).temp_target+30,E=e(y).temp,te=e(r).temp_target;if(E<=te)return 100;if(E>=_)return 0;const V=(_-E)/(_-te)*100;return Math.min(100,Math.max(0,V))}),y=M(()=>{if(!e(r)?.device_id)return null;const _=Wt.tilts.get(e(r).device_id);if(_)return _;const E=e(r).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!E?.[1])return null;const te=E[1].toUpperCase();for(const V of Wt.tilts.values())if(V.color&&V.color.toUpperCase()===te)return V;return null});async function le(){g(N,!0),g(Y,null);try{if(g(r,await wa(e(O)),!0),e(r).status==="fermenting"||e(r).status==="conditioning")try{g(D,await Ht(e(O)),!0)}catch{}if(e(r).heater_entity_id||e(r).cooler_entity_id)try{g(p,await jt(e(O)),!0)}catch{}}catch(_){g(Y,_ instanceof Error?_.message:"Failed to load batch",!0)}finally{g(N,!1)}}async function he(_){if(!(!e(r)||e(u))&&!(_==="conditioning"&&e(r).status==="fermenting"&&!confirm(`üí° Entering Conditioning Phase

Reminder: Adjust target temperature if cold crashing.
Temperature control will continue during conditioning.

Continue?`))){g(u,!0);try{g(r,await Vt(e(r).id,{status:_}),!0),(_==="fermenting"||_==="conditioning")&&g(D,await Ht(e(r).id),!0)}catch(E){console.error("Failed to update status:",E)}finally{g(u,!1)}}}async function ke(_){if(e(r)&&(g(r,await Vt(e(r).id,_),!0),g(K,!1),e(r).heater_entity_id||e(r).cooler_entity_id))try{g(p,await jt(e(r).id),!0)}catch{}}async function Ye(){if(e(r)){g(H,!0);try{await za(e(r).id),xa("/batches")}catch(_){g(Y,_ instanceof Error?_.message:"Failed to delete batch",!0),g(H,!1),g(S,!1)}}}async function Z(_,E){if(!(!e(r)||e(j))){g(j,!0);try{await Ft(e(r).id,E,60,_),g(p,await jt(e(r).id),!0)}catch(te){console.error("Failed to set override:",te)}finally{g(j,!1)}}}async function re(){if(!(!e(r)||e(j))){g(j,!0);try{e(r).heater_entity_id&&await Ft(e(r).id,null,60,"heater"),e(r).cooler_entity_id&&await Ft(e(r).id,null,60,"cooler"),g(p,await jt(e(r).id),!0)}catch(_){console.error("Failed to clear overrides:",_)}finally{g(j,!1)}}}function A(){if(f?.readyState===WebSocket.OPEN)return;const E=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;f=new WebSocket(E),f.onmessage=async te=>{try{const V=JSON.parse(te.data);V.type==="control_event"&&V.batch_id===e(O)&&e(p)&&(V.action==="heat_on"?g(p,{...e(p),heater_state:"on"},!0):V.action==="heat_off"?g(p,{...e(p),heater_state:"off"},!0):V.action==="cool_on"?g(p,{...e(p),cooler_state:"on"},!0):V.action==="cool_off"&&g(p,{...e(p),cooler_state:"off"},!0))}catch{}},f.onclose=()=>{f=null,z=setTimeout(A,3e3)},f.onerror=()=>{f?.close()}}function G(){z&&(clearTimeout(z),z=null),f?.close(),f=null}function I(_){return _==null?"--":Zt(_)}Yt(()=>{le(),A()}),ua(()=>{G()});var ne=Zs();pa("g5au2j",_=>{_a(()=>{ga.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var ie=J(ne),we=s(a(ie),2);{var ce=_=>{var E=ks();n(_,E)},Te=_=>{var E=Be(),te=J(E);{var V=ue=>{var ve=ws(),be=s(a(ve),2),Ue=a(be,!0);t(be);var Ie=s(be,2);Ie.__click=le,t(ve),c(()=>v(Ue,e(Y))),n(ue,ve)},Ge=ue=>{var ve=Be(),be=J(ve);{var Ue=m=>{var h=zs();n(m,h)},Ie=m=>{var h=Be(),L=J(h);{var ae=oe=>{qa(oe,{get batch(){return e(r)},onSubmit:ke,onCancel:()=>g(K,!1)})},ze=oe=>{var Ee=Qs(),_e=J(Ee),je=a(_e),Qe=a(je),st=a(Qe);t(Qe);var dt=s(Qe,2),Me=a(dt),rt=a(Me,!0);t(Me);var He=s(Me,2);{var Xe=q=>{var $=Cs(),de=a($),xe=s(de);{var qe=De=>{var Le=qs(),We=a(Le);t(Le),c(()=>v(We,`(${e(r).recipe.type??""})`)),n(De,Le)};o(xe,De=>{e(r).recipe.type&&De(qe)})}t($),c(()=>{Xt($,"href",`/recipes/${e(r).recipe.id??""}`),v(de,`${e(r).recipe.name??""} `)}),n(q,$)};o(He,q=>{e(r).recipe&&q(Xe)})}t(dt),t(je);var ct=s(je,2),kt=a(ct),Ve=a(kt);Ve.__change=q=>he(q.currentTarget.value),Kt(Ve,21,()=>x,Qt,(q,$)=>{var de=Fs(),xe=a(de,!0);t(de);var qe={};c(()=>{v(xe,R[e($)].label),qe!==(qe=e($))&&(de.value=(de.__value=e($))??"")}),n(q,de)}),t(Ve);var Rt;fa(Ve),t(kt);var Bt=s(kt,2);Bt.__click=()=>g(K,!0);var ta=s(Bt,2);ta.__click=()=>g(S,!0),t(ct),t(_e);var Tt=s(_e,2);{var aa=q=>{var $=Ps();let de;var xe=a($),qe=a(xe);{var De=k=>{var W=Rs();me(2),n(k,W)},Le=k=>{var W=Bs();me(2),n(k,W)};o(qe,k=>{e(P)?k(De):k(Le,!1)})}t(xe);var We=s(xe,2),lt=a(We),Ze=a(lt),ut=s(a(Ze),2),Oe=a(ut,!0);t(ut),t(Ze);var ee=s(Ze,4),ye=s(a(ee),2),nt=a(ye,!0);t(ye),t(ee),t(lt);var it=s(lt,2);{var vt=k=>{var W=Ts(),ge=a(W),Ce=a(ge);t(ge);var Fe=s(ge,2),se=a(Fe);t(Fe),t(W),c(pe=>{at(Ce,`width: ${e(X)??""}%`),v(se,`${pe??""}% to target`)},[()=>Math.round(e(X))]),n(k,W)};o(it,k=>{e(X)!=null&&!e(P)&&k(vt)})}var _t=s(it,2),zt=a(_t);{var qt=k=>{var W=Ms();n(k,W)},Ct=k=>{var W=Be(),ge=J(W);{var Ce=se=>{var pe=Ds();n(se,pe)},Fe=se=>{var pe=Be(),$e=J(pe);{var Je=tt=>{var gt=Ss();n(tt,gt)},et=tt=>{var gt=Os();n(tt,gt)};o($e,tt=>{e(P)?tt(Je):tt(et,!1)},!0)}n(se,pe)};o(ge,se=>{!xt.config.ha_enabled||!xt.config.temp_control_enabled?se(Ce):se(Fe,!1)},!0)}n(k,W)};o(zt,k=>{e(r).cooler_entity_id?k(Ct,!1):k(qt)})}t(_t),t(We),t($),c((k,W)=>{de=Se($,1,"chilling-banner svelte-g5au2j",null,de,{ready:e(P)}),v(Oe,k),v(nt,W)},[()=>e(y)?.temp!=null?I(e(y).temp):"--",()=>e(r).temp_target!=null?I(e(r).temp_target):"--"]),n(q,$)};o(Tt,q=>{e(U)&&q(aa)})}var Mt=s(Tt,2),wt=a(Mt),Dt=a(wt);{let q=M(()=>e(y)?.sg??e(D)?.measured?.current_sg);Ua(Dt,{get batch(){return e(r)},get currentSg(){return e(q)},get progress(){return e(D)},get liveReading(){return e(y)}})}var sa=s(Dt,2);{var ra=q=>{ss(q,{get recipe(){return e(r).recipe}})};o(sa,q=>{e(r).recipe&&q(ra)})}t(wt);var St=s(wt,2),Ot=a(St);Ha(Ot,{get batch(){return e(r)}});var Pt=s(Ot,2);$a(Pt,{get batch(){return e(r)},get liveReading(){return e(y)},onEdit:()=>g(K,!0)});var At=s(Pt,2);{let q=M(()=>e(y)?.sg);ys(At,{get batchId(){return e(r).id},get measuredOg(){return e(r).measured_og},get currentSg(){return e(q)},get liveReading(){return e(y)}})}var Gt=s(At,2);{var la=q=>{var $=Ws();let de;var xe=a($);xe.__click=()=>g(F,!e(F));var qe=s(a(xe),2),De=a(qe);{var Le=ee=>{var ye=As();n(ee,ye)},We=ee=>{var ye=Be(),nt=J(ye);{var it=vt=>{var _t=Gs();n(vt,_t)};o(nt,vt=>{e(p)?.cooler_state==="on"&&vt(it)},!0)}n(ee,ye)};o(De,ee=>{e(p)?.heater_state==="on"?ee(Le):ee(We,!1)})}var lt=s(De,2);let Ze;t(qe),t(xe);var ut=s(xe,2);{var Oe=ee=>{var ye=Vs(),nt=J(ye),it=a(nt);{var vt=k=>{var W=Es(),ge=a(W);let Ce;var Fe=s(ge,2),se=s(a(Fe),2);let pe;var $e=a(se,!0);t(se);var Je=s(se,2),et=a(Je,!0);t(Je),t(Fe),t(W),c(()=>{Ce=Se(ge,1,"device-icon-wrap svelte-g5au2j",null,Ce,{active:e(p)?.heater_state==="on"}),pe=Se(se,1,"device-state svelte-g5au2j",null,pe,{on:e(p)?.heater_state==="on"}),v($e,e(p)?.heater_state==="on"?"ON":"OFF"),v(et,e(r).heater_entity_id)}),n(k,W)};o(it,k=>{e(r).heater_entity_id&&k(vt)})}var _t=s(it,2);{var zt=k=>{var W=Ls(),ge=a(W);let Ce;var Fe=s(ge,2),se=s(a(Fe),2);let pe;var $e=a(se,!0);t(se);var Je=s(se,2),et=a(Je,!0);t(Je),t(Fe),t(W),c(()=>{Ce=Se(ge,1,"device-icon-wrap svelte-g5au2j",null,Ce,{active:e(p)?.cooler_state==="on"}),pe=Se(se,1,"device-state svelte-g5au2j",null,pe,{on:e(p)?.cooler_state==="on"}),v($e,e(p)?.cooler_state==="on"?"ON":"OFF"),v(et,e(r).cooler_entity_id)}),n(k,W)};o(_t,k=>{e(r).cooler_entity_id&&k(zt)})}t(nt);var qt=s(nt,2);{var Ct=k=>{var W=Hs(),ge=J(W),Ce=a(ge),Fe=s(a(Ce),2),se=a(Fe);t(Fe),t(Ce);var pe=s(Ce,2),$e=s(a(pe),2),Je=a($e);t($e),t(pe),t(ge);var et=s(ge,2);{var tt=Re=>{var Pe=Ns(),Ae=s(a(Pe),2),ot=a(Ae);t(Ae);var It=s(Ae,2);It.__click=()=>re(),t(Pe),c(ca=>{v(ot,`Override active: ${ca??""}`),It.disabled=e(j)},[()=>e(p).override_state?.toUpperCase()]),n(Re,Pe)};o(et,Re=>{e(p).override_active&&Re(tt)})}var gt=s(et,2),Et=s(a(gt),2),Lt=a(Et);{var oa=Re=>{var Pe=Us(),Ae=J(Pe);Ae.__click=()=>Z("heater","on");var ot=s(Ae,2);ot.__click=()=>Z("heater","off"),c(()=>{Ae.disabled=e(j),ot.disabled=e(j)}),n(Re,Pe)};o(Lt,Re=>{e(r).heater_entity_id&&Re(oa)})}var Nt=s(Lt,2);{var da=Re=>{var Pe=Is(),Ae=J(Pe);Ae.__click=()=>Z("cooler","on");var ot=s(Ae,2);ot.__click=()=>Z("cooler","off"),c(()=>{Ae.disabled=e(j),ot.disabled=e(j)}),n(Re,Pe)};o(Nt,Re=>{e(r).cooler_entity_id&&Re(da)})}var Ut=s(Nt,2);Ut.__click=()=>re(),t(Et),t(gt),c((Re,Pe)=>{v(se,`${Re??""}${e(d)??""}`),v(Je,`¬±${Pe??""}${e(d)??""}`),Ut.disabled=e(j)},[()=>I(e(p).target_temp),()=>e(p).hysteresis?.toFixed(1)||"--"]),n(k,W)};o(qt,k=>{e(p)&&k(Ct)})}n(ee,ye)};o(ut,ee=>{e(F)||ee(Oe)})}t($),c(()=>{de=Se($,1,"info-card temp-control-card svelte-g5au2j",null,de,{"heater-on":e(p)?.heater_state==="on","cooler-on":e(p)?.cooler_state==="on",collapsed:e(F)}),Ze=Se(lt,0,"chevron svelte-g5au2j",null,Ze,{rotated:!e(F)})}),n(q,$)},na=q=>{var $=Be(),de=J($);{var xe=qe=>{var De=Ks(),Le=s(a(De),2),We=a(Le);{var lt=Oe=>{var ee=Js(),ye=a(ee);t(ee),c(()=>v(ye,`Heater: ${e(r).heater_entity_id??""}`)),n(Oe,ee)};o(We,Oe=>{e(r).heater_entity_id&&Oe(lt)})}var Ze=s(We,2);{var ut=Oe=>{var ee=Ys(),ye=a(ee);t(ee),c(()=>v(ye,`Cooler: ${e(r).cooler_entity_id??""}`)),n(Oe,ee)};o(Ze,Oe=>{e(r).cooler_entity_id&&Oe(ut)})}me(2),t(Le),t(De),n(qe,De)};o(de,qe=>{(e(r).heater_entity_id||e(r).cooler_entity_id)&&e(r).status!=="fermenting"&&qe(xe)},!0)}n(q,$)};o(Gt,q=>{e(T)&&(e(r).status==="fermenting"||e(r).status==="conditioning")?q(la):q(na,!1)})}var ia=s(Gt,2);{var va=q=>{ls(q,{get notes(){return e(r).notes}})};o(ia,q=>{e(r).notes&&q(va)})}t(St),t(Mt),c(()=>{v(st,`#${(e(r).batch_number||"?")??""}`),v(rt,e(r).name||e(r).recipe?.name||"Unnamed Batch"),Ve.disabled=e(u),at(Ve,`color: ${e(B).color??""}; background: ${e(B).bg??""};`),Rt!==(Rt=e(r).status)&&(Ve.value=(Ve.__value=e(r).status)??"",ma(Ve,e(r).status))}),n(oe,Ee)};o(L,oe=>{e(K)?oe(ae):oe(ze,!1)},!0)}n(m,h)};o(be,m=>{e(r)?m(Ie,!1):m(Ue)},!0)}n(ue,ve)};o(te,ue=>{e(Y)?ue(V):ue(Ge,!1)},!0)}n(_,E)};o(we,_=>{e(N)?_(ce):_(Te,!1)})}t(ie);var Ke=s(ie,2);{var Ne=_=>{var E=Xs();E.__click=()=>g(S,!1);var te=a(E);te.__click=Ie=>Ie.stopPropagation();var V=s(a(te),2),Ge=a(V);t(V);var ue=s(V,2),ve=a(ue);ve.__click=()=>g(S,!1);var be=s(ve,2);be.__click=Ye;var Ue=a(be,!0);t(be),t(ue),t(te),t(E),c(()=>{v(Ge,`Are you sure you want to delete "${(e(r)?.name||"this batch")??""}"? This cannot be undone.`),ve.disabled=e(H),be.disabled=e(H),v(Ue,e(H)?"Deleting...":"Delete Batch")}),n(_,E)};o(Ke,_=>{e(S)&&_(Ne)})}n(Q,ne),mt(),b()}yt(["click","change"]);export{hr as component,mr as universal};
