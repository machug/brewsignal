import{d as jt,f as i,s as v,a as n,c as Me}from"../chunks/CsQfwH0S.js";import{al as a,ak as s,an as t,ar as _,ah as _t,at as K,c as e,ai as R,as as xe,aj as gt,aq as ke,p as At,ao as Gt,s as g,aL as ea,ay as ta,am as aa}from"../chunks/fKkNMI8q.js";import{e as Et,i as Lt}from"../chunks/COk1ZY4R.js";import{i as o}from"../chunks/BvBRaQNg.js";import{h as sa}from"../chunks/DLseniaC.js";import{s as Ut}from"../chunks/DbN3nGCc.js";import{s as Oe}from"../chunks/BDI2zAFW.js";import{s as st}from"../chunks/CcRNvR1k.js";import{i as ra,s as la}from"../chunks/C8srtpii.js";import{s as na,a as ia}from"../chunks/C51ud8ec.js";import{p as va}from"../chunks/C-N41BG5.js";import{g as oa}from"../chunks/C0D9TBiE.js";import{z as da,A as ca,q as ua,j as St,B as ht,k as _a,x as Pt,C as kt}from"../chunks/i8VL_lOf.js";import{d as ft,e as Nt,g as It,c as bt}from"../chunks/CPwbAm-l.js";import{t as Ot}from"../chunks/C8NDSE1R.js";import{B as ga}from"../chunks/DTfC6M4H.js";import{s as pa}from"../chunks/Bdaed-dN.js";import{p as ut}from"../chunks/CllCHKBI.js";const fa=!1,ar=Object.freeze(Object.defineProperty({__proto__:null,prerender:fa},Symbol.toStringTag,{value:"Module"}));function ma(Q){return Q>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:Q>=-60?{bars:3,color:"var(--positive)",label:"Good"}:Q>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function Ht(Q){const l=Math.floor((Date.now()-new Date(Q).getTime())/1e3);if(l<10)return"just now";if(l<60)return`${l}s ago`;const k=Math.floor(l/60);if(k<60)return`${k}m ago`;const z=Math.floor(k/60);return z<24?`${z}h ago`:`${Math.floor(z/24)}d ago`}var ha=i('<div class="accent-bar svelte-1oyrwd9"></div>'),ba=i('<span class="card-icon svelte-1oyrwd9"> </span>'),ja=i('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),ya=i('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function mt(Q,l){let k=ut(l,"highlight",3,!1),z=ut(l,"collapsible",3,!1),b=ut(l,"expanded",3,!1);var f=ya();let q;var r=a(f);{var B=y=>{var C=ha();n(y,C)};o(r,y=>{k()&&y(B)})}var p=s(r,2),E=a(p),H=a(E);{var W=y=>{var C=ba(),d=a(C,!0);t(C),_(()=>v(d,l.icon)),n(y,C)};o(H,y=>{l.icon&&y(W)})}var u=s(H,2),j=a(u,!0);t(u),t(E);var T=s(E,2);{var L=y=>{var C=ja();C.__click=function(...D){l.onToggle?.apply(this,D)};var d=a(C);let x;t(C),_(()=>{Ut(C,"aria-label",b()?"Collapse":"Expand"),x=Oe(d,0,"expand-icon svelte-1oyrwd9",null,x,{"rotate-180":b()})}),n(y,C)};o(T,y=>{z()&&l.onToggle&&y(L)})}t(p);var M=s(p,2);let O;var A=a(M);pa(A,()=>l.children),t(M),t(f),_(()=>{q=Oe(f,1,"batch-card svelte-1oyrwd9",null,q,{highlight:k()}),v(j,l.title),O=Oe(M,1,"card-content svelte-1oyrwd9",null,O,{collapsed:z()&&!b()})}),n(Q,f)}jt(["click"]);var xa=i('<span class="updated-text svelte-t80j9z"> </span>'),ka=i('<div class="hero-divider svelte-t80j9z"></div> <div class="hero-metric temperature svelte-t80j9z"><span class="hero-value svelte-t80j9z"> <span class="hero-unit svelte-t80j9z"> </span></span> <span class="hero-label svelte-t80j9z">Temperature</span></div>',1),wa=i('<div class="remaining-text svelte-t80j9z"> </div>'),za=i('<div class="progress-section svelte-t80j9z"><div class="progress-labels svelte-t80j9z"><div class="progress-endpoint start svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">OG</span></div> <div class="progress-current svelte-t80j9z"><span class="current-percent svelte-t80j9z"> </span></div> <div class="progress-endpoint end svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">Target FG</span></div></div> <div class="progress-track svelte-t80j9z"><div class="progress-fill svelte-t80j9z"></div> <div><div class="marker-dot svelte-t80j9z"></div> <div class="marker-value svelte-t80j9z"> </div></div></div> <!></div>'),qa=i('<div class="metrics-row svelte-t80j9z"><div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">ABV</span></div> <div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">Attenuation</span></div></div>'),Ca=i('<div class="status-row svelte-t80j9z"><div class="live-indicator svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> <span class="status-text svelte-t80j9z">LIVE</span></div> <!></div> <div class="hero-section svelte-t80j9z"><div class="hero-metric gravity svelte-t80j9z"><span class="hero-value svelte-t80j9z"> </span> <span class="hero-label svelte-t80j9z">Gravity</span></div> <!></div> <!> <!>',1),Fa=i('<div class="completed-grid svelte-t80j9z"><div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Original Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Final Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">ABV</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Attenuation</span></div></div>'),Ra=i('<div class="empty-state svelte-t80j9z"><div class="empty-icon svelte-t80j9z">‚óé</div> <p class="empty-text svelte-t80j9z">Set Original Gravity to track fermentation</p></div>');function Ba(Q,l){_t(l,!0);let k=R(()=>l.currentSg??l.progress?.measured?.current_sg),z=R(()=>l.liveReading?.temp??l.progress?.temperature?.current),b=R(()=>l.liveReading?.last_seen),f=R(()=>e(b)?Ht(e(b)):null),q=R(It),r=R(()=>{if(!l.batch.measured_og||!e(k))return null;const u=Math.max(0,(l.batch.measured_og-e(k))*131.25),j=l.batch.measured_og-1,T=j!==0?Math.max(0,Math.min(100,(l.batch.measured_og-e(k))/j*100)):0;return{abv:u,attenuation:T}}),B=R(()=>{const u=l.batch.measured_og,j=l.batch.recipe?.fg;if(!u||!j||!e(k))return null;const T=u-j,L=u-e(k);return T<=0?null:Math.max(0,Math.min(100,L/T*100))}),p=R(()=>l.batch.status==="fermenting"||l.batch.status==="conditioning");function E(u){return u==null?"--":ft(u)}function H(u){return u==null?"--":`${u.toFixed(1)}%`}function W(u){return u==null?"--":Nt(u)}mt(Q,{title:"Fermentation",children:(u,j)=>{var T=Me(),L=K(T);{var M=A=>{var y=Ca(),C=K(y),d=s(a(C),2);{var x=I=>{var U=xa(),V=a(U);t(U),_(()=>v(V,`Updated ${e(f)??""}`)),n(I,U)};o(d,I=>{e(f)&&I(x)})}t(C);var D=s(C,2),G=a(D),F=a(G),J=a(F,!0);t(F),xe(2),t(G);var ie=s(G,2);{var me=I=>{var U=ka(),V=s(K(U),2),le=a(V),he=a(le,!0),ze=s(he),ge=a(ze,!0);t(ze),t(le),xe(2),t(V),_(Be=>{v(he,Be),v(ge,e(q))},[()=>W(e(z))]),n(I,U)};o(ie,I=>{e(z)!=null&&I(me)})}t(D);var we=s(D,2);{var De=I=>{var U=za(),V=a(U),le=a(V),he=a(le),ze=a(he,!0);t(he),xe(2),t(le);var ge=s(le,2),Be=a(ge),$e=a(Be);t(Be),t(ge);var c=s(ge,2),S=a(c),ae=a(S,!0);t(S),xe(2),t(c),t(V);var N=s(V,2),Ie=a(N),ve=s(Ie,2);let oe;var de=s(a(ve),2),He=a(de,!0);t(de),t(ve),t(N);var Ve=s(N,2);{var Ae=m=>{var h=wa(),P=a(h);t(h),_(Z=>v(P,`${Z??""} points to go`),[()=>l.progress.progress.sg_remaining.toFixed(3)]),n(m,h)};o(Ve,m=>{l.progress?.progress?.sg_remaining!=null&&l.progress.progress.sg_remaining>0&&m(Ae)})}t(U),_((m,h,P,Z)=>{v(ze,m),v($e,`${h??""}%`),v(ae,P),st(Ie,`width: ${e(B)??""}%`),oe=Oe(ve,1,"progress-marker svelte-t80j9z",null,oe,{"at-start":e(B)<3}),st(ve,`left: ${e(B)??""}%`),v(He,Z)},[()=>E(l.batch.measured_og),()=>e(B).toFixed(0),()=>E(l.batch.recipe.fg),()=>E(e(k))]),n(I,U)};o(we,I=>{e(B)!==null&&l.batch.measured_og&&l.batch.recipe?.fg&&I(De)})}var te=s(we,2);{var re=I=>{var U=qa(),V=a(U),le=a(V),he=a(le,!0);t(le),xe(2),t(V);var ze=s(V,2),ge=a(ze),Be=a(ge,!0);t(ge),xe(2),t(ze),t(U),_(($e,c)=>{v(he,$e),v(Be,c)},[()=>H(e(r).abv),()=>H(e(r).attenuation)]),n(I,U)};o(te,I=>{e(r)&&I(re)})}_(I=>v(J,I),[()=>E(e(k))]),n(A,y)},O=A=>{var y=Me(),C=K(y);{var d=D=>{var G=Fa(),F=a(G),J=a(F),ie=a(J,!0);t(J),xe(2),t(F);var me=s(F,2),we=a(me),De=a(we,!0);t(we),xe(2),t(me);var te=s(me,2),re=a(te),I=a(re,!0);t(re),xe(2),t(te);var U=s(te,2),V=a(U),le=a(V,!0);t(V),xe(2),t(U),t(G),_((he,ze,ge,Be)=>{v(ie,he),v(De,ze),v(I,ge),v(le,Be)},[()=>E(l.batch.measured_og),()=>E(l.batch.measured_fg),()=>l.batch.measured_abv!=null?H(l.batch.measured_abv):"--",()=>l.batch.measured_attenuation!=null?H(l.batch.measured_attenuation):"--"]),n(D,G)},x=D=>{var G=Ra();n(D,G)};o(C,D=>{l.batch.measured_og?D(d):D(x,!1)},!0)}n(A,y)};o(L,A=>{e(k)&&e(p)?A(M):A(O,!1)})}n(u,T)},$$slots:{default:!0}}),gt()}var Ta=i('<div class="timeline svelte-yskb8i"><div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Brew Date</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Started</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Ended</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Created</span> <span class="timeline-value svelte-yskb8i"> </span></div></div>');function Ma(Q,l){_t(l,!0);function k(b){return b?new Date(b).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"}):"--"}function z(b){return b?new Date(b).toLocaleString("en-GB",{day:"numeric",month:"short",hour:"numeric",minute:"2-digit"}):"--"}mt(Q,{title:"Timeline",children:(b,f)=>{var q=Ta(),r=a(q),B=s(a(r),2),p=a(B,!0);t(B),t(r);var E=s(r,2),H=s(a(E),2),W=a(H,!0);t(H),t(E);var u=s(E,2),j=s(a(u),2),T=a(j,!0);t(j),t(u);var L=s(u,2),M=s(a(L),2),O=a(M,!0);t(M),t(L),t(q),_((A,y,C,d)=>{v(p,A),v(W,y),v(T,C),v(O,d)},[()=>k(l.batch.brew_date),()=>z(l.batch.start_time),()=>z(l.batch.end_time),()=>z(l.batch.created_at)]),n(b,q)},$$slots:{default:!0}}),gt()}var Da=i('<div class="signal-bar svelte-1kdxwtz"></div>'),Sa=i('<div class="signal-details svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="signal-text svelte-1kdxwtz"> </span></div>'),Pa=i('<div class="device-last-seen svelte-1kdxwtz"> </div>'),Oa=i('<div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!> <!>',1),Aa=i('<div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <div class="device-last-seen svelte-1kdxwtz">Not receiving data</div>',1),Ga=i('<div class="device-info svelte-1kdxwtz"><!></div>'),Ea=i('<button type="button" class="link-btn svelte-1kdxwtz">Link a device</button>'),La=i('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function Ua(Q,l){_t(l,!0);let k=R(()=>l.liveReading?.device_type==="tilt"),z=R(()=>e(k)&&l.liveReading?.rssi?ma(l.liveReading.rssi):null),b=R(()=>l.liveReading?.last_seen?Ht(l.liveReading.last_seen):null),f=R(()=>{if(!l.liveReading)return l.batch.device_id||"Unknown";const q=l.liveReading.device_type;return q==="tilt"?`${l.liveReading.color} Tilt`:q==="gravitymon"?`GravityMon (${l.liveReading.id})`:q==="ispindel"?`iSpindel (${l.liveReading.id})`:q==="floaty"?`Floaty (${l.liveReading.id})`:l.liveReading.color||l.liveReading.id});mt(Q,{title:"Tracking Device",children:(q,r)=>{var B=Me(),p=K(B);{var E=W=>{var u=Ga(),j=a(u);{var T=M=>{var O=Oa(),A=K(O),y=s(a(A));t(A);var C=s(A,2);{var d=G=>{var F=Sa(),J=a(F);Et(J,20,()=>Array(4),Lt,(we,De,te)=>{var re=Da();_(()=>st(re,`
										height: ${6+te*3}px;
										background: ${(te<e(z).bars?e(z).color:"var(--bg-hover)")??""};
										opacity: ${te<e(z).bars?1:.4};
									`)),n(we,re)}),t(J);var ie=s(J,2),me=a(ie);t(ie),t(F),_(()=>{st(ie,`color: ${e(z).color??""}`),v(me,`${e(z).label??""} (${l.liveReading.rssi??""} dBm)`)}),n(G,F)};o(C,G=>{e(z)&&G(d)})}var x=s(C,2);{var D=G=>{var F=Pa(),J=a(F);t(F),_(()=>v(J,`Updated ${e(b)??""}`)),n(G,F)};o(x,G=>{e(b)&&G(D)})}_(()=>v(y,` ${e(f)??""} - Connected`)),n(M,O)},L=M=>{var O=Aa(),A=K(O),y=s(a(A));t(A),xe(2),_(()=>v(y,` Device: ${l.batch.device_id??""}`)),n(M,O)};o(j,M=>{l.liveReading?M(T):M(L,!1)})}t(u),n(W,u)},H=W=>{var u=La(),j=s(a(u),2);{var T=L=>{var M=Ea();M.__click=function(...O){l.onEdit?.apply(this,O)},n(L,M)};o(j,L=>{l.onEdit&&L(T)})}t(u),n(W,u)};o(p,W=>{l.batch.device_id?W(E):W(H,!1)})}n(q,B)},$$slots:{default:!0}}),gt()}jt(["click"]);const Na=131.25;var Ia=i('<div class="target wide svelte-19u9n31"><span class="target-label svelte-19u9n31">Yeast</span> <span class="target-value svelte-19u9n31"> </span></div>'),Ha=i('<div class="targets-grid svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div> <!></div>');function Va(Q,l){_t(l,!0);function k(b){return b==null?"--":ft(b)}let z=R(()=>l.recipe.abv!=null?l.recipe.abv:l.recipe.og&&l.recipe.fg?(l.recipe.og-l.recipe.fg)*Na:null);mt(Q,{title:"Recipe Targets",children:(b,f)=>{var q=Ha(),r=a(q),B=s(a(r),2),p=a(B,!0);t(B),t(r);var E=s(r,2),H=s(a(E),2),W=a(H,!0);t(H),t(E);var u=s(E,2),j=s(a(u),2),T=a(j,!0);t(j),t(u);var L=s(u,2);{var M=O=>{var A=Ia(),y=s(a(A),2),C=a(y,!0);t(y),t(A),_(()=>v(C,l.recipe.yeast_name)),n(O,A)};o(L,O=>{l.recipe.yeast_name&&O(M)})}t(q),_((O,A,y)=>{v(p,O),v(W,A),v(T,y)},[()=>k(l.recipe.og),()=>k(l.recipe.fg),()=>e(z)!=null?`${e(z).toFixed(1)}%`:"--"]),n(b,q)},$$slots:{default:!0}}),gt()}var Wa=i('<p class="notes-content svelte-hkv31i"> </p>');function Ja(Q,l){mt(Q,{title:"Notes",children:(k,z)=>{var b=Wa(),f=a(b,!0);t(b),_(()=>v(f,l.notes)),n(k,b)},$$slots:{default:!0}})}var Ya=i('<div class="ml-panel loading svelte-1xs394q"><p>Loading predictions...</p></div>'),Ka=i('<div class="ml-panel error svelte-1xs394q"><p class="error-text svelte-1xs394q"> </p></div>'),Qa=i('<span class="anomaly-reasons svelte-1xs394q"> </span>'),Xa=i('<div class="anomaly-banner svelte-1xs394q"><span class="anomaly-icon svelte-1xs394q">‚ö†Ô∏è</span> <div class="anomaly-content svelte-1xs394q"><span class="anomaly-label svelte-1xs394q">Anomaly Detected</span> <!></div></div>'),Za=i('<span class="activity-badge svelte-1xs394q"> </span>'),$a=i('<div class="progress-section svelte-1xs394q"><div class="progress-header svelte-1xs394q"><span class="progress-label svelte-1xs394q">Fermentation Progress</span> <!></div> <div class="fermentation-progress-bar svelte-1xs394q"><div class="fermentation-fill svelte-1xs394q"></div></div> <div class="progress-labels svelte-1xs394q"><span class="og-label svelte-1xs394q"> </span> <span class="progress-percent svelte-1xs394q"> </span> <span class="fg-label svelte-1xs394q"> </span></div></div>'),es=i('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Predicted FG:</span> <span class="value svelte-1xs394q"> </span></div>'),ts=i('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Attenuation:</span> <span class="value attenuation svelte-1xs394q"> </span></div>'),as=i('<span class="complete-now svelte-1xs394q">Ready now!</span>'),ss=i('<span class="days svelte-1xs394q"> </span>'),rs=i(" <!>",1),ls=i('<div class="metric completion-metric svelte-1xs394q"><span class="label svelte-1xs394q">Est. Completion:</span> <span class="value svelte-1xs394q"><!></span></div>'),ns=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),is=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Data points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),vs=i('<div><div class="panel-header svelte-1xs394q"><h3 class="panel-title svelte-1xs394q">Fermentation Intelligence</h3> <button type="button" class="reload-btn svelte-1xs394q" title="Recalculate predictions from database history"> </button></div> <!> <!> <div class="metrics svelte-1xs394q"><!> <!> <!> <div class="model-info svelte-1xs394q"><!> <!></div></div></div>'),os=i('<div class="ml-panel disabled svelte-1xs394q"><p class="unavailable-text svelte-1xs394q">ML predictions unavailable</p> <p class="unavailable-hint svelte-1xs394q">Predictions require at least 10 readings over 2+ hours</p></div>');function ds(Q,l){_t(l,!0);let k=ut(l,"measuredOg",3,null),z=ut(l,"currentSg",3,null),b=ut(l,"liveReading",3,null),f=ke(At({available:!1})),q=ke(!0),r=ke(!1),B=ke(null);async function p(){g(q,!0),g(B,null);try{g(f,await da(l.batchId),!0)}catch(d){g(B,d instanceof Error?d.message:"Failed to load predictions",!0),console.error("Failed to load ML predictions:",d)}finally{g(q,!1)}}async function E(){g(r,!0),g(B,null);try{const d=await ca(l.batchId);console.log("Reloaded predictions:",d.message),await p()}catch(d){g(B,d instanceof Error?d.message:"Failed to reload predictions",!0),console.error("Failed to reload predictions:",d)}finally{g(r,!1)}}Gt(p);function H(d){return d?new Date(d).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}):"N/A"}function W(d){if(!d)return null;const x=new Date(d),D=new Date,G=x.getTime()-D.getTime();return Math.ceil(G/(1e3*60*60*24))}let u=R(()=>{const d=k()??e(f).predicted_og,x=e(f).predicted_fg,D=z()??b()?.sg;if(!d||!x||!D||d<=x)return null;const G=d-x,J=(d-D)/G*100;return Math.min(100,Math.max(0,J))}),j=R(()=>{const d=k()??e(f).predicted_og,x=z()??b()?.sg;if(!d||!x||d<=1)return null;const D=(d-x)/(d-1)*100;return Math.min(100,Math.max(0,D))}),T=R(()=>{const d=b()?.sg_rate;if(d==null)return null;const x=Math.abs(d);return x>.002?{label:"Very Active",color:"#22c55e",emoji:"üî•"}:x>5e-4?{label:"Active",color:"#84cc16",emoji:"‚ú®"}:x>1e-4?{label:"Slowing",color:"#eab308",emoji:"üê¢"}:{label:"Complete",color:"#6b7280",emoji:"‚úì"}}),L=R(()=>b()?.is_anomaly??!1),M=R(()=>b()?.anomaly_reasons??[]);var O=Me(),A=K(O);{var y=d=>{var x=Ya();n(d,x)},C=d=>{var x=Me(),D=K(x);{var G=J=>{var ie=Ka(),me=a(ie),we=a(me);t(me),t(ie),_(()=>v(we,`‚ö†Ô∏è ${e(B)??""}`)),n(J,ie)},F=J=>{var ie=Me(),me=K(ie);{var we=te=>{var re=vs();let I;var U=a(re),V=s(a(U),2);V.__click=E;var le=a(V,!0);t(V),t(U);var he=s(U,2);{var ze=m=>{var h=Xa(),P=s(a(h),2),Z=s(a(P),2);{var se=Te=>{var Se=Qa(),pe=a(Se,!0);t(Se),_(be=>v(pe,be),[()=>e(M).join(", ")]),n(Te,Se)};o(Z,Te=>{e(M).length>0&&Te(se)})}t(P),t(h),n(m,h)};o(he,m=>{e(L)&&m(ze)})}var ge=s(he,2);{var Be=m=>{var h=$a(),P=a(h),Z=s(a(P),2);{var se=We=>{var Je=Za(),nt=a(Je);t(Je),_(()=>{st(Je,`color: ${e(T).color??""}`),v(nt,`${e(T).emoji??""} ${e(T).label??""}`)}),n(We,Je)};o(Z,We=>{e(T)&&We(se)})}t(P);var Te=s(P,2),Se=a(Te);t(Te);var pe=s(Te,2),be=a(pe),dt=a(be);t(be);var et=s(be,2),rt=a(et);t(et);var Ge=s(et,2),lt=a(Ge);t(Ge),t(pe),t(h),_((We,Je,nt)=>{st(Se,`width: ${e(u)??""}%`),v(dt,`OG: ${We??""}`),v(rt,`${Je??""}%`),v(lt,`FG: ${nt??""}`)},[()=>ft(k()??e(f).predicted_og??0),()=>e(u).toFixed(0),()=>ft(e(f).predicted_fg??0)]),n(m,h)};o(ge,m=>{e(u)!==null&&m(Be)})}var $e=s(ge,2),c=a($e);{var S=m=>{var h=es(),P=s(a(h),2),Z=a(P,!0);t(P),t(h),_(se=>v(Z,se),[()=>ft(e(f).predicted_fg)]),n(m,h)};o(c,m=>{e(f).predicted_fg&&m(S)})}var ae=s(c,2);{var N=m=>{var h=ts(),P=s(a(h),2),Z=a(P);t(P),t(h),_(se=>v(Z,`${se??""}%`),[()=>e(j).toFixed(1)]),n(m,h)};o(ae,m=>{e(j)!==null&&m(N)})}var Ie=s(ae,2);{var ve=m=>{const h=R(()=>W(e(f).estimated_completion));var P=ls(),Z=s(a(P),2),se=a(Z);{var Te=pe=>{var be=as();n(pe,be)},Se=pe=>{var be=rs(),dt=K(be),et=s(dt);{var rt=Ge=>{var lt=ss(),We=a(lt);t(lt),_(()=>v(We,`(${e(h)??""} ${e(h)===1?"day":"days"})`)),n(Ge,lt)};o(et,Ge=>{e(h)!==null&&Ge(rt)})}_(Ge=>v(dt,`${Ge??""} `),[()=>H(e(f).estimated_completion)]),n(pe,be)};o(se,pe=>{e(h)!==null&&e(h)<=0?pe(Te):pe(Se,!1)})}t(Z),t(P),n(m,P)};o(Ie,m=>{e(f).estimated_completion&&m(ve)})}var oe=s(Ie,2),de=a(oe);{var He=m=>{var h=ns(),P=s(a(h),2),Z=a(P);t(P),t(h),_(se=>v(Z,`${se??""}%`),[()=>(e(f).r_squared*100).toFixed(0)]),n(m,h)};o(de,m=>{e(f).r_squared!==void 0&&m(He)})}var Ve=s(de,2);{var Ae=m=>{var h=is(),P=s(a(h),2),Z=a(P,!0);t(P),t(h),_(()=>v(Z,e(f).num_readings)),n(m,h)};o(Ve,m=>{e(f).num_readings&&m(Ae)})}t(oe),t($e),t(re),_(()=>{I=Oe(re,1,"ml-panel svelte-1xs394q",null,I,{"has-anomaly":e(L)}),V.disabled=e(r)||e(q),v(le,e(r)?"Reloading...":"‚Üª Reload")}),n(te,re)},De=te=>{var re=os();n(te,re)};o(me,te=>{e(f).available?te(we):te(De,!1)},!0)}n(J,ie)};o(D,J=>{e(B)?J(G):J(F,!1)},!0)}n(d,x)};o(A,d=>{e(q)?d(y):d(C,!1)})}n(Q,O),gt()}jt(["click"]);var cs=i('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),us=i('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),_s=i('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),gs=i('<span class="recipe-type svelte-g5au2j"> </span>'),ps=i('<a class="recipe-link svelte-g5au2j"> <!></a>'),fs=i('<option class="svelte-g5au2j"> </option>'),ms=i('<span class="chilling-icon svelte-g5au2j">üç∫</span> <h3 class="chilling-title svelte-g5au2j">Ready to Pitch!</h3>',1),hs=i('<span class="chilling-icon svelte-g5au2j">‚ùÑÔ∏è</span> <h3 class="chilling-title svelte-g5au2j">Chilling to Pitch Temperature</h3>',1),bs=i('<div class="progress-section svelte-g5au2j"><div class="progress-bar svelte-g5au2j"><div class="progress-fill svelte-g5au2j"></div></div> <span class="progress-text svelte-g5au2j"> </span></div>'),js=i('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è No cooler configured - set a cooler entity to enable automated chilling</span>'),ys=i('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è Temperature control disabled in settings</span>'),xs=i('<span class="status-ready svelte-g5au2j">Wort has reached pitch temperature - ready to add yeast!</span>'),ks=i('<span class="status-active svelte-g5au2j">Cooler will run automatically when temp exceeds target + hysteresis</span>'),ws=i('<div><div class="chilling-header svelte-g5au2j"><!></div> <div class="chilling-content svelte-g5au2j"><div class="temp-display svelte-g5au2j"><div class="temp-current svelte-g5au2j"><span class="temp-label svelte-g5au2j">Current</span> <span class="temp-value svelte-g5au2j"> </span></div> <div class="temp-arrow svelte-g5au2j">‚Üí</div> <div class="temp-target svelte-g5au2j"><span class="temp-label svelte-g5au2j">Target</span> <span class="temp-value svelte-g5au2j"> </span></div></div> <!> <div class="chilling-status svelte-g5au2j"><!></div></div></div>'),zs=i('<div class="device-status heater svelte-g5au2j"><div>üî•</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Heater</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),qs=i('<div class="device-status cooler svelte-g5au2j"><div>‚ùÑÔ∏è</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Cooler</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Cs=i('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">‚ö°</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),Fs=i('<button type="button" class="override-btn heat-on svelte-g5au2j">Force Heat ON</button> <button type="button" class="override-btn heat-off svelte-g5au2j">Force Heat OFF</button>',1),Rs=i('<button type="button" class="override-btn cool-on svelte-g5au2j">Force Cool ON</button> <button type="button" class="override-btn cool-off svelte-g5au2j">Force Cool OFF</button>',1),Bs=i('<div class="control-details svelte-g5au2j"><div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns-grid svelte-g5au2j"><!> <!> <button type="button" class="override-btn auto-mode svelte-g5au2j">Auto Mode</button></div></div>',1),Ts=i('<div><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="device-status-grid svelte-g5au2j"><!> <!></div> <!></div>'),Ms=i('<span class="svelte-g5au2j"> </span>'),Ds=i('<span class="svelte-g5au2j"> </span>'),Ss=i('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><!> <!> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),Ps=i('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j" aria-label="Delete batch"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <!> <div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!> <!></div></div>',1),Os=i('<div class="modal-overlay svelte-g5au2j"><div class="modal svelte-g5au2j"><h2 class="modal-title svelte-g5au2j">Delete Batch?</h2> <p class="modal-text svelte-g5au2j"> </p> <div class="modal-actions svelte-g5au2j"><button type="button" class="modal-btn cancel svelte-g5au2j">Cancel</button> <button type="button" class="modal-btn delete svelte-g5au2j"> </button></div></div></div>'),As=i('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div> <!>',1);function sr(Q,l){_t(l,!0);const k=()=>ia(va,"$page",z),[z,b]=na();let f=null,q=null,r=ke(null),B=ke(null),p=ke(null);At([]);let E=ke(!0),H=ke(null),W=ke(!1),u=ke(!1),j=ke(!1),T=ke(!1),L=ke(!1),M=R(()=>parseInt(k().params.id??"0"));const O={planning:{label:"Planning",color:"var(--text-secondary)",bg:"var(--bg-elevated)"},fermenting:{label:"Fermenting",color:"#f59e0b",bg:"rgba(245, 158, 11, 0.12)"},conditioning:{label:"Conditioning",color:"#8b5cf6",bg:"rgba(139, 92, 246, 0.12)"},completed:{label:"Completed",color:"var(--positive)",bg:"rgba(34, 197, 94, 0.12)"},archived:{label:"Archived",color:"var(--text-muted)",bg:"var(--bg-elevated)"}},A=["planning","fermenting","conditioning","completed","archived"];let y=R(()=>e(r)?O[e(r).status]:O.planning),C=R(It),d=R(()=>bt.config.ha_enabled&&bt.config.temp_control_enabled&&(e(r)?.heater_entity_id||e(r)?.cooler_entity_id)),x=R(()=>e(r)?.status==="planning"&&e(r)?.temp_target!=null),D=R(()=>!e(x)||!e(F)?.temp||!e(r)?.temp_target?!1:e(F).temp<=e(r).temp_target),G=R(()=>{if(!e(x)||!e(F)?.temp||!e(r)?.temp_target)return null;const c=e(r).temp_target+30,S=e(F).temp,ae=e(r).temp_target;if(S<=ae)return 100;if(S>=c)return 0;const N=(c-S)/(c-ae)*100;return Math.min(100,Math.max(0,N))}),F=R(()=>{if(!e(r)?.device_id)return null;const c=Ot.tilts.get(e(r).device_id);if(c)return c;const S=e(r).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!S?.[1])return null;const ae=S[1].toUpperCase();for(const N of Ot.tilts.values())if(N.color&&N.color.toUpperCase()===ae)return N;return null});async function J(){g(E,!0),g(H,null);try{if(g(r,await ua(e(M)),!0),e(r).status==="fermenting"||e(r).status==="conditioning")try{g(B,await St(e(M)),!0)}catch{}if(e(r).heater_entity_id||e(r).cooler_entity_id)try{g(p,await ht(e(M)),!0)}catch{}}catch(c){g(H,c instanceof Error?c.message:"Failed to load batch",!0)}finally{g(E,!1)}}async function ie(c){if(!(!e(r)||e(u))&&!(c==="conditioning"&&e(r).status==="fermenting"&&!confirm(`üí° Entering Conditioning Phase

Reminder: Adjust target temperature if cold crashing.
Temperature control will continue during conditioning.

Continue?`))){g(u,!0);try{g(r,await Pt(e(r).id,{status:c}),!0),(c==="fermenting"||c==="conditioning")&&g(B,await St(e(r).id),!0)}catch(S){console.error("Failed to update status:",S)}finally{g(u,!1)}}}async function me(c){if(e(r)&&(g(r,await Pt(e(r).id,c),!0),g(W,!1),e(r).heater_entity_id||e(r).cooler_entity_id))try{g(p,await ht(e(r).id),!0)}catch{}}async function we(){if(e(r)){g(L,!0);try{await _a(e(r).id),oa("/batches")}catch(c){g(H,c instanceof Error?c.message:"Failed to delete batch",!0),g(L,!1),g(T,!1)}}}async function De(c,S){if(!(!e(r)||e(j))){g(j,!0);try{await kt(e(r).id,S,60,c),g(p,await ht(e(r).id),!0)}catch(ae){console.error("Failed to set override:",ae)}finally{g(j,!1)}}}async function te(){if(!(!e(r)||e(j))){g(j,!0);try{e(r).heater_entity_id&&await kt(e(r).id,null,60,"heater"),e(r).cooler_entity_id&&await kt(e(r).id,null,60,"cooler"),g(p,await ht(e(r).id),!0)}catch(c){console.error("Failed to clear overrides:",c)}finally{g(j,!1)}}}function re(){if(f?.readyState===WebSocket.OPEN)return;const S=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;f=new WebSocket(S),f.onmessage=async ae=>{try{const N=JSON.parse(ae.data);N.type==="control_event"&&N.batch_id===e(M)&&e(p)&&(N.action==="heat_on"?g(p,{...e(p),heater_state:"on"},!0):N.action==="heat_off"?g(p,{...e(p),heater_state:"off"},!0):N.action==="cool_on"?g(p,{...e(p),cooler_state:"on"},!0):N.action==="cool_off"&&g(p,{...e(p),cooler_state:"off"},!0))}catch{}},f.onclose=()=>{f=null,q=setTimeout(re,3e3)},f.onerror=()=>{f?.close()}}function I(){q&&(clearTimeout(q),q=null),f?.close(),f=null}function U(c){return c==null?"--":Nt(c)}Gt(()=>{J(),re()}),ea(()=>{I()});var V=As();sa("g5au2j",c=>{ta(()=>{aa.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var le=K(V),he=s(a(le),2);{var ze=c=>{var S=cs();n(c,S)},ge=c=>{var S=Me(),ae=K(S);{var N=ve=>{var oe=us(),de=s(a(oe),2),He=a(de,!0);t(de);var Ve=s(de,2);Ve.__click=J,t(oe),_(()=>v(He,e(H))),n(ve,oe)},Ie=ve=>{var oe=Me(),de=K(oe);{var He=Ae=>{var m=_s();n(Ae,m)},Ve=Ae=>{var m=Me(),h=K(m);{var P=se=>{ga(se,{get batch(){return e(r)},onSubmit:me,onCancel:()=>g(W,!1)})},Z=se=>{var Te=Ps(),Se=K(Te),pe=a(Se),be=a(pe),dt=a(be);t(be);var et=s(be,2),rt=a(et),Ge=a(rt,!0);t(rt);var lt=s(rt,2);{var We=w=>{var X=ps(),ce=a(X),qe=s(ce);{var Ce=Pe=>{var Ee=gs(),Ke=a(Ee);t(Ee),_(()=>v(Ke,`(${e(r).recipe.type??""})`)),n(Pe,Ee)};o(qe,Pe=>{e(r).recipe.type&&Pe(Ce)})}t(X),_(()=>{Ut(X,"href",`/recipes/${e(r).recipe.id??""}`),v(ce,`${e(r).recipe.name??""} `)}),n(w,X)};o(lt,w=>{e(r).recipe&&w(We)})}t(et),t(pe);var Je=s(pe,2),nt=a(Je),Ye=a(nt);Ye.__change=w=>ie(w.currentTarget.value),Et(Ye,21,()=>A,Lt,(w,X)=>{var ce=fs(),qe=a(ce,!0);t(ce);var Ce={};_(()=>{v(qe,O[e(X)].label),Ce!==(Ce=e(X))&&(ce.value=(ce.__value=e(X))??"")}),n(w,ce)}),t(Ye);var wt;ra(Ye),t(nt);var zt=s(nt,2);zt.__click=()=>g(W,!0);var Vt=s(zt,2);Vt.__click=()=>g(T,!0),t(Je),t(Se);var qt=s(Se,2);{var Wt=w=>{var X=ws();let ce;var qe=a(X),Ce=a(qe);{var Pe=Y=>{var ne=ms();xe(2),n(Y,ne)},Ee=Y=>{var ne=hs();xe(2),n(Y,ne)};o(Ce,Y=>{e(D)?Y(Pe):Y(Ee,!1)})}t(qe);var Ke=s(qe,2),it=a(Ke),vt=a(it),ue=s(a(vt),2),$=a(ue,!0);t(ue),t(vt);var ee=s(vt,4),_e=s(a(ee),2),Le=a(_e,!0);t(_e),t(ee),t(it);var je=s(it,2);{var Ue=Y=>{var ne=bs(),at=a(ne),pt=a(at);t(at);var ot=s(at,2),Ne=a(ot);t(ot),t(ne),_(Ze=>{st(pt,`width: ${e(G)??""}%`),v(Ne,`${Ze??""}% to target`)},[()=>Math.round(e(G))]),n(Y,ne)};o(je,Y=>{e(G)!=null&&!e(D)&&Y(Ue)})}var Qe=s(je,2),Xe=a(Qe);{var tt=Y=>{var ne=js();n(Y,ne)},xt=Y=>{var ne=Me(),at=K(ne);{var pt=Ne=>{var Ze=ys();n(Ne,Ze)},ot=Ne=>{var Ze=Me(),fe=K(Ze);{var Fe=ye=>{var ct=xs();n(ye,ct)},Re=ye=>{var ct=ks();n(ye,ct)};o(fe,ye=>{e(D)?ye(Fe):ye(Re,!1)},!0)}n(Ne,Ze)};o(at,Ne=>{!bt.config.ha_enabled||!bt.config.temp_control_enabled?Ne(pt):Ne(ot,!1)},!0)}n(Y,ne)};o(Xe,Y=>{e(r).cooler_entity_id?Y(xt,!1):Y(tt)})}t(Qe),t(Ke),t(X),_((Y,ne)=>{ce=Oe(X,1,"chilling-banner svelte-g5au2j",null,ce,{ready:e(D)}),v($,Y),v(Le,ne)},[()=>e(F)?.temp!=null?U(e(F).temp):"--",()=>e(r).temp_target!=null?U(e(r).temp_target):"--"]),n(w,X)};o(qt,w=>{e(x)&&w(Wt)})}var Ct=s(qt,2),yt=a(Ct),Ft=a(yt);{let w=R(()=>e(F)?.sg??e(B)?.measured?.current_sg);Ba(Ft,{get batch(){return e(r)},get currentSg(){return e(w)},get progress(){return e(B)},get liveReading(){return e(F)}})}var Jt=s(Ft,2);{var Yt=w=>{Va(w,{get recipe(){return e(r).recipe}})};o(Jt,w=>{e(r).recipe&&w(Yt)})}t(yt);var Rt=s(yt,2),Bt=a(Rt);Ma(Bt,{get batch(){return e(r)}});var Tt=s(Bt,2);Ua(Tt,{get batch(){return e(r)},get liveReading(){return e(F)},onEdit:()=>g(W,!0)});var Mt=s(Tt,2);{let w=R(()=>e(F)?.sg);ds(Mt,{get batchId(){return e(r).id},get measuredOg(){return e(r).measured_og},get currentSg(){return e(w)},get liveReading(){return e(F)}})}var Dt=s(Mt,2);{var Kt=w=>{var X=Ts();let ce;var qe=s(a(X),2),Ce=a(qe);{var Pe=ue=>{var $=zs(),ee=a($);let _e;var Le=s(ee,2),je=s(a(Le),2);let Ue;var Qe=a(je,!0);t(je);var Xe=s(je,2),tt=a(Xe,!0);t(Xe),t(Le),t($),_(()=>{_e=Oe(ee,1,"device-icon-wrap svelte-g5au2j",null,_e,{active:e(p)?.heater_state==="on"}),Ue=Oe(je,1,"device-state svelte-g5au2j",null,Ue,{on:e(p)?.heater_state==="on"}),v(Qe,e(p)?.heater_state==="on"?"ON":"OFF"),v(tt,e(r).heater_entity_id)}),n(ue,$)};o(Ce,ue=>{e(r).heater_entity_id&&ue(Pe)})}var Ee=s(Ce,2);{var Ke=ue=>{var $=qs(),ee=a($);let _e;var Le=s(ee,2),je=s(a(Le),2);let Ue;var Qe=a(je,!0);t(je);var Xe=s(je,2),tt=a(Xe,!0);t(Xe),t(Le),t($),_(()=>{_e=Oe(ee,1,"device-icon-wrap svelte-g5au2j",null,_e,{active:e(p)?.cooler_state==="on"}),Ue=Oe(je,1,"device-state svelte-g5au2j",null,Ue,{on:e(p)?.cooler_state==="on"}),v(Qe,e(p)?.cooler_state==="on"?"ON":"OFF"),v(tt,e(r).cooler_entity_id)}),n(ue,$)};o(Ee,ue=>{e(r).cooler_entity_id&&ue(Ke)})}t(qe);var it=s(qe,2);{var vt=ue=>{var $=Bs(),ee=K($),_e=a(ee),Le=s(a(_e),2),je=a(Le);t(Le),t(_e);var Ue=s(_e,2),Qe=s(a(Ue),2),Xe=a(Qe);t(Qe),t(Ue),t(ee);var tt=s(ee,2);{var xt=fe=>{var Fe=Cs(),Re=s(a(Fe),2),ye=a(Re);t(Re);var ct=s(Re,2);ct.__click=()=>te(),t(Fe),_($t=>{v(ye,`Override active: ${$t??""}`),ct.disabled=e(j)},[()=>e(p).override_state?.toUpperCase()]),n(fe,Fe)};o(tt,fe=>{e(p).override_active&&fe(xt)})}var Y=s(tt,2),ne=s(a(Y),2),at=a(ne);{var pt=fe=>{var Fe=Fs(),Re=K(Fe);Re.__click=()=>De("heater","on");var ye=s(Re,2);ye.__click=()=>De("heater","off"),_(()=>{Re.disabled=e(j),ye.disabled=e(j)}),n(fe,Fe)};o(at,fe=>{e(r).heater_entity_id&&fe(pt)})}var ot=s(at,2);{var Ne=fe=>{var Fe=Rs(),Re=K(Fe);Re.__click=()=>De("cooler","on");var ye=s(Re,2);ye.__click=()=>De("cooler","off"),_(()=>{Re.disabled=e(j),ye.disabled=e(j)}),n(fe,Fe)};o(ot,fe=>{e(r).cooler_entity_id&&fe(Ne)})}var Ze=s(ot,2);Ze.__click=()=>te(),t(ne),t(Y),_((fe,Fe)=>{v(je,`${fe??""}${e(C)??""}`),v(Xe,`¬±${Fe??""}${e(C)??""}`),Ze.disabled=e(j)},[()=>U(e(p).target_temp),()=>e(p).hysteresis?.toFixed(1)||"--"]),n(ue,$)};o(it,ue=>{e(p)&&ue(vt)})}t(X),_(()=>ce=Oe(X,1,"info-card temp-control-card svelte-g5au2j",null,ce,{"heater-on":e(p)?.heater_state==="on","cooler-on":e(p)?.cooler_state==="on"})),n(w,X)},Qt=w=>{var X=Me(),ce=K(X);{var qe=Ce=>{var Pe=Ss(),Ee=s(a(Pe),2),Ke=a(Ee);{var it=$=>{var ee=Ms(),_e=a(ee);t(ee),_(()=>v(_e,`Heater: ${e(r).heater_entity_id??""}`)),n($,ee)};o(Ke,$=>{e(r).heater_entity_id&&$(it)})}var vt=s(Ke,2);{var ue=$=>{var ee=Ds(),_e=a(ee);t(ee),_(()=>v(_e,`Cooler: ${e(r).cooler_entity_id??""}`)),n($,ee)};o(vt,$=>{e(r).cooler_entity_id&&$(ue)})}xe(2),t(Ee),t(Pe),n(Ce,Pe)};o(ce,Ce=>{(e(r).heater_entity_id||e(r).cooler_entity_id)&&e(r).status!=="fermenting"&&Ce(qe)},!0)}n(w,X)};o(Dt,w=>{e(d)&&(e(r).status==="fermenting"||e(r).status==="conditioning")?w(Kt):w(Qt,!1)})}var Xt=s(Dt,2);{var Zt=w=>{Ja(w,{get notes(){return e(r).notes}})};o(Xt,w=>{e(r).notes&&w(Zt)})}t(Rt),t(Ct),_(()=>{v(dt,`#${(e(r).batch_number||"?")??""}`),v(Ge,e(r).name||e(r).recipe?.name||"Unnamed Batch"),Ye.disabled=e(u),st(Ye,`color: ${e(y).color??""}; background: ${e(y).bg??""};`),wt!==(wt=e(r).status)&&(Ye.value=(Ye.__value=e(r).status)??"",la(Ye,e(r).status))}),n(se,Te)};o(h,se=>{e(W)?se(P):se(Z,!1)},!0)}n(Ae,m)};o(de,Ae=>{e(r)?Ae(Ve,!1):Ae(He)},!0)}n(ve,oe)};o(ae,ve=>{e(H)?ve(N):ve(Ie,!1)},!0)}n(c,S)};o(he,c=>{e(E)?c(ze):c(ge,!1)})}t(le);var Be=s(le,2);{var $e=c=>{var S=Os();S.__click=()=>g(T,!1);var ae=a(S);ae.__click=Ve=>Ve.stopPropagation();var N=s(a(ae),2),Ie=a(N);t(N);var ve=s(N,2),oe=a(ve);oe.__click=()=>g(T,!1);var de=s(oe,2);de.__click=we;var He=a(de,!0);t(de),t(ve),t(ae),t(S),_(()=>{v(Ie,`Are you sure you want to delete "${(e(r)?.name||"this batch")??""}"? This cannot be undone.`),oe.disabled=e(L),de.disabled=e(L),v(He,e(L)?"Deleting...":"Delete Batch")}),n(c,S)};o(Be,c=>{e(T)&&c($e)})}n(Q,V),gt(),b()}jt(["click","change"]);export{sr as component,ar as universal};
