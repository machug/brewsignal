import{d as qt,f as i,s as o,a as n,c as ze,t as Ht}from"../chunks/CsQfwH0S.js";import{al as a,ak as s,an as t,ar as c,ah as mt,at as J,c as e,ai as q,as as we,aj as ht,aq as ke,p as Kt,ao as Qt,s as _,aL as _a,ay as ga,am as pa}from"../chunks/fKkNMI8q.js";import{e as Xt,i as Zt}from"../chunks/COk1ZY4R.js";import{i as d}from"../chunks/BvBRaQNg.js";import{h as fa}from"../chunks/DLseniaC.js";import{s as ft}from"../chunks/DbN3nGCc.js";import{s as Ae}from"../chunks/BDI2zAFW.js";import{s as Xe}from"../chunks/CcRNvR1k.js";import{i as ma,s as ha}from"../chunks/C8srtpii.js";import{s as ba,a as xa}from"../chunks/C51ud8ec.js";import{p as ja}from"../chunks/DAqu8AAD.js";import{g as ya}from"../chunks/Dv2c3Yvy.js";import{z as ka,A as wa,q as za,j as Wt,B as wt,k as qa,x as Jt,C as Ft}from"../chunks/i8VL_lOf.js";import{d as yt,e as $t,g as ea,c as zt}from"../chunks/CPwbAm-l.js";import{t as Yt}from"../chunks/C8NDSE1R.js";import{B as Ca}from"../chunks/DTfC6M4H.js";import{s as Ra}from"../chunks/Bdaed-dN.js";import{p as ct}from"../chunks/CllCHKBI.js";const Fa=!1,jr=Object.freeze(Object.defineProperty({__proto__:null,prerender:Fa},Symbol.toStringTag,{value:"Module"}));function Ba($){return $>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:$>=-60?{bars:3,color:"var(--positive)",label:"Good"}:$>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function ta($){const l=Math.floor((Date.now()-new Date($).getTime())/1e3);if(l<10)return"just now";if(l<60)return`${l}s ago`;const T=Math.floor(l/60);if(T<60)return`${T}m ago`;const A=Math.floor(T/60);return A<24?`${A}h ago`:`${Math.floor(A/24)}d ago`}var Ta=i('<div class="accent-bar svelte-1oyrwd9"></div>'),Ma=i('<span class="card-icon svelte-1oyrwd9"> </span>'),Da=i('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),Sa=i('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function kt($,l){let T=ct(l,"highlight",3,!1),A=ct(l,"compact",3,!1),x=ct(l,"collapsible",3,!1),p=ct(l,"expanded",3,!1);var C=Sa();let r;var B=a(C);{var g=b=>{var v=Ta();n(b,v)};d(B,b=>{T()&&b(g)})}var R=s(B,2),X=a(R),le=a(X);{var f=b=>{var v=Ma(),j=a(v,!0);t(v),c(()=>o(j,l.icon)),n(b,v)};d(le,b=>{l.icon&&b(f)})}var z=s(le,2),N=a(z,!0);t(z),t(X);var U=s(X,2);{var I=b=>{var v=Da();v.__click=function(...K){l.onToggle?.apply(this,K)};var j=a(v);let F;t(v),c(()=>{ft(v,"aria-label",p()?"Collapse":"Expand"),F=Ae(j,0,"expand-icon svelte-1oyrwd9",null,F,{"rotate-180":p()})}),n(b,v)};d(U,b=>{x()&&l.onToggle&&b(I)})}t(R);var H=s(R,2);let E;var Y=a(H);Ra(Y,()=>l.children),t(H),t(C),c(()=>{r=Ae(C,1,"batch-card svelte-1oyrwd9",null,r,{highlight:T(),compact:A()}),o(N,l.title),E=Ae(H,1,"card-content svelte-1oyrwd9",null,E,{collapsed:x()&&!p()})}),n($,C)}qt(["click"]);var Pa=i('<span class="updated-text svelte-t80j9z"> </span>'),Oa=i('<div class="hero-divider svelte-t80j9z"></div> <div class="hero-metric temperature svelte-t80j9z"><span class="hero-value svelte-t80j9z"> <span class="hero-unit svelte-t80j9z"> </span></span> <span class="hero-label svelte-t80j9z">Temperature</span></div>',1),Aa=i('<div class="remaining-text svelte-t80j9z"> </div>'),Ga=i('<div class="progress-section svelte-t80j9z"><div class="progress-labels svelte-t80j9z"><div class="progress-endpoint start svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">OG</span></div> <div class="progress-current svelte-t80j9z"><span class="current-percent svelte-t80j9z"> </span></div> <div class="progress-endpoint end svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">Target FG</span></div></div> <div class="progress-track svelte-t80j9z"><div class="progress-fill svelte-t80j9z"></div> <div><div class="marker-dot svelte-t80j9z"></div> <div class="marker-value svelte-t80j9z"> </div></div></div> <!></div>'),Ea=i('<div class="metrics-row svelte-t80j9z"><div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">ABV</span></div> <div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">Attenuation</span></div></div>'),La=i('<div class="status-row svelte-t80j9z"><div class="live-indicator svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> <span class="status-text svelte-t80j9z">LIVE</span></div> <!></div> <div class="hero-section svelte-t80j9z"><div class="hero-metric gravity svelte-t80j9z"><span class="hero-value svelte-t80j9z"> </span> <span class="hero-label svelte-t80j9z">Gravity</span></div> <!></div> <!> <!>',1),Na=i('<div class="completed-grid svelte-t80j9z"><div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Original Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Final Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">ABV</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Attenuation</span></div></div>'),Ua=i('<div class="empty-state svelte-t80j9z"><div class="empty-icon svelte-t80j9z">‚óé</div> <p class="empty-text svelte-t80j9z">Set Original Gravity to track fermentation</p></div>');function Ia($,l){mt(l,!0);let T=q(()=>l.currentSg??l.progress?.measured?.current_sg),A=q(()=>l.liveReading?.temp??l.progress?.temperature?.current),x=q(()=>l.liveReading?.last_seen),p=q(()=>e(x)?ta(e(x)):null),C=q(ea),r=q(()=>{if(!l.batch.measured_og||!e(T))return null;const f=Math.max(0,(l.batch.measured_og-e(T))*131.25),z=l.batch.measured_og-1,N=z!==0?Math.max(0,Math.min(100,(l.batch.measured_og-e(T))/z*100)):0;return{abv:f,attenuation:N}}),B=q(()=>{const f=l.batch.measured_og,z=l.batch.recipe?.fg;if(!f||!z||!e(T))return null;const N=f-z,U=f-e(T);return N<=0?null:Math.max(0,Math.min(100,U/N*100))}),g=q(()=>l.batch.status==="fermenting"||l.batch.status==="conditioning");function R(f){return f==null?"--":yt(f)}function X(f){return f==null?"--":`${f.toFixed(1)}%`}function le(f){return f==null?"--":$t(f)}kt($,{title:"Fermentation",children:(f,z)=>{var N=ze(),U=J(N);{var I=E=>{var Y=La(),b=J(Y),v=s(a(b),2);{var j=M=>{var D=Pa(),y=a(D);t(D),c(()=>o(y,`Updated ${e(p)??""}`)),n(M,D)};d(v,M=>{e(p)&&M(j)})}t(b);var F=s(b,2),K=a(F),fe=a(K),L=a(fe,!0);t(fe),we(2),t(K);var me=s(K,2);{var qe=M=>{var D=Oa(),y=s(J(D),2),Q=a(y),W=a(Q,!0),ee=s(W),ie=a(ee,!0);t(ee),t(Q),we(2),t(y),c(ce=>{o(W,ce),o(ie,e(C))},[()=>le(e(A))]),n(M,D)};d(me,M=>{e(A)!=null&&M(qe)})}t(F);var ne=s(F,2);{var he=M=>{var D=Ga(),y=a(D),Q=a(y),W=a(Q),ee=a(W,!0);t(W),we(2),t(Q);var ie=s(Q,2),ce=a(ie),Ge=a(ce);t(ce),t(ie);var be=s(ie,2),u=a(be),k=a(u,!0);t(u),we(2),t(be),t(y);var V=s(y,2),P=a(V),Se=s(P,2);let ve;var oe=s(a(Se),2),_e=a(oe,!0);t(oe),t(Se),t(V);var He=s(V,2);{var We=m=>{var h=Aa(),G=a(h);t(h),c(se=>o(G,`${se??""} points to go`),[()=>l.progress.progress.sg_remaining.toFixed(3)]),n(m,h)};d(He,m=>{l.progress?.progress?.sg_remaining!=null&&l.progress.progress.sg_remaining>0&&m(We)})}t(D),c((m,h,G,se)=>{o(ee,m),o(Ge,`${h??""}%`),o(k,G),Xe(P,`width: ${e(B)??""}%`),ve=Ae(Se,1,"progress-marker svelte-t80j9z",null,ve,{"at-start":e(B)<3}),Xe(Se,`left: ${e(B)??""}%`),o(_e,se)},[()=>R(l.batch.measured_og),()=>e(B).toFixed(0),()=>R(l.batch.recipe.fg),()=>R(e(T))]),n(M,D)};d(ne,M=>{e(B)!==null&&l.batch.measured_og&&l.batch.recipe?.fg&&M(he)})}var Z=s(ne,2);{var de=M=>{var D=Ea(),y=a(D),Q=a(y),W=a(Q,!0);t(Q),we(2),t(y);var ee=s(y,2),ie=a(ee),ce=a(ie,!0);t(ie),we(2),t(ee),t(D),c((Ge,be)=>{o(W,Ge),o(ce,be)},[()=>X(e(r).abv),()=>X(e(r).attenuation)]),n(M,D)};d(Z,M=>{e(r)&&M(de)})}c(M=>o(L,M),[()=>R(e(T))]),n(E,Y)},H=E=>{var Y=ze(),b=J(Y);{var v=F=>{var K=Na(),fe=a(K),L=a(fe),me=a(L,!0);t(L),we(2),t(fe);var qe=s(fe,2),ne=a(qe),he=a(ne,!0);t(ne),we(2),t(qe);var Z=s(qe,2),de=a(Z),M=a(de,!0);t(de),we(2),t(Z);var D=s(Z,2),y=a(D),Q=a(y,!0);t(y),we(2),t(D),t(K),c((W,ee,ie,ce)=>{o(me,W),o(he,ee),o(M,ie),o(Q,ce)},[()=>R(l.batch.measured_og),()=>R(l.batch.measured_fg),()=>l.batch.measured_abv!=null?X(l.batch.measured_abv):"--",()=>l.batch.measured_attenuation!=null?X(l.batch.measured_attenuation):"--"]),n(F,K)},j=F=>{var K=Ua();n(F,K)};d(b,F=>{l.batch.measured_og?F(v):F(j,!1)},!0)}n(E,Y)};d(U,E=>{e(T)&&e(g)?E(I):E(H,!1)})}n(f,N)},$$slots:{default:!0}}),ht()}var Va=i('<div class="timeline svelte-yskb8i"><div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Brew Date</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Started</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Ended</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Created</span> <span class="timeline-value svelte-yskb8i"> </span></div></div>');function Ha($,l){mt(l,!0);function T(x){return x?new Date(x).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"}):"--"}function A(x){return x?new Date(x).toLocaleString("en-GB",{day:"numeric",month:"short",hour:"numeric",minute:"2-digit"}):"--"}kt($,{title:"Timeline",children:(x,p)=>{var C=Va(),r=a(C),B=s(a(r),2),g=a(B,!0);t(B),t(r);var R=s(r,2),X=s(a(R),2),le=a(X,!0);t(X),t(R);var f=s(R,2),z=s(a(f),2),N=a(z,!0);t(z),t(f);var U=s(f,2),I=s(a(U),2),H=a(I,!0);t(I),t(U),t(C),c((E,Y,b,v)=>{o(g,E),o(le,Y),o(N,b),o(H,v)},[()=>T(l.batch.brew_date),()=>A(l.batch.start_time),()=>A(l.batch.end_time),()=>A(l.batch.created_at)]),n(x,C)},$$slots:{default:!0}}),ht()}var Wa=i('<span class="device-last-seen svelte-1kdxwtz"> </span>'),Ja=i('<div class="signal-bar svelte-1kdxwtz"></div>'),Ya=i('<div class="metric-item svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="metric-text svelte-1kdxwtz"> </span></div>'),Ka=i('<div class="metric-item battery svelte-1kdxwtz"><svg class="battery-icon svelte-1kdxwtz" viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="2" y="7" width="18" height="10" rx="2"></rect><rect x="4" y="9" height="6" stroke="none" rx="1"></rect><path d="M20 10v4h2v-4z" stroke="none"></path></svg> <span class="metric-text svelte-1kdxwtz"><!></span></div>'),Qa=i('<div class="device-metrics svelte-1kdxwtz"><!> <!></div>'),Xa=i('<div class="device-row svelte-1kdxwtz"><div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!></div> <!>',1),Za=i('<div class="device-row svelte-1kdxwtz"><div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <span class="device-last-seen svelte-1kdxwtz">No data</span></div>'),$a=i('<div class="device-info svelte-1kdxwtz"><!></div>'),es=i('<button type="button" class="link-btn svelte-1kdxwtz">Link device</button>'),ts=i('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function as($,l){mt(l,!0);let T=q(()=>l.liveReading?.device_type==="tilt"),A=q(()=>e(T)&&l.liveReading?.rssi?Ba(l.liveReading.rssi):null),x=q(()=>l.liveReading?.last_seen?ta(l.liveReading.last_seen):null),p=q(()=>l.liveReading?.battery_percent!=null||l.liveReading?.battery_voltage!=null),C=q(()=>l.liveReading?.battery_percent),r=q(()=>l.liveReading?.battery_voltage),B=q(()=>e(C)?e(C)>50?"var(--positive)":e(C)>20?"#f59e0b":"var(--negative)":"var(--text-muted)"),g=q(()=>{if(!l.liveReading)return l.batch.device_id||"Unknown";const R=l.liveReading.device_type;return R==="tilt"?`${l.liveReading.color} Tilt`:R==="gravitymon"?`GravityMon (${l.liveReading.id})`:R==="ispindel"?`iSpindel (${l.liveReading.id})`:R==="floaty"?`Floaty (${l.liveReading.id})`:l.liveReading.color||l.liveReading.id});kt($,{title:"Tracking Device",compact:!0,children:(R,X)=>{var le=ze(),f=J(le);{var z=U=>{var I=$a(),H=a(I);{var E=b=>{var v=Xa(),j=J(v),F=a(j),K=s(a(F));t(F);var fe=s(F,2);{var L=ne=>{var he=Wa(),Z=a(he,!0);t(he),c(()=>o(Z,e(x))),n(ne,he)};d(fe,ne=>{e(x)&&ne(L)})}t(j);var me=s(j,2);{var qe=ne=>{var he=Qa(),Z=a(he);{var de=y=>{var Q=Ya(),W=a(Q);Xt(W,20,()=>Array(4),Zt,(ce,Ge,be)=>{var u=Ja();c(()=>Xe(u,`height: ${4+be*2}px; background: ${(be<e(A).bars?e(A).color:"var(--bg-hover)")??""}; opacity: ${be<e(A).bars?1:.4};`)),n(ce,u)}),t(W);var ee=s(W,2),ie=a(ee);t(ee),t(Q),c(()=>{Xe(ee,`color: ${e(A).color??""}`),o(ie,`${l.liveReading.rssi??""}dBm`)}),n(y,Q)};d(Z,y=>{e(A)&&y(de)})}var M=s(Z,2);{var D=y=>{var Q=Ka(),W=a(Q),ee=s(a(W)),ie=s(ee);t(W);var ce=s(W,2),Ge=a(ce);{var be=k=>{var V=Ht();c(P=>o(V,`${P??""}%`),[()=>e(C).toFixed(0)]),n(k,V)},u=k=>{var V=ze(),P=J(V);{var Se=ve=>{var oe=Ht();c(_e=>o(oe,`${_e??""}V`),[()=>e(r).toFixed(2)]),n(ve,oe)};d(P,ve=>{e(r)!=null&&ve(Se)},!0)}n(k,V)};d(Ge,k=>{e(C)!=null?k(be):k(u,!1)})}t(ce),t(Q),c(()=>{ft(W,"stroke",e(B)),ft(ee,"width",(e(C)??50)*.14),ft(ee,"fill",e(B)),ft(ie,"fill",e(B)),Xe(ce,`color: ${e(B)??""}`)}),n(y,Q)};d(M,y=>{e(p)&&y(D)})}t(he),n(ne,he)};d(me,ne=>{(e(A)||e(p))&&ne(qe)})}c(()=>o(K,` ${e(g)??""}`)),n(b,v)},Y=b=>{var v=Za(),j=a(v),F=s(a(j));t(j),we(2),t(v),c(()=>o(F,` ${l.batch.device_id??""}`)),n(b,v)};d(H,b=>{l.liveReading?b(E):b(Y,!1)})}t(I),n(U,I)},N=U=>{var I=ts(),H=s(a(I),2);{var E=Y=>{var b=es();b.__click=function(...v){l.onEdit?.apply(this,v)},n(Y,b)};d(H,Y=>{l.onEdit&&Y(E)})}t(I),n(U,I)};d(f,U=>{l.batch.device_id?U(z):U(N,!1)})}n(R,le)},$$slots:{default:!0}}),ht()}qt(["click"]);const ss=131.25;var rs=i('<div class="target wide svelte-19u9n31"><span class="target-label svelte-19u9n31">Yeast</span> <span class="target-value svelte-19u9n31"> </span></div>'),ls=i('<div class="targets-grid svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div> <!></div>');function ns($,l){mt(l,!0);function T(x){return x==null?"--":yt(x)}let A=q(()=>l.recipe.abv!=null?l.recipe.abv:l.recipe.og&&l.recipe.fg?(l.recipe.og-l.recipe.fg)*ss:null);kt($,{title:"Recipe Targets",children:(x,p)=>{var C=ls(),r=a(C),B=s(a(r),2),g=a(B,!0);t(B),t(r);var R=s(r,2),X=s(a(R),2),le=a(X,!0);t(X),t(R);var f=s(R,2),z=s(a(f),2),N=a(z,!0);t(z),t(f);var U=s(f,2);{var I=H=>{var E=rs(),Y=s(a(E),2),b=a(Y,!0);t(Y),t(E),c(()=>o(b,l.recipe.yeast_name)),n(H,E)};d(U,H=>{l.recipe.yeast_name&&H(I)})}t(C),c((H,E,Y)=>{o(g,H),o(le,E),o(N,Y)},[()=>T(l.recipe.og),()=>T(l.recipe.fg),()=>e(A)!=null?`${e(A).toFixed(1)}%`:"--"]),n(x,C)},$$slots:{default:!0}}),ht()}var is=i('<p class="notes-content svelte-hkv31i"> </p>');function vs($,l){kt($,{title:"Notes",children:(T,A)=>{var x=is(),p=a(x,!0);t(x),c(()=>o(p,l.notes)),n(T,x)},$$slots:{default:!0}})}var os=i('<div class="ml-panel loading svelte-1xs394q"><p>Loading predictions...</p></div>'),ds=i('<div class="ml-panel error svelte-1xs394q"><p class="error-text svelte-1xs394q"> </p></div>'),cs=i('<span class="anomaly-reasons svelte-1xs394q"> </span>'),us=i('<div class="anomaly-banner svelte-1xs394q"><span class="anomaly-icon svelte-1xs394q">‚ö†Ô∏è</span> <div class="anomaly-content svelte-1xs394q"><span class="anomaly-label svelte-1xs394q">Anomaly Detected</span> <!></div></div>'),_s=i('<span class="activity-badge svelte-1xs394q"> </span>'),gs=i('<div class="progress-section svelte-1xs394q"><div class="progress-header svelte-1xs394q"><span class="progress-label svelte-1xs394q">Fermentation Progress</span> <!></div> <div class="fermentation-progress-bar svelte-1xs394q"><div class="fermentation-fill svelte-1xs394q"></div></div> <div class="progress-labels svelte-1xs394q"><span class="og-label svelte-1xs394q"> </span> <span class="progress-percent svelte-1xs394q"> </span> <span class="fg-label svelte-1xs394q"> </span></div></div>'),ps=i('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Predicted FG:</span> <span class="value svelte-1xs394q"> </span></div>'),fs=i('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Attenuation:</span> <span class="value attenuation svelte-1xs394q"> </span></div>'),ms=i('<span class="complete-now svelte-1xs394q">Ready now!</span>'),hs=i('<span class="days svelte-1xs394q"> </span>'),bs=i(" <!>",1),xs=i('<div class="metric completion-metric svelte-1xs394q"><span class="label svelte-1xs394q">Est. Completion:</span> <span class="value svelte-1xs394q"><!></span></div>'),js=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),ys=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Data points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),ks=i('<div><div class="panel-header svelte-1xs394q"><h3 class="panel-title svelte-1xs394q">Fermentation Intelligence</h3> <button type="button" class="reload-btn svelte-1xs394q" title="Recalculate predictions from database history"> </button></div> <!> <!> <div class="metrics svelte-1xs394q"><!> <!> <!> <div class="model-info svelte-1xs394q"><!> <!></div></div></div>'),ws=i('<div class="ml-panel disabled svelte-1xs394q"><div class="disabled-header svelte-1xs394q"><p class="unavailable-text svelte-1xs394q">ML predictions unavailable</p> <button type="button" class="reload-btn svelte-1xs394q" title="Reload predictions from database"> </button></div> <p class="unavailable-hint svelte-1xs394q">Predictions require at least 10 readings over 2+ hours</p></div>');function zs($,l){mt(l,!0);let T=ct(l,"measuredOg",3,null),A=ct(l,"currentSg",3,null),x=ct(l,"liveReading",3,null),p=ke(Kt({available:!1})),C=ke(!0),r=ke(!1),B=ke(null);async function g(){_(C,!0),_(B,null);try{_(p,await ka(l.batchId),!0)}catch(v){_(B,v instanceof Error?v.message:"Failed to load predictions",!0),console.error("Failed to load ML predictions:",v)}finally{_(C,!1)}}async function R(){_(r,!0),_(B,null);try{const v=await wa(l.batchId);console.log("Reloaded predictions:",v.message),await g()}catch(v){_(B,v instanceof Error?v.message:"Failed to reload predictions",!0),console.error("Failed to reload predictions:",v)}finally{_(r,!1)}}Qt(g);function X(v){return v?new Date(v).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}):"N/A"}function le(v){if(!v)return null;const j=new Date(v),F=new Date,K=j.getTime()-F.getTime();return Math.ceil(K/(1e3*60*60*24))}let f=q(()=>{const v=T()??e(p).predicted_og,j=e(p).predicted_fg,F=A()??x()?.sg;if(!v||!j||!F||v<=j)return null;const K=v-j,L=(v-F)/K*100;return Math.min(100,Math.max(0,L))}),z=q(()=>{const v=T()??e(p).predicted_og,j=A()??x()?.sg;if(!v||!j||v<=1)return null;const F=(v-j)/(v-1)*100;return Math.min(100,Math.max(0,F))}),N=q(()=>{const v=x()?.sg_rate;if(v==null)return null;const j=Math.abs(v);return j>.002?{label:"Very Active",color:"#22c55e",emoji:"üî•"}:j>5e-4?{label:"Active",color:"#84cc16",emoji:"‚ú®"}:j>1e-4?{label:"Slowing",color:"#eab308",emoji:"üê¢"}:{label:"Complete",color:"#6b7280",emoji:"‚úì"}}),U=q(()=>x()?.is_anomaly??!1),I=q(()=>x()?.anomaly_reasons??[]);var H=ze(),E=J(H);{var Y=v=>{var j=os();n(v,j)},b=v=>{var j=ze(),F=J(j);{var K=L=>{var me=ds(),qe=a(me),ne=a(qe);t(qe),t(me),c(()=>o(ne,`‚ö†Ô∏è ${e(B)??""}`)),n(L,me)},fe=L=>{var me=ze(),qe=J(me);{var ne=Z=>{var de=ks();let M;var D=a(de),y=s(a(D),2);y.__click=R;var Q=a(y,!0);t(y),t(D);var W=s(D,2);{var ee=m=>{var h=us(),G=s(a(h),2),se=s(a(G),2);{var Be=ge=>{var Ie=cs(),xe=a(Ie,!0);t(Ie),c(Ce=>o(xe,Ce),[()=>e(I).join(", ")]),n(ge,Ie)};d(se,ge=>{e(I).length>0&&ge(Be)})}t(G),t(h),n(m,h)};d(W,m=>{e(U)&&m(ee)})}var ie=s(W,2);{var ce=m=>{var h=gs(),G=a(h),se=s(a(G),2);{var Be=Je=>{var $e=_s(),_t=a($e);t($e),c(()=>{Xe($e,`color: ${e(N).color??""}`),o(_t,`${e(N).emoji??""} ${e(N).label??""}`)}),n(Je,$e)};d(se,Je=>{e(N)&&Je(Be)})}t(G);var ge=s(G,2),Ie=a(ge);t(ge);var xe=s(ge,2),Ce=a(xe),Ze=a(Ce);t(Ce);var lt=s(Ce,2),ut=a(lt);t(lt);var Pe=s(lt,2),nt=a(Pe);t(Pe),t(xe),t(h),c((Je,$e,_t)=>{Xe(Ie,`width: ${e(f)??""}%`),o(Ze,`OG: ${Je??""}`),o(ut,`${$e??""}%`),o(nt,`FG: ${_t??""}`)},[()=>yt(T()??e(p).predicted_og??0),()=>e(f).toFixed(0),()=>yt(e(p).predicted_fg??0)]),n(m,h)};d(ie,m=>{e(f)!==null&&m(ce)})}var Ge=s(ie,2),be=a(Ge);{var u=m=>{var h=ps(),G=s(a(h),2),se=a(G,!0);t(G),t(h),c(Be=>o(se,Be),[()=>yt(e(p).predicted_fg)]),n(m,h)};d(be,m=>{e(p).predicted_fg&&m(u)})}var k=s(be,2);{var V=m=>{var h=fs(),G=s(a(h),2),se=a(G);t(G),t(h),c(Be=>o(se,`${Be??""}%`),[()=>e(z).toFixed(1)]),n(m,h)};d(k,m=>{e(z)!==null&&m(V)})}var P=s(k,2);{var Se=m=>{const h=q(()=>le(e(p).estimated_completion));var G=xs(),se=s(a(G),2),Be=a(se);{var ge=xe=>{var Ce=ms();n(xe,Ce)},Ie=xe=>{var Ce=bs(),Ze=J(Ce),lt=s(Ze);{var ut=Pe=>{var nt=hs(),Je=a(nt);t(nt),c(()=>o(Je,`(${e(h)??""} ${e(h)===1?"day":"days"})`)),n(Pe,nt)};d(lt,Pe=>{e(h)!==null&&Pe(ut)})}c(Pe=>o(Ze,`${Pe??""} `),[()=>X(e(p).estimated_completion)]),n(xe,Ce)};d(Be,xe=>{e(h)!==null&&e(h)<=0?xe(ge):xe(Ie,!1)})}t(se),t(G),n(m,G)};d(P,m=>{e(p).estimated_completion&&m(Se)})}var ve=s(P,2),oe=a(ve);{var _e=m=>{var h=js(),G=s(a(h),2),se=a(G);t(G),t(h),c(Be=>o(se,`${Be??""}%`),[()=>(e(p).r_squared*100).toFixed(0)]),n(m,h)};d(oe,m=>{e(p).r_squared!==void 0&&m(_e)})}var He=s(oe,2);{var We=m=>{var h=ys(),G=s(a(h),2),se=a(G,!0);t(G),t(h),c(()=>o(se,e(p).num_readings)),n(m,h)};d(He,m=>{e(p).num_readings&&m(We)})}t(ve),t(Ge),t(de),c(()=>{M=Ae(de,1,"ml-panel svelte-1xs394q",null,M,{"has-anomaly":e(U)}),y.disabled=e(r)||e(C),o(Q,e(r)?"Reloading...":"‚Üª Reload")}),n(Z,de)},he=Z=>{var de=ws(),M=a(de),D=s(a(M),2);D.__click=R;var y=a(D,!0);t(D),t(M),we(2),t(de),c(()=>{D.disabled=e(r)||e(C),o(y,e(r)?"Reloading...":"‚Üª Reload")}),n(Z,de)};d(qe,Z=>{e(p).available?Z(ne):Z(he,!1)},!0)}n(L,me)};d(F,L=>{e(B)?L(K):L(fe,!1)},!0)}n(v,j)};d(E,v=>{e(C)?v(Y):v(b,!1)})}n($,H),ht()}qt(["click"]);var qs=i('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),Cs=i('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),Rs=i('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),Fs=i('<span class="recipe-type svelte-g5au2j"> </span>'),Bs=i('<a class="recipe-link svelte-g5au2j"> <!></a>'),Ts=i('<option class="svelte-g5au2j"> </option>'),Ms=i('<span class="chilling-icon svelte-g5au2j">üç∫</span> <h3 class="chilling-title svelte-g5au2j">Ready to Pitch!</h3>',1),Ds=i('<span class="chilling-icon svelte-g5au2j">‚ùÑÔ∏è</span> <h3 class="chilling-title svelte-g5au2j">Chilling to Pitch Temperature</h3>',1),Ss=i('<div class="progress-section svelte-g5au2j"><div class="progress-bar svelte-g5au2j"><div class="progress-fill svelte-g5au2j"></div></div> <span class="progress-text svelte-g5au2j"> </span></div>'),Ps=i('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è No cooler configured - set a cooler entity to enable automated chilling</span>'),Os=i('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è Temperature control disabled in settings</span>'),As=i('<span class="status-ready svelte-g5au2j">Wort has reached pitch temperature - ready to add yeast!</span>'),Gs=i('<span class="status-active svelte-g5au2j">Cooler will run automatically when temp exceeds target + hysteresis</span>'),Es=i('<div><div class="chilling-header svelte-g5au2j"><!></div> <div class="chilling-content svelte-g5au2j"><div class="temp-display svelte-g5au2j"><div class="temp-current svelte-g5au2j"><span class="temp-label svelte-g5au2j">Current</span> <span class="temp-value svelte-g5au2j"> </span></div> <div class="temp-arrow svelte-g5au2j">‚Üí</div> <div class="temp-target svelte-g5au2j"><span class="temp-label svelte-g5au2j">Target</span> <span class="temp-value svelte-g5au2j"> </span></div></div> <!> <div class="chilling-status svelte-g5au2j"><!></div></div></div>'),Ls=i('<span class="status-badge heater svelte-g5au2j">üî• Heating</span>'),Ns=i('<span class="status-badge cooler svelte-g5au2j">‚ùÑÔ∏è Cooling</span>'),Us=i('<span class="status-badge idle svelte-g5au2j"> </span>'),Is=i('<div class="device-status heater svelte-g5au2j"><div>üî•</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Heater</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Vs=i('<div class="device-status cooler svelte-g5au2j"><div>‚ùÑÔ∏è</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Cooler</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Hs=i('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">‚ö°</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),Ws=i('<button type="button" class="override-btn heat-on svelte-g5au2j">Force Heat ON</button> <button type="button" class="override-btn heat-off svelte-g5au2j">Force Heat OFF</button>',1),Js=i('<button type="button" class="override-btn cool-on svelte-g5au2j">Force Cool ON</button> <button type="button" class="override-btn cool-off svelte-g5au2j">Force Cool OFF</button>',1),Ys=i('<div class="control-details svelte-g5au2j"><div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns-grid svelte-g5au2j"><!> <!> <button type="button" class="override-btn auto-mode svelte-g5au2j">Auto Mode</button></div></div>',1),Ks=i('<div class="device-status-grid svelte-g5au2j"><!> <!></div> <!>',1),Qs=i('<div><button type="button" class="collapsible-header svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="collapse-indicator svelte-g5au2j"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" class="svelte-g5au2j"></path></svg></div></button> <!></div>'),Xs=i('<span class="svelte-g5au2j"> </span>'),Zs=i('<span class="svelte-g5au2j"> </span>'),$s=i('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><!> <!> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),er=i('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j" aria-label="Delete batch"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <!> <div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!> <!></div></div>',1),tr=i('<div class="modal-overlay svelte-g5au2j"><div class="modal svelte-g5au2j"><h2 class="modal-title svelte-g5au2j">Delete Batch?</h2> <p class="modal-text svelte-g5au2j"> </p> <div class="modal-actions svelte-g5au2j"><button type="button" class="modal-btn cancel svelte-g5au2j">Cancel</button> <button type="button" class="modal-btn delete svelte-g5au2j"> </button></div></div></div>'),ar=i('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div> <!>',1);function yr($,l){mt(l,!0);const T=()=>xa(ja,"$page",A),[A,x]=ba();let p=null,C=null,r=ke(null),B=ke(null),g=ke(null);Kt([]);let R=ke(!0),X=ke(null),le=ke(!1),f=ke(!1),z=ke(!1),N=ke(!1),U=ke(!1),I=ke(!1),H=q(()=>parseInt(T().params.id??"0"));const E={planning:{label:"Planning",color:"var(--text-secondary)",bg:"var(--bg-elevated)"},fermenting:{label:"Fermenting",color:"#f59e0b",bg:"rgba(245, 158, 11, 0.12)"},conditioning:{label:"Conditioning",color:"#8b5cf6",bg:"rgba(139, 92, 246, 0.12)"},completed:{label:"Completed",color:"var(--positive)",bg:"rgba(34, 197, 94, 0.12)"},archived:{label:"Archived",color:"var(--text-muted)",bg:"var(--bg-elevated)"}},Y=["planning","fermenting","conditioning","completed","archived"];let b=q(()=>e(r)?E[e(r).status]:E.planning),v=q(ea),j=q(()=>zt.config.ha_enabled&&zt.config.temp_control_enabled&&(e(r)?.heater_entity_id||e(r)?.cooler_entity_id)),F=q(()=>e(r)?.status==="planning"&&e(r)?.temp_target!=null),K=q(()=>!e(F)||!e(L)?.temp||!e(r)?.temp_target?!1:e(L).temp<=e(r).temp_target),fe=q(()=>{if(!e(F)||!e(L)?.temp||!e(r)?.temp_target)return null;const u=e(r).temp_target+30,k=e(L).temp,V=e(r).temp_target;if(k<=V)return 100;if(k>=u)return 0;const P=(u-k)/(u-V)*100;return Math.min(100,Math.max(0,P))}),L=q(()=>{if(!e(r)?.device_id)return null;const u=Yt.tilts.get(e(r).device_id);if(u)return u;const k=e(r).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!k?.[1])return null;const V=k[1].toUpperCase();for(const P of Yt.tilts.values())if(P.color&&P.color.toUpperCase()===V)return P;return null});async function me(){_(R,!0),_(X,null);try{if(_(r,await za(e(H)),!0),e(r).status==="fermenting"||e(r).status==="conditioning")try{_(B,await Wt(e(H)),!0)}catch{}if(e(r).heater_entity_id||e(r).cooler_entity_id)try{_(g,await wt(e(H)),!0)}catch{}}catch(u){_(X,u instanceof Error?u.message:"Failed to load batch",!0)}finally{_(R,!1)}}async function qe(u){if(!(!e(r)||e(f))&&!(u==="conditioning"&&e(r).status==="fermenting"&&!confirm(`üí° Entering Conditioning Phase

Reminder: Adjust target temperature if cold crashing.
Temperature control will continue during conditioning.

Continue?`))){_(f,!0);try{_(r,await Jt(e(r).id,{status:u}),!0),(u==="fermenting"||u==="conditioning")&&_(B,await Wt(e(r).id),!0)}catch(k){console.error("Failed to update status:",k)}finally{_(f,!1)}}}async function ne(u){if(e(r)&&(_(r,await Jt(e(r).id,u),!0),_(le,!1),e(r).heater_entity_id||e(r).cooler_entity_id))try{_(g,await wt(e(r).id),!0)}catch{}}async function he(){if(e(r)){_(U,!0);try{await qa(e(r).id),ya("/batches")}catch(u){_(X,u instanceof Error?u.message:"Failed to delete batch",!0),_(U,!1),_(N,!1)}}}async function Z(u,k){if(!(!e(r)||e(z))){_(z,!0);try{await Ft(e(r).id,k,60,u),_(g,await wt(e(r).id),!0)}catch(V){console.error("Failed to set override:",V)}finally{_(z,!1)}}}async function de(){if(!(!e(r)||e(z))){_(z,!0);try{e(r).heater_entity_id&&await Ft(e(r).id,null,60,"heater"),e(r).cooler_entity_id&&await Ft(e(r).id,null,60,"cooler"),_(g,await wt(e(r).id),!0)}catch(u){console.error("Failed to clear overrides:",u)}finally{_(z,!1)}}}function M(){if(p?.readyState===WebSocket.OPEN)return;const k=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;p=new WebSocket(k),p.onmessage=async V=>{try{const P=JSON.parse(V.data);P.type==="control_event"&&P.batch_id===e(H)&&e(g)&&(P.action==="heat_on"?_(g,{...e(g),heater_state:"on"},!0):P.action==="heat_off"?_(g,{...e(g),heater_state:"off"},!0):P.action==="cool_on"?_(g,{...e(g),cooler_state:"on"},!0):P.action==="cool_off"&&_(g,{...e(g),cooler_state:"off"},!0))}catch{}},p.onclose=()=>{p=null,C=setTimeout(M,3e3)},p.onerror=()=>{p?.close()}}function D(){C&&(clearTimeout(C),C=null),p?.close(),p=null}function y(u){return u==null?"--":$t(u)}Qt(()=>{me(),M()}),_a(()=>{D()});var Q=ar();fa("g5au2j",u=>{ga(()=>{pa.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var W=J(Q),ee=s(a(W),2);{var ie=u=>{var k=qs();n(u,k)},ce=u=>{var k=ze(),V=J(k);{var P=ve=>{var oe=Cs(),_e=s(a(oe),2),He=a(_e,!0);t(_e);var We=s(_e,2);We.__click=me,t(oe),c(()=>o(He,e(X))),n(ve,oe)},Se=ve=>{var oe=ze(),_e=J(oe);{var He=m=>{var h=Rs();n(m,h)},We=m=>{var h=ze(),G=J(h);{var se=ge=>{Ca(ge,{get batch(){return e(r)},onSubmit:ne,onCancel:()=>_(le,!1)})},Be=ge=>{var Ie=er(),xe=J(Ie),Ce=a(xe),Ze=a(Ce),lt=a(Ze);t(Ze);var ut=s(Ze,2),Pe=a(ut),nt=a(Pe,!0);t(Pe);var Je=s(Pe,2);{var $e=S=>{var te=Bs(),pe=a(te),Re=s(pe);{var Te=Oe=>{var Ve=Fs(),Ke=a(Ve);t(Ve),c(()=>o(Ke,`(${e(r).recipe.type??""})`)),n(Oe,Ve)};d(Re,Oe=>{e(r).recipe.type&&Oe(Te)})}t(te),c(()=>{ft(te,"href",`/recipes/${e(r).recipe.id??""}`),o(pe,`${e(r).recipe.name??""} `)}),n(S,te)};d(Je,S=>{e(r).recipe&&S($e)})}t(ut),t(Ce);var _t=s(Ce,2),Ct=a(_t),Ye=a(Ct);Ye.__change=S=>qe(S.currentTarget.value),Xt(Ye,21,()=>Y,Zt,(S,te)=>{var pe=Ts(),Re=a(pe,!0);t(pe);var Te={};c(()=>{o(Re,E[e(te)].label),Te!==(Te=e(te))&&(pe.value=(pe.__value=e(te))??"")}),n(S,pe)}),t(Ye);var Bt;ma(Ye),t(Ct);var Tt=s(Ct,2);Tt.__click=()=>_(le,!0);var aa=s(Tt,2);aa.__click=()=>_(N,!0),t(_t),t(xe);var Mt=s(xe,2);{var sa=S=>{var te=Es();let pe;var Re=a(te),Te=a(Re);{var Oe=w=>{var O=Ms();we(2),n(w,O)},Ve=w=>{var O=Ds();we(2),n(w,O)};d(Te,w=>{e(K)?w(Oe):w(Ve,!1)})}t(Re);var Ke=s(Re,2),it=a(Ke),et=a(it),gt=s(a(et),2),Ee=a(gt,!0);t(gt),t(et);var ae=s(et,4),Fe=s(a(ae),2),vt=a(Fe,!0);t(Fe),t(ae),t(it);var ot=s(it,2);{var bt=w=>{var O=Ss(),ue=a(O),je=a(ue);t(ue);var Me=s(ue,2),re=a(Me);t(Me),t(O),c(ye=>{Xe(je,`width: ${e(fe)??""}%`),o(re,`${ye??""}% to target`)},[()=>Math.round(e(fe))]),n(w,O)};d(ot,w=>{e(fe)!=null&&!e(K)&&w(bt)})}var Le=s(ot,2),tt=a(Le);{var xt=w=>{var O=Ps();n(w,O)},jt=w=>{var O=ze(),ue=J(O);{var je=re=>{var ye=Os();n(re,ye)},Me=re=>{var ye=ze(),at=J(ye);{var Qe=rt=>{var pt=As();n(rt,pt)},st=rt=>{var pt=Gs();n(rt,pt)};d(at,rt=>{e(K)?rt(Qe):rt(st,!1)},!0)}n(re,ye)};d(ue,re=>{!zt.config.ha_enabled||!zt.config.temp_control_enabled?re(je):re(Me,!1)},!0)}n(w,O)};d(tt,w=>{e(r).cooler_entity_id?w(jt,!1):w(xt)})}t(Le),t(Ke),t(te),c((w,O)=>{pe=Ae(te,1,"chilling-banner svelte-g5au2j",null,pe,{ready:e(K)}),o(Ee,w),o(vt,O)},[()=>e(L)?.temp!=null?y(e(L).temp):"--",()=>e(r).temp_target!=null?y(e(r).temp_target):"--"]),n(S,te)};d(Mt,S=>{e(F)&&S(sa)})}var Dt=s(Mt,2),Rt=a(Dt),St=a(Rt);{let S=q(()=>e(L)?.sg??e(B)?.measured?.current_sg);Ia(St,{get batch(){return e(r)},get currentSg(){return e(S)},get progress(){return e(B)},get liveReading(){return e(L)}})}var ra=s(St,2);{var la=S=>{ns(S,{get recipe(){return e(r).recipe}})};d(ra,S=>{e(r).recipe&&S(la)})}t(Rt);var Pt=s(Rt,2),Ot=a(Pt);Ha(Ot,{get batch(){return e(r)}});var At=s(Ot,2);as(At,{get batch(){return e(r)},get liveReading(){return e(L)},onEdit:()=>_(le,!0)});var Gt=s(At,2);{let S=q(()=>e(L)?.sg);zs(Gt,{get batchId(){return e(r).id},get measuredOg(){return e(r).measured_og},get currentSg(){return e(S)},get liveReading(){return e(L)}})}var Et=s(Gt,2);{var na=S=>{var te=Qs();let pe;var Re=a(te);Re.__click=()=>_(I,!e(I));var Te=s(a(Re),2),Oe=a(Te);{var Ve=ae=>{var Fe=Ls();n(ae,Fe)},Ke=ae=>{var Fe=ze(),vt=J(Fe);{var ot=Le=>{var tt=Ns();n(Le,tt)},bt=Le=>{var tt=ze(),xt=J(tt);{var jt=w=>{var O=Us(),ue=a(O);t(O),c(je=>o(ue,`üéØ ${je??""}${e(v)??""}`),[()=>y(e(g).target_temp)]),n(w,O)};d(xt,w=>{e(I)&&e(g)&&w(jt)},!0)}n(Le,tt)};d(vt,Le=>{e(g)?.cooler_state==="on"?Le(ot):Le(bt,!1)},!0)}n(ae,Fe)};d(Oe,ae=>{e(g)?.heater_state==="on"?ae(Ve):ae(Ke,!1)})}var it=s(Oe,2);let et;t(Te),t(Re);var gt=s(Re,2);{var Ee=ae=>{var Fe=Ks(),vt=J(Fe),ot=a(vt);{var bt=w=>{var O=Is(),ue=a(O);let je;var Me=s(ue,2),re=s(a(Me),2);let ye;var at=a(re,!0);t(re);var Qe=s(re,2),st=a(Qe,!0);t(Qe),t(Me),t(O),c(()=>{je=Ae(ue,1,"device-icon-wrap svelte-g5au2j",null,je,{active:e(g)?.heater_state==="on"}),ye=Ae(re,1,"device-state svelte-g5au2j",null,ye,{on:e(g)?.heater_state==="on"}),o(at,e(g)?.heater_state==="on"?"ON":"OFF"),o(st,e(r).heater_entity_id)}),n(w,O)};d(ot,w=>{e(r).heater_entity_id&&w(bt)})}var Le=s(ot,2);{var tt=w=>{var O=Vs(),ue=a(O);let je;var Me=s(ue,2),re=s(a(Me),2);let ye;var at=a(re,!0);t(re);var Qe=s(re,2),st=a(Qe,!0);t(Qe),t(Me),t(O),c(()=>{je=Ae(ue,1,"device-icon-wrap svelte-g5au2j",null,je,{active:e(g)?.cooler_state==="on"}),ye=Ae(re,1,"device-state svelte-g5au2j",null,ye,{on:e(g)?.cooler_state==="on"}),o(at,e(g)?.cooler_state==="on"?"ON":"OFF"),o(st,e(r).cooler_entity_id)}),n(w,O)};d(Le,w=>{e(r).cooler_entity_id&&w(tt)})}t(vt);var xt=s(vt,2);{var jt=w=>{var O=Ys(),ue=J(O),je=a(ue),Me=s(a(je),2),re=a(Me);t(Me),t(je);var ye=s(je,2),at=s(a(ye),2),Qe=a(at);t(at),t(ye),t(ue);var st=s(ue,2);{var rt=De=>{var Ne=Hs(),Ue=s(a(Ne),2),dt=a(Ue);t(Ue);var Vt=s(Ue,2);Vt.__click=()=>de(),t(Ne),c(ua=>{o(dt,`Override active: ${ua??""}`),Vt.disabled=e(z)},[()=>e(g).override_state?.toUpperCase()]),n(De,Ne)};d(st,De=>{e(g).override_active&&De(rt)})}var pt=s(st,2),Lt=s(a(pt),2),Nt=a(Lt);{var da=De=>{var Ne=Ws(),Ue=J(Ne);Ue.__click=()=>Z("heater","on");var dt=s(Ue,2);dt.__click=()=>Z("heater","off"),c(()=>{Ue.disabled=e(z),dt.disabled=e(z)}),n(De,Ne)};d(Nt,De=>{e(r).heater_entity_id&&De(da)})}var Ut=s(Nt,2);{var ca=De=>{var Ne=Js(),Ue=J(Ne);Ue.__click=()=>Z("cooler","on");var dt=s(Ue,2);dt.__click=()=>Z("cooler","off"),c(()=>{Ue.disabled=e(z),dt.disabled=e(z)}),n(De,Ne)};d(Ut,De=>{e(r).cooler_entity_id&&De(ca)})}var It=s(Ut,2);It.__click=()=>de(),t(Lt),t(pt),c((De,Ne)=>{o(re,`${De??""}${e(v)??""}`),o(Qe,`¬±${Ne??""}${e(v)??""}`),It.disabled=e(z)},[()=>y(e(g).target_temp),()=>e(g).hysteresis?.toFixed(1)||"--"]),n(w,O)};d(xt,w=>{e(g)&&w(jt)})}n(ae,Fe)};d(gt,ae=>{e(I)||ae(Ee)})}t(te),c(()=>{pe=Ae(te,1,"info-card temp-control-card svelte-g5au2j",null,pe,{"heater-on":e(g)?.heater_state==="on","cooler-on":e(g)?.cooler_state==="on",collapsed:e(I)}),et=Ae(it,0,"chevron svelte-g5au2j",null,et,{rotated:!e(I)})}),n(S,te)},ia=S=>{var te=ze(),pe=J(te);{var Re=Te=>{var Oe=$s(),Ve=s(a(Oe),2),Ke=a(Ve);{var it=Ee=>{var ae=Xs(),Fe=a(ae);t(ae),c(()=>o(Fe,`Heater: ${e(r).heater_entity_id??""}`)),n(Ee,ae)};d(Ke,Ee=>{e(r).heater_entity_id&&Ee(it)})}var et=s(Ke,2);{var gt=Ee=>{var ae=Zs(),Fe=a(ae);t(ae),c(()=>o(Fe,`Cooler: ${e(r).cooler_entity_id??""}`)),n(Ee,ae)};d(et,Ee=>{e(r).cooler_entity_id&&Ee(gt)})}we(2),t(Ve),t(Oe),n(Te,Oe)};d(pe,Te=>{(e(r).heater_entity_id||e(r).cooler_entity_id)&&e(r).status!=="fermenting"&&Te(Re)},!0)}n(S,te)};d(Et,S=>{e(j)&&(e(r).status==="fermenting"||e(r).status==="conditioning")?S(na):S(ia,!1)})}var va=s(Et,2);{var oa=S=>{vs(S,{get notes(){return e(r).notes}})};d(va,S=>{e(r).notes&&S(oa)})}t(Pt),t(Dt),c(()=>{o(lt,`#${(e(r).batch_number||"?")??""}`),o(nt,e(r).name||e(r).recipe?.name||"Unnamed Batch"),Ye.disabled=e(f),Xe(Ye,`color: ${e(b).color??""}; background: ${e(b).bg??""};`),Bt!==(Bt=e(r).status)&&(Ye.value=(Ye.__value=e(r).status)??"",ha(Ye,e(r).status))}),n(ge,Ie)};d(G,ge=>{e(le)?ge(se):ge(Be,!1)},!0)}n(m,h)};d(_e,m=>{e(r)?m(We,!1):m(He)},!0)}n(ve,oe)};d(V,ve=>{e(X)?ve(P):ve(Se,!1)},!0)}n(u,k)};d(ee,u=>{e(R)?u(ie):u(ce,!1)})}t(W);var Ge=s(W,2);{var be=u=>{var k=tr();k.__click=()=>_(N,!1);var V=a(k);V.__click=We=>We.stopPropagation();var P=s(a(V),2),Se=a(P);t(P);var ve=s(P,2),oe=a(ve);oe.__click=()=>_(N,!1);var _e=s(oe,2);_e.__click=he;var He=a(_e,!0);t(_e),t(ve),t(V),t(k),c(()=>{o(Se,`Are you sure you want to delete "${(e(r)?.name||"this batch")??""}"? This cannot be undone.`),oe.disabled=e(U),_e.disabled=e(U),o(He,e(U)?"Deleting...":"Delete Batch")}),n(u,k)};d(Ge,u=>{e(N)&&u(be)})}n($,Q),ht(),x()}qt(["click","change"]);export{yr as component,jr as universal};
