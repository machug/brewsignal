import{d as Bt,f as i,s as o,a as l,c as je,t as wt,h as Ut}from"../chunks/BPY3LF1i.js";import{d as a,e as s,r as t,t as u,a as zt,f as G,h as e,u as B,n as Ae,g as Ft,s as fe,p as It,o as oa,c as _,az as qa,aJ as Ma,aC as Sa,ax as Ba}from"../chunks/WzhiZOZ9.js";import{e as At,i as Ht}from"../chunks/DnC7am1E.js";import{i as v}from"../chunks/DTo_ih-i.js";import{h as Ta}from"../chunks/BJzfFUzm.js";import{s as st}from"../chunks/D5Ox4mlS.js";import{s as Ve}from"../chunks/BYYdgBsh.js";import{s as Ke}from"../chunks/6KfV5OBv.js";import{b as Da,i as Aa,s as Pa}from"../chunks/BX-VZZUc.js";import{s as Oa,a as Ea}from"../chunks/fcLv_oK9.js";import{p as La}from"../chunks/C7eA4GeJ.js";import{g as Ga}from"../chunks/B9FR9mFH.js";import{a8 as Na,a9 as Ua,aa as Ia,ab as Ha,ac as Va,X as Wa,S as ia,ad as Tt,a3 as Ja,Q as Lt,ae as Gt}from"../chunks/K3YiLSbk.js";import{b as St,d as da,g as ca,c as Dt}from"../chunks/Dhf-mfqW.js";import{t as va}from"../chunks/DGrXzhna.js";import{B as Ya}from"../chunks/B3n1llnb.js";import{s as Qa}from"../chunks/sGHY5uTo.js";import{p as ht}from"../chunks/AVMQxM7Q.js";import{F as Xa}from"../chunks/BYbR5wwK.js";import{s as Nt}from"../chunks/BuoPMR_v.js";const Ka=!1,cl=Object.freeze(Object.defineProperty({__proto__:null,prerender:Ka},Symbol.toStringTag,{value:"Module"}));function Za(me){return me>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:me>=-60?{bars:3,color:"var(--positive)",label:"Good"}:me>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function ua(me){const n=Math.floor((Date.now()-new Date(me).getTime())/1e3);if(n<10)return"just now";if(n<60)return`${n}s ago`;const S=Math.floor(n/60);if(S<60)return`${S}m ago`;const Z=Math.floor(S/60);return Z<24?`${Z}h ago`:`${Math.floor(Z/24)}d ago`}var $a=i('<div class="accent-bar svelte-1oyrwd9"></div>'),es=i('<span class="card-icon svelte-1oyrwd9"> </span>'),ts=i('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),as=i('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function kt(me,n){let S=ht(n,"highlight",3,!1),Z=ht(n,"compact",3,!1),D=ht(n,"collapsible",3,!1),m=ht(n,"expanded",3,!1);var N=as();let r;var V=a(N);{var h=j=>{var k=$a();l(j,k)};v(V,j=>{S()&&j(h)})}var re=s(V,2),ue=a(re),oe=a(ue);{var T=j=>{var k=es(),ae=a(k,!0);t(k),u(()=>o(ae,n.icon)),l(j,k)};v(oe,j=>{n.icon&&j(T)})}var de=s(oe,2),W=a(de,!0);t(de),t(ue);var te=s(ue,2);{var b=j=>{var k=ts();k.__click=function(...g){n.onToggle?.apply(this,g)};var ae=a(k);let J;t(k),u(()=>{st(k,"aria-label",m()?"Collapse":"Expand"),J=Ve(ae,0,"expand-icon svelte-1oyrwd9",null,J,{"rotate-180":m()})}),l(j,k)};v(te,j=>{D()&&n.onToggle&&j(b)})}t(re);var A=s(re,2);let U;var I=a(A);Qa(I,()=>n.children),t(A),t(N),u(()=>{r=Ve(N,1,"batch-card svelte-1oyrwd9",null,r,{highlight:S(),compact:Z()}),o(W,n.title),U=Ve(A,1,"card-content svelte-1oyrwd9",null,U,{collapsed:D()&&!m()})}),l(me,N)}Bt(["click"]);var ss=i('<span class="updated-text svelte-t80j9z"> </span>'),rs=i('<div class="hero-divider svelte-t80j9z"></div> <div class="hero-metric temperature svelte-t80j9z"><span class="hero-value svelte-t80j9z"> <span class="hero-unit svelte-t80j9z"> </span></span> <span class="hero-label svelte-t80j9z">Temperature</span></div>',1),ls=i('<div class="remaining-text svelte-t80j9z"> </div>'),ns=i('<div class="progress-section svelte-t80j9z"><div class="progress-labels svelte-t80j9z"><div class="progress-endpoint start svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">OG</span></div> <div class="progress-current svelte-t80j9z"><span class="current-percent svelte-t80j9z"> </span></div> <div class="progress-endpoint end svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">Target FG</span></div></div> <div class="progress-track svelte-t80j9z"><div class="progress-fill svelte-t80j9z"></div> <div><div class="marker-dot svelte-t80j9z"></div> <div class="marker-value svelte-t80j9z"> </div></div></div> <!></div>'),is=i('<div class="metrics-row svelte-t80j9z"><div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">ABV</span></div> <div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">Attenuation</span></div></div>'),vs=i('<div class="status-row svelte-t80j9z"><div class="live-indicator svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> <span class="status-text svelte-t80j9z">LIVE</span></div> <!></div> <div class="hero-section svelte-t80j9z"><div class="hero-metric gravity svelte-t80j9z"><span class="hero-value svelte-t80j9z"> </span> <span class="hero-label svelte-t80j9z">Gravity</span></div> <!></div> <!> <!>',1),os=i('<div class="completed-grid svelte-t80j9z"><div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Original Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Final Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">ABV</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Attenuation</span></div></div>'),ds=i('<div class="empty-state svelte-t80j9z"><div class="empty-icon svelte-t80j9z">‚óé</div> <p class="empty-text svelte-t80j9z">Set Original Gravity to track fermentation</p></div>');function cs(me,n){zt(n,!0);let S=B(()=>n.currentSg??n.progress?.measured?.current_sg),Z=B(()=>n.liveReading?.temp??n.progress?.temperature?.current),D=B(()=>n.liveReading?.last_seen),m=B(()=>e(D)?ua(e(D)):null),N=B(ca),r=B(()=>{if(!n.batch.measured_og||!e(S))return null;const T=Math.max(0,(n.batch.measured_og-e(S))*131.25),de=n.batch.measured_og-1,W=de!==0?Math.max(0,Math.min(100,(n.batch.measured_og-e(S))/de*100)):0;return{abv:T,attenuation:W}}),V=B(()=>{const T=n.batch.measured_og,de=n.batch.recipe?.fg;if(!T||!de||!e(S))return null;const W=T-de,te=T-e(S);return W<=0?null:Math.max(0,Math.min(100,te/W*100))}),h=B(()=>n.batch.status==="fermenting"||n.batch.status==="conditioning");function re(T){return T==null?"--":St(T)}function ue(T){return T==null?"--":`${T.toFixed(1)}%`}function oe(T){return T==null?"--":da(T)}kt(me,{title:"Fermentation",children:(T,de)=>{var W=je(),te=G(W);{var b=U=>{var I=vs(),j=G(I),k=s(a(j),2);{var ae=w=>{var d=ss(),p=a(d);t(d),u(()=>o(p,`Updated ${e(m)??""}`)),l(w,d)};v(k,w=>{e(m)&&w(ae)})}t(j);var J=s(j,2),g=a(J),R=a(g),se=a(R,!0);t(R),Ae(2),t(g);var P=s(g,2);{var ie=w=>{var d=rs(),p=s(G(d),2),z=a(p),F=a(z,!0),H=s(F),Q=a(H,!0);t(H),t(z),Ae(2),t(p),u($=>{o(F,$),o(Q,e(N))},[()=>oe(e(Z))]),l(w,d)};v(P,w=>{e(Z)!=null&&w(ie)})}t(J);var Y=s(J,2);{var le=w=>{var d=ns(),p=a(d),z=a(p),F=a(z),H=a(F,!0);t(F),Ae(2),t(z);var Q=s(z,2),$=a(Q),Re=a($);t($),t(Q);var ce=s(Q,2),_e=a(ce),ge=a(_e,!0);t(_e),Ae(2),t(ce),t(p);var Se=s(p,2),De=a(Se),c=s(De,2);let y;var L=s(a(c),2),O=a(L,!0);t(L),t(c),t(Se);var ze=s(Se,2);{var Be=ee=>{var ne=ls(),we=a(ne);t(ne),u(pe=>o(we,`${pe??""} points to go`),[()=>n.progress.progress.sg_remaining.toFixed(3)]),l(ee,ne)};v(ze,ee=>{n.progress?.progress?.sg_remaining!=null&&n.progress.progress.sg_remaining>0&&ee(Be)})}t(d),u((ee,ne,we,pe)=>{o(H,ee),o(Re,`${ne??""}%`),o(ge,we),Ke(De,`width: ${e(V)??""}%`),y=Ve(c,1,"progress-marker svelte-t80j9z",null,y,{"at-start":e(V)<3}),Ke(c,`left: ${e(V)??""}%`),o(O,pe)},[()=>re(n.batch.measured_og),()=>e(V).toFixed(0),()=>re(n.batch.recipe.fg),()=>re(e(S))]),l(w,d)};v(Y,w=>{e(V)!==null&&n.batch.measured_og&&n.batch.recipe?.fg&&w(le)})}var he=s(Y,2);{var Ce=w=>{var d=is(),p=a(d),z=a(p),F=a(z,!0);t(z),Ae(2),t(p);var H=s(p,2),Q=a(H),$=a(Q,!0);t(Q),Ae(2),t(H),t(d),u((Re,ce)=>{o(F,Re),o($,ce)},[()=>ue(e(r).abv),()=>ue(e(r).attenuation)]),l(w,d)};v(he,w=>{e(r)&&w(Ce)})}u(w=>o(se,w),[()=>re(e(S))]),l(U,I)},A=U=>{var I=je(),j=G(I);{var k=J=>{const g=B(()=>n.batch.measured_fg??n.progress?.measured?.fg??n.progress?.measured?.current_sg),R=B(()=>n.batch.measured_abv??n.progress?.measured?.abv),se=B(()=>n.batch.measured_attenuation??n.progress?.measured?.attenuation);var P=os(),ie=a(P),Y=a(ie),le=a(Y,!0);t(Y),Ae(2),t(ie);var he=s(ie,2),Ce=a(he),w=a(Ce,!0);t(Ce),Ae(2),t(he);var d=s(he,2),p=a(d),z=a(p,!0);t(p),Ae(2),t(d);var F=s(d,2),H=a(F),Q=a(H,!0);t(H),Ae(2),t(F),t(P),u(($,Re,ce,_e)=>{o(le,$),o(w,Re),o(z,ce),o(Q,_e)},[()=>re(n.batch.measured_og),()=>re(e(g)),()=>e(R)!=null?ue(e(R)):"--",()=>e(se)!=null?ue(e(se)):"--"]),l(J,P)},ae=J=>{var g=ds();l(J,g)};v(j,J=>{n.batch.measured_og?J(k):J(ae,!1)},!0)}l(U,I)};v(te,U=>{e(S)&&e(h)?U(b):U(A,!1)})}l(T,W)},$$slots:{default:!0}}),Ft()}var us=i('<span class="device-last-seen svelte-1kdxwtz"> </span>'),_s=i('<div class="signal-bar svelte-1kdxwtz"></div>'),gs=i('<div class="metric-item svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="metric-text svelte-1kdxwtz"> </span></div>'),ps=i('<div class="metric-item battery svelte-1kdxwtz"><svg class="battery-icon svelte-1kdxwtz" viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="2" y="7" width="18" height="10" rx="2"></rect><rect x="4" y="9" height="6" stroke="none" rx="1"></rect><path d="M20 10v4h2v-4z" stroke="none"></path></svg> <span class="metric-text svelte-1kdxwtz"><!></span></div>'),fs=i('<div class="device-metrics svelte-1kdxwtz"><!> <!></div>'),ms=i('<div class="device-row svelte-1kdxwtz"><div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!></div> <!>',1),hs=i('<div class="device-row svelte-1kdxwtz"><div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <span class="device-last-seen svelte-1kdxwtz">No data</span></div>'),bs=i('<div class="device-info svelte-1kdxwtz"><!></div>'),ys=i('<button type="button" class="link-btn svelte-1kdxwtz">Link device</button>'),xs=i('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function js(me,n){zt(n,!0);let S=B(()=>n.liveReading?.device_type==="tilt"),Z=B(()=>e(S)&&n.liveReading?.rssi?Za(n.liveReading.rssi):null),D=B(()=>n.liveReading?.last_seen?ua(n.liveReading.last_seen):null),m=B(()=>n.liveReading?.battery_percent!=null||n.liveReading?.battery_voltage!=null),N=B(()=>n.liveReading?.battery_percent),r=B(()=>n.liveReading?.battery_voltage),V=B(()=>e(N)?e(N)>50?"var(--positive)":e(N)>20?"var(--warning)":"var(--negative)":"var(--text-muted)"),h=B(()=>{if(!n.liveReading)return n.batch.device_id||"Unknown";const re=n.liveReading.device_type;return re==="tilt"?`${n.liveReading.color} Tilt`:re==="gravitymon"?`GravityMon (${n.liveReading.id})`:re==="ispindel"?`iSpindel (${n.liveReading.id})`:re==="floaty"?`Floaty (${n.liveReading.id})`:n.liveReading.color||n.liveReading.id});kt(me,{title:"Tracking Device",compact:!0,children:(re,ue)=>{var oe=je(),T=G(oe);{var de=te=>{var b=bs(),A=a(b);{var U=j=>{var k=ms(),ae=G(k),J=a(ae),g=s(a(J));t(J);var R=s(J,2);{var se=Y=>{var le=us(),he=a(le,!0);t(le),u(()=>o(he,e(D))),l(Y,le)};v(R,Y=>{e(D)&&Y(se)})}t(ae);var P=s(ae,2);{var ie=Y=>{var le=fs(),he=a(le);{var Ce=p=>{var z=gs(),F=a(z);At(F,20,()=>Array(4),Ht,($,Re,ce)=>{var _e=_s();u(()=>Ke(_e,`height: ${4+ce*2}px; background: ${(ce<e(Z).bars?e(Z).color:"var(--bg-hover)")??""}; opacity: ${ce<e(Z).bars?1:.4};`)),l($,_e)}),t(F);var H=s(F,2),Q=a(H);t(H),t(z),u(()=>{Ke(H,`color: ${e(Z).color??""}`),o(Q,`${n.liveReading.rssi??""}dBm`)}),l(p,z)};v(he,p=>{e(Z)&&p(Ce)})}var w=s(he,2);{var d=p=>{var z=ps(),F=a(z),H=s(a(F)),Q=s(H);t(F);var $=s(F,2),Re=a($);{var ce=ge=>{var Se=wt();u(De=>o(Se,`${De??""}%`),[()=>e(N).toFixed(0)]),l(ge,Se)},_e=ge=>{var Se=je(),De=G(Se);{var c=y=>{var L=wt();u(O=>o(L,`${O??""}V`),[()=>e(r).toFixed(2)]),l(y,L)};v(De,y=>{e(r)!=null&&y(c)},!0)}l(ge,Se)};v(Re,ge=>{e(N)!=null?ge(ce):ge(_e,!1)})}t($),t(z),u(()=>{st(F,"stroke",e(V)),st(H,"width",(e(N)??50)*.14),st(H,"fill",e(V)),st(Q,"fill",e(V)),Ke($,`color: ${e(V)??""}`)}),l(p,z)};v(w,p=>{e(m)&&p(d)})}t(le),l(Y,le)};v(P,Y=>{(e(Z)||e(m))&&Y(ie)})}u(()=>o(g,` ${e(h)??""}`)),l(j,k)},I=j=>{var k=hs(),ae=a(k),J=s(a(ae));t(ae),Ae(2),t(k),u(()=>o(J,` ${n.batch.device_id??""}`)),l(j,k)};v(A,j=>{n.liveReading?j(U):j(I,!1)})}t(b),l(te,b)},W=te=>{var b=xs(),A=s(a(b),2);{var U=I=>{var j=ys();j.__click=function(...k){n.onEdit?.apply(this,k)},l(I,j)};v(A,I=>{n.onEdit&&I(U)})}t(b),l(te,b)};v(T,te=>{n.batch.device_id?te(de):te(W,!1)})}l(re,oe)},$$slots:{default:!0}}),Ft()}Bt(["click"]);const ws=131.25;var ks=i('<span class="yeast-producer svelte-19u9n31"> </span>'),zs=i('<span class="yeast-temp svelte-19u9n31"> </span>'),Fs=i('<div class="yeast-row recipe svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Recipe</span> <span class="yeast-value muted svelte-19u9n31"> </span></div>'),Cs=i('<div class="yeast-row actual svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span> <!> <!></div> <!>',1),Rs=i('<div class="yeast-row svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span></div>'),qs=i('<div class="yeast-section svelte-19u9n31"><!></div>'),Ms=i('<div class="targets-row svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div></div> <!>',1);function Ss(me,n){zt(n,!0);function S(D){return D==null?"--":St(D)}let Z=B(()=>n.recipe.abv!=null?n.recipe.abv:n.recipe.og&&n.recipe.fg?(n.recipe.og-n.recipe.fg)*ws:null);kt(me,{title:"Recipe Targets",compact:!0,children:(D,m)=>{var N=Ms(),r=G(N),V=a(r),h=s(a(V),2),re=a(h,!0);t(h),t(V);var ue=s(V,2),oe=s(a(ue),2),T=a(oe,!0);t(oe),t(ue);var de=s(ue,2),W=s(a(de),2),te=a(W,!0);t(W),t(de),t(r);var b=s(r,2);{var A=U=>{var I=qs(),j=a(I);{var k=J=>{var g=Cs(),R=G(g),se=s(a(R),2),P=a(se,!0);t(se);var ie=s(se,2);{var Y=d=>{var p=ks(),z=a(p);t(p),u(()=>o(z,`(${n.yeastStrain.producer??""})`)),l(d,p)};v(ie,d=>{n.yeastStrain.producer&&d(Y)})}var le=s(ie,2);{var he=d=>{var p=zs(),z=a(p);t(p),u((F,H)=>o(z,`${F??""}-${H??""}¬∞C`),[()=>n.yeastStrain.temp_low.toFixed(0),()=>n.yeastStrain.temp_high.toFixed(0)]),l(d,p)};v(le,d=>{n.yeastStrain.temp_low&&n.yeastStrain.temp_high&&d(he)})}t(R);var Ce=s(R,2);{var w=d=>{var p=Fs(),z=s(a(p),2),F=a(z,!0);t(z),t(p),u(()=>o(F,n.recipe.yeast_name)),l(d,p)};v(Ce,d=>{n.recipe.yeast_name&&d(w)})}u(()=>o(P,n.yeastStrain.name)),l(J,g)},ae=J=>{var g=je(),R=G(g);{var se=P=>{var ie=Rs(),Y=s(a(ie),2),le=a(Y,!0);t(Y),t(ie),u(()=>o(le,n.recipe.yeast_name)),l(P,ie)};v(R,P=>{n.recipe.yeast_name&&P(se)},!0)}l(J,g)};v(j,J=>{n.yeastStrain?J(k):J(ae,!1)})}t(I),l(U,I)};v(b,U=>{(n.yeastStrain||n.recipe.yeast_name)&&U(A)})}u((U,I,j)=>{o(re,U),o(T,I),o(te,j)},[()=>S(n.recipe.og),()=>S(n.recipe.fg),()=>e(Z)!=null?`${e(Z).toFixed(1)}%`:"--"]),l(D,N)},$$slots:{default:!0}}),Ft()}var Bs=i('<p class="notes-content svelte-hkv31i"> </p>');function Ts(me,n){kt(me,{title:"Notes",children:(S,Z)=>{var D=Bs(),m=a(D,!0);t(D),u(()=>o(m,n.notes)),l(S,D)},$$slots:{default:!0}})}var Ds=i('<div class="ml-panel loading svelte-1xs394q"><p>Loading predictions...</p></div>'),As=i('<div class="ml-panel error svelte-1xs394q"><p class="error-text svelte-1xs394q"> </p></div>'),Ps=i("<option> </option>"),Os=i('<span class="anomaly-reasons svelte-1xs394q"> </span>'),Es=i('<div class="anomaly-banner svelte-1xs394q"><span class="anomaly-icon svelte-1xs394q">‚ö†Ô∏è</span> <div class="anomaly-content svelte-1xs394q"><span class="anomaly-label svelte-1xs394q">Anomaly Detected</span> <!></div></div>'),Ls=i('<span class="activity-badge svelte-1xs394q"> </span>'),Gs=i('<div class="progress-section svelte-1xs394q"><div class="progress-header svelte-1xs394q"><span class="progress-label svelte-1xs394q">Fermentation Progress</span> <!></div> <div class="fermentation-progress-bar svelte-1xs394q"><div class="fermentation-fill svelte-1xs394q"></div></div> <div class="progress-labels svelte-1xs394q"><span class="og-label svelte-1xs394q"> </span> <span class="progress-percent svelte-1xs394q"> </span> <span class="fg-label svelte-1xs394q"> </span></div></div>'),Ns=i('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Predicted FG:</span> <span class="value svelte-1xs394q"> </span></div>'),Us=i('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Attenuation:</span> <span class="value attenuation svelte-1xs394q"> </span></div>'),Is=i('<span class="complete-now svelte-1xs394q">Ready now!</span>'),Hs=i('<span class="days svelte-1xs394q"> </span>'),Vs=i(" <!>",1),Ws=i('<div class="metric completion-metric svelte-1xs394q"><span class="label svelte-1xs394q">Est. Completion:</span> <span class="value svelte-1xs394q"><!></span></div>'),Js=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model:</span> <span class="model-value model-type svelte-1xs394q"> </span></div>'),Ys=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),Qs=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),Xs=i('<div><div class="panel-header svelte-1xs394q"><h3 class="panel-title svelte-1xs394q">Fermentation Intelligence</h3> <div class="header-controls svelte-1xs394q"><select class="model-select svelte-1xs394q" title="Select prediction model"></select> <button type="button" class="reload-btn svelte-1xs394q" title="Recalculate predictions from database history"> </button></div></div> <!> <!> <div class="metrics svelte-1xs394q"><!> <!> <!> <div class="model-info svelte-1xs394q"><!> <!> <!></div></div></div>'),Ks=i('<div class="ml-panel disabled svelte-1xs394q"><div class="disabled-header svelte-1xs394q"><p class="unavailable-text svelte-1xs394q">ML predictions unavailable</p> <button type="button" class="reload-btn svelte-1xs394q" title="Reload predictions from database"> </button></div> <p class="unavailable-hint svelte-1xs394q"><!></p></div>');function Zs(me,n){zt(n,!0);let S=ht(n,"measuredOg",3,null),Z=ht(n,"currentSg",3,null),D=ht(n,"liveReading",3,null),m=fe(It({available:!1})),N=fe(!0),r=fe(!1),V=fe(null),h=fe("auto");const re=[{value:"auto",label:"Auto (Best Fit)"},{value:"exponential",label:"Exponential"},{value:"gompertz",label:"Gompertz (S-Curve)"},{value:"logistic",label:"Logistic"}];async function ue(){_(N,!0),_(V,null);try{_(m,await Ua(n.batchId,e(h)),!0)}catch(g){_(V,g instanceof Error?g.message:"Failed to load predictions",!0),console.error("Failed to load ML predictions:",g)}finally{_(N,!1)}}async function oe(){_(r,!0),_(V,null);try{const g=await Na(n.batchId);console.log("Reloaded predictions:",g.message),await ue()}catch(g){_(V,g instanceof Error?g.message:"Failed to reload predictions",!0),console.error("Failed to reload predictions:",g)}finally{_(r,!1)}}function T(){ue()}oa(oe);function de(g){return g?new Date(g).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}):"N/A"}function W(g){if(!g)return null;const R=new Date(g),se=new Date,P=R.getTime()-se.getTime();return Math.ceil(P/(1e3*60*60*24))}let te=B(()=>{const g=S()??e(m).predicted_og,R=e(m).predicted_fg,se=Z()??D()?.sg;if(!g||!R||!se||g<=R)return null;const P=g-R,Y=(g-se)/P*100;return Math.min(100,Math.max(0,Y))}),b=B(()=>{const g=S()??e(m).predicted_og,R=Z()??D()?.sg;if(!g||!R||g<=1)return null;const se=(g-R)/(g-1)*100;return Math.min(100,Math.max(0,se))}),A=B(()=>{const g=D()?.sg_rate;if(g==null)return null;const R=Math.abs(g);return R>.002?{label:"Very Active",color:"var(--activity-very-active)",emoji:"üî•"}:R>5e-4?{label:"Active",color:"var(--activity-active)",emoji:"‚ú®"}:R>1e-4?{label:"Slowing",color:"var(--activity-slowing)",emoji:"üê¢"}:{label:"Complete",color:"var(--activity-complete)",emoji:"‚úì"}}),U=B(()=>D()?.is_anomaly??!1),I=B(()=>D()?.anomaly_reasons??[]);var j=je(),k=G(j);{var ae=g=>{var R=Ds();l(g,R)},J=g=>{var R=je(),se=G(R);{var P=Y=>{var le=As(),he=a(le),Ce=a(he);t(he),t(le),u(()=>o(Ce,`‚ö†Ô∏è ${e(V)??""}`)),l(Y,le)},ie=Y=>{var le=je(),he=G(le);{var Ce=d=>{var p=Xs();let z;var F=a(p),H=s(a(F),2),Q=a(H);Q.__change=T,At(Q,21,()=>re,Ht,(M,C)=>{var q=Ps(),be=a(q,!0);t(q);var qe={};u(()=>{o(be,e(C).label),qe!==(qe=e(C).value)&&(q.value=(q.__value=e(C).value)??"")}),l(M,q)}),t(Q);var $=s(Q,2);$.__click=oe;var Re=a($,!0);t($),t(H),t(F);var ce=s(F,2);{var _e=M=>{var C=Es(),q=s(a(C),2),be=s(a(q),2);{var qe=Ge=>{var We=Os(),Ne=a(We,!0);t(We),u(Ue=>o(Ne,Ue),[()=>e(I).join(", ")]),l(Ge,We)};v(be,Ge=>{e(I).length>0&&Ge(qe)})}t(q),t(C),l(M,C)};v(ce,M=>{e(U)&&M(_e)})}var ge=s(ce,2);{var Se=M=>{var C=Gs(),q=a(C),be=s(a(q),2);{var qe=et=>{var nt=Ls(),yt=a(nt);t(nt),u(()=>{Ke(nt,`color: ${e(A).color??""}`),o(yt,`${e(A).emoji??""} ${e(A).label??""}`)}),l(et,nt)};v(be,et=>{e(A)&&et(qe)})}t(q);var Ge=s(q,2),We=a(Ge);t(Ge);var Ne=s(Ge,2),Ue=a(Ne),lt=a(Ue);t(Ue);var ut=s(Ue,2),bt=a(ut);t(ut);var $e=s(ut,2),_t=a($e);t($e),t(Ne),t(C),u((et,nt,yt)=>{Ke(We,`width: ${e(te)??""}%`),o(lt,`OG: ${et??""}`),o(bt,`${nt??""}%`),o(_t,`FG: ${yt??""}`)},[()=>St(S()??e(m).predicted_og??0),()=>e(te).toFixed(0),()=>St(e(m).predicted_fg??0)]),l(M,C)};v(ge,M=>{e(te)!==null&&M(Se)})}var De=s(ge,2),c=a(De);{var y=M=>{var C=Ns(),q=s(a(C),2),be=a(q,!0);t(q),t(C),u(qe=>o(be,qe),[()=>St(e(m).predicted_fg)]),l(M,C)};v(c,M=>{e(m).predicted_fg&&M(y)})}var L=s(c,2);{var O=M=>{var C=Us(),q=s(a(C),2),be=a(q);t(q),t(C),u(qe=>o(be,`${qe??""}%`),[()=>e(b).toFixed(1)]),l(M,C)};v(L,M=>{e(b)!==null&&M(O)})}var ze=s(L,2);{var Be=M=>{const C=B(()=>W(e(m).estimated_completion));var q=Ws(),be=s(a(q),2),qe=a(be);{var Ge=Ne=>{var Ue=Is();l(Ne,Ue)},We=Ne=>{var Ue=Vs(),lt=G(Ue),ut=s(lt);{var bt=$e=>{var _t=Hs(),et=a(_t);t(_t),u(()=>o(et,`(${e(C)??""} ${e(C)===1?"day":"days"})`)),l($e,_t)};v(ut,$e=>{e(C)!==null&&$e(bt)})}u($e=>o(lt,`${$e??""} `),[()=>de(e(m).estimated_completion)]),l(Ne,Ue)};v(qe,Ne=>{e(C)!==null&&e(C)<=0?Ne(Ge):Ne(We,!1)})}t(be),t(q),l(M,q)};v(ze,M=>{e(m).estimated_completion&&M(Be)})}var ee=s(ze,2),ne=a(ee);{var we=M=>{var C=Js(),q=s(a(C),2),be=a(q,!0);t(q),t(C),u(()=>o(be,e(m).model_type)),l(M,C)};v(ne,M=>{e(m).model_type&&M(we)})}var pe=s(ne,2);{var Ze=M=>{var C=Ys(),q=s(a(C),2),be=a(q);t(q),t(C),u(qe=>o(be,`${qe??""}%`),[()=>(e(m).r_squared*100).toFixed(0)]),l(M,C)};v(pe,M=>{e(m).r_squared!==void 0&&M(Ze)})}var rt=s(pe,2);{var Ct=M=>{var C=Qs(),q=s(a(C),2),be=a(q,!0);t(q),t(C),u(()=>o(be,e(m).num_readings)),l(M,C)};v(rt,M=>{e(m).num_readings&&M(Ct)})}t(ee),t(De),t(p),u(()=>{z=Ve(p,1,"ml-panel svelte-1xs394q",null,z,{"has-anomaly":e(U)}),Q.disabled=e(N)||e(r),$.disabled=e(r)||e(N),o(Re,e(r)?"Reloading...":"‚Üª")}),Da(Q,()=>e(h),M=>_(h,M)),l(d,p)},w=d=>{var p=Ks(),z=a(p),F=s(a(z),2);F.__click=oe;var H=a(F,!0);t(F),t(z);var Q=s(z,2),$=a(Q);{var Re=_e=>{var ge=wt("Waiting for fermentation to progress (need visible SG drop)");l(_e,ge)},ce=_e=>{var ge=je(),Se=G(ge);{var De=y=>{var L=wt("Need more fermentation curve data for reliable prediction");l(y,L)},c=y=>{var L=je(),O=G(L);{var ze=ee=>{var ne=wt("Need at least 10 readings to make predictions");l(ee,ne)},Be=ee=>{var ne=wt("Predictions will appear once fermentation is underway");l(ee,ne)};v(O,ee=>{e(m).reason==="insufficient_data"?ee(ze):ee(Be,!1)},!0)}l(y,L)};v(Se,y=>{e(m).reason==="insufficient_curve_data"?y(De):y(c,!1)},!0)}l(_e,ge)};v($,_e=>{e(m).reason==="insufficient_fermentation_progress"?_e(Re):_e(ce,!1)})}t(Q),t(p),u(()=>{F.disabled=e(r)||e(N),o(H,e(r)?"Reloading...":"‚Üª Reload")}),l(d,p)};v(he,d=>{e(m).available?d(Ce):d(w,!1)},!0)}l(Y,le)};v(se,Y=>{e(V)?Y(P):Y(ie,!1)},!0)}l(g,R)};v(k,g=>{e(N)?g(ae):g(J,!1)})}l(me,j),Ft()}Bt(["change","click"]);var $s=i('<div class="loading svelte-1hws0u6">Loading alerts...</div>'),er=i('<div class="error-banner svelte-1hws0u6"><span> </span> <button type="button" class="dismiss-error svelte-1hws0u6">√ó</button></div>'),tr=i('<button type="button" class="dismiss-all-btn svelte-1hws0u6"> </button>'),ar=i('<span class="spinner svelte-1hws0u6"></span>'),sr=Ut('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1hws0u6"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg>'),rr=i('<div class="alert-item svelte-1hws0u6"><div class="alert-icon svelte-1hws0u6"> </div> <div class="alert-content svelte-1hws0u6"><div class="alert-header svelte-1hws0u6"><span class="alert-type svelte-1hws0u6"> </span> <span class="severity-badge svelte-1hws0u6"> </span></div> <p class="alert-message svelte-1hws0u6"> </p> <div class="alert-meta svelte-1hws0u6"><span class="alert-time svelte-1hws0u6"> </span> <span class="alert-separator svelte-1hws0u6">¬∑</span> <span class="alert-time svelte-1hws0u6"> </span></div></div> <button type="button" class="dismiss-btn svelte-1hws0u6" title="Dismiss alert"><!></button></div>'),lr=i('<!> <div class="alerts-header svelte-1hws0u6"><span class="alert-count svelte-1hws0u6"> </span> <!></div> <div class="alerts-list svelte-1hws0u6"></div>',1);function nr(me,n){zt(n,!0);let S=fe(It([])),Z=fe(!0),D=fe(null),m=fe(null),N=fe(!1);qa(()=>{r()});async function r(){try{_(Z,!0),_(D,null),_(S,await Ia(n.batchId,!1),!0)}catch(b){_(D,b instanceof Error?b.message:"Failed to load alerts",!0)}finally{_(Z,!1)}}async function V(b){try{_(m,b,!0),await Ha(n.batchId,b),_(S,e(S).filter(A=>A.id!==b),!0)}catch(A){_(D,A instanceof Error?A.message:"Failed to dismiss alert",!0)}finally{_(m,null)}}async function h(){try{_(N,!0),await Va(n.batchId),_(S,[],!0)}catch(b){_(D,b instanceof Error?b.message:"Failed to dismiss alerts",!0)}finally{_(N,!1)}}function re(b){switch(b){case"critical":return"var(--negative)";case"warning":return"var(--warning)";case"info":return"var(--accent)";default:return"var(--text-muted)"}}function ue(b){switch(b){case"stall":return"‚è∏";case"temperature_high":return"üî•";case"temperature_low":return"‚ùÑ";case"anomaly":return"‚ö†";default:return"‚ö†"}}function oe(b){const A=new Date(b),I=new Date().getTime()-A.getTime(),j=Math.floor(I/6e4),k=Math.floor(j/60),ae=Math.floor(k/24);return ae>0?`${ae}d ago`:k>0?`${k}h ago`:j>0?`${j}m ago`:"just now"}var T=je(),de=G(T);{var W=b=>{kt(b,{title:"Alerts",icon:"üîî",children:(A,U)=>{var I=$s();l(A,I)},$$slots:{default:!0}})},te=b=>{var A=je(),U=G(A);{var I=k=>{},j=k=>{kt(k,{title:"Active Alerts",icon:"üîî",highlight:!0,children:(ae,J)=>{var g=lr(),R=G(g);{var se=w=>{var d=er(),p=a(d),z=a(p,!0);t(p);var F=s(p,2);F.__click=()=>_(D,null),t(d),u(()=>o(z,e(D))),l(w,d)};v(R,w=>{e(D)&&w(se)})}var P=s(R,2),ie=a(P),Y=a(ie);t(ie);var le=s(ie,2);{var he=w=>{var d=tr();d.__click=h;var p=a(d,!0);t(d),u(()=>{d.disabled=e(N),o(p,e(N)?"Dismissing...":"Dismiss All")}),l(w,d)};v(le,w=>{e(S).length>1&&w(he)})}t(P);var Ce=s(P,2);At(Ce,21,()=>e(S),w=>w.id,(w,d)=>{var p=rr(),z=a(p),F=a(z,!0);t(z);var H=s(z,2),Q=a(H),$=a(Q),Re=a($,!0);t($);var ce=s($,2),_e=a(ce,!0);t(ce),t(Q);var ge=s(Q,2),Se=a(ge,!0);t(ge);var De=s(ge,2),c=a(De),y=a(c);t(c);var L=s(c,4),O=a(L);t(L),t(De),t(H);var ze=s(H,2);ze.__click=()=>V(e(d).id);var Be=a(ze);{var ee=we=>{var pe=ar();l(we,pe)},ne=we=>{var pe=sr();l(we,pe)};v(Be,we=>{e(m)===e(d).id?we(ee):we(ne,!1)})}t(ze),t(p),u((we,pe,Ze,rt,Ct,M,C,q)=>{Ke(p,`--severity-color: ${we??""}`),o(F,pe),o(Re,Ze),Ke(ce,`background: ${rt??""}`),o(_e,e(d).severity),o(Se,e(d).message),st(c,"title",`First detected: ${Ct??""}`),o(y,`First: ${M??""}`),st(L,"title",`Last seen: ${C??""}`),o(O,`Last: ${q??""}`),ze.disabled=e(m)===e(d).id},[()=>re(e(d).severity),()=>ue(e(d).alert_type),()=>e(d).alert_type.replace("_"," "),()=>re(e(d).severity),()=>new Date(e(d).first_detected_at).toLocaleString(),()=>oe(e(d).first_detected_at),()=>new Date(e(d).last_seen_at).toLocaleString(),()=>oe(e(d).last_seen_at)]),l(w,p)}),t(Ce),u(()=>o(Y,`${e(S).length??""} active`)),l(ae,g)},$$slots:{default:!0}})};v(U,k=>{e(S).length===0?k(I):k(j,!1)},!0)}l(b,A)};v(de,b=>{e(Z)?b(W):b(te,!1)})}l(me,T),Ft()}Bt(["click"]);var ir=i('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),vr=i('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),or=i('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),dr=i('<span class="recipe-type svelte-g5au2j"> </span>'),cr=i('<a class="recipe-link svelte-g5au2j"> <!></a>'),ur=i('<div class="batch-timing svelte-g5au2j"> </div>'),_r=i('<div class="batch-timing svelte-g5au2j"> </div>'),gr=i('<option class="svelte-g5au2j"> </option>'),pr=Ut('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" class="svelte-g5au2j"></path><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Resume',1),fr=Ut('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Pause',1),mr=i('<button type="button"><!></button>'),hr=i('<span class="chilling-icon svelte-g5au2j">üç∫</span> <h3 class="chilling-title svelte-g5au2j">Ready to Pitch!</h3>',1),br=i('<span class="chilling-icon svelte-g5au2j">‚ùÑÔ∏è</span> <h3 class="chilling-title svelte-g5au2j">Chilling to Pitch Temperature</h3>',1),yr=i('<div class="progress-section svelte-g5au2j"><div class="progress-bar svelte-g5au2j"><div class="progress-fill svelte-g5au2j"></div></div> <span class="progress-text svelte-g5au2j"> </span></div>'),xr=i('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è No cooler configured - set a cooler entity to enable automated chilling</span>'),jr=i('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è Temperature control disabled in settings</span>'),wr=i('<span class="status-ready svelte-g5au2j">Wort has reached pitch temperature - ready to add yeast!</span>'),kr=i('<span class="status-active svelte-g5au2j">Cooler will run automatically when temp exceeds target + hysteresis</span>'),zr=i('<div><div class="chilling-header svelte-g5au2j"><!></div> <div class="chilling-content svelte-g5au2j"><div class="temp-display svelte-g5au2j"><div class="temp-current svelte-g5au2j"><span class="temp-label svelte-g5au2j">Current</span> <span class="temp-value svelte-g5au2j"> </span></div> <div class="temp-arrow svelte-g5au2j">‚Üí</div> <div class="temp-target svelte-g5au2j"><span class="temp-label svelte-g5au2j">Target</span> <span class="temp-value svelte-g5au2j"> </span></div></div> <!> <div class="chilling-status svelte-g5au2j"><!></div></div></div>'),Fr=i(`<div class="paused-banner svelte-g5au2j"><div class="paused-header svelte-g5au2j"><svg class="paused-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> <h3 class="paused-title svelte-g5au2j">Readings Paused</h3></div> <p class="paused-text svelte-g5au2j">Hydrometer readings are not being stored. Live readings still display but won't be saved to the fermentation history.</p> <button type="button" class="resume-btn svelte-g5au2j"> </button></div>`),Cr=i('<span class="status-badge heater svelte-g5au2j">üî• Heating</span>'),Rr=i('<span class="status-badge cooler svelte-g5au2j">‚ùÑÔ∏è Cooling</span>'),qr=i('<span class="status-badge idle svelte-g5au2j"> </span>'),Mr=i('<div class="device-status heater svelte-g5au2j"><div>üî•</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Heater</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Sr=i('<div class="device-status cooler svelte-g5au2j"><div>‚ùÑÔ∏è</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Cooler</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Br=i('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">‚ö°</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),Tr=i('<button type="button" class="override-btn heat-on svelte-g5au2j">Force Heat ON</button> <button type="button" class="override-btn heat-off svelte-g5au2j">Force Heat OFF</button>',1),Dr=i('<button type="button" class="override-btn cool-on svelte-g5au2j">Force Cool ON</button> <button type="button" class="override-btn cool-off svelte-g5au2j">Force Cool OFF</button>',1),Ar=i('<div class="control-details svelte-g5au2j"><div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns-grid svelte-g5au2j"><!> <!> <button type="button" class="override-btn auto-mode svelte-g5au2j">Auto Mode</button></div></div>',1),Pr=i('<div class="device-status-grid svelte-g5au2j"><!> <!></div> <!>',1),Or=i('<div><button type="button" class="collapsible-header svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="collapse-indicator svelte-g5au2j"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" class="svelte-g5au2j"></path></svg></div></button> <!></div>'),Er=i('<span class="svelte-g5au2j"> </span>'),Lr=i('<span class="svelte-g5au2j"> </span>'),Gr=i('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><!> <!> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),Nr=i('<div class="chart-section svelte-g5au2j"><!></div>'),Ur=i('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <!> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j" aria-label="Delete batch"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <!> <!> <div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!> <!></div></div>  <!>',1),Ir=i('<div class="modal-overlay svelte-g5au2j" role="presentation"><div class="modal svelte-g5au2j" role="dialog" aria-modal="true" aria-labelledby="delete-modal-title" tabindex="-1"><h2 id="delete-modal-title" class="modal-title svelte-g5au2j">Delete Batch?</h2> <p class="modal-text svelte-g5au2j"> </p> <div class="modal-actions svelte-g5au2j"><button type="button" class="modal-btn cancel svelte-g5au2j">Cancel</button> <button type="button" class="modal-btn delete svelte-g5au2j"> </button></div></div></div>'),Hr=i('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div> <!>',1);function ul(me,n){zt(n,!0);const S=()=>Ea(La,"$page",Z),[Z,D]=Oa();let m=null,N=null,r=fe(null),V=fe(null),h=fe(null),re=It([]),ue=fe(!0),oe=fe(null),T=fe(!1),de=fe(!1),W=fe(!1),te=fe(!1),b=fe(!1),A=fe(!1),U=fe(!1),I=B(()=>parseInt(S().params.id??"0"));const j=["planning","fermenting","conditioning","completed","archived"];let k=B(()=>e(r)?Nt[e(r).status]:Nt.planning),ae=B(ca),J=B(()=>Dt.config.ha_enabled&&Dt.config.temp_control_enabled&&(e(r)?.heater_entity_id||e(r)?.cooler_entity_id)),g=B(()=>e(r)?.status==="planning"&&e(r)?.temp_target!=null),R=B(()=>!e(g)||!e(P)?.temp||!e(r)?.temp_target?!1:e(P).temp<=e(r).temp_target),se=B(()=>{if(!e(g)||!e(P)?.temp||!e(r)?.temp_target)return null;const c=e(r).temp_target+30,y=e(P).temp,L=e(r).temp_target;if(y<=L)return 100;if(y>=c)return 0;const O=(c-y)/(c-L)*100;return Math.min(100,Math.max(0,O))}),P=B(()=>{if(!e(r)?.device_id)return null;const c=va.tilts.get(e(r).device_id);if(c)return c;const y=e(r).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!y?.[1])return null;const L=y[1].toUpperCase();for(const O of va.tilts.values())if(O.color&&O.color.toUpperCase()===L)return O;return null});async function ie(){_(ue,!0),_(oe,null);try{if(_(r,await Wa(e(I)),!0),e(r).status==="fermenting"||e(r).status==="conditioning"||e(r).status==="completed")try{_(V,await ia(e(I)),!0)}catch{}if(e(r).heater_entity_id||e(r).cooler_entity_id)try{_(h,await Tt(e(I)),!0)}catch{}}catch(c){_(oe,c instanceof Error?c.message:"Failed to load batch",!0)}finally{_(ue,!1)}}async function Y(c){if(!(!e(r)||e(de))&&!(c==="conditioning"&&e(r).status==="fermenting"&&!confirm(`üí° Entering Conditioning Phase

Reminder: Adjust target temperature if cold crashing.
Temperature control will continue during conditioning.

Continue?`))){_(de,!0);try{_(r,await Lt(e(r).id,{status:c}),!0),(c==="fermenting"||c==="conditioning")&&_(V,await ia(e(r).id),!0)}catch(y){console.error("Failed to update status:",y)}finally{_(de,!1)}}}async function le(c){if(e(r)&&(_(r,await Lt(e(r).id,c),!0),_(T,!1),e(r).heater_entity_id||e(r).cooler_entity_id))try{_(h,await Tt(e(r).id),!0)}catch{}}async function he(){if(e(r)){_(b,!0);try{await Ja(e(r).id),Ga("/batches")}catch(c){_(oe,c instanceof Error?c.message:"Failed to delete batch",!0),_(b,!1),_(te,!1)}}}async function Ce(){if(!(!e(r)||e(U))){_(U,!0);try{_(r,await Lt(e(r).id,{readings_paused:!e(r).readings_paused}),!0)}catch(c){console.error("Failed to toggle pause:",c)}finally{_(U,!1)}}}async function w(c,y){if(!(!e(r)||e(W))){_(W,!0);try{await Gt(e(r).id,y,60,c),_(h,await Tt(e(r).id),!0)}catch(L){console.error("Failed to set override:",L)}finally{_(W,!1)}}}async function d(){if(!(!e(r)||e(W))){_(W,!0);try{e(r).heater_entity_id&&await Gt(e(r).id,null,60,"heater"),e(r).cooler_entity_id&&await Gt(e(r).id,null,60,"cooler"),_(h,await Tt(e(r).id),!0)}catch(c){console.error("Failed to clear overrides:",c)}finally{_(W,!1)}}}function p(){if(m?.readyState===WebSocket.OPEN)return;const y=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;m=new WebSocket(y),m.onmessage=async L=>{try{const O=JSON.parse(L.data);O.type==="control_event"&&O.batch_id===e(I)&&e(h)&&(O.action==="heat_on"?_(h,{...e(h),heater_state:"on"},!0):O.action==="heat_off"?_(h,{...e(h),heater_state:"off"},!0):O.action==="cool_on"?_(h,{...e(h),cooler_state:"on"},!0):O.action==="cool_off"&&_(h,{...e(h),cooler_state:"off"},!0))}catch{}},m.onclose=()=>{m=null,N=setTimeout(p,3e3)},m.onerror=()=>{m?.close()}}function z(){N&&(clearTimeout(N),N=null),m?.close(),m=null}function F(c){return c==null?"--":da(c)}function H(c){return c?new Date(c).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"--"}function Q(c){if(!c)return"--";const y=new Date(c),O=(new Date().getTime()-y.getTime())/(1e3*60*60);if(O<1)return`${Math.round(O*60)}m`;if(O<24)return`${O.toFixed(1)}h`;const ze=O/24;return ze<7?`${ze.toFixed(1)}d`:`${Math.round(ze)}d`}oa(()=>{ie(),p()}),Ma(()=>{z()});var $=Hr();Ta("g5au2j",c=>{Sa(()=>{Ba.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var Re=G($),ce=s(a(Re),2);{var _e=c=>{var y=ir();l(c,y)},ge=c=>{var y=je(),L=G(y);{var O=Be=>{var ee=vr(),ne=s(a(ee),2),we=a(ne,!0);t(ne);var pe=s(ne,2);pe.__click=ie,t(ee),u(()=>o(we,e(oe))),l(Be,ee)},ze=Be=>{var ee=je(),ne=G(ee);{var we=Ze=>{var rt=or();l(Ze,rt)},pe=Ze=>{var rt=je(),Ct=G(rt);{var M=q=>{Ya(q,{get batch(){return e(r)},onSubmit:le,onCancel:()=>_(T,!1)})},C=q=>{var be=Ur(),qe=G(be),Ge=a(qe),We=a(Ge),Ne=a(We);t(We);var Ue=s(We,2),lt=a(Ue),ut=a(lt,!0);t(lt);var bt=s(lt,2);{var $e=f=>{var x=cr(),X=a(x),ve=s(X);{var ye=Me=>{var Fe=dr(),Pe=a(Fe);t(Fe),u(()=>o(Pe,`(${e(r).recipe.type??""})`)),l(Me,Fe)};v(ve,Me=>{e(r).recipe.type&&Me(ye)})}t(x),u(()=>{st(x,"href",`/recipes/${e(r).recipe.id??""}`),o(X,`${e(r).recipe.name??""} `)}),l(f,x)};v(bt,f=>{e(r).recipe&&f($e)})}var _t=s(bt,2);{var et=f=>{var x=ur(),X=a(x);t(x),u((ve,ye)=>o(X,`Started ${ve??""} ¬∑ ${ye??""} ago`),[()=>H(e(r).start_time),()=>Q(e(r).start_time)]),l(f,x)},nt=f=>{var x=je(),X=G(x);{var ve=ye=>{var Me=_r(),Fe=a(Me);t(Me),u(Pe=>o(Fe,`Brewed ${Pe??""}`),[()=>H(e(r).brew_date)]),l(ye,Me)};v(X,ye=>{e(r).brew_date&&ye(ve)},!0)}l(f,x)};v(_t,f=>{e(r).start_time?f(et):f(nt,!1)})}t(Ue),t(Ge);var yt=s(Ge,2),Pt=a(yt),tt=a(Pt);tt.__change=f=>Y(f.currentTarget.value),At(tt,21,()=>j,Ht,(f,x)=>{var X=gr(),ve=a(X,!0);t(X);var ye={};u(()=>{o(ve,Nt[e(x)].label),ye!==(ye=e(x))&&(X.value=(X.__value=e(x))??"")}),l(f,X)}),t(tt);var Vt;Aa(tt),t(Pt);var Wt=s(Pt,2);{var _a=f=>{var x=mr();let X;x.__click=Ce;var ve=a(x);{var ye=Fe=>{var Pe=pr();Ae(),l(Fe,Pe)},Me=Fe=>{var Pe=fr();Ae(),l(Fe,Pe)};v(ve,Fe=>{e(r).readings_paused?Fe(ye):Fe(Me,!1)})}t(x),u(()=>{X=Ve(x,1,"pause-btn svelte-g5au2j",null,X,{paused:e(r).readings_paused}),x.disabled=e(U),st(x,"title",e(r).readings_paused?"Resume storing readings":"Pause storing readings")}),l(f,x)};v(Wt,f=>{(e(r).status==="fermenting"||e(r).status==="conditioning")&&f(_a)})}var Jt=s(Wt,2);Jt.__click=()=>_(T,!0);var ga=s(Jt,2);ga.__click=()=>_(te,!0),t(yt),t(qe);var Yt=s(qe,2);{var pa=f=>{var x=zr();let X;var ve=a(x),ye=a(ve);{var Me=E=>{var K=hr();Ae(2),l(E,K)},Fe=E=>{var K=br();Ae(2),l(E,K)};v(ye,E=>{e(R)?E(Me):E(Fe,!1)})}t(ve);var Pe=s(ve,2),gt=a(Pe),it=a(gt),xt=s(a(it),2),Je=a(xt,!0);t(xt),t(it);var xe=s(it,4),Le=s(a(xe),2),pt=a(Le,!0);t(Le),t(xe),t(gt);var ft=s(gt,2);{var Rt=E=>{var K=yr(),Te=a(K),Oe=a(Te);t(Te);var Ie=s(Te,2),ke=a(Ie);t(Ie),t(K),u(Ee=>{Ke(Oe,`width: ${e(se)??""}%`),o(ke,`${Ee??""}% to target`)},[()=>Math.round(e(se))]),l(E,K)};v(ft,E=>{e(se)!=null&&!e(R)&&E(Rt)})}var Ye=s(ft,2),vt=a(Ye);{var qt=E=>{var K=xr();l(E,K)},Mt=E=>{var K=je(),Te=G(K);{var Oe=ke=>{var Ee=jr();l(ke,Ee)},Ie=ke=>{var Ee=je(),ot=G(Ee);{var at=ct=>{var jt=wr();l(ct,jt)},dt=ct=>{var jt=kr();l(ct,jt)};v(ot,ct=>{e(R)?ct(at):ct(dt,!1)},!0)}l(ke,Ee)};v(Te,ke=>{!Dt.config.ha_enabled||!Dt.config.temp_control_enabled?ke(Oe):ke(Ie,!1)},!0)}l(E,K)};v(vt,E=>{e(r).cooler_entity_id?E(Mt,!1):E(qt)})}t(Ye),t(Pe),t(x),u((E,K)=>{X=Ve(x,1,"chilling-banner svelte-g5au2j",null,X,{ready:e(R)}),o(Je,E),o(pt,K)},[()=>e(P)?.temp!=null?F(e(P).temp):"--",()=>e(r).temp_target!=null?F(e(r).temp_target):"--"]),l(f,x)};v(Yt,f=>{e(g)&&f(pa)})}var Qt=s(Yt,2);{var fa=f=>{var x=Fr(),X=s(a(x),4);X.__click=Ce;var ve=a(X,!0);t(X),t(x),u(()=>{X.disabled=e(U),o(ve,e(U)?"Resuming...":"Resume Readings")}),l(f,x)};v(Qt,f=>{e(r).readings_paused&&(e(r).status==="fermenting"||e(r).status==="conditioning")&&f(fa)})}var Ot=s(Qt,2),Et=a(Ot),Xt=a(Et);{let f=B(()=>e(P)?.sg??e(V)?.measured?.current_sg);cs(Xt,{get batch(){return e(r)},get currentSg(){return e(f)},get progress(){return e(V)},get liveReading(){return e(P)}})}var ma=s(Xt,2);{var ha=f=>{Ss(f,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(ma,f=>{e(r).recipe&&f(ha)})}t(Et);var Kt=s(Et,2),Zt=a(Kt);js(Zt,{get batch(){return e(r)},get liveReading(){return e(P)},onEdit:()=>_(T,!0)});var $t=s(Zt,2);{var ba=f=>{nr(f,{get batchId(){return e(r).id}})};v($t,f=>{(e(r).status==="fermenting"||e(r).status==="conditioning")&&f(ba)})}var ea=s($t,2);{let f=B(()=>e(P)?.sg);Zs(ea,{get batchId(){return e(r).id},get measuredOg(){return e(r).measured_og},get currentSg(){return e(f)},get liveReading(){return e(P)}})}var ta=s(ea,2);{var ya=f=>{var x=Or();let X;var ve=a(x);ve.__click=()=>_(A,!e(A));var ye=s(a(ve),2),Me=a(ye);{var Fe=xe=>{var Le=Cr();l(xe,Le)},Pe=xe=>{var Le=je(),pt=G(Le);{var ft=Ye=>{var vt=Rr();l(Ye,vt)},Rt=Ye=>{var vt=je(),qt=G(vt);{var Mt=E=>{var K=qr(),Te=a(K);t(K),u(Oe=>o(Te,`üéØ ${Oe??""}${e(ae)??""}`),[()=>F(e(h).target_temp)]),l(E,K)};v(qt,E=>{e(A)&&e(h)&&E(Mt)},!0)}l(Ye,vt)};v(pt,Ye=>{e(h)?.cooler_state==="on"?Ye(ft):Ye(Rt,!1)},!0)}l(xe,Le)};v(Me,xe=>{e(h)?.heater_state==="on"?xe(Fe):xe(Pe,!1)})}var gt=s(Me,2);let it;t(ye),t(ve);var xt=s(ve,2);{var Je=xe=>{var Le=Pr(),pt=G(Le),ft=a(pt);{var Rt=E=>{var K=Mr(),Te=a(K);let Oe;var Ie=s(Te,2),ke=s(a(Ie),2);let Ee;var ot=a(ke,!0);t(ke);var at=s(ke,2),dt=a(at,!0);t(at),t(Ie),t(K),u(()=>{Oe=Ve(Te,1,"device-icon-wrap svelte-g5au2j",null,Oe,{active:e(h)?.heater_state==="on"}),Ee=Ve(ke,1,"device-state svelte-g5au2j",null,Ee,{on:e(h)?.heater_state==="on"}),o(ot,e(h)?.heater_state==="on"?"ON":"OFF"),o(dt,e(r).heater_entity_id)}),l(E,K)};v(ft,E=>{e(r).heater_entity_id&&E(Rt)})}var Ye=s(ft,2);{var vt=E=>{var K=Sr(),Te=a(K);let Oe;var Ie=s(Te,2),ke=s(a(Ie),2);let Ee;var ot=a(ke,!0);t(ke);var at=s(ke,2),dt=a(at,!0);t(at),t(Ie),t(K),u(()=>{Oe=Ve(Te,1,"device-icon-wrap svelte-g5au2j",null,Oe,{active:e(h)?.cooler_state==="on"}),Ee=Ve(ke,1,"device-state svelte-g5au2j",null,Ee,{on:e(h)?.cooler_state==="on"}),o(ot,e(h)?.cooler_state==="on"?"ON":"OFF"),o(dt,e(r).cooler_entity_id)}),l(E,K)};v(Ye,E=>{e(r).cooler_entity_id&&E(vt)})}t(pt);var qt=s(pt,2);{var Mt=E=>{var K=Ar(),Te=G(K),Oe=a(Te),Ie=s(a(Oe),2),ke=a(Ie);t(Ie),t(Oe);var Ee=s(Oe,2),ot=s(a(Ee),2),at=a(ot);t(ot),t(Ee),t(Te);var dt=s(Te,2);{var ct=He=>{var Qe=Br(),Xe=s(a(Qe),2),mt=a(Xe);t(Xe);var na=s(Xe,2);na.__click=()=>d(),t(Qe),u(Ra=>{o(mt,`Override active: ${Ra??""}`),na.disabled=e(W)},[()=>e(h).override_state?.toUpperCase()]),l(He,Qe)};v(dt,He=>{e(h).override_active&&He(ct)})}var jt=s(dt,2),aa=s(a(jt),2),sa=a(aa);{var Fa=He=>{var Qe=Tr(),Xe=G(Qe);Xe.__click=()=>w("heater","on");var mt=s(Xe,2);mt.__click=()=>w("heater","off"),u(()=>{Xe.disabled=e(W),mt.disabled=e(W)}),l(He,Qe)};v(sa,He=>{e(r).heater_entity_id&&He(Fa)})}var ra=s(sa,2);{var Ca=He=>{var Qe=Dr(),Xe=G(Qe);Xe.__click=()=>w("cooler","on");var mt=s(Xe,2);mt.__click=()=>w("cooler","off"),u(()=>{Xe.disabled=e(W),mt.disabled=e(W)}),l(He,Qe)};v(ra,He=>{e(r).cooler_entity_id&&He(Ca)})}var la=s(ra,2);la.__click=()=>d(),t(aa),t(jt),u((He,Qe)=>{o(ke,`${He??""}${e(ae)??""}`),o(at,`¬±${Qe??""}${e(ae)??""}`),la.disabled=e(W)},[()=>F(e(h).target_temp),()=>e(h).hysteresis?.toFixed(1)||"--"]),l(E,K)};v(qt,E=>{e(h)&&E(Mt)})}l(xe,Le)};v(xt,xe=>{e(A)||xe(Je)})}t(x),u(()=>{X=Ve(x,1,"info-card temp-control-card svelte-g5au2j",null,X,{"heater-on":e(h)?.heater_state==="on","cooler-on":e(h)?.cooler_state==="on",collapsed:e(A)}),it=Ve(gt,0,"chevron svelte-g5au2j",null,it,{rotated:!e(A)})}),l(f,x)},xa=f=>{var x=je(),X=G(x);{var ve=ye=>{var Me=Gr(),Fe=s(a(Me),2),Pe=a(Fe);{var gt=Je=>{var xe=Er(),Le=a(xe);t(xe),u(()=>o(Le,`Heater: ${e(r).heater_entity_id??""}`)),l(Je,xe)};v(Pe,Je=>{e(r).heater_entity_id&&Je(gt)})}var it=s(Pe,2);{var xt=Je=>{var xe=Lr(),Le=a(xe);t(xe),u(()=>o(Le,`Cooler: ${e(r).cooler_entity_id??""}`)),l(Je,xe)};v(it,Je=>{e(r).cooler_entity_id&&Je(xt)})}Ae(2),t(Fe),t(Me),l(ye,Me)};v(X,ye=>{(e(r).heater_entity_id||e(r).cooler_entity_id)&&e(r).status!=="fermenting"&&ye(ve)},!0)}l(f,x)};v(ta,f=>{e(J)&&(e(r).status==="fermenting"||e(r).status==="conditioning")?f(ya):f(xa,!1)})}var ja=s(ta,2);{var wa=f=>{Ts(f,{get notes(){return e(r).notes}})};v(ja,f=>{e(r).notes&&f(wa)})}t(Kt),t(Ot);var ka=s(Ot,2);{var za=f=>{var x=Nr(),X=a(x);{let ve=B(()=>e(r).device_id||"historical");Xa(X,{get batchId(){return e(r).id},get deviceColor(){return e(ve)},get originalGravity(){return e(r).measured_og},get controlEvents(){return re}})}t(x),l(f,x)};v(ka,f=>{(e(r).device_id||e(r).status==="completed"||e(r).status==="archived")&&f(za)})}u(()=>{o(Ne,`#${(e(r).batch_number||"?")??""}`),o(ut,e(r).name||e(r).recipe?.name||"Unnamed Batch"),tt.disabled=e(de),Ke(tt,`color: ${e(k).color??""}; background: ${e(k).bg??""};`),Vt!==(Vt=e(r).status)&&(tt.value=(tt.__value=e(r).status)??"",Pa(tt,e(r).status))}),l(q,be)};v(Ct,q=>{e(T)?q(M):q(C,!1)},!0)}l(Ze,rt)};v(ne,Ze=>{e(r)?Ze(pe,!1):Ze(we)},!0)}l(Be,ee)};v(L,Be=>{e(oe)?Be(O):Be(ze,!1)},!0)}l(c,y)};v(ce,c=>{e(ue)?c(_e):c(ge,!1)})}t(Re);var Se=s(Re,2);{var De=c=>{var y=Ir();y.__click=()=>_(te,!1),y.__keydown=pe=>pe.key==="Escape"&&_(te,!1);var L=a(y);L.__click=pe=>pe.stopPropagation(),L.__keydown=pe=>pe.stopPropagation();var O=s(a(L),2),ze=a(O);t(O);var Be=s(O,2),ee=a(Be);ee.__click=()=>_(te,!1);var ne=s(ee,2);ne.__click=he;var we=a(ne,!0);t(ne),t(Be),t(L),t(y),u(()=>{o(ze,`Are you sure you want to delete "${(e(r)?.name||"this batch")??""}"? This cannot be undone.`),ee.disabled=e(b),ne.disabled=e(b),o(we,e(b)?"Deleting...":"Delete Batch")}),l(c,y)};v(Se,c=>{e(te)&&c(De)})}l(me,$),Ft(),D()}Bt(["click","change","keydown"]);export{ul as component,cl as universal};
