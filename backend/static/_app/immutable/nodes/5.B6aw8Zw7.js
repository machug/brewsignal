import{d as Ft,f as i,s as o,a as n,c as me,t as pt}from"../chunks/CJmjvTrd.js";import{d as a,g as s,j as t,t as u,a as jt,f as D,i as e,l as S,n as Te,h as wt,s as Se,p as Xt,o as Zt,c as p,aJ as xa,ay as ya,at as ja}from"../chunks/Bt34JHv5.js";import{e as Qt,i as $t}from"../chunks/BdS3W2cr.js";import{i as v}from"../chunks/DMJnaEfo.js";import{h as wa}from"../chunks/BiFc9prw.js";import{s as ft}from"../chunks/DPFjJc-R.js";import{s as Ne}from"../chunks/F_XGNgUc.js";import{s as $e}from"../chunks/DyZ30OTe.js";import{i as ka,s as za}from"../chunks/DE7lyrTW.js";import{s as Fa,a as Ca}from"../chunks/iuesrop3.js";import{p as Ra}from"../chunks/B9tAYugQ.js";import{g as qa}from"../chunks/7_qNd-gx.js";import{X as Sa,Y as Ba,P as Ma,I as Yt,Z as kt,K as Ta,N as Jt,_ as Bt}from"../chunks/CnrOGk3n.js";import{d as yt,e as ea,g as ta,c as zt}from"../chunks/i5gcUk_J.js";import{t as Kt}from"../chunks/D44OciwZ.js";import{B as Da}from"../chunks/CGwGP-DG.js";import{s as Pa}from"../chunks/BatM6XTu.js";import{p as ut}from"../chunks/sjQSfnnq.js";import{F as Oa}from"../chunks/DiOUsu4c.js";const Aa=!1,Or=Object.freeze(Object.defineProperty({__proto__:null,prerender:Aa},Symbol.toStringTag,{value:"Module"}));function Ea(_e){return _e>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:_e>=-60?{bars:3,color:"var(--positive)",label:"Good"}:_e>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function aa(_e){const l=Math.floor((Date.now()-new Date(_e).getTime())/1e3);if(l<10)return"just now";if(l<60)return`${l}s ago`;const N=Math.floor(l/60);if(N<60)return`${N}m ago`;const X=Math.floor(N/60);return X<24?`${X}h ago`:`${Math.floor(X/24)}d ago`}var Ga=i('<div class="accent-bar svelte-1oyrwd9"></div>'),Na=i('<span class="card-icon svelte-1oyrwd9"> </span>'),La=i('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),Ua=i('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function Ct(_e,l){let N=ut(l,"highlight",3,!1),X=ut(l,"compact",3,!1),L=ut(l,"collapsible",3,!1),m=ut(l,"expanded",3,!1);var U=Ua();let r;var A=a(U);{var h=C=>{var d=Ga();n(C,d)};v(A,C=>{N()&&C(h)})}var Z=s(A,2),ge=a(Z),he=a(ge);{var F=C=>{var d=Na(),y=a(d,!0);t(d),u(()=>o(y,l.icon)),n(C,d)};v(he,C=>{l.icon&&C(F)})}var ee=s(he,2),B=a(ee,!0);t(ee),t(ge);var $=s(ge,2);{var te=C=>{var d=La();d.__click=function(...E){l.onToggle?.apply(this,E)};var y=a(d);let j;t(d),u(()=>{ft(d,"aria-label",m()?"Collapse":"Expand"),j=Ne(y,0,"expand-icon svelte-1oyrwd9",null,j,{"rotate-180":m()})}),n(C,d)};v($,C=>{L()&&l.onToggle&&C(te)})}t(Z);var ie=s(Z,2);let H;var W=a(ie);Pa(W,()=>l.children),t(ie),t(U),u(()=>{r=Ne(U,1,"batch-card svelte-1oyrwd9",null,r,{highlight:N(),compact:X()}),o(B,l.title),H=Ne(ie,1,"card-content svelte-1oyrwd9",null,H,{collapsed:L()&&!m()})}),n(_e,U)}Ft(["click"]);var Ia=i('<span class="updated-text svelte-t80j9z"> </span>'),Va=i('<div class="hero-divider svelte-t80j9z"></div> <div class="hero-metric temperature svelte-t80j9z"><span class="hero-value svelte-t80j9z"> <span class="hero-unit svelte-t80j9z"> </span></span> <span class="hero-label svelte-t80j9z">Temperature</span></div>',1),Ha=i('<div class="remaining-text svelte-t80j9z"> </div>'),Wa=i('<div class="progress-section svelte-t80j9z"><div class="progress-labels svelte-t80j9z"><div class="progress-endpoint start svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">OG</span></div> <div class="progress-current svelte-t80j9z"><span class="current-percent svelte-t80j9z"> </span></div> <div class="progress-endpoint end svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">Target FG</span></div></div> <div class="progress-track svelte-t80j9z"><div class="progress-fill svelte-t80j9z"></div> <div><div class="marker-dot svelte-t80j9z"></div> <div class="marker-value svelte-t80j9z"> </div></div></div> <!></div>'),Ya=i('<div class="metrics-row svelte-t80j9z"><div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">ABV</span></div> <div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">Attenuation</span></div></div>'),Ja=i('<div class="status-row svelte-t80j9z"><div class="live-indicator svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> <span class="status-text svelte-t80j9z">LIVE</span></div> <!></div> <div class="hero-section svelte-t80j9z"><div class="hero-metric gravity svelte-t80j9z"><span class="hero-value svelte-t80j9z"> </span> <span class="hero-label svelte-t80j9z">Gravity</span></div> <!></div> <!> <!>',1),Ka=i('<div class="completed-grid svelte-t80j9z"><div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Original Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Final Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">ABV</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Attenuation</span></div></div>'),Xa=i('<div class="empty-state svelte-t80j9z"><div class="empty-icon svelte-t80j9z">‚óé</div> <p class="empty-text svelte-t80j9z">Set Original Gravity to track fermentation</p></div>');function Za(_e,l){jt(l,!0);let N=S(()=>l.currentSg??l.progress?.measured?.current_sg),X=S(()=>l.liveReading?.temp??l.progress?.temperature?.current),L=S(()=>l.liveReading?.last_seen),m=S(()=>e(L)?aa(e(L)):null),U=S(ta),r=S(()=>{if(!l.batch.measured_og||!e(N))return null;const F=Math.max(0,(l.batch.measured_og-e(N))*131.25),ee=l.batch.measured_og-1,B=ee!==0?Math.max(0,Math.min(100,(l.batch.measured_og-e(N))/ee*100)):0;return{abv:F,attenuation:B}}),A=S(()=>{const F=l.batch.measured_og,ee=l.batch.recipe?.fg;if(!F||!ee||!e(N))return null;const B=F-ee,$=F-e(N);return B<=0?null:Math.max(0,Math.min(100,$/B*100))}),h=S(()=>l.batch.status==="fermenting"||l.batch.status==="conditioning");function Z(F){return F==null?"--":yt(F)}function ge(F){return F==null?"--":`${F.toFixed(1)}%`}function he(F){return F==null?"--":ea(F)}Ct(_e,{title:"Fermentation",children:(F,ee)=>{var B=me(),$=D(B);{var te=H=>{var W=Ja(),C=D(W),d=s(a(C),2);{var y=q=>{var f=Ia(),_=a(f);t(f),u(()=>o(_,`Updated ${e(m)??""}`)),n(q,f)};v(d,q=>{e(m)&&q(y)})}t(C);var j=s(C,2),E=a(j),ae=a(E),Y=a(ae,!0);t(ae),Te(2),t(E);var P=s(E,2);{var se=q=>{var f=Va(),_=s(D(f),2),k=a(_),O=a(k,!0),J=s(O),le=a(J,!0);t(J),t(k),Te(2),t(_),u(I=>{o(O,I),o(le,e(U))},[()=>he(e(X))]),n(q,f)};v(P,q=>{e(X)!=null&&q(se)})}t(j);var Q=s(j,2);{var pe=q=>{var f=Wa(),_=a(f),k=a(_),O=a(k),J=a(O,!0);t(O),Te(2),t(k);var le=s(k,2),I=a(le),ke=a(I);t(I),t(le);var xe=s(le,2),De=a(xe),Ce=a(De,!0);t(De),Te(2),t(xe),t(_);var de=s(_,2),c=a(de),w=s(c,2);let V;var z=s(a(w),2),ce=a(z,!0);t(z),t(w),t(de);var ye=s(de,2);{var Be=g=>{var b=Ha(),M=a(b);t(b),u(K=>o(M,`${K??""} points to go`),[()=>l.progress.progress.sg_remaining.toFixed(3)]),n(g,b)};v(ye,g=>{l.progress?.progress?.sg_remaining!=null&&l.progress.progress.sg_remaining>0&&g(Be)})}t(f),u((g,b,M,K)=>{o(J,g),o(ke,`${b??""}%`),o(Ce,M),$e(c,`width: ${e(A)??""}%`),V=Ne(w,1,"progress-marker svelte-t80j9z",null,V,{"at-start":e(A)<3}),$e(w,`left: ${e(A)??""}%`),o(ce,K)},[()=>Z(l.batch.measured_og),()=>e(A).toFixed(0),()=>Z(l.batch.recipe.fg),()=>Z(e(N))]),n(q,f)};v(Q,q=>{e(A)!==null&&l.batch.measured_og&&l.batch.recipe?.fg&&q(pe)})}var ve=s(Q,2);{var re=q=>{var f=Ya(),_=a(f),k=a(_),O=a(k,!0);t(k),Te(2),t(_);var J=s(_,2),le=a(J),I=a(le,!0);t(le),Te(2),t(J),t(f),u((ke,xe)=>{o(O,ke),o(I,xe)},[()=>ge(e(r).abv),()=>ge(e(r).attenuation)]),n(q,f)};v(ve,q=>{e(r)&&q(re)})}u(q=>o(Y,q),[()=>Z(e(N))]),n(H,W)},ie=H=>{var W=me(),C=D(W);{var d=j=>{var E=Ka(),ae=a(E),Y=a(ae),P=a(Y,!0);t(Y),Te(2),t(ae);var se=s(ae,2),Q=a(se),pe=a(Q,!0);t(Q),Te(2),t(se);var ve=s(se,2),re=a(ve),q=a(re,!0);t(re),Te(2),t(ve);var f=s(ve,2),_=a(f),k=a(_,!0);t(_),Te(2),t(f),t(E),u((O,J,le,I)=>{o(P,O),o(pe,J),o(q,le),o(k,I)},[()=>Z(l.batch.measured_og),()=>Z(l.batch.measured_fg),()=>l.batch.measured_abv!=null?ge(l.batch.measured_abv):"--",()=>l.batch.measured_attenuation!=null?ge(l.batch.measured_attenuation):"--"]),n(j,E)},y=j=>{var E=Xa();n(j,E)};v(C,j=>{l.batch.measured_og?j(d):j(y,!1)},!0)}n(H,W)};v($,H=>{e(N)&&e(h)?H(te):H(ie,!1)})}n(F,B)},$$slots:{default:!0}}),wt()}var Qa=i('<span class="device-last-seen svelte-1kdxwtz"> </span>'),$a=i('<div class="signal-bar svelte-1kdxwtz"></div>'),es=i('<div class="metric-item svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="metric-text svelte-1kdxwtz"> </span></div>'),ts=i('<div class="metric-item battery svelte-1kdxwtz"><svg class="battery-icon svelte-1kdxwtz" viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="2" y="7" width="18" height="10" rx="2"></rect><rect x="4" y="9" height="6" stroke="none" rx="1"></rect><path d="M20 10v4h2v-4z" stroke="none"></path></svg> <span class="metric-text svelte-1kdxwtz"><!></span></div>'),as=i('<div class="device-metrics svelte-1kdxwtz"><!> <!></div>'),ss=i('<div class="device-row svelte-1kdxwtz"><div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!></div> <!>',1),rs=i('<div class="device-row svelte-1kdxwtz"><div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <span class="device-last-seen svelte-1kdxwtz">No data</span></div>'),ls=i('<div class="device-info svelte-1kdxwtz"><!></div>'),ns=i('<button type="button" class="link-btn svelte-1kdxwtz">Link device</button>'),is=i('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function vs(_e,l){jt(l,!0);let N=S(()=>l.liveReading?.device_type==="tilt"),X=S(()=>e(N)&&l.liveReading?.rssi?Ea(l.liveReading.rssi):null),L=S(()=>l.liveReading?.last_seen?aa(l.liveReading.last_seen):null),m=S(()=>l.liveReading?.battery_percent!=null||l.liveReading?.battery_voltage!=null),U=S(()=>l.liveReading?.battery_percent),r=S(()=>l.liveReading?.battery_voltage),A=S(()=>e(U)?e(U)>50?"var(--positive)":e(U)>20?"#f59e0b":"var(--negative)":"var(--text-muted)"),h=S(()=>{if(!l.liveReading)return l.batch.device_id||"Unknown";const Z=l.liveReading.device_type;return Z==="tilt"?`${l.liveReading.color} Tilt`:Z==="gravitymon"?`GravityMon (${l.liveReading.id})`:Z==="ispindel"?`iSpindel (${l.liveReading.id})`:Z==="floaty"?`Floaty (${l.liveReading.id})`:l.liveReading.color||l.liveReading.id});Ct(_e,{title:"Tracking Device",compact:!0,children:(Z,ge)=>{var he=me(),F=D(he);{var ee=$=>{var te=ls(),ie=a(te);{var H=C=>{var d=ss(),y=D(d),j=a(y),E=s(a(j));t(j);var ae=s(j,2);{var Y=Q=>{var pe=Qa(),ve=a(pe,!0);t(pe),u(()=>o(ve,e(L))),n(Q,pe)};v(ae,Q=>{e(L)&&Q(Y)})}t(y);var P=s(y,2);{var se=Q=>{var pe=as(),ve=a(pe);{var re=_=>{var k=es(),O=a(k);Qt(O,20,()=>Array(4),$t,(I,ke,xe)=>{var De=$a();u(()=>$e(De,`height: ${4+xe*2}px; background: ${(xe<e(X).bars?e(X).color:"var(--bg-hover)")??""}; opacity: ${xe<e(X).bars?1:.4};`)),n(I,De)}),t(O);var J=s(O,2),le=a(J);t(J),t(k),u(()=>{$e(J,`color: ${e(X).color??""}`),o(le,`${l.liveReading.rssi??""}dBm`)}),n(_,k)};v(ve,_=>{e(X)&&_(re)})}var q=s(ve,2);{var f=_=>{var k=ts(),O=a(k),J=s(a(O)),le=s(J);t(O);var I=s(O,2),ke=a(I);{var xe=Ce=>{var de=pt();u(c=>o(de,`${c??""}%`),[()=>e(U).toFixed(0)]),n(Ce,de)},De=Ce=>{var de=me(),c=D(de);{var w=V=>{var z=pt();u(ce=>o(z,`${ce??""}V`),[()=>e(r).toFixed(2)]),n(V,z)};v(c,V=>{e(r)!=null&&V(w)},!0)}n(Ce,de)};v(ke,Ce=>{e(U)!=null?Ce(xe):Ce(De,!1)})}t(I),t(k),u(()=>{ft(O,"stroke",e(A)),ft(J,"width",(e(U)??50)*.14),ft(J,"fill",e(A)),ft(le,"fill",e(A)),$e(I,`color: ${e(A)??""}`)}),n(_,k)};v(q,_=>{e(m)&&_(f)})}t(pe),n(Q,pe)};v(P,Q=>{(e(X)||e(m))&&Q(se)})}u(()=>o(E,` ${e(h)??""}`)),n(C,d)},W=C=>{var d=rs(),y=a(d),j=s(a(y));t(y),Te(2),t(d),u(()=>o(j,` ${l.batch.device_id??""}`)),n(C,d)};v(ie,C=>{l.liveReading?C(H):C(W,!1)})}t(te),n($,te)},B=$=>{var te=is(),ie=s(a(te),2);{var H=W=>{var C=ns();C.__click=function(...d){l.onEdit?.apply(this,d)},n(W,C)};v(ie,W=>{l.onEdit&&W(H)})}t(te),n($,te)};v(F,$=>{l.batch.device_id?$(ee):$(B,!1)})}n(Z,he)},$$slots:{default:!0}}),wt()}Ft(["click"]);const os=131.25;var ds=i('<span class="yeast-producer svelte-19u9n31"> </span>'),cs=i('<span class="yeast-temp svelte-19u9n31"> </span>'),us=i('<div class="yeast-row recipe svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Recipe</span> <span class="yeast-value muted svelte-19u9n31"> </span></div>'),_s=i('<div class="yeast-row actual svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span> <!> <!></div> <!>',1),gs=i('<div class="yeast-row svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span></div>'),ps=i('<div class="yeast-section svelte-19u9n31"><!></div>'),fs=i('<div class="targets-row svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div></div> <!>',1);function ms(_e,l){jt(l,!0);function N(L){return L==null?"--":yt(L)}let X=S(()=>l.recipe.abv!=null?l.recipe.abv:l.recipe.og&&l.recipe.fg?(l.recipe.og-l.recipe.fg)*os:null);Ct(_e,{title:"Recipe Targets",compact:!0,children:(L,m)=>{var U=fs(),r=D(U),A=a(r),h=s(a(A),2),Z=a(h,!0);t(h),t(A);var ge=s(A,2),he=s(a(ge),2),F=a(he,!0);t(he),t(ge);var ee=s(ge,2),B=s(a(ee),2),$=a(B,!0);t(B),t(ee),t(r);var te=s(r,2);{var ie=H=>{var W=ps(),C=a(W);{var d=j=>{var E=_s(),ae=D(E),Y=s(a(ae),2),P=a(Y,!0);t(Y);var se=s(Y,2);{var Q=f=>{var _=ds(),k=a(_);t(_),u(()=>o(k,`(${l.yeastStrain.producer??""})`)),n(f,_)};v(se,f=>{l.yeastStrain.producer&&f(Q)})}var pe=s(se,2);{var ve=f=>{var _=cs(),k=a(_);t(_),u((O,J)=>o(k,`${O??""}-${J??""}¬∞C`),[()=>l.yeastStrain.temp_low.toFixed(0),()=>l.yeastStrain.temp_high.toFixed(0)]),n(f,_)};v(pe,f=>{l.yeastStrain.temp_low&&l.yeastStrain.temp_high&&f(ve)})}t(ae);var re=s(ae,2);{var q=f=>{var _=us(),k=s(a(_),2),O=a(k,!0);t(k),t(_),u(()=>o(O,l.recipe.yeast_name)),n(f,_)};v(re,f=>{l.recipe.yeast_name&&f(q)})}u(()=>o(P,l.yeastStrain.name)),n(j,E)},y=j=>{var E=me(),ae=D(E);{var Y=P=>{var se=gs(),Q=s(a(se),2),pe=a(Q,!0);t(Q),t(se),u(()=>o(pe,l.recipe.yeast_name)),n(P,se)};v(ae,P=>{l.recipe.yeast_name&&P(Y)},!0)}n(j,E)};v(C,j=>{l.yeastStrain?j(d):j(y,!1)})}t(W),n(H,W)};v(te,H=>{(l.yeastStrain||l.recipe.yeast_name)&&H(ie)})}u((H,W,C)=>{o(Z,H),o(F,W),o($,C)},[()=>N(l.recipe.og),()=>N(l.recipe.fg),()=>e(X)!=null?`${e(X).toFixed(1)}%`:"--"]),n(L,U)},$$slots:{default:!0}}),wt()}var hs=i('<p class="notes-content svelte-hkv31i"> </p>');function bs(_e,l){Ct(_e,{title:"Notes",children:(N,X)=>{var L=hs(),m=a(L,!0);t(L),u(()=>o(m,l.notes)),n(N,L)},$$slots:{default:!0}})}var xs=i('<div class="ml-panel loading svelte-1xs394q"><p>Loading predictions...</p></div>'),ys=i('<div class="ml-panel error svelte-1xs394q"><p class="error-text svelte-1xs394q"> </p></div>'),js=i('<span class="anomaly-reasons svelte-1xs394q"> </span>'),ws=i('<div class="anomaly-banner svelte-1xs394q"><span class="anomaly-icon svelte-1xs394q">‚ö†Ô∏è</span> <div class="anomaly-content svelte-1xs394q"><span class="anomaly-label svelte-1xs394q">Anomaly Detected</span> <!></div></div>'),ks=i('<span class="activity-badge svelte-1xs394q"> </span>'),zs=i('<div class="progress-section svelte-1xs394q"><div class="progress-header svelte-1xs394q"><span class="progress-label svelte-1xs394q">Fermentation Progress</span> <!></div> <div class="fermentation-progress-bar svelte-1xs394q"><div class="fermentation-fill svelte-1xs394q"></div></div> <div class="progress-labels svelte-1xs394q"><span class="og-label svelte-1xs394q"> </span> <span class="progress-percent svelte-1xs394q"> </span> <span class="fg-label svelte-1xs394q"> </span></div></div>'),Fs=i('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Predicted FG:</span> <span class="value svelte-1xs394q"> </span></div>'),Cs=i('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Attenuation:</span> <span class="value attenuation svelte-1xs394q"> </span></div>'),Rs=i('<span class="complete-now svelte-1xs394q">Ready now!</span>'),qs=i('<span class="days svelte-1xs394q"> </span>'),Ss=i(" <!>",1),Bs=i('<div class="metric completion-metric svelte-1xs394q"><span class="label svelte-1xs394q">Est. Completion:</span> <span class="value svelte-1xs394q"><!></span></div>'),Ms=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),Ts=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Data points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),Ds=i('<div><div class="panel-header svelte-1xs394q"><h3 class="panel-title svelte-1xs394q">Fermentation Intelligence</h3> <button type="button" class="reload-btn svelte-1xs394q" title="Recalculate predictions from database history"> </button></div> <!> <!> <div class="metrics svelte-1xs394q"><!> <!> <!> <div class="model-info svelte-1xs394q"><!> <!></div></div></div>'),Ps=i('<div class="ml-panel disabled svelte-1xs394q"><div class="disabled-header svelte-1xs394q"><p class="unavailable-text svelte-1xs394q">ML predictions unavailable</p> <button type="button" class="reload-btn svelte-1xs394q" title="Reload predictions from database"> </button></div> <p class="unavailable-hint svelte-1xs394q"><!></p></div>');function Os(_e,l){jt(l,!0);let N=ut(l,"measuredOg",3,null),X=ut(l,"currentSg",3,null),L=ut(l,"liveReading",3,null),m=Se(Xt({available:!1})),U=Se(!0),r=Se(!1),A=Se(null);async function h(){p(U,!0),p(A,null);try{p(m,await Sa(l.batchId),!0)}catch(d){p(A,d instanceof Error?d.message:"Failed to load predictions",!0),console.error("Failed to load ML predictions:",d)}finally{p(U,!1)}}async function Z(){p(r,!0),p(A,null);try{const d=await Ba(l.batchId);console.log("Reloaded predictions:",d.message),await h()}catch(d){p(A,d instanceof Error?d.message:"Failed to reload predictions",!0),console.error("Failed to reload predictions:",d)}finally{p(r,!1)}}Zt(h);function ge(d){return d?new Date(d).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}):"N/A"}function he(d){if(!d)return null;const y=new Date(d),j=new Date,E=y.getTime()-j.getTime();return Math.ceil(E/(1e3*60*60*24))}let F=S(()=>{const d=N()??e(m).predicted_og,y=e(m).predicted_fg,j=X()??L()?.sg;if(!d||!y||!j||d<=y)return null;const E=d-y,Y=(d-j)/E*100;return Math.min(100,Math.max(0,Y))}),ee=S(()=>{const d=N()??e(m).predicted_og,y=X()??L()?.sg;if(!d||!y||d<=1)return null;const j=(d-y)/(d-1)*100;return Math.min(100,Math.max(0,j))}),B=S(()=>{const d=L()?.sg_rate;if(d==null)return null;const y=Math.abs(d);return y>.002?{label:"Very Active",color:"#22c55e",emoji:"üî•"}:y>5e-4?{label:"Active",color:"#84cc16",emoji:"‚ú®"}:y>1e-4?{label:"Slowing",color:"#eab308",emoji:"üê¢"}:{label:"Complete",color:"#6b7280",emoji:"‚úì"}}),$=S(()=>L()?.is_anomaly??!1),te=S(()=>L()?.anomaly_reasons??[]);var ie=me(),H=D(ie);{var W=d=>{var y=xs();n(d,y)},C=d=>{var y=me(),j=D(y);{var E=Y=>{var P=ys(),se=a(P),Q=a(se);t(se),t(P),u(()=>o(Q,`‚ö†Ô∏è ${e(A)??""}`)),n(Y,P)},ae=Y=>{var P=me(),se=D(P);{var Q=ve=>{var re=Ds();let q;var f=a(re),_=s(a(f),2);_.__click=Z;var k=a(_,!0);t(_),t(f);var O=s(f,2);{var J=g=>{var b=ws(),M=s(a(b),2),K=s(a(M),2);{var ze=Le=>{var Ke=js(),Pe=a(Ke,!0);t(Ke),u(je=>o(Pe,je),[()=>e(te).join(", ")]),n(Le,Ke)};v(K,Le=>{e(te).length>0&&Le(ze)})}t(M),t(b),n(g,b)};v(O,g=>{e($)&&g(J)})}var le=s(O,2);{var I=g=>{var b=zs(),M=a(b),K=s(a(M),2);{var ze=Ye=>{var Je=ks(),mt=a(Je);t(Je),u(()=>{$e(Je,`color: ${e(B).color??""}`),o(mt,`${e(B).emoji??""} ${e(B).label??""}`)}),n(Ye,Je)};v(K,Ye=>{e(B)&&Ye(ze)})}t(M);var Le=s(M,2),Ke=a(Le);t(Le);var Pe=s(Le,2),je=a(Pe),lt=a(je);t(je);var Xe=s(je,2),nt=a(Xe);t(Xe);var Ee=s(Xe,2),it=a(Ee);t(Ee),t(Pe),t(b),u((Ye,Je,mt)=>{$e(Ke,`width: ${e(F)??""}%`),o(lt,`OG: ${Ye??""}`),o(nt,`${Je??""}%`),o(it,`FG: ${mt??""}`)},[()=>yt(N()??e(m).predicted_og??0),()=>e(F).toFixed(0),()=>yt(e(m).predicted_fg??0)]),n(g,b)};v(le,g=>{e(F)!==null&&g(I)})}var ke=s(le,2),xe=a(ke);{var De=g=>{var b=Fs(),M=s(a(b),2),K=a(M,!0);t(M),t(b),u(ze=>o(K,ze),[()=>yt(e(m).predicted_fg)]),n(g,b)};v(xe,g=>{e(m).predicted_fg&&g(De)})}var Ce=s(xe,2);{var de=g=>{var b=Cs(),M=s(a(b),2),K=a(M);t(M),t(b),u(ze=>o(K,`${ze??""}%`),[()=>e(ee).toFixed(1)]),n(g,b)};v(Ce,g=>{e(ee)!==null&&g(de)})}var c=s(Ce,2);{var w=g=>{const b=S(()=>he(e(m).estimated_completion));var M=Bs(),K=s(a(M),2),ze=a(K);{var Le=Pe=>{var je=Rs();n(Pe,je)},Ke=Pe=>{var je=Ss(),lt=D(je),Xe=s(lt);{var nt=Ee=>{var it=qs(),Ye=a(it);t(it),u(()=>o(Ye,`(${e(b)??""} ${e(b)===1?"day":"days"})`)),n(Ee,it)};v(Xe,Ee=>{e(b)!==null&&Ee(nt)})}u(Ee=>o(lt,`${Ee??""} `),[()=>ge(e(m).estimated_completion)]),n(Pe,je)};v(ze,Pe=>{e(b)!==null&&e(b)<=0?Pe(Le):Pe(Ke,!1)})}t(K),t(M),n(g,M)};v(c,g=>{e(m).estimated_completion&&g(w)})}var V=s(c,2),z=a(V);{var ce=g=>{var b=Ms(),M=s(a(b),2),K=a(M);t(M),t(b),u(ze=>o(K,`${ze??""}%`),[()=>(e(m).r_squared*100).toFixed(0)]),n(g,b)};v(z,g=>{e(m).r_squared!==void 0&&g(ce)})}var ye=s(z,2);{var Be=g=>{var b=Ts(),M=s(a(b),2),K=a(M,!0);t(M),t(b),u(()=>o(K,e(m).num_readings)),n(g,b)};v(ye,g=>{e(m).num_readings&&g(Be)})}t(V),t(ke),t(re),u(()=>{q=Ne(re,1,"ml-panel svelte-1xs394q",null,q,{"has-anomaly":e($)}),_.disabled=e(r)||e(U),o(k,e(r)?"Reloading...":"‚Üª Reload")}),n(ve,re)},pe=ve=>{var re=Ps(),q=a(re),f=s(a(q),2);f.__click=Z;var _=a(f,!0);t(f),t(q);var k=s(q,2),O=a(k);{var J=I=>{var ke=pt("Waiting for fermentation to progress (need visible SG drop)");n(I,ke)},le=I=>{var ke=me(),xe=D(ke);{var De=de=>{var c=pt("Need more fermentation curve data for reliable prediction");n(de,c)},Ce=de=>{var c=me(),w=D(c);{var V=ce=>{var ye=pt("Need at least 10 readings to make predictions");n(ce,ye)},z=ce=>{var ye=pt("Predictions will appear once fermentation is underway");n(ce,ye)};v(w,ce=>{e(m).reason==="insufficient_data"?ce(V):ce(z,!1)},!0)}n(de,c)};v(xe,de=>{e(m).reason==="insufficient_curve_data"?de(De):de(Ce,!1)},!0)}n(I,ke)};v(O,I=>{e(m).reason==="insufficient_fermentation_progress"?I(J):I(le,!1)})}t(k),t(re),u(()=>{f.disabled=e(r)||e(U),o(_,e(r)?"Reloading...":"‚Üª Reload")}),n(ve,re)};v(se,ve=>{e(m).available?ve(Q):ve(pe,!1)},!0)}n(Y,P)};v(j,Y=>{e(A)?Y(E):Y(ae,!1)},!0)}n(d,y)};v(H,d=>{e(U)?d(W):d(C,!1)})}n(_e,ie),wt()}Ft(["click"]);var As=i('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),Es=i('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),Gs=i('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),Ns=i('<span class="recipe-type svelte-g5au2j"> </span>'),Ls=i('<a class="recipe-link svelte-g5au2j"> <!></a>'),Us=i('<div class="batch-timing svelte-g5au2j"> </div>'),Is=i('<div class="batch-timing svelte-g5au2j"> </div>'),Vs=i('<option class="svelte-g5au2j"> </option>'),Hs=i('<span class="chilling-icon svelte-g5au2j">üç∫</span> <h3 class="chilling-title svelte-g5au2j">Ready to Pitch!</h3>',1),Ws=i('<span class="chilling-icon svelte-g5au2j">‚ùÑÔ∏è</span> <h3 class="chilling-title svelte-g5au2j">Chilling to Pitch Temperature</h3>',1),Ys=i('<div class="progress-section svelte-g5au2j"><div class="progress-bar svelte-g5au2j"><div class="progress-fill svelte-g5au2j"></div></div> <span class="progress-text svelte-g5au2j"> </span></div>'),Js=i('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è No cooler configured - set a cooler entity to enable automated chilling</span>'),Ks=i('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è Temperature control disabled in settings</span>'),Xs=i('<span class="status-ready svelte-g5au2j">Wort has reached pitch temperature - ready to add yeast!</span>'),Zs=i('<span class="status-active svelte-g5au2j">Cooler will run automatically when temp exceeds target + hysteresis</span>'),Qs=i('<div><div class="chilling-header svelte-g5au2j"><!></div> <div class="chilling-content svelte-g5au2j"><div class="temp-display svelte-g5au2j"><div class="temp-current svelte-g5au2j"><span class="temp-label svelte-g5au2j">Current</span> <span class="temp-value svelte-g5au2j"> </span></div> <div class="temp-arrow svelte-g5au2j">‚Üí</div> <div class="temp-target svelte-g5au2j"><span class="temp-label svelte-g5au2j">Target</span> <span class="temp-value svelte-g5au2j"> </span></div></div> <!> <div class="chilling-status svelte-g5au2j"><!></div></div></div>'),$s=i('<span class="status-badge heater svelte-g5au2j">üî• Heating</span>'),er=i('<span class="status-badge cooler svelte-g5au2j">‚ùÑÔ∏è Cooling</span>'),tr=i('<span class="status-badge idle svelte-g5au2j"> </span>'),ar=i('<div class="device-status heater svelte-g5au2j"><div>üî•</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Heater</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),sr=i('<div class="device-status cooler svelte-g5au2j"><div>‚ùÑÔ∏è</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Cooler</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),rr=i('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">‚ö°</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),lr=i('<button type="button" class="override-btn heat-on svelte-g5au2j">Force Heat ON</button> <button type="button" class="override-btn heat-off svelte-g5au2j">Force Heat OFF</button>',1),nr=i('<button type="button" class="override-btn cool-on svelte-g5au2j">Force Cool ON</button> <button type="button" class="override-btn cool-off svelte-g5au2j">Force Cool OFF</button>',1),ir=i('<div class="control-details svelte-g5au2j"><div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns-grid svelte-g5au2j"><!> <!> <button type="button" class="override-btn auto-mode svelte-g5au2j">Auto Mode</button></div></div>',1),vr=i('<div class="device-status-grid svelte-g5au2j"><!> <!></div> <!>',1),or=i('<div><button type="button" class="collapsible-header svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="collapse-indicator svelte-g5au2j"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" class="svelte-g5au2j"></path></svg></div></button> <!></div>'),dr=i('<span class="svelte-g5au2j"> </span>'),cr=i('<span class="svelte-g5au2j"> </span>'),ur=i('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><!> <!> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),_r=i('<div class="chart-section svelte-g5au2j"><!></div>'),gr=i('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j" aria-label="Delete batch"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <!> <div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!></div></div> <!>',1),pr=i('<div class="modal-overlay svelte-g5au2j"><div class="modal svelte-g5au2j"><h2 class="modal-title svelte-g5au2j">Delete Batch?</h2> <p class="modal-text svelte-g5au2j"> </p> <div class="modal-actions svelte-g5au2j"><button type="button" class="modal-btn cancel svelte-g5au2j">Cancel</button> <button type="button" class="modal-btn delete svelte-g5au2j"> </button></div></div></div>'),fr=i('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div> <!>',1);function Ar(_e,l){jt(l,!0);const N=()=>Ca(Ra,"$page",X),[X,L]=Fa();let m=null,U=null,r=Se(null),A=Se(null),h=Se(null),Z=Xt([]),ge=Se(!0),he=Se(null),F=Se(!1),ee=Se(!1),B=Se(!1),$=Se(!1),te=Se(!1),ie=Se(!1),H=S(()=>parseInt(N().params.id??"0"));const W={planning:{label:"Planning",color:"var(--text-secondary)",bg:"var(--bg-elevated)"},fermenting:{label:"Fermenting",color:"#f59e0b",bg:"rgba(245, 158, 11, 0.12)"},conditioning:{label:"Conditioning",color:"#8b5cf6",bg:"rgba(139, 92, 246, 0.12)"},completed:{label:"Completed",color:"var(--positive)",bg:"rgba(34, 197, 94, 0.12)"},archived:{label:"Archived",color:"var(--text-muted)",bg:"var(--bg-elevated)"}},C=["planning","fermenting","conditioning","completed","archived"];let d=S(()=>e(r)?W[e(r).status]:W.planning),y=S(ta),j=S(()=>zt.config.ha_enabled&&zt.config.temp_control_enabled&&(e(r)?.heater_entity_id||e(r)?.cooler_entity_id)),E=S(()=>e(r)?.status==="planning"&&e(r)?.temp_target!=null),ae=S(()=>!e(E)||!e(P)?.temp||!e(r)?.temp_target?!1:e(P).temp<=e(r).temp_target),Y=S(()=>{if(!e(E)||!e(P)?.temp||!e(r)?.temp_target)return null;const c=e(r).temp_target+30,w=e(P).temp,V=e(r).temp_target;if(w<=V)return 100;if(w>=c)return 0;const z=(c-w)/(c-V)*100;return Math.min(100,Math.max(0,z))}),P=S(()=>{if(!e(r)?.device_id)return null;const c=Kt.tilts.get(e(r).device_id);if(c)return c;const w=e(r).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!w?.[1])return null;const V=w[1].toUpperCase();for(const z of Kt.tilts.values())if(z.color&&z.color.toUpperCase()===V)return z;return null});async function se(){p(ge,!0),p(he,null);try{if(p(r,await Ma(e(H)),!0),e(r).status==="fermenting"||e(r).status==="conditioning")try{p(A,await Yt(e(H)),!0)}catch{}if(e(r).heater_entity_id||e(r).cooler_entity_id)try{p(h,await kt(e(H)),!0)}catch{}}catch(c){p(he,c instanceof Error?c.message:"Failed to load batch",!0)}finally{p(ge,!1)}}async function Q(c){if(!(!e(r)||e(ee))&&!(c==="conditioning"&&e(r).status==="fermenting"&&!confirm(`üí° Entering Conditioning Phase

Reminder: Adjust target temperature if cold crashing.
Temperature control will continue during conditioning.

Continue?`))){p(ee,!0);try{p(r,await Jt(e(r).id,{status:c}),!0),(c==="fermenting"||c==="conditioning")&&p(A,await Yt(e(r).id),!0)}catch(w){console.error("Failed to update status:",w)}finally{p(ee,!1)}}}async function pe(c){if(e(r)&&(p(r,await Jt(e(r).id,c),!0),p(F,!1),e(r).heater_entity_id||e(r).cooler_entity_id))try{p(h,await kt(e(r).id),!0)}catch{}}async function ve(){if(e(r)){p(te,!0);try{await Ta(e(r).id),qa("/batches")}catch(c){p(he,c instanceof Error?c.message:"Failed to delete batch",!0),p(te,!1),p($,!1)}}}async function re(c,w){if(!(!e(r)||e(B))){p(B,!0);try{await Bt(e(r).id,w,60,c),p(h,await kt(e(r).id),!0)}catch(V){console.error("Failed to set override:",V)}finally{p(B,!1)}}}async function q(){if(!(!e(r)||e(B))){p(B,!0);try{e(r).heater_entity_id&&await Bt(e(r).id,null,60,"heater"),e(r).cooler_entity_id&&await Bt(e(r).id,null,60,"cooler"),p(h,await kt(e(r).id),!0)}catch(c){console.error("Failed to clear overrides:",c)}finally{p(B,!1)}}}function f(){if(m?.readyState===WebSocket.OPEN)return;const w=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;m=new WebSocket(w),m.onmessage=async V=>{try{const z=JSON.parse(V.data);z.type==="control_event"&&z.batch_id===e(H)&&e(h)&&(z.action==="heat_on"?p(h,{...e(h),heater_state:"on"},!0):z.action==="heat_off"?p(h,{...e(h),heater_state:"off"},!0):z.action==="cool_on"?p(h,{...e(h),cooler_state:"on"},!0):z.action==="cool_off"&&p(h,{...e(h),cooler_state:"off"},!0))}catch{}},m.onclose=()=>{m=null,U=setTimeout(f,3e3)},m.onerror=()=>{m?.close()}}function _(){U&&(clearTimeout(U),U=null),m?.close(),m=null}function k(c){return c==null?"--":ea(c)}function O(c){return c?new Date(c).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"--"}function J(c){if(!c)return"--";const w=new Date(c),z=(new Date().getTime()-w.getTime())/(1e3*60*60);if(z<1)return`${Math.round(z*60)}m`;if(z<24)return`${z.toFixed(1)}h`;const ce=z/24;return ce<7?`${ce.toFixed(1)}d`:`${Math.round(ce)}d`}Zt(()=>{se(),f()}),xa(()=>{_()});var le=fr();wa("g5au2j",c=>{ya(()=>{ja.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var I=D(le),ke=s(a(I),2);{var xe=c=>{var w=As();n(c,w)},De=c=>{var w=me(),V=D(w);{var z=ye=>{var Be=Es(),g=s(a(Be),2),b=a(g,!0);t(g);var M=s(g,2);M.__click=se,t(Be),u(()=>o(b,e(he))),n(ye,Be)},ce=ye=>{var Be=me(),g=D(Be);{var b=K=>{var ze=Gs();n(K,ze)},M=K=>{var ze=me(),Le=D(ze);{var Ke=je=>{Da(je,{get batch(){return e(r)},onSubmit:pe,onCancel:()=>p(F,!1)})},Pe=je=>{var lt=gr(),Xe=D(lt),nt=a(Xe),Ee=a(nt),it=a(Ee);t(Ee);var Ye=s(Ee,2),Je=a(Ye),mt=a(Je,!0);t(Je);var Mt=s(Je,2);{var sa=x=>{var T=Ls(),ne=a(T),be=s(ne);{var fe=Fe=>{var Ge=Ns(),Ue=a(Ge);t(Ge),u(()=>o(Ue,`(${e(r).recipe.type??""})`)),n(Fe,Ge)};v(be,Fe=>{e(r).recipe.type&&Fe(fe)})}t(T),u(()=>{ft(T,"href",`/recipes/${e(r).recipe.id??""}`),o(ne,`${e(r).recipe.name??""} `)}),n(x,T)};v(Mt,x=>{e(r).recipe&&x(sa)})}var ra=s(Mt,2);{var la=x=>{var T=Us(),ne=a(T);t(T),u((be,fe)=>o(ne,`Started ${be??""} ¬∑ ${fe??""} ago`),[()=>O(e(r).start_time),()=>J(e(r).start_time)]),n(x,T)},na=x=>{var T=me(),ne=D(T);{var be=fe=>{var Fe=Is(),Ge=a(Fe);t(Fe),u(Ue=>o(Ge,`Brewed ${Ue??""}`),[()=>O(e(r).brew_date)]),n(fe,Fe)};v(ne,fe=>{e(r).brew_date&&fe(be)},!0)}n(x,T)};v(ra,x=>{e(r).start_time?x(la):x(na,!1)})}t(Ye),t(nt);var Tt=s(nt,2),Rt=a(Tt),Ze=a(Rt);Ze.__change=x=>Q(x.currentTarget.value),Qt(Ze,21,()=>C,$t,(x,T)=>{var ne=Vs(),be=a(ne,!0);t(ne);var fe={};u(()=>{o(be,W[e(T)].label),fe!==(fe=e(T))&&(ne.value=(ne.__value=e(T))??"")}),n(x,ne)}),t(Ze);var Dt;ka(Ze),t(Rt);var Pt=s(Rt,2);Pt.__click=()=>p(F,!0);var ia=s(Pt,2);ia.__click=()=>p($,!0),t(Tt),t(Xe);var Ot=s(Xe,2);{var va=x=>{var T=Qs();let ne;var be=a(T),fe=a(be);{var Fe=R=>{var G=Hs();Te(2),n(R,G)},Ge=R=>{var G=Ws();Te(2),n(R,G)};v(fe,R=>{e(ae)?R(Fe):R(Ge,!1)})}t(be);var Ue=s(be,2),vt=a(Ue),et=a(vt),_t=s(a(et),2),Ie=a(_t,!0);t(_t),t(et);var oe=s(et,4),Me=s(a(oe),2),ot=a(Me,!0);t(Me),t(oe),t(vt);var dt=s(vt,2);{var ht=R=>{var G=Ys(),we=a(G),Re=a(we);t(we);var Oe=s(we,2),ue=a(Oe);t(Oe),t(G),u(qe=>{$e(Re,`width: ${e(Y)??""}%`),o(ue,`${qe??""}% to target`)},[()=>Math.round(e(Y))]),n(R,G)};v(dt,R=>{e(Y)!=null&&!e(ae)&&R(ht)})}var Ve=s(dt,2),tt=a(Ve);{var bt=R=>{var G=Js();n(R,G)},xt=R=>{var G=me(),we=D(G);{var Re=ue=>{var qe=Ks();n(ue,qe)},Oe=ue=>{var qe=me(),at=D(qe);{var Qe=rt=>{var gt=Xs();n(rt,gt)},st=rt=>{var gt=Zs();n(rt,gt)};v(at,rt=>{e(ae)?rt(Qe):rt(st,!1)},!0)}n(ue,qe)};v(we,ue=>{!zt.config.ha_enabled||!zt.config.temp_control_enabled?ue(Re):ue(Oe,!1)},!0)}n(R,G)};v(tt,R=>{e(r).cooler_entity_id?R(xt,!1):R(bt)})}t(Ve),t(Ue),t(T),u((R,G)=>{ne=Ne(T,1,"chilling-banner svelte-g5au2j",null,ne,{ready:e(ae)}),o(Ie,R),o(ot,G)},[()=>e(P)?.temp!=null?k(e(P).temp):"--",()=>e(r).temp_target!=null?k(e(r).temp_target):"--"]),n(x,T)};v(Ot,x=>{e(E)&&x(va)})}var qt=s(Ot,2),St=a(qt),At=a(St);{let x=S(()=>e(P)?.sg??e(A)?.measured?.current_sg);Za(At,{get batch(){return e(r)},get currentSg(){return e(x)},get progress(){return e(A)},get liveReading(){return e(P)}})}var oa=s(At,2);{var da=x=>{ms(x,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(oa,x=>{e(r).recipe&&x(da)})}t(St);var Et=s(St,2),Gt=a(Et);vs(Gt,{get batch(){return e(r)},get liveReading(){return e(P)},onEdit:()=>p(F,!0)});var Nt=s(Gt,2);{let x=S(()=>e(P)?.sg);Os(Nt,{get batchId(){return e(r).id},get measuredOg(){return e(r).measured_og},get currentSg(){return e(x)},get liveReading(){return e(P)}})}var Lt=s(Nt,2);{var ca=x=>{var T=or();let ne;var be=a(T);be.__click=()=>p(ie,!e(ie));var fe=s(a(be),2),Fe=a(fe);{var Ge=oe=>{var Me=$s();n(oe,Me)},Ue=oe=>{var Me=me(),ot=D(Me);{var dt=Ve=>{var tt=er();n(Ve,tt)},ht=Ve=>{var tt=me(),bt=D(tt);{var xt=R=>{var G=tr(),we=a(G);t(G),u(Re=>o(we,`üéØ ${Re??""}${e(y)??""}`),[()=>k(e(h).target_temp)]),n(R,G)};v(bt,R=>{e(ie)&&e(h)&&R(xt)},!0)}n(Ve,tt)};v(ot,Ve=>{e(h)?.cooler_state==="on"?Ve(dt):Ve(ht,!1)},!0)}n(oe,Me)};v(Fe,oe=>{e(h)?.heater_state==="on"?oe(Ge):oe(Ue,!1)})}var vt=s(Fe,2);let et;t(fe),t(be);var _t=s(be,2);{var Ie=oe=>{var Me=vr(),ot=D(Me),dt=a(ot);{var ht=R=>{var G=ar(),we=a(G);let Re;var Oe=s(we,2),ue=s(a(Oe),2);let qe;var at=a(ue,!0);t(ue);var Qe=s(ue,2),st=a(Qe,!0);t(Qe),t(Oe),t(G),u(()=>{Re=Ne(we,1,"device-icon-wrap svelte-g5au2j",null,Re,{active:e(h)?.heater_state==="on"}),qe=Ne(ue,1,"device-state svelte-g5au2j",null,qe,{on:e(h)?.heater_state==="on"}),o(at,e(h)?.heater_state==="on"?"ON":"OFF"),o(st,e(r).heater_entity_id)}),n(R,G)};v(dt,R=>{e(r).heater_entity_id&&R(ht)})}var Ve=s(dt,2);{var tt=R=>{var G=sr(),we=a(G);let Re;var Oe=s(we,2),ue=s(a(Oe),2);let qe;var at=a(ue,!0);t(ue);var Qe=s(ue,2),st=a(Qe,!0);t(Qe),t(Oe),t(G),u(()=>{Re=Ne(we,1,"device-icon-wrap svelte-g5au2j",null,Re,{active:e(h)?.cooler_state==="on"}),qe=Ne(ue,1,"device-state svelte-g5au2j",null,qe,{on:e(h)?.cooler_state==="on"}),o(at,e(h)?.cooler_state==="on"?"ON":"OFF"),o(st,e(r).cooler_entity_id)}),n(R,G)};v(Ve,R=>{e(r).cooler_entity_id&&R(tt)})}t(ot);var bt=s(ot,2);{var xt=R=>{var G=ir(),we=D(G),Re=a(we),Oe=s(a(Re),2),ue=a(Oe);t(Oe),t(Re);var qe=s(Re,2),at=s(a(qe),2),Qe=a(at);t(at),t(qe),t(we);var st=s(we,2);{var rt=Ae=>{var He=rr(),We=s(a(He),2),ct=a(We);t(We);var Wt=s(We,2);Wt.__click=()=>q(),t(He),u(ba=>{o(ct,`Override active: ${ba??""}`),Wt.disabled=e(B)},[()=>e(h).override_state?.toUpperCase()]),n(Ae,He)};v(st,Ae=>{e(h).override_active&&Ae(rt)})}var gt=s(st,2),Ut=s(a(gt),2),It=a(Ut);{var ma=Ae=>{var He=lr(),We=D(He);We.__click=()=>re("heater","on");var ct=s(We,2);ct.__click=()=>re("heater","off"),u(()=>{We.disabled=e(B),ct.disabled=e(B)}),n(Ae,He)};v(It,Ae=>{e(r).heater_entity_id&&Ae(ma)})}var Vt=s(It,2);{var ha=Ae=>{var He=nr(),We=D(He);We.__click=()=>re("cooler","on");var ct=s(We,2);ct.__click=()=>re("cooler","off"),u(()=>{We.disabled=e(B),ct.disabled=e(B)}),n(Ae,He)};v(Vt,Ae=>{e(r).cooler_entity_id&&Ae(ha)})}var Ht=s(Vt,2);Ht.__click=()=>q(),t(Ut),t(gt),u((Ae,He)=>{o(ue,`${Ae??""}${e(y)??""}`),o(Qe,`¬±${He??""}${e(y)??""}`),Ht.disabled=e(B)},[()=>k(e(h).target_temp),()=>e(h).hysteresis?.toFixed(1)||"--"]),n(R,G)};v(bt,R=>{e(h)&&R(xt)})}n(oe,Me)};v(_t,oe=>{e(ie)||oe(Ie)})}t(T),u(()=>{ne=Ne(T,1,"info-card temp-control-card svelte-g5au2j",null,ne,{"heater-on":e(h)?.heater_state==="on","cooler-on":e(h)?.cooler_state==="on",collapsed:e(ie)}),et=Ne(vt,0,"chevron svelte-g5au2j",null,et,{rotated:!e(ie)})}),n(x,T)},ua=x=>{var T=me(),ne=D(T);{var be=fe=>{var Fe=ur(),Ge=s(a(Fe),2),Ue=a(Ge);{var vt=Ie=>{var oe=dr(),Me=a(oe);t(oe),u(()=>o(Me,`Heater: ${e(r).heater_entity_id??""}`)),n(Ie,oe)};v(Ue,Ie=>{e(r).heater_entity_id&&Ie(vt)})}var et=s(Ue,2);{var _t=Ie=>{var oe=cr(),Me=a(oe);t(oe),u(()=>o(Me,`Cooler: ${e(r).cooler_entity_id??""}`)),n(Ie,oe)};v(et,Ie=>{e(r).cooler_entity_id&&Ie(_t)})}Te(2),t(Ge),t(Fe),n(fe,Fe)};v(ne,fe=>{(e(r).heater_entity_id||e(r).cooler_entity_id)&&e(r).status!=="fermenting"&&fe(be)},!0)}n(x,T)};v(Lt,x=>{e(j)&&(e(r).status==="fermenting"||e(r).status==="conditioning")?x(ca):x(ua,!1)})}var _a=s(Lt,2);{var ga=x=>{bs(x,{get notes(){return e(r).notes}})};v(_a,x=>{e(r).notes&&x(ga)})}t(Et),t(qt);var pa=s(qt,2);{var fa=x=>{var T=_r(),ne=a(T);Oa(ne,{get batchId(){return e(r).id},get deviceColor(){return e(r).device_id},get originalGravity(){return e(r).measured_og},get controlEvents(){return Z}}),t(T),n(x,T)};v(pa,x=>{e(r).device_id&&x(fa)})}u(()=>{o(it,`#${(e(r).batch_number||"?")??""}`),o(mt,e(r).name||e(r).recipe?.name||"Unnamed Batch"),Ze.disabled=e(ee),$e(Ze,`color: ${e(d).color??""}; background: ${e(d).bg??""};`),Dt!==(Dt=e(r).status)&&(Ze.value=(Ze.__value=e(r).status)??"",za(Ze,e(r).status))}),n(je,lt)};v(Le,je=>{e(F)?je(Ke):je(Pe,!1)},!0)}n(K,ze)};v(g,K=>{e(r)?K(M,!1):K(b)},!0)}n(ye,Be)};v(V,ye=>{e(he)?ye(z):ye(ce,!1)},!0)}n(c,w)};v(ke,c=>{e(ge)?c(xe):c(De,!1)})}t(I);var Ce=s(I,2);{var de=c=>{var w=pr();w.__click=()=>p($,!1);var V=a(w);V.__click=M=>M.stopPropagation();var z=s(a(V),2),ce=a(z);t(z);var ye=s(z,2),Be=a(ye);Be.__click=()=>p($,!1);var g=s(Be,2);g.__click=ve;var b=a(g,!0);t(g),t(ye),t(V),t(w),u(()=>{o(ce,`Are you sure you want to delete "${(e(r)?.name||"this batch")??""}"? This cannot be undone.`),Be.disabled=e(te),g.disabled=e(te),o(b,e(te)?"Deleting...":"Delete Batch")}),n(c,w)};v(Ce,c=>{e($)&&c(de)})}n(_e,le),wt(),L()}Ft(["click","change"]);export{Ar as component,Or as universal};
