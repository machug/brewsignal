import{d as aa,f as n,s as d,a as l,c as De,t as ta,h as da,e as Ut}from"../chunks/orbuQWWI.js";import{d as a,e as s,r as t,t as u,a as Wt,f as le,h as e,u as A,n as ge,g as Xt,s as Y,p as _t,o as Ua,c as o,az as Ba,b9 as ts,ay as as,i as ss,aJ as rs,aC as ls,ax as is}from"../chunks/pAodAtlG.js";import{e as oa,i as xa}from"../chunks/0whDC7Rl.js";import{i as v}from"../chunks/ucc1DXe2.js";import{h as ns}from"../chunks/DJBMpqSf.js";import{s as Vt,r as Dt,a as vs}from"../chunks/CYuZshLQ.js";import{s as Ee}from"../chunks/Cpbxxhlc.js";import{s as gt}from"../chunks/C-5oeV0L.js";import{b as os,i as ds,s as cs}from"../chunks/RboyDiSx.js";import{s as us,a as _s}from"../chunks/BkeTWnxc.js";import{p as ps}from"../chunks/Cjz_Yz8X.js";import{g as hs}from"../chunks/Dj6itDdr.js";import{a8 as gs,a9 as fs,aa as ms,ab as bs,ac as ys,Q as fa,X as xs,S as Sa,ad as ka,a3 as ks,ae as Ca}from"../chunks/BKVJalqB.js";import{d as At,e as ja,g as Ta,c as wa}from"../chunks/D9t2HWx4.js";import{t as Ga}from"../chunks/DWpXqN03.js";import{B as ws}from"../chunks/D0ubrFx-.js";import{s as js}from"../chunks/GbV1md6Y.js";import{p as va}from"../chunks/C44MPb_E.js";import{F as Bs}from"../chunks/Bb2uDevi.js";import{b as Rt}from"../chunks/Dh5hCwq1.js";import{s as qa}from"../chunks/BkabqQ1A.js";const zs=!1,Ai=Object.freeze(Object.defineProperty({__proto__:null,prerender:zs},Symbol.toStringTag,{value:"Module"}));function Ms(Me){return Me>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:Me>=-60?{bars:3,color:"var(--positive)",label:"Good"}:Me>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function Va(Me){const i=Math.floor((Date.now()-new Date(Me).getTime())/1e3);if(i<10)return"just now";if(i<60)return`${i}s ago`;const h=Math.floor(i/60);if(h<60)return`${h}m ago`;const j=Math.floor(h/60);return j<24?`${j}h ago`:`${Math.floor(j/24)}d ago`}var Ss=n('<div class="accent-bar svelte-1oyrwd9"></div>'),Cs=n('<span class="card-icon svelte-1oyrwd9"> </span>'),qs=n('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),Fs=n('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function ma(Me,i){let h=va(i,"highlight",3,!1),j=va(i,"compact",3,!1),S=va(i,"collapsible",3,!1),w=va(i,"expanded",3,!1);var R=Fs();let r;var D=a(R);{var B=z=>{var q=Ss();l(z,q)};v(D,z=>{h()&&z(B)})}var ue=s(D,2),be=a(ue),ye=a(be);{var F=z=>{var q=Cs(),de=a(q,!0);t(q),u(()=>d(de,i.icon)),l(z,q)};v(ye,z=>{i.icon&&z(F)})}var X=s(ye,2),ae=a(X,!0);t(X),t(be);var ie=s(be,2);{var C=z=>{var q=qs();q.__click=function(...y){i.onToggle?.apply(this,y)};var de=a(q);let K;t(q),u(()=>{Vt(q,"aria-label",w()?"Collapse":"Expand"),K=Ee(de,0,"expand-icon svelte-1oyrwd9",null,K,{"rotate-180":w()})}),l(z,q)};v(ie,z=>{S()&&i.onToggle&&z(C)})}t(ue);var G=s(ue,2);let U;var ee=a(G);js(ee,()=>i.children),t(G),t(R),u(()=>{r=Ee(R,1,"batch-card svelte-1oyrwd9",null,r,{highlight:h(),compact:j()}),d(ae,i.title),U=Ee(G,1,"card-content svelte-1oyrwd9",null,U,{collapsed:S()&&!w()})}),l(Me,R)}aa(["click"]);var Ts=n('<span class="updated-text svelte-t80j9z"> </span>'),Rs=n('<div class="hero-divider svelte-t80j9z"></div> <div class="hero-metric temperature svelte-t80j9z"><span class="hero-value svelte-t80j9z"> <span class="hero-unit svelte-t80j9z"> </span></span> <span class="hero-label svelte-t80j9z">Temperature</span></div>',1),Ds=n('<div class="remaining-text svelte-t80j9z"> </div>'),As=n('<div class="progress-section svelte-t80j9z"><div class="progress-labels svelte-t80j9z"><div class="progress-endpoint start svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">OG</span></div> <div class="progress-current svelte-t80j9z"><span class="current-percent svelte-t80j9z"> </span></div> <div class="progress-endpoint end svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">Target FG</span></div></div> <div class="progress-track svelte-t80j9z"><div class="progress-fill svelte-t80j9z"></div> <div><div class="marker-dot svelte-t80j9z"></div> <div class="marker-value svelte-t80j9z"> </div></div></div> <!></div>'),Ps=n('<div class="metrics-row svelte-t80j9z"><div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">ABV</span></div> <div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">Attenuation</span></div></div>'),Os=n('<div class="status-row svelte-t80j9z"><div class="live-indicator svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> <span class="status-text svelte-t80j9z">LIVE</span></div> <!></div> <div class="hero-section svelte-t80j9z"><div class="hero-metric gravity svelte-t80j9z"><span class="hero-value svelte-t80j9z"> </span> <span class="hero-label svelte-t80j9z">Gravity</span></div> <!></div> <!> <!>',1),Is=n('<div class="completed-grid svelte-t80j9z"><div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Original Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Final Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">ABV</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Attenuation</span></div></div>'),Ls=n('<div class="empty-state svelte-t80j9z"><div class="empty-icon svelte-t80j9z">‚óé</div> <p class="empty-text svelte-t80j9z">Set Original Gravity to track fermentation</p></div>');function Es(Me,i){Wt(i,!0);let h=A(()=>i.currentSg??i.progress?.measured?.current_sg),j=A(()=>i.liveReading?.temp??i.progress?.temperature?.current),S=A(()=>i.liveReading?.last_seen),w=A(()=>e(S)?Va(e(S)):null),R=A(Ta),r=A(()=>{if(!i.batch.measured_og||!e(h))return null;const F=Math.max(0,(i.batch.measured_og-e(h))*131.25),X=i.batch.measured_og-1,ae=X!==0?Math.max(0,Math.min(100,(i.batch.measured_og-e(h))/X*100)):0;return{abv:F,attenuation:ae}}),D=A(()=>{const F=i.batch.measured_og,X=i.batch.recipe?.fg;if(!F||!X||!e(h))return null;const ae=F-X,ie=F-e(h);return ae<=0?null:Math.max(0,Math.min(100,ie/ae*100))}),B=A(()=>i.batch.status==="fermenting"||i.batch.status==="conditioning");function ue(F){return F==null?"--":At(F)}function be(F){return F==null?"--":`${F.toFixed(1)}%`}function ye(F){return F==null?"--":ja(F)}ma(Me,{title:"Fermentation",children:(F,X)=>{var ae=De(),ie=le(ae);{var C=U=>{var ee=Os(),z=le(ee),q=s(a(z),2);{var de=x=>{var p=Ts(),b=a(p);t(p),u(()=>d(b,`Updated ${e(w)??""}`)),l(x,p)};v(q,x=>{e(w)&&x(de)})}t(z);var K=s(z,2),y=a(K),I=a(y),_e=a(I,!0);t(I),ge(2),t(y);var Q=s(y,2);{var c=x=>{var p=Rs(),b=s(le(p),2),M=a(b),P=a(M,!0),E=s(P),Z=a(E,!0);t(E),t(M),ge(2),t(b),u(J=>{d(P,J),d(Z,e(R))},[()=>ye(e(j))]),l(x,p)};v(Q,x=>{e(j)!=null&&x(c)})}t(K);var _=s(K,2);{var m=x=>{var p=As(),b=a(p),M=a(b),P=a(M),E=a(P,!0);t(P),ge(2),t(M);var Z=s(M,2),J=a(Z),je=a(J);t(J),t(Z);var he=s(Z,2),pe=a(he),xe=a(pe,!0);t(pe),ge(2),t(he),t(b);var Be=s(b,2),Se=a(Be),Re=s(Se,2);let ze;var Ce=s(a(Re),2),We=a(Ce,!0);t(Ce),t(Re),t(Be);var g=s(Be,2);{var te=ne=>{var N=Ds(),se=a(N);t(N),u(ve=>d(se,`${ve??""} points to go`),[()=>i.progress.progress.sg_remaining.toFixed(3)]),l(ne,N)};v(g,ne=>{i.progress?.progress?.sg_remaining!=null&&i.progress.progress.sg_remaining>0&&ne(te)})}t(p),u((ne,N,se,ve)=>{d(E,ne),d(je,`${N??""}%`),d(xe,se),gt(Se,`width: ${e(D)??""}%`),ze=Ee(Re,1,"progress-marker svelte-t80j9z",null,ze,{"at-start":e(D)<3}),gt(Re,`left: ${e(D)??""}%`),d(We,ve)},[()=>ue(i.batch.measured_og),()=>e(D).toFixed(0),()=>ue(i.batch.recipe.fg),()=>ue(e(h))]),l(x,p)};v(_,x=>{e(D)!==null&&i.batch.measured_og&&i.batch.recipe?.fg&&x(m)})}var V=s(_,2);{var fe=x=>{var p=Ps(),b=a(p),M=a(b),P=a(M,!0);t(M),ge(2),t(b);var E=s(b,2),Z=a(E),J=a(Z,!0);t(Z),ge(2),t(E),t(p),u((je,he)=>{d(P,je),d(J,he)},[()=>be(e(r).abv),()=>be(e(r).attenuation)]),l(x,p)};v(V,x=>{e(r)&&x(fe)})}u(x=>d(_e,x),[()=>ue(e(h))]),l(U,ee)},G=U=>{var ee=De(),z=le(ee);{var q=K=>{var y=Is(),I=a(y),_e=a(I),Q=a(_e,!0);t(_e),ge(2),t(I);var c=s(I,2),_=a(c),m=a(_,!0);t(_),ge(2),t(c);var V=s(c,2),fe=a(V),x=a(fe,!0);t(fe),ge(2),t(V);var p=s(V,2),b=a(p),M=a(b,!0);t(b),ge(2),t(p),t(y),u((P,E,Z,J)=>{d(Q,P),d(m,E),d(x,Z),d(M,J)},[()=>ue(i.batch.measured_og),()=>ue(i.batch.measured_fg),()=>i.batch.measured_abv!=null?be(i.batch.measured_abv):"--",()=>i.batch.measured_attenuation!=null?be(i.batch.measured_attenuation):"--"]),l(K,y)},de=K=>{var y=Ls();l(K,y)};v(z,K=>{i.batch.measured_og?K(q):K(de,!1)},!0)}l(U,ee)};v(ie,U=>{e(h)&&e(B)?U(C):U(G,!1)})}l(F,ae)},$$slots:{default:!0}}),Xt()}var Gs=n('<span class="device-last-seen svelte-1kdxwtz"> </span>'),Ns=n('<div class="signal-bar svelte-1kdxwtz"></div>'),Hs=n('<div class="metric-item svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="metric-text svelte-1kdxwtz"> </span></div>'),Us=n('<div class="metric-item battery svelte-1kdxwtz"><svg class="battery-icon svelte-1kdxwtz" viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="2" y="7" width="18" height="10" rx="2"></rect><rect x="4" y="9" height="6" stroke="none" rx="1"></rect><path d="M20 10v4h2v-4z" stroke="none"></path></svg> <span class="metric-text svelte-1kdxwtz"><!></span></div>'),Vs=n('<div class="device-metrics svelte-1kdxwtz"><!> <!></div>'),Ws=n('<div class="device-row svelte-1kdxwtz"><div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!></div> <!>',1),Xs=n('<div class="device-row svelte-1kdxwtz"><div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <span class="device-last-seen svelte-1kdxwtz">No data</span></div>'),Js=n('<div class="device-info svelte-1kdxwtz"><!></div>'),Ys=n('<button type="button" class="link-btn svelte-1kdxwtz">Link device</button>'),Ks=n('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function Na(Me,i){Wt(i,!0);let h=A(()=>i.liveReading?.device_type==="tilt"),j=A(()=>e(h)&&i.liveReading?.rssi?Ms(i.liveReading.rssi):null),S=A(()=>i.liveReading?.last_seen?Va(i.liveReading.last_seen):null),w=A(()=>i.liveReading?.battery_percent!=null||i.liveReading?.battery_voltage!=null),R=A(()=>i.liveReading?.battery_percent),r=A(()=>i.liveReading?.battery_voltage),D=A(()=>e(R)?e(R)>50?"var(--positive)":e(R)>20?"var(--warning)":"var(--negative)":"var(--text-muted)"),B=A(()=>{if(!i.liveReading)return i.batch.device_id||"Unknown";const ue=i.liveReading.device_type;return ue==="tilt"?`${i.liveReading.color} Tilt`:ue==="gravitymon"?`GravityMon (${i.liveReading.id})`:ue==="ispindel"?`iSpindel (${i.liveReading.id})`:ue==="floaty"?`Floaty (${i.liveReading.id})`:i.liveReading.color||i.liveReading.id});ma(Me,{title:"Tracking Device",compact:!0,children:(ue,be)=>{var ye=De(),F=le(ye);{var X=ie=>{var C=Js(),G=a(C);{var U=z=>{var q=Ws(),de=le(q),K=a(de),y=s(a(K));t(K);var I=s(K,2);{var _e=_=>{var m=Gs(),V=a(m,!0);t(m),u(()=>d(V,e(S))),l(_,m)};v(I,_=>{e(S)&&_(_e)})}t(de);var Q=s(de,2);{var c=_=>{var m=Vs(),V=a(m);{var fe=b=>{var M=Hs(),P=a(M);oa(P,20,()=>Array(4),xa,(J,je,he)=>{var pe=Ns();u(()=>gt(pe,`height: ${4+he*2}px; background: ${(he<e(j).bars?e(j).color:"var(--bg-hover)")??""}; opacity: ${he<e(j).bars?1:.4};`)),l(J,pe)}),t(P);var E=s(P,2),Z=a(E);t(E),t(M),u(()=>{gt(E,`color: ${e(j).color??""}`),d(Z,`${i.liveReading.rssi??""}dBm`)}),l(b,M)};v(V,b=>{e(j)&&b(fe)})}var x=s(V,2);{var p=b=>{var M=Us(),P=a(M),E=s(a(P)),Z=s(E);t(P);var J=s(P,2),je=a(J);{var he=xe=>{var Be=ta();u(Se=>d(Be,`${Se??""}%`),[()=>e(R).toFixed(0)]),l(xe,Be)},pe=xe=>{var Be=De(),Se=le(Be);{var Re=ze=>{var Ce=ta();u(We=>d(Ce,`${We??""}V`),[()=>e(r).toFixed(2)]),l(ze,Ce)};v(Se,ze=>{e(r)!=null&&ze(Re)},!0)}l(xe,Be)};v(je,xe=>{e(R)!=null?xe(he):xe(pe,!1)})}t(J),t(M),u(()=>{Vt(P,"stroke",e(D)),Vt(E,"width",(e(R)??50)*.14),Vt(E,"fill",e(D)),Vt(Z,"fill",e(D)),gt(J,`color: ${e(D)??""}`)}),l(b,M)};v(x,b=>{e(w)&&b(p)})}t(m),l(_,m)};v(Q,_=>{(e(j)||e(w))&&_(c)})}u(()=>d(y,` ${e(B)??""}`)),l(z,q)},ee=z=>{var q=Xs(),de=a(q),K=s(a(de));t(de),ge(2),t(q),u(()=>d(K,` ${i.batch.device_id??""}`)),l(z,q)};v(G,z=>{i.liveReading?z(U):z(ee,!1)})}t(C),l(ie,C)},ae=ie=>{var C=Ks(),G=s(a(C),2);{var U=ee=>{var z=Ys();z.__click=function(...q){i.onEdit?.apply(this,q)},l(ee,z)};v(G,ee=>{i.onEdit&&ee(U)})}t(C),l(ie,C)};v(F,ie=>{i.batch.device_id?ie(X):ie(ae,!1)})}l(ue,ye)},$$slots:{default:!0}}),Xt()}aa(["click"]);const Qs=131.25;var Zs=n('<span class="yeast-producer svelte-19u9n31"> </span>'),$s=n('<span class="yeast-temp svelte-19u9n31"> </span>'),er=n('<div class="yeast-row recipe svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Recipe</span> <span class="yeast-value muted svelte-19u9n31"> </span></div>'),tr=n('<div class="yeast-row actual svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span> <!> <!></div> <!>',1),ar=n('<div class="yeast-row svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span></div>'),sr=n('<div class="yeast-section svelte-19u9n31"><!></div>'),rr=n('<div class="targets-row svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div></div> <!>',1);function Fa(Me,i){Wt(i,!0);function h(S){return S==null?"--":At(S)}let j=A(()=>i.recipe.abv!=null?i.recipe.abv:i.recipe.og&&i.recipe.fg?(i.recipe.og-i.recipe.fg)*Qs:null);ma(Me,{title:"Recipe Targets",compact:!0,children:(S,w)=>{var R=rr(),r=le(R),D=a(r),B=s(a(D),2),ue=a(B,!0);t(B),t(D);var be=s(D,2),ye=s(a(be),2),F=a(ye,!0);t(ye),t(be);var X=s(be,2),ae=s(a(X),2),ie=a(ae,!0);t(ae),t(X),t(r);var C=s(r,2);{var G=U=>{var ee=sr(),z=a(ee);{var q=K=>{var y=tr(),I=le(y),_e=s(a(I),2),Q=a(_e,!0);t(_e);var c=s(_e,2);{var _=p=>{var b=Zs(),M=a(b);t(b),u(()=>d(M,`(${i.yeastStrain.producer??""})`)),l(p,b)};v(c,p=>{i.yeastStrain.producer&&p(_)})}var m=s(c,2);{var V=p=>{var b=$s(),M=a(b);t(b),u((P,E)=>d(M,`${P??""}-${E??""}¬∞C`),[()=>i.yeastStrain.temp_low.toFixed(0),()=>i.yeastStrain.temp_high.toFixed(0)]),l(p,b)};v(m,p=>{i.yeastStrain.temp_low&&i.yeastStrain.temp_high&&p(V)})}t(I);var fe=s(I,2);{var x=p=>{var b=er(),M=s(a(b),2),P=a(M,!0);t(M),t(b),u(()=>d(P,i.recipe.yeast_name)),l(p,b)};v(fe,p=>{i.recipe.yeast_name&&p(x)})}u(()=>d(Q,i.yeastStrain.name)),l(K,y)},de=K=>{var y=De(),I=le(y);{var _e=Q=>{var c=ar(),_=s(a(c),2),m=a(_,!0);t(_),t(c),u(()=>d(m,i.recipe.yeast_name)),l(Q,c)};v(I,Q=>{i.recipe.yeast_name&&Q(_e)},!0)}l(K,y)};v(z,K=>{i.yeastStrain?K(q):K(de,!1)})}t(ee),l(U,ee)};v(C,U=>{(i.yeastStrain||i.recipe.yeast_name)&&U(G)})}u((U,ee,z)=>{d(ue,U),d(F,ee),d(ie,z)},[()=>h(i.recipe.og),()=>h(i.recipe.fg),()=>e(j)!=null?`${e(j).toFixed(1)}%`:"--"]),l(S,R)},$$slots:{default:!0}}),Xt()}var lr=n('<p class="notes-content svelte-hkv31i"> </p>');function Ha(Me,i){ma(Me,{title:"Notes",children:(h,j)=>{var S=lr(),w=a(S,!0);t(S),u(()=>d(w,i.notes)),l(h,S)},$$slots:{default:!0}})}var ir=n('<div class="ml-panel loading svelte-1xs394q"><p>Loading predictions...</p></div>'),nr=n('<div class="ml-panel error svelte-1xs394q"><p class="error-text svelte-1xs394q"> </p></div>'),vr=n("<option> </option>"),or=n('<span class="anomaly-reasons svelte-1xs394q"> </span>'),dr=n('<div class="anomaly-banner svelte-1xs394q"><span class="anomaly-icon svelte-1xs394q">‚ö†Ô∏è</span> <div class="anomaly-content svelte-1xs394q"><span class="anomaly-label svelte-1xs394q">Anomaly Detected</span> <!></div></div>'),cr=n('<span class="activity-badge svelte-1xs394q"> </span>'),ur=n('<div class="progress-section svelte-1xs394q"><div class="progress-header svelte-1xs394q"><span class="progress-label svelte-1xs394q">Fermentation Progress</span> <!></div> <div class="fermentation-progress-bar svelte-1xs394q"><div class="fermentation-fill svelte-1xs394q"></div></div> <div class="progress-labels svelte-1xs394q"><span class="og-label svelte-1xs394q"> </span> <span class="progress-percent svelte-1xs394q"> </span> <span class="fg-label svelte-1xs394q"> </span></div></div>'),_r=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Predicted FG:</span> <span class="value svelte-1xs394q"> </span></div>'),pr=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Attenuation:</span> <span class="value attenuation svelte-1xs394q"> </span></div>'),hr=n('<span class="complete-now svelte-1xs394q">Ready now!</span>'),gr=n('<span class="days svelte-1xs394q"> </span>'),fr=n(" <!>",1),mr=n('<div class="metric completion-metric svelte-1xs394q"><span class="label svelte-1xs394q">Est. Completion:</span> <span class="value svelte-1xs394q"><!></span></div>'),br=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model:</span> <span class="model-value model-type svelte-1xs394q"> </span></div>'),yr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),xr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),kr=n('<div><div class="panel-header svelte-1xs394q"><h3 class="panel-title svelte-1xs394q">Fermentation Intelligence</h3> <div class="header-controls svelte-1xs394q"><select class="model-select svelte-1xs394q" title="Select prediction model"></select> <button type="button" class="reload-btn svelte-1xs394q" title="Recalculate predictions from database history"> </button></div></div> <!> <!> <div class="metrics svelte-1xs394q"><!> <!> <!> <div class="model-info svelte-1xs394q"><!> <!> <!></div></div></div>'),wr=n('<div class="ml-panel disabled svelte-1xs394q"><div class="disabled-header svelte-1xs394q"><p class="unavailable-text svelte-1xs394q">ML predictions unavailable</p> <button type="button" class="reload-btn svelte-1xs394q" title="Reload predictions from database"> </button></div> <p class="unavailable-hint svelte-1xs394q"><!></p></div>');function jr(Me,i){Wt(i,!0);let h=va(i,"measuredOg",3,null),j=va(i,"currentSg",3,null),S=va(i,"liveReading",3,null),w=Y(_t({available:!1})),R=Y(!0),r=Y(!1),D=Y(null),B=Y("auto");const ue=[{value:"auto",label:"Auto (Best Fit)"},{value:"exponential",label:"Exponential"},{value:"gompertz",label:"Gompertz (S-Curve)"},{value:"logistic",label:"Logistic"}];async function be(){o(R,!0),o(D,null);try{o(w,await fs(i.batchId,e(B)),!0)}catch(y){o(D,y instanceof Error?y.message:"Failed to load predictions",!0),console.error("Failed to load ML predictions:",y)}finally{o(R,!1)}}async function ye(){o(r,!0),o(D,null);try{const y=await gs(i.batchId);console.log("Reloaded predictions:",y.message),await be()}catch(y){o(D,y instanceof Error?y.message:"Failed to reload predictions",!0),console.error("Failed to reload predictions:",y)}finally{o(r,!1)}}function F(){be()}Ua(ye);function X(y){return y?new Date(y).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}):"N/A"}function ae(y){if(!y)return null;const I=new Date(y),_e=new Date,Q=I.getTime()-_e.getTime();return Math.ceil(Q/(1e3*60*60*24))}let ie=A(()=>{const y=h()??e(w).predicted_og,I=e(w).predicted_fg,_e=j()??S()?.sg;if(!y||!I||!_e||y<=I)return null;const Q=y-I,_=(y-_e)/Q*100;return Math.min(100,Math.max(0,_))}),C=A(()=>{const y=h()??e(w).predicted_og,I=j()??S()?.sg;if(!y||!I||y<=1)return null;const _e=(y-I)/(y-1)*100;return Math.min(100,Math.max(0,_e))}),G=A(()=>{const y=S()?.sg_rate;if(y==null)return null;const I=Math.abs(y);return I>.002?{label:"Very Active",color:"var(--activity-very-active)",emoji:"üî•"}:I>5e-4?{label:"Active",color:"var(--activity-active)",emoji:"‚ú®"}:I>1e-4?{label:"Slowing",color:"var(--activity-slowing)",emoji:"üê¢"}:{label:"Complete",color:"var(--activity-complete)",emoji:"‚úì"}}),U=A(()=>S()?.is_anomaly??!1),ee=A(()=>S()?.anomaly_reasons??[]);var z=De(),q=le(z);{var de=y=>{var I=ir();l(y,I)},K=y=>{var I=De(),_e=le(I);{var Q=_=>{var m=nr(),V=a(m),fe=a(V);t(V),t(m),u(()=>d(fe,`‚ö†Ô∏è ${e(D)??""}`)),l(_,m)},c=_=>{var m=De(),V=le(m);{var fe=p=>{var b=kr();let M;var P=a(b),E=s(a(P),2),Z=a(E);Z.__change=F,oa(Z,21,()=>ue,xa,(T,O)=>{var W=vr(),qe=a(W,!0);t(W);var Ne={};u(()=>{d(qe,e(O).label),Ne!==(Ne=e(O).value)&&(W.value=(W.__value=e(O).value)??"")}),l(T,W)}),t(Z);var J=s(Z,2);J.__click=ye;var je=a(J,!0);t(J),t(E),t(P);var he=s(P,2);{var pe=T=>{var O=dr(),W=s(a(O),2),qe=s(a(W),2);{var Ne=f=>{var k=or(),L=a(k,!0);t(k),u(H=>d(L,H),[()=>e(ee).join(", ")]),l(f,k)};v(qe,f=>{e(ee).length>0&&f(Ne)})}t(W),t(O),l(T,O)};v(he,T=>{e(U)&&T(pe)})}var xe=s(he,2);{var Be=T=>{var O=ur(),W=a(O),qe=s(a(W),2);{var Ne=Je=>{var Ye=cr(),$e=a(Ye);t(Ye),u(()=>{gt(Ye,`color: ${e(G).color??""}`),d($e,`${e(G).emoji??""} ${e(G).label??""}`)}),l(Je,Ye)};v(qe,Je=>{e(G)&&Je(Ne)})}t(W);var f=s(W,2),k=a(f);t(f);var L=s(f,2),H=a(L),Ae=a(H);t(H);var Pe=s(H,2),ot=a(Pe);t(Pe);var Ze=s(Pe,2),He=a(Ze);t(Ze),t(L),t(O),u((Je,Ye,$e)=>{gt(k,`width: ${e(ie)??""}%`),d(Ae,`OG: ${Je??""}`),d(ot,`${Ye??""}%`),d(He,`FG: ${$e??""}`)},[()=>At(h()??e(w).predicted_og??0),()=>e(ie).toFixed(0),()=>At(e(w).predicted_fg??0)]),l(T,O)};v(xe,T=>{e(ie)!==null&&T(Be)})}var Se=s(xe,2),Re=a(Se);{var ze=T=>{var O=_r(),W=s(a(O),2),qe=a(W,!0);t(W),t(O),u(Ne=>d(qe,Ne),[()=>At(e(w).predicted_fg)]),l(T,O)};v(Re,T=>{e(w).predicted_fg&&T(ze)})}var Ce=s(Re,2);{var We=T=>{var O=pr(),W=s(a(O),2),qe=a(W);t(W),t(O),u(Ne=>d(qe,`${Ne??""}%`),[()=>e(C).toFixed(1)]),l(T,O)};v(Ce,T=>{e(C)!==null&&T(We)})}var g=s(Ce,2);{var te=T=>{const O=A(()=>ae(e(w).estimated_completion));var W=mr(),qe=s(a(W),2),Ne=a(qe);{var f=L=>{var H=hr();l(L,H)},k=L=>{var H=fr(),Ae=le(H),Pe=s(Ae);{var ot=Ze=>{var He=gr(),Je=a(He);t(He),u(()=>d(Je,`(${e(O)??""} ${e(O)===1?"day":"days"})`)),l(Ze,He)};v(Pe,Ze=>{e(O)!==null&&Ze(ot)})}u(Ze=>d(Ae,`${Ze??""} `),[()=>X(e(w).estimated_completion)]),l(L,H)};v(Ne,L=>{e(O)!==null&&e(O)<=0?L(f):L(k,!1)})}t(qe),t(W),l(T,W)};v(g,T=>{e(w).estimated_completion&&T(te)})}var ne=s(g,2),N=a(ne);{var se=T=>{var O=br(),W=s(a(O),2),qe=a(W,!0);t(W),t(O),u(()=>d(qe,e(w).model_type)),l(T,O)};v(N,T=>{e(w).model_type&&T(se)})}var ve=s(N,2);{var Xe=T=>{var O=yr(),W=s(a(O),2),qe=a(W);t(W),t(O),u(Ne=>d(qe,`${Ne??""}%`),[()=>(e(w).r_squared*100).toFixed(0)]),l(T,O)};v(ve,T=>{e(w).r_squared!==void 0&&T(Xe)})}var Ge=s(ve,2);{var Qe=T=>{var O=xr(),W=s(a(O),2),qe=a(W,!0);t(W),t(O),u(()=>d(qe,e(w).num_readings)),l(T,O)};v(Ge,T=>{e(w).num_readings&&T(Qe)})}t(ne),t(Se),t(b),u(()=>{M=Ee(b,1,"ml-panel svelte-1xs394q",null,M,{"has-anomaly":e(U)}),Z.disabled=e(R)||e(r),J.disabled=e(r)||e(R),d(je,e(r)?"Reloading...":"‚Üª")}),os(Z,()=>e(B),T=>o(B,T)),l(p,b)},x=p=>{var b=wr(),M=a(b),P=s(a(M),2);P.__click=ye;var E=a(P,!0);t(P),t(M);var Z=s(M,2),J=a(Z);{var je=pe=>{var xe=ta("Waiting for fermentation to progress (need visible SG drop)");l(pe,xe)},he=pe=>{var xe=De(),Be=le(xe);{var Se=ze=>{var Ce=ta("Need more fermentation curve data for reliable prediction");l(ze,Ce)},Re=ze=>{var Ce=De(),We=le(Ce);{var g=ne=>{var N=ta("Need at least 10 readings to make predictions");l(ne,N)},te=ne=>{var N=ta("Predictions will appear once fermentation is underway");l(ne,N)};v(We,ne=>{e(w).reason==="insufficient_data"?ne(g):ne(te,!1)},!0)}l(ze,Ce)};v(Be,ze=>{e(w).reason==="insufficient_curve_data"?ze(Se):ze(Re,!1)},!0)}l(pe,xe)};v(J,pe=>{e(w).reason==="insufficient_fermentation_progress"?pe(je):pe(he,!1)})}t(Z),t(b),u(()=>{P.disabled=e(r)||e(R),d(E,e(r)?"Reloading...":"‚Üª Reload")}),l(p,b)};v(V,p=>{e(w).available?p(fe):p(x,!1)},!0)}l(_,m)};v(_e,_=>{e(D)?_(Q):_(c,!1)},!0)}l(y,I)};v(q,y=>{e(R)?y(de):y(K,!1)})}l(Me,z),Xt()}aa(["change","click"]);var Br=n('<div class="loading svelte-1hws0u6">Loading alerts...</div>'),zr=n('<div class="error-banner svelte-1hws0u6"><span> </span> <button type="button" class="dismiss-error svelte-1hws0u6">√ó</button></div>'),Mr=n('<button type="button" class="dismiss-all-btn svelte-1hws0u6"> </button>'),Sr=n('<span class="spinner svelte-1hws0u6"></span>'),Cr=da('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1hws0u6"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg>'),qr=n('<div class="alert-item svelte-1hws0u6"><div class="alert-icon svelte-1hws0u6"> </div> <div class="alert-content svelte-1hws0u6"><div class="alert-header svelte-1hws0u6"><span class="alert-type svelte-1hws0u6"> </span> <span class="severity-badge svelte-1hws0u6"> </span></div> <p class="alert-message svelte-1hws0u6"> </p> <div class="alert-meta svelte-1hws0u6"><span class="alert-time svelte-1hws0u6"> </span> <span class="alert-separator svelte-1hws0u6">¬∑</span> <span class="alert-time svelte-1hws0u6"> </span></div></div> <button type="button" class="dismiss-btn svelte-1hws0u6" title="Dismiss alert"><!></button></div>'),Fr=n('<!> <div class="alerts-header svelte-1hws0u6"><span class="alert-count svelte-1hws0u6"> </span> <!></div> <div class="alerts-list svelte-1hws0u6"></div>',1);function Tr(Me,i){Wt(i,!0);let h=Y(_t([])),j=Y(!0),S=Y(null),w=Y(null),R=Y(!1);Ba(()=>{r()});async function r(){try{o(j,!0),o(S,null),o(h,await ms(i.batchId,!1),!0)}catch(C){o(S,C instanceof Error?C.message:"Failed to load alerts",!0)}finally{o(j,!1)}}async function D(C){try{o(w,C,!0),await bs(i.batchId,C),o(h,e(h).filter(G=>G.id!==C),!0)}catch(G){o(S,G instanceof Error?G.message:"Failed to dismiss alert",!0)}finally{o(w,null)}}async function B(){try{o(R,!0),await ys(i.batchId),o(h,[],!0)}catch(C){o(S,C instanceof Error?C.message:"Failed to dismiss alerts",!0)}finally{o(R,!1)}}function ue(C){switch(C){case"critical":return"var(--negative)";case"warning":return"var(--warning)";case"info":return"var(--accent)";default:return"var(--text-muted)"}}function be(C){switch(C){case"stall":return"‚è∏";case"temperature_high":return"üî•";case"temperature_low":return"‚ùÑ";case"anomaly":return"‚ö†";default:return"‚ö†"}}function ye(C){const G=new Date(C),ee=new Date().getTime()-G.getTime(),z=Math.floor(ee/6e4),q=Math.floor(z/60),de=Math.floor(q/24);return de>0?`${de}d ago`:q>0?`${q}h ago`:z>0?`${z}m ago`:"just now"}var F=De(),X=le(F);{var ae=C=>{ma(C,{title:"Alerts",icon:"üîî",children:(G,U)=>{var ee=Br();l(G,ee)},$$slots:{default:!0}})},ie=C=>{var G=De(),U=le(G);{var ee=q=>{},z=q=>{ma(q,{title:"Active Alerts",icon:"üîî",highlight:!0,children:(de,K)=>{var y=Fr(),I=le(y);{var _e=x=>{var p=zr(),b=a(p),M=a(b,!0);t(b);var P=s(b,2);P.__click=()=>o(S,null),t(p),u(()=>d(M,e(S))),l(x,p)};v(I,x=>{e(S)&&x(_e)})}var Q=s(I,2),c=a(Q),_=a(c);t(c);var m=s(c,2);{var V=x=>{var p=Mr();p.__click=B;var b=a(p,!0);t(p),u(()=>{p.disabled=e(R),d(b,e(R)?"Dismissing...":"Dismiss All")}),l(x,p)};v(m,x=>{e(h).length>1&&x(V)})}t(Q);var fe=s(Q,2);oa(fe,21,()=>e(h),x=>x.id,(x,p)=>{var b=qr(),M=a(b),P=a(M,!0);t(M);var E=s(M,2),Z=a(E),J=a(Z),je=a(J,!0);t(J);var he=s(J,2),pe=a(he,!0);t(he),t(Z);var xe=s(Z,2),Be=a(xe,!0);t(xe);var Se=s(xe,2),Re=a(Se),ze=a(Re);t(Re);var Ce=s(Re,4),We=a(Ce);t(Ce),t(Se),t(E);var g=s(E,2);g.__click=()=>D(e(p).id);var te=a(g);{var ne=se=>{var ve=Sr();l(se,ve)},N=se=>{var ve=Cr();l(se,ve)};v(te,se=>{e(w)===e(p).id?se(ne):se(N,!1)})}t(g),t(b),u((se,ve,Xe,Ge,Qe,T,O,W)=>{gt(b,`--severity-color: ${se??""}`),d(P,ve),d(je,Xe),gt(he,`background: ${Ge??""}`),d(pe,e(p).severity),d(Be,e(p).message),Vt(Re,"title",`First detected: ${Qe??""}`),d(ze,`First: ${T??""}`),Vt(Ce,"title",`Last seen: ${O??""}`),d(We,`Last: ${W??""}`),g.disabled=e(w)===e(p).id},[()=>ue(e(p).severity),()=>be(e(p).alert_type),()=>e(p).alert_type.replace("_"," "),()=>ue(e(p).severity),()=>new Date(e(p).first_detected_at).toLocaleString(),()=>ye(e(p).first_detected_at),()=>new Date(e(p).last_seen_at).toLocaleString(),()=>ye(e(p).last_seen_at)]),l(x,b)}),t(fe),u(()=>d(_,`${e(h).length??""} active`)),l(de,y)},$$slots:{default:!0}})};v(U,q=>{e(h).length===0?q(ee):q(z,!1)},!0)}l(C,G)};v(X,C=>{e(j)?C(ae):C(ie,!1)})}l(Me,F),Xt()}aa(["click"]);var Rr=n("<span> </span>"),Dr=n('<div class="timer-idle svelte-ukh80y"><div class="timer-option svelte-ukh80y"><label class="option-label svelte-ukh80y">Mash Duration</label> <div class="duration-input svelte-ukh80y"><button type="button" class="duration-btn svelte-ukh80y">‚àí</button> <span class="duration-value svelte-ukh80y"> </span> <button type="button" class="duration-btn svelte-ukh80y">+</button> <span class="duration-unit svelte-ukh80y">min</span></div></div> <div class="timer-option svelte-ukh80y"><label class="option-label svelte-ukh80y">Boil Duration</label> <div class="duration-display svelte-ukh80y"><span class="duration-value svelte-ukh80y"> </span> <span class="duration-unit svelte-ukh80y">min</span></div></div> <div class="timer-actions svelte-ukh80y"><button type="button" class="start-btn mash svelte-ukh80y"><svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path></svg> Start Mash</button> <button type="button" class="start-btn boil svelte-ukh80y">Skip to Boil</button></div></div>'),Ar=n('<div class="timer-complete svelte-ukh80y"><div class="complete-icon svelte-ukh80y">‚úì</div> <p class="complete-text svelte-ukh80y">Boil complete! Time to chill the wort.</p> <button type="button" class="reset-btn svelte-ukh80y">Reset Timer</button></div>'),Pr=da('<svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path></svg> Resume',1),Or=da('<svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6"></path></svg> Pause',1),Ir=n('<span class="hop-check svelte-ukh80y">‚úì</span>'),Lr=n('<div><span class="hop-time svelte-ukh80y"> </span> <span class="hop-name svelte-ukh80y"> </span> <span class="hop-amount svelte-ukh80y"> </span> <!></div>'),Er=n('<div class="hop-schedule svelte-ukh80y"><h4 class="schedule-title svelte-ukh80y">Hop Additions</h4> <div class="hop-list svelte-ukh80y"></div></div>'),Gr=n('<button type="button" class="next-phase-btn svelte-ukh80y">Mash Done ‚Üí Start Boil</button>'),Nr=n('<div class="timer-active svelte-ukh80y"><div class="timer-display svelte-ukh80y"><span class="time-value svelte-ukh80y"> </span> <span class="time-label svelte-ukh80y">remaining</span></div> <div class="progress-bar svelte-ukh80y"><div></div></div> <div class="timer-controls svelte-ukh80y"><button type="button" class="control-btn svelte-ukh80y" title="Subtract 1 minute">‚àí1m</button> <button type="button"><!></button> <button type="button" class="control-btn svelte-ukh80y" title="Add 1 minute">+1m</button></div> <!> <div class="phase-actions svelte-ukh80y"><!> <button type="button" class="reset-btn svelte-ukh80y">Reset</button></div></div>'),Hr=n('<div class="timer-card svelte-ukh80y"><div class="timer-header svelte-ukh80y"><h3 class="timer-title svelte-ukh80y">Brew Day Timer</h3> <!></div> <!></div>');function Ur(Me,i){Wt(i,!0);let h=Y("idle"),j=Y(0),S=null,w=Y(!1),R=Y(_t(new Set)),r=Y(60),D=A(()=>i.recipe.boil_time_minutes||60),B=A(()=>i.recipe.hops?i.recipe.hops.filter(c=>c.timing?.use==="add_to_boil"||!c.timing?.use).map(c=>({name:c.name,amount:c.amount_grams,time:c.timing?.duration?.value||0,unit:c.timing?.duration?.unit||"min"})).sort((c,_)=>_.time-c.time):[]),ue=A(()=>{const c=Math.floor(e(j)/60),_=e(j)%60;return`${c.toString().padStart(2,"0")}:${_.toString().padStart(2,"0")}`}),be=A(()=>e(h)==="mash"?(e(r)*60-e(j))/(e(r)*60)*100:e(h)==="boil"?(e(D)*60-e(j))/(e(D)*60)*100:0),ye=A(()=>{switch(e(h)){case"mash":return"Mash";case"boil":return"Boil";case"complete":return"Complete!";default:return"Ready"}});function F(){o(h,"mash"),o(j,e(r)*60),o(R,new Set,!0),ae()}function X(){o(h,"boil"),o(j,e(D)*60),o(R,new Set,!0),ae()}function ae(){S&&clearInterval(S),o(w,!1),S=setInterval(()=>{if(!e(w)&&e(j)>0){if(ts(j,-1),e(h)==="boil"){const c=Math.floor(e(j)/60);for(const _ of e(B)){const m=_.time;c===m&&!e(R).has(m)&&(e(R).add(m),ee(),z(`Add ${_.name}`,`${_.amount}g at ${m} minutes`))}}e(j)===0&&(clearInterval(S),S=null,ee(),e(h)==="mash"?z("Mash Complete","Time to sparge and start the boil!"):e(h)==="boil"&&(o(h,"complete"),z("Boil Complete","Time to chill the wort!"),i.onComplete?.()))}},1e3)}function ie(){o(w,!e(w))}function C(){S&&(clearInterval(S),S=null),o(h,"idle"),o(j,0),o(w,!1),o(R,new Set,!0)}function G(){o(j,e(j)+60)}function U(){e(j)>=60&&o(j,e(j)-60)}function ee(){try{const c=new(window.AudioContext||window.webkitAudioContext),_=c.createOscillator(),m=c.createGain();_.connect(m),m.connect(c.destination),_.frequency.value=880,_.type="sine",m.gain.value=.3,_.start(),setTimeout(()=>m.gain.value=0,150),setTimeout(()=>m.gain.value=.3,250),setTimeout(()=>m.gain.value=0,400),setTimeout(()=>m.gain.value=.3,500),setTimeout(()=>m.gain.value=0,650),setTimeout(()=>{_.stop(),c.close()},700)}catch(c){console.warn("Audio notification not available:",c)}}function z(c,_){"Notification"in window&&Notification.permission==="granted"&&new Notification(c,{body:_,icon:"/favicon.png"})}Ba(()=>("Notification"in window&&Notification.permission==="default"&&Notification.requestPermission(),()=>{S&&clearInterval(S)}));var q=Hr(),de=a(q),K=s(a(de),2);{var y=c=>{var _=Rr();let m;var V=a(_,!0);t(_),u(()=>{m=Ee(_,1,"phase-badge svelte-ukh80y",null,m,{mash:e(h)==="mash",boil:e(h)==="boil"}),d(V,e(ye))}),l(c,_)};v(K,c=>{e(h)!=="idle"&&e(h)!=="complete"&&c(y)})}t(de);var I=s(de,2);{var _e=c=>{var _=Dr(),m=a(_),V=s(a(m),2),fe=a(V);fe.__click=()=>o(r,Math.max(1,e(r)-5),!0);var x=s(fe,2),p=a(x,!0);t(x);var b=s(x,2);b.__click=()=>o(r,e(r)+5),ge(2),t(V),t(m);var M=s(m,2),P=s(a(M),2),E=a(P),Z=a(E,!0);t(E),ge(2),t(P),t(M);var J=s(M,2),je=a(J);je.__click=F;var he=s(je,2);he.__click=X,t(J),t(_),u(()=>{d(p,e(r)),d(Z,e(D))}),l(c,_)},Q=c=>{var _=De(),m=le(_);{var V=x=>{var p=Ar(),b=s(a(p),4);b.__click=C,t(p),l(x,p)},fe=x=>{var p=Nr(),b=a(p),M=a(b),P=a(M,!0);t(M),ge(2),t(b);var E=s(b,2),Z=a(E);let J;t(E);var je=s(E,2),he=a(je);he.__click=U;var pe=s(he,2);let xe;pe.__click=ie;var Be=a(pe);{var Se=se=>{var ve=Pr();ge(),l(se,ve)},Re=se=>{var ve=Or();ge(),l(se,ve)};v(Be,se=>{e(w)?se(Se):se(Re,!1)})}t(pe);var ze=s(pe,2);ze.__click=G,t(je);var Ce=s(je,2);{var We=se=>{var ve=Er(),Xe=s(a(ve),2);oa(Xe,21,()=>e(B),xa,(Ge,Qe)=>{const T=A(()=>Math.floor(e(j)/60)),O=A(()=>e(Qe).time<=e(T)&&!e(R).has(e(Qe).time)),W=A(()=>e(R).has(e(Qe).time)||e(Qe).time>e(T));var qe=Lr();let Ne;var f=a(qe),k=a(f);t(f);var L=s(f,2),H=a(L,!0);t(L);var Ae=s(L,2),Pe=a(Ae);t(Ae);var ot=s(Ae,2);{var Ze=He=>{var Je=Ir();l(He,Je)};v(ot,He=>{e(W)&&He(Ze)})}t(qe),u(()=>{Ne=Ee(qe,1,"hop-item svelte-ukh80y",null,Ne,{next:e(O),done:e(W)}),d(k,`${e(Qe).time??""}m`),d(H,e(Qe).name),d(Pe,`${e(Qe).amount??""}g`)}),l(Ge,qe)}),t(Xe),t(ve),l(se,ve)};v(Ce,se=>{e(h)==="boil"&&e(B).length>0&&se(We)})}var g=s(Ce,2),te=a(g);{var ne=se=>{var ve=Gr();ve.__click=X,l(se,ve)};v(te,se=>{e(h)==="mash"&&se(ne)})}var N=s(te,2);N.__click=C,t(g),t(p),u(()=>{d(P,e(ue)),J=Ee(Z,1,"progress-fill svelte-ukh80y",null,J,{mash:e(h)==="mash",boil:e(h)==="boil"}),gt(Z,`width: ${e(be)??""}%`),xe=Ee(pe,1,"control-btn pause svelte-ukh80y",null,xe,{paused:e(w)})}),l(x,p)};v(m,x=>{e(h)==="complete"?x(V):x(fe,!1)},!0)}l(c,_)};v(I,c=>{e(h)==="idle"?c(_e):c(Q,!1)})}t(q),l(Me,q),Xt()}aa(["click"]);var Vr=n('<button type="button" class="remove-btn svelte-ue9vqt" title="Remove item">√ó</button>'),Wr=n('<label><input type="checkbox" class="svelte-ue9vqt"/> <span class="item-text svelte-ue9vqt"> </span> <!></label>'),Xr=n('<div class="category-group svelte-ue9vqt"><h4 class="category-title svelte-ue9vqt"> </h4> <div class="items-list svelte-ue9vqt"></div></div>'),Jr=n('<div class="add-form svelte-ue9vqt"><input type="text" class="add-input svelte-ue9vqt" placeholder="Add custom item..."/> <button type="button" class="add-btn svelte-ue9vqt">Add</button> <button type="button" class="cancel-btn svelte-ue9vqt">Cancel</button></div>'),Yr=n('<button type="button" class="show-add-btn svelte-ue9vqt"><svg class="btn-icon svelte-ue9vqt" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path></svg> Add custom item</button>'),Kr=n('<div class="checklist-card svelte-ue9vqt"><div class="checklist-header svelte-ue9vqt"><div class="header-left svelte-ue9vqt"><h3 class="checklist-title svelte-ue9vqt">Brew Day Checklist</h3> <span class="progress-badge svelte-ue9vqt"> </span></div> <button type="button" class="reset-btn svelte-ue9vqt" title="Reset all items"><svg class="btn-icon svelte-ue9vqt" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg></button></div> <div class="progress-bar svelte-ue9vqt"><div class="progress-fill svelte-ue9vqt"></div></div> <div class="checklist-groups svelte-ue9vqt"></div> <div class="add-section svelte-ue9vqt"><!></div></div>');function Qr(Me,i){Wt(i,!0);let h=Y(_t([])),j=Y(""),S=Y(!1),w=A(()=>`brewday-checklist-${i.batchId}`);function R(){const c=[];return c.push({id:"prep-sanitize",text:"Sanitize all equipment",checked:!1,category:"prep"}),c.push({id:"prep-water",text:`Heat strike water (${i.recipe.batch_size_liters?Math.round(i.recipe.batch_size_liters*1.3):"--"}L)`,checked:!1,category:"prep"}),i.recipe.fermentables&&i.recipe.fermentables.forEach((_,m)=>{const V=_.amount_kg?`${(_.amount_kg*1e3).toFixed(0)}g`:"";c.push({id:`ferm-${m}`,text:`Mill grain: ${_.name} ${V}`,checked:!1,category:"prep"})}),c.push({id:"mash-dough-in",text:"Dough in - add grain to strike water",checked:!1,category:"mash"}),c.push({id:"mash-temp",text:"Check mash temperature",checked:!1,category:"mash"}),c.push({id:"mash-rest",text:"Mash rest complete",checked:!1,category:"mash"}),c.push({id:"mash-sparge",text:"Sparge and collect wort",checked:!1,category:"mash"}),c.push({id:"boil-preboil",text:"Record pre-boil gravity",checked:!1,category:"boil"}),c.push({id:"boil-start",text:"Bring to boil",checked:!1,category:"boil"}),i.recipe.hops&&i.recipe.hops.filter(m=>m.timing?.use==="add_to_boil"||!m.timing?.use).sort((m,V)=>(V.timing?.duration?.value||0)-(m.timing?.duration?.value||0)).forEach((m,V)=>{const fe=m.timing?.duration?.value||0,x=m.amount_grams?`${m.amount_grams}g`:"";c.push({id:`hop-${V}`,text:`Add ${m.name} ${x} @ ${fe}min`,checked:!1,category:"boil"})}),c.push({id:"postboil-flame-off",text:"Flame off / end boil",checked:!1,category:"post-boil"}),c.push({id:"postboil-chill",text:"Chill wort to pitch temp",checked:!1,category:"post-boil"}),c.push({id:"postboil-og",text:"Record original gravity (OG)",checked:!1,category:"post-boil"}),c.push({id:"postboil-transfer",text:"Transfer to fermenter",checked:!1,category:"post-boil"}),c.push({id:"postboil-yeast",text:"Pitch yeast",checked:!1,category:"post-boil"}),c.push({id:"postboil-airlock",text:"Seal fermenter and add airlock",checked:!1,category:"post-boil"}),c}function r(){try{const c=localStorage.getItem(e(w));if(c){const _=JSON.parse(c),m=R(),V=new Map(_.map(x=>[x.id,x]));for(const x of m){const p=V.get(x.id);p&&(x.checked=p.checked)}const fe=_.filter(x=>x.category==="custom");o(h,[...m,...fe],!0)}else o(h,R(),!0)}catch{o(h,R(),!0)}}function D(){try{localStorage.setItem(e(w),JSON.stringify(e(h)))}catch(c){console.warn("Failed to save checklist:",c)}}function B(c){o(h,e(h).map(_=>_.id===c?{..._,checked:!_.checked}:_),!0),D()}function ue(){if(!e(j).trim())return;const c={id:`custom-${Date.now()}`,text:e(j).trim(),checked:!1,category:"custom"};o(h,[...e(h),c],!0),o(j,""),o(S,!1),D()}function be(c){o(h,e(h).filter(_=>_.id!==c),!0),D()}function ye(){confirm("Reset all checklist items to unchecked?")&&(o(h,e(h).map(c=>({...c,checked:!1})),!0),D())}let F=A(()=>{if(e(h).length===0)return 0;const c=e(h).filter(_=>_.checked).length;return Math.round(c/e(h).length*100)}),X=A(()=>{const c={prep:[],mash:[],boil:[],"post-boil":[],custom:[]};for(const _ of e(h))c[_.category].push(_);return c});const ae={prep:"Preparation",mash:"Mash",boil:"Boil","post-boil":"Post-Boil",custom:"Custom"};Ba(()=>{r()});var ie=Kr(),C=a(ie),G=a(C),U=s(a(G),2),ee=a(U);t(U),t(G);var z=s(G,2);z.__click=ye,t(C);var q=s(C,2),de=a(q);t(q);var K=s(q,2);oa(K,21,()=>Object.entries(e(X)),xa,(c,_)=>{var m=A(()=>as(e(_),2));let V=()=>e(m)[0],fe=()=>e(m)[1];var x=De(),p=le(x);{var b=M=>{var P=Xr(),E=a(P),Z=a(E,!0);t(E);var J=s(E,2);oa(J,21,fe,je=>je.id,(je,he)=>{var pe=Wr();let xe;var Be=a(pe);Dt(Be),Be.__change=()=>B(e(he).id);var Se=s(Be,2),Re=a(Se,!0);t(Se);var ze=s(Se,2);{var Ce=We=>{var g=Vr();g.__click=()=>be(e(he).id),l(We,g)};v(ze,We=>{e(he).category==="custom"&&We(Ce)})}t(pe),u(()=>{xe=Ee(pe,1,"checklist-item svelte-ue9vqt",null,xe,{checked:e(he).checked}),vs(Be,e(he).checked),d(Re,e(he).text)}),l(je,pe)}),t(J),t(P),u(()=>d(Z,ae[V()])),l(M,P)};v(p,M=>{fe().length>0&&M(b)})}l(c,x)}),t(K);var y=s(K,2),I=a(y);{var _e=c=>{var _=Jr(),m=a(_);Dt(m),m.__keydown=x=>x.key==="Enter"&&ue();var V=s(m,2);V.__click=ue;var fe=s(V,2);fe.__click=()=>{o(S,!1),o(j,"")},t(_),Rt(m,()=>e(j),x=>o(j,x)),l(c,_)},Q=c=>{var _=Yr();_.__click=()=>o(S,!0),l(c,_)};v(I,c=>{e(S)?c(_e):c(Q,!1)})}t(y),t(ie),u(()=>{d(ee,`${e(F)??""}%`),gt(de,`width: ${e(F)??""}%`)}),l(Me,ie),Xt()}aa(["click","change","keydown"]);var Zr=n('<span class="save-indicator svelte-1hyfh06"> </span>'),$r=n('<span class="summary-value svelte-1hyfh06"> </span>'),el=n('<span class="summary-value svelte-1hyfh06"> </span>'),tl=n('<span class="target svelte-1hyfh06"> </span>'),al=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Mash Temperature</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06"> </span></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Mash pH</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.01" min="4" max="7" class="field-input svelte-1hyfh06" placeholder="--"/></div> <span class="target svelte-1hyfh06">Target: 5.2-5.6</span></div></div> <div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Strike Water Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div></div></div></div>'),sl=n('<span class="summary-value svelte-1hyfh06"> </span>'),rl=n('<span class="summary-value svelte-1hyfh06"> </span>'),ll=n('<span class="target svelte-1hyfh06"> </span>'),il=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Pre-Boil Gravity</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.001" min="1.000" max="1.200" class="field-input svelte-1hyfh06" placeholder="1.0XX"/></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Pre-Boil Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div></div></div></div>'),nl=n('<span class="summary-value og svelte-1hyfh06"> </span>'),vl=n('<span class="summary-value svelte-1hyfh06"> </span>'),ol=n('<span class="target svelte-1hyfh06"> </span>'),dl=n('<span class="target svelte-1hyfh06"> </span>'),cl=n('<span class="target svelte-1hyfh06"> </span>'),ul=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Original Gravity (OG)</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.001" min="1.000" max="1.200" class="field-input og-input svelte-1hyfh06" placeholder="1.0XX"/></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Post-Boil Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div> <!></div></div> <div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Brewhouse Efficiency</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" min="0" max="100" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">%</span></div> <!></div></div></div>'),_l=n('<span class="has-notes svelte-1hyfh06">Has notes</span>'),pl=n('<div class="section-content svelte-1hyfh06"><textarea class="notes-input svelte-1hyfh06" placeholder="Record any deviations, substitutions, or observations..." rows="4"></textarea></div>'),hl=n('<div class="saving-indicator svelte-1hyfh06"><span class="spinner svelte-1hyfh06"></span> Saving...</div>'),gl=n('<div class="observations-card svelte-1hyfh06"><div class="card-header svelte-1hyfh06"><h3 class="card-title svelte-1hyfh06">Brew Day Log</h3> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Mash</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Pre-Boil</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Post-Boil / OG</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Brew Day Notes</span> <!> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <!></div>');function fl(Me,i){Wt(i,!0);let h=Y(_t(i.batch.actual_mash_temp??null)),j=Y(_t(i.batch.actual_mash_ph??null)),S=Y(_t(i.batch.strike_water_volume??null)),w=Y(_t(i.batch.pre_boil_gravity??null)),R=Y(_t(i.batch.pre_boil_volume??null)),r=Y(_t(i.batch.post_boil_volume??null)),D=Y(_t(i.batch.measured_og??null)),B=Y(_t(i.batch.actual_efficiency??null)),ue=Y(_t(i.batch.brew_day_notes??"")),be=Y(!1),ye=Y(null),F=Y("mash"),X=A(Ta),ae=A(()=>i.recipe.mash_temp),ie=A(()=>i.recipe.og),C=A(()=>i.recipe.pre_boil_og),G=A(()=>i.recipe.batch_size_liters),U=A(()=>i.recipe.efficiency);function ee(){if(!e(D)||!e(ie)||!e(U))return null;const f=(e(D)-1)*1e3,k=(e(ie)-1)*1e3;return k===0?null:f/k*e(U)}Ba(()=>{if(e(D)&&!e(B)){const f=ee();f&&o(B,Math.round(f*10)/10)}});async function z(){if(!e(be)){o(be,!0);try{const f={actual_mash_temp:e(h)??void 0,actual_mash_ph:e(j)??void 0,strike_water_volume:e(S)??void 0,pre_boil_gravity:e(w)??void 0,pre_boil_volume:e(R)??void 0,post_boil_volume:e(r)??void 0,measured_og:e(D)??void 0,actual_efficiency:e(B)??void 0,brew_day_notes:e(ue)||void 0},k=await fa(i.batch.id,f);o(ye,new Date,!0),i.onUpdate?.(k)}catch(f){console.error("Failed to save observations:",f)}finally{o(be,!1)}}}function q(f){o(F,e(F)===f?null:f,!0)}var de=gl(),K=a(de),y=s(a(K),2);{var I=f=>{var k=Zr(),L=a(k);t(k),u(H=>d(L,`Saved ${H??""}`),[()=>e(ye).toLocaleTimeString()]),l(f,k)};v(y,f=>{e(ye)&&f(I)})}t(K);var _e=s(K,2);let Q;var c=a(_e);c.__click=()=>q("mash");var _=s(a(c),2),m=a(_);{var V=f=>{var k=$r(),L=a(k);t(k),u(H=>d(L,`${H??""}${e(X)??""}`),[()=>ja(e(h))]),l(f,k)};v(m,f=>{e(h)&&f(V)})}var fe=s(m,2);{var x=f=>{var k=el(),L=a(k);t(k),u(H=>d(L,`pH ${H??""}`),[()=>e(j).toFixed(2)]),l(f,k)};v(fe,f=>{e(j)&&f(x)})}t(_),ge(2),t(c);var p=s(c,2);{var b=f=>{var k=al(),L=a(k),H=a(L),Ae=s(a(H),2),Pe=a(Ae);Dt(Pe);var ot=s(Pe,2),Ze=a(ot,!0);t(ot),t(Ae);var He=s(Ae,2);{var Je=Ue=>{var Jt=tl(),Ie=a(Jt);t(Jt),u(lt=>d(Ie,`Target: ${lt??""}${e(X)??""}`),[()=>ja(e(ae))]),l(Ue,Jt)};v(He,Ue=>{e(ae)&&Ue(Je)})}t(H);var Ye=s(H,2),$e=s(a(Ye),2),kt=a($e);Dt(kt),t($e),ge(2),t(Ye),t(L);var Pt=s(L,2),Ot=a(Pt),It=s(a(Ot),2),wt=a(It);Dt(wt),ge(2),t(It),t(Ot),t(Pt),t(k),u(()=>d(Ze,e(X))),Ut("blur",Pe,z),Rt(Pe,()=>e(h),Ue=>o(h,Ue)),Ut("blur",kt,z),Rt(kt,()=>e(j),Ue=>o(j,Ue)),Ut("blur",wt,z),Rt(wt,()=>e(S),Ue=>o(S,Ue)),l(f,k)};v(p,f=>{e(F)==="mash"&&f(b)})}t(_e);var M=s(_e,2);let P;var E=a(M);E.__click=()=>q("preboil");var Z=s(a(E),2),J=a(Z);{var je=f=>{var k=sl(),L=a(k,!0);t(k),u(H=>d(L,H),[()=>At(e(w))]),l(f,k)};v(J,f=>{e(w)&&f(je)})}var he=s(J,2);{var pe=f=>{var k=rl(),L=a(k);t(k),u(H=>d(L,`${H??""}L`),[()=>e(R).toFixed(1)]),l(f,k)};v(he,f=>{e(R)&&f(pe)})}t(Z),ge(2),t(E);var xe=s(E,2);{var Be=f=>{var k=il(),L=a(k),H=a(L),Ae=s(a(H),2),Pe=a(Ae);Dt(Pe),t(Ae);var ot=s(Ae,2);{var Ze=$e=>{var kt=ll(),Pt=a(kt);t(kt),u(Ot=>d(Pt,`Target: ${Ot??""}`),[()=>At(e(C))]),l($e,kt)};v(ot,$e=>{e(C)&&$e(Ze)})}t(H);var He=s(H,2),Je=s(a(He),2),Ye=a(Je);Dt(Ye),ge(2),t(Je),t(He),t(L),t(k),Ut("blur",Pe,z),Rt(Pe,()=>e(w),$e=>o(w,$e)),Ut("blur",Ye,z),Rt(Ye,()=>e(R),$e=>o(R,$e)),l(f,k)};v(xe,f=>{e(F)==="preboil"&&f(Be)})}t(M);var Se=s(M,2);let Re;var ze=a(Se);ze.__click=()=>q("postboil");var Ce=s(a(ze),2),We=a(Ce);{var g=f=>{var k=nl(),L=a(k,!0);t(k),u(H=>d(L,H),[()=>At(e(D))]),l(f,k)};v(We,f=>{e(D)&&f(g)})}var te=s(We,2);{var ne=f=>{var k=vl(),L=a(k);t(k),u(H=>d(L,`${H??""}% eff`),[()=>e(B).toFixed(0)]),l(f,k)};v(te,f=>{e(B)&&f(ne)})}t(Ce),ge(2),t(ze);var N=s(ze,2);{var se=f=>{var k=ul(),L=a(k),H=a(L),Ae=s(a(H),2),Pe=a(Ae);Dt(Pe),t(Ae);var ot=s(Ae,2);{var Ze=Ie=>{var lt=ol(),Yt=a(lt);t(lt),u(sa=>d(Yt,`Target: ${sa??""}`),[()=>At(e(ie))]),l(Ie,lt)};v(ot,Ie=>{e(ie)&&Ie(Ze)})}t(H);var He=s(H,2),Je=s(a(He),2),Ye=a(Je);Dt(Ye),ge(2),t(Je);var $e=s(Je,2);{var kt=Ie=>{var lt=dl(),Yt=a(lt);t(lt),u(sa=>d(Yt,`Target: ${sa??""}L`),[()=>e(G).toFixed(1)]),l(Ie,lt)};v($e,Ie=>{e(G)&&Ie(kt)})}t(He),t(L);var Pt=s(L,2),Ot=a(Pt),It=s(a(Ot),2),wt=a(It);Dt(wt),ge(2),t(It);var Ue=s(It,2);{var Jt=Ie=>{var lt=cl(),Yt=a(lt);t(lt),u(sa=>d(Yt,`Target: ${sa??""}%`),[()=>e(U).toFixed(0)]),l(Ie,lt)};v(Ue,Ie=>{e(U)&&Ie(Jt)})}t(Ot),t(Pt),t(k),Ut("blur",Pe,z),Rt(Pe,()=>e(D),Ie=>o(D,Ie)),Ut("blur",Ye,z),Rt(Ye,()=>e(r),Ie=>o(r,Ie)),Ut("blur",wt,z),Rt(wt,()=>e(B),Ie=>o(B,Ie)),l(f,k)};v(N,f=>{e(F)==="postboil"&&f(se)})}t(Se);var ve=s(Se,2);let Xe;var Ge=a(ve);Ge.__click=()=>q("notes");var Qe=s(a(Ge),2);{var T=f=>{var k=_l();l(f,k)};v(Qe,f=>{e(ue)&&f(T)})}ge(2),t(Ge);var O=s(Ge,2);{var W=f=>{var k=pl(),L=a(k);ss(L),t(k),Ut("blur",L,z),Rt(L,()=>e(ue),H=>o(ue,H)),l(f,k)};v(O,f=>{e(F)==="notes"&&f(W)})}t(ve);var qe=s(ve,2);{var Ne=f=>{var k=hl();l(f,k)};v(qe,f=>{e(be)&&f(Ne)})}t(de),u(()=>{Q=Ee(_e,1,"section svelte-1hyfh06",null,Q,{expanded:e(F)==="mash"}),P=Ee(M,1,"section svelte-1hyfh06",null,P,{expanded:e(F)==="preboil"}),Re=Ee(Se,1,"section svelte-1hyfh06",null,Re,{expanded:e(F)==="postboil"}),Xe=Ee(ve,1,"section svelte-1hyfh06",null,Xe,{expanded:e(F)==="notes"})}),l(Me,de),Xt()}aa(["click"]);var ml=n('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),bl=n('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),yl=n('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),xl=n('<span class="recipe-type svelte-g5au2j"> </span>'),kl=n('<a class="recipe-link svelte-g5au2j"> <!></a>'),wl=n('<div class="batch-timing svelte-g5au2j"> </div>'),jl=n('<div class="batch-timing svelte-g5au2j"> </div>'),Bl=n('<option class="svelte-g5au2j"> </option>'),zl=da('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" class="svelte-g5au2j"></path><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Resume',1),Ml=da('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Pause',1),Sl=n('<button type="button"><!></button>'),Cl=n('<span class="chilling-icon svelte-g5au2j">üç∫</span> <h3 class="chilling-title svelte-g5au2j">Ready to Pitch!</h3>',1),ql=n('<span class="chilling-icon svelte-g5au2j">‚ùÑÔ∏è</span> <h3 class="chilling-title svelte-g5au2j">Chilling to Pitch Temperature</h3>',1),Fl=n('<div class="progress-section svelte-g5au2j"><div class="progress-bar svelte-g5au2j"><div class="progress-fill svelte-g5au2j"></div></div> <span class="progress-text svelte-g5au2j"> </span></div>'),Tl=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è No cooler configured - set a cooler entity to enable automated chilling</span>'),Rl=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è Temperature control disabled in settings</span>'),Dl=n('<span class="status-ready svelte-g5au2j">Wort has reached pitch temperature - ready to add yeast!</span>'),Al=n('<span class="status-active svelte-g5au2j">Cooler will run automatically when temp exceeds target + hysteresis</span>'),Pl=n('<div><div class="chilling-header svelte-g5au2j"><!></div> <div class="chilling-content svelte-g5au2j"><div class="temp-display svelte-g5au2j"><div class="temp-current svelte-g5au2j"><span class="temp-label svelte-g5au2j">Current</span> <span class="temp-value svelte-g5au2j"> </span></div> <div class="temp-arrow svelte-g5au2j">‚Üí</div> <div class="temp-target svelte-g5au2j"><span class="temp-label svelte-g5au2j">Target</span> <span class="temp-value svelte-g5au2j"> </span></div></div> <!> <div class="chilling-status svelte-g5au2j"><!></div></div></div>'),Ol=n(`<div class="paused-banner svelte-g5au2j"><div class="paused-header svelte-g5au2j"><svg class="paused-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> <h3 class="paused-title svelte-g5au2j">Readings Paused</h3></div> <p class="paused-text svelte-g5au2j">Hydrometer readings are not being stored. Live readings still display but won't be saved to the fermentation history.</p> <button type="button" class="resume-btn svelte-g5au2j"> </button></div>`),Il=n('<span class="btn-spinner svelte-g5au2j"></span> Starting...',1),Ll=da('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" class="svelte-g5au2j"></path><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Start Brew Day',1),El=n(`<div class="planning-phase svelte-g5au2j"><div class="phase-action-card svelte-g5au2j"><div class="phase-icon svelte-g5au2j">üìã</div> <h2 class="phase-title svelte-g5au2j">Ready to Brew?</h2> <p class="phase-description svelte-g5au2j">Review your recipe below, then start brew day when you're ready to begin.</p> <button type="button" class="start-brewday-btn svelte-g5au2j"><!></button></div> <!></div>`),Gl=n('<span class="btn-spinner svelte-g5au2j"></span> Starting...',1),Nl=da('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" class="svelte-g5au2j"></path></svg> Yeast Pitched - Start Fermentation',1),Hl=n(`<div class="brewing-phase svelte-g5au2j"><div class="phase-action-card brewing svelte-g5au2j"><div class="phase-icon svelte-g5au2j">üç∫</div> <h2 class="phase-title svelte-g5au2j">Brew Day in Progress</h2> <p class="phase-description svelte-g5au2j">Track your brew day activities. When you've pitched the yeast and fermentation begins, transition to the fermentation phase.</p> <button type="button" class="start-fermentation-btn svelte-g5au2j"><!></button></div> <div class="brewday-tools-grid svelte-g5au2j"><!> <!></div> <!> <!> <!></div>`),Ul=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot brewing svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Brew Day</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Vl=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot fermenting svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Fermentation Started</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Wl=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot conditioning svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Conditioning Started</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Xl=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot completed svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Completed</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Jl=n('<div class="completed-phase svelte-g5au2j"><div class="batch-summary-card svelte-g5au2j"><h2 class="summary-title svelte-g5au2j">Batch Complete</h2> <div class="summary-stats svelte-g5au2j"><div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Original Gravity</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Final Gravity</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">ABV</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Attenuation</span> <span class="stat-value svelte-g5au2j"><!></span></div></div></div> <div class="timeline-card svelte-g5au2j"><h3 class="timeline-title svelte-g5au2j">Batch Timeline</h3> <div class="timeline svelte-g5au2j"><!> <!> <!> <!></div></div> <!></div>'),Yl=n('<span class="status-badge heater svelte-g5au2j">üî• Heating</span>'),Kl=n('<span class="status-badge cooler svelte-g5au2j">‚ùÑÔ∏è Cooling</span>'),Ql=n('<span class="status-badge idle svelte-g5au2j"> </span>'),Zl=n('<div class="device-status heater svelte-g5au2j"><div>üî•</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Heater</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),$l=n('<div class="device-status cooler svelte-g5au2j"><div>‚ùÑÔ∏è</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Cooler</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),ei=n('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">‚ö°</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),ti=n('<button type="button" class="override-btn heat-on svelte-g5au2j">Force Heat ON</button> <button type="button" class="override-btn heat-off svelte-g5au2j">Force Heat OFF</button>',1),ai=n('<button type="button" class="override-btn cool-on svelte-g5au2j">Force Cool ON</button> <button type="button" class="override-btn cool-off svelte-g5au2j">Force Cool OFF</button>',1),si=n('<div class="control-details svelte-g5au2j"><div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns-grid svelte-g5au2j"><!> <!> <button type="button" class="override-btn auto-mode svelte-g5au2j">Auto Mode</button></div></div>',1),ri=n('<div class="device-status-grid svelte-g5au2j"><!> <!></div> <!>',1),li=n('<div><button type="button" class="collapsible-header svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="collapse-indicator svelte-g5au2j"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" class="svelte-g5au2j"></path></svg></div></button> <!></div>'),ii=n('<span class="svelte-g5au2j"> </span>'),ni=n('<span class="svelte-g5au2j"> </span>'),vi=n('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><!> <!> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),oi=n('<div class="chart-section svelte-g5au2j"><!></div>'),di=n('<div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!> <!></div></div> <!>',1),ci=n('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <!> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j" aria-label="Delete batch"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <!> <!> <!>',1),ui=n('<div class="modal-overlay svelte-g5au2j" role="presentation"><div class="modal svelte-g5au2j" role="dialog" aria-modal="true" aria-labelledby="delete-modal-title" tabindex="-1"><h2 id="delete-modal-title" class="modal-title svelte-g5au2j">Delete Batch?</h2> <p class="modal-text svelte-g5au2j"> </p> <div class="modal-actions svelte-g5au2j"><button type="button" class="modal-btn cancel svelte-g5au2j">Cancel</button> <button type="button" class="modal-btn delete svelte-g5au2j"> </button></div></div></div>'),_i=n('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div> <!>',1);function Pi(Me,i){Wt(i,!0);const h=()=>_s(ps,"$page",j),[j,S]=us();let w=null,R=null,r=Y(null),D=Y(null),B=Y(null),ue=_t([]),be=Y(!0),ye=Y(null),F=Y(!1),X=Y(!1),ae=Y(!1),ie=Y(!1),C=Y(!1),G=Y(!1),U=Y(!1),ee=A(()=>parseInt(h().params.id??"0"));const z=["planning","brewing","fermenting","conditioning","completed","archived"];let q=A(()=>e(r)?qa[e(r).status]:qa.planning),de=A(Ta),K=A(()=>wa.config.ha_enabled&&wa.config.temp_control_enabled&&(e(r)?.heater_entity_id||e(r)?.cooler_entity_id)),y=A(()=>e(r)?.status==="planning"&&e(r)?.temp_target!=null),I=A(()=>!e(y)||!e(Q)?.temp||!e(r)?.temp_target?!1:e(Q).temp<=e(r).temp_target),_e=A(()=>{if(!e(y)||!e(Q)?.temp||!e(r)?.temp_target)return null;const g=e(r).temp_target+30,te=e(Q).temp,ne=e(r).temp_target;if(te<=ne)return 100;if(te>=g)return 0;const N=(g-te)/(g-ne)*100;return Math.min(100,Math.max(0,N))}),Q=A(()=>{if(!e(r)?.device_id)return null;const g=Ga.tilts.get(e(r).device_id);if(g)return g;const te=e(r).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!te?.[1])return null;const ne=te[1].toUpperCase();for(const N of Ga.tilts.values())if(N.color&&N.color.toUpperCase()===ne)return N;return null});async function c(){o(be,!0),o(ye,null);try{if(o(r,await xs(e(ee)),!0),e(r).status==="fermenting"||e(r).status==="conditioning")try{o(D,await Sa(e(ee)),!0)}catch{}if(e(r).heater_entity_id||e(r).cooler_entity_id)try{o(B,await ka(e(ee)),!0)}catch{}}catch(g){o(ye,g instanceof Error?g.message:"Failed to load batch",!0)}finally{o(be,!1)}}async function _(g){if(!(!e(r)||e(X))&&!(g==="conditioning"&&e(r).status==="fermenting"&&!confirm(`üí° Entering Conditioning Phase

Reminder: Adjust target temperature if cold crashing.
Temperature control will continue during conditioning.

Continue?`))){o(X,!0);try{o(r,await fa(e(r).id,{status:g}),!0),(g==="fermenting"||g==="conditioning")&&o(D,await Sa(e(r).id),!0)}catch(te){console.error("Failed to update status:",te)}finally{o(X,!1)}}}async function m(){if(!(!e(r)||e(X))){o(X,!0);try{o(r,await fa(e(r).id,{status:"brewing"}),!0)}catch(g){console.error("Failed to start brew day:",g)}finally{o(X,!1)}}}async function V(){if(!(!e(r)||e(X))){o(X,!0);try{o(r,await fa(e(r).id,{status:"fermenting"}),!0),o(D,await Sa(e(r).id),!0)}catch(g){console.error("Failed to start fermentation:",g)}finally{o(X,!1)}}}async function fe(g){if(e(r)&&(o(r,await fa(e(r).id,g),!0),o(F,!1),e(r).heater_entity_id||e(r).cooler_entity_id))try{o(B,await ka(e(r).id),!0)}catch{}}async function x(){if(e(r)){o(C,!0);try{await ks(e(r).id),hs("/batches")}catch(g){o(ye,g instanceof Error?g.message:"Failed to delete batch",!0),o(C,!1),o(ie,!1)}}}async function p(){if(!(!e(r)||e(U))){o(U,!0);try{o(r,await fa(e(r).id,{readings_paused:!e(r).readings_paused}),!0)}catch(g){console.error("Failed to toggle pause:",g)}finally{o(U,!1)}}}async function b(g,te){if(!(!e(r)||e(ae))){o(ae,!0);try{await Ca(e(r).id,te,60,g),o(B,await ka(e(r).id),!0)}catch(ne){console.error("Failed to set override:",ne)}finally{o(ae,!1)}}}async function M(){if(!(!e(r)||e(ae))){o(ae,!0);try{e(r).heater_entity_id&&await Ca(e(r).id,null,60,"heater"),e(r).cooler_entity_id&&await Ca(e(r).id,null,60,"cooler"),o(B,await ka(e(r).id),!0)}catch(g){console.error("Failed to clear overrides:",g)}finally{o(ae,!1)}}}function P(){if(w?.readyState===WebSocket.OPEN)return;const te=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;w=new WebSocket(te),w.onmessage=async ne=>{try{const N=JSON.parse(ne.data);N.type==="control_event"&&N.batch_id===e(ee)&&e(B)&&(N.action==="heat_on"?o(B,{...e(B),heater_state:"on"},!0):N.action==="heat_off"?o(B,{...e(B),heater_state:"off"},!0):N.action==="cool_on"?o(B,{...e(B),cooler_state:"on"},!0):N.action==="cool_off"&&o(B,{...e(B),cooler_state:"off"},!0))}catch{}},w.onclose=()=>{w=null,R=setTimeout(P,3e3)},w.onerror=()=>{w?.close()}}function E(){R&&(clearTimeout(R),R=null),w?.close(),w=null}function Z(g){return g==null?"--":At(g)}function J(g){return g==null?"--":ja(g)}function je(g){return g?new Date(g).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"--"}function he(g){if(!g)return"--";const te=new Date(g),N=(new Date().getTime()-te.getTime())/(1e3*60*60);if(N<1)return`${Math.round(N*60)}m`;if(N<24)return`${N.toFixed(1)}h`;const se=N/24;return se<7?`${se.toFixed(1)}d`:`${Math.round(se)}d`}function pe(g){return g?new Date(g).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"}):"--"}Ua(()=>{c(),P()}),rs(()=>{E()});var xe=_i();ns("g5au2j",g=>{ls(()=>{is.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var Be=le(xe),Se=s(a(Be),2);{var Re=g=>{var te=ml();l(g,te)},ze=g=>{var te=De(),ne=le(te);{var N=ve=>{var Xe=bl(),Ge=s(a(Xe),2),Qe=a(Ge,!0);t(Ge);var T=s(Ge,2);T.__click=c,t(Xe),u(()=>d(Qe,e(ye))),l(ve,Xe)},se=ve=>{var Xe=De(),Ge=le(Xe);{var Qe=O=>{var W=yl();l(O,W)},T=O=>{var W=De(),qe=le(W);{var Ne=k=>{ws(k,{get batch(){return e(r)},onSubmit:fe,onCancel:()=>o(F,!1)})},f=k=>{var L=ci(),H=le(L),Ae=a(H),Pe=a(Ae),ot=a(Pe);t(Pe);var Ze=s(Pe,2),He=a(Ze),Je=a(He,!0);t(He);var Ye=s(He,2);{var $e=me=>{var re=kl(),we=a(re),Le=s(we);{var et=Ke=>{var Oe=xl(),tt=a(Oe);t(Oe),u(()=>d(tt,`(${e(r).recipe.type??""})`)),l(Ke,Oe)};v(Le,Ke=>{e(r).recipe.type&&Ke(et)})}t(re),u(()=>{Vt(re,"href",`/recipes/${e(r).recipe.id??""}`),d(we,`${e(r).recipe.name??""} `)}),l(me,re)};v(Ye,me=>{e(r).recipe&&me($e)})}var kt=s(Ye,2);{var Pt=me=>{var re=wl(),we=a(re);t(re),u((Le,et)=>d(we,`Started ${Le??""} ¬∑ ${et??""} ago`),[()=>je(e(r).start_time),()=>he(e(r).start_time)]),l(me,re)},Ot=me=>{var re=De(),we=le(re);{var Le=et=>{var Ke=jl(),Oe=a(Ke);t(Ke),u(tt=>d(Oe,`Brewed ${tt??""}`),[()=>je(e(r).brew_date)]),l(et,Ke)};v(we,et=>{e(r).brew_date&&et(Le)},!0)}l(me,re)};v(kt,me=>{e(r).start_time?me(Pt):me(Ot,!1)})}t(Ze),t(Ae);var It=s(Ae,2),wt=a(It),Ue=a(wt);Ue.__change=me=>_(me.currentTarget.value),oa(Ue,21,()=>z,xa,(me,re)=>{var we=Bl(),Le=a(we,!0);t(we);var et={};u(()=>{d(Le,qa[e(re)].label),et!==(et=e(re))&&(we.value=(we.__value=e(re))??"")}),l(me,we)}),t(Ue);var Jt;ds(Ue),t(wt);var Ie=s(wt,2);{var lt=me=>{var re=Sl();let we;re.__click=p;var Le=a(re);{var et=Oe=>{var tt=zl();ge(),l(Oe,tt)},Ke=Oe=>{var tt=Ml();ge(),l(Oe,tt)};v(Le,Oe=>{e(r).readings_paused?Oe(et):Oe(Ke,!1)})}t(re),u(()=>{we=Ee(re,1,"pause-btn svelte-g5au2j",null,we,{paused:e(r).readings_paused}),re.disabled=e(U),Vt(re,"title",e(r).readings_paused?"Resume storing readings":"Pause storing readings")}),l(me,re)};v(Ie,me=>{(e(r).status==="fermenting"||e(r).status==="conditioning")&&me(lt)})}var Yt=s(Ie,2);Yt.__click=()=>o(F,!0);var sa=s(Yt,2);sa.__click=()=>o(ie,!0),t(It),t(H);var Ra=s(H,2);{var Wa=me=>{var re=Pl();let we;var Le=a(re),et=a(Le);{var Ke=Fe=>{var Ve=Cl();ge(2),l(Fe,Ve)},Oe=Fe=>{var Ve=ql();ge(2),l(Fe,Ve)};v(et,Fe=>{e(I)?Fe(Ke):Fe(Oe,!1)})}t(Le);var tt=s(Le,2),ft=a(tt),at=a(ft),it=s(a(at),2),qt=a(it,!0);t(it),t(at);var dt=s(at,4),mt=s(a(dt),2),Ft=a(mt,!0);t(mt),t(dt),t(ft);var Lt=s(ft,2);{var ra=Fe=>{var Ve=Fl(),ce=a(Ve),ct=a(ce);t(ce);var Kt=s(ce,2),yt=a(Kt);t(Kt),t(Ve),u(Tt=>{gt(ct,`width: ${e(_e)??""}%`),d(yt,`${Tt??""}% to target`)},[()=>Math.round(e(_e))]),l(Fe,Ve)};v(Lt,Fe=>{e(_e)!=null&&!e(I)&&Fe(ra)})}var bt=s(Lt,2),Et=a(bt);{var Gt=Fe=>{var Ve=Tl();l(Fe,Ve)},Nt=Fe=>{var Ve=De(),ce=le(Ve);{var ct=yt=>{var Tt=Rl();l(yt,Tt)},Kt=yt=>{var Tt=De(),la=le(Tt);{var ke=nt=>{var pt=Dl();l(nt,pt)},rt=nt=>{var pt=Al();l(nt,pt)};v(la,nt=>{e(I)?nt(ke):nt(rt,!1)},!0)}l(yt,Tt)};v(ce,yt=>{!wa.config.ha_enabled||!wa.config.temp_control_enabled?yt(ct):yt(Kt,!1)},!0)}l(Fe,Ve)};v(Et,Fe=>{e(r).cooler_entity_id?Fe(Nt,!1):Fe(Gt)})}t(bt),t(tt),t(re),u((Fe,Ve)=>{we=Ee(re,1,"chilling-banner svelte-g5au2j",null,we,{ready:e(I)}),d(qt,Fe),d(Ft,Ve)},[()=>e(Q)?.temp!=null?J(e(Q).temp):"--",()=>e(r).temp_target!=null?J(e(r).temp_target):"--"]),l(me,re)};v(Ra,me=>{e(y)&&me(Wa)})}var Da=s(Ra,2);{var Xa=me=>{var re=Ol(),we=s(a(re),4);we.__click=p;var Le=a(we,!0);t(we),t(re),u(()=>{we.disabled=e(U),d(Le,e(U)?"Resuming...":"Resume Readings")}),l(me,re)};v(Da,me=>{e(r).readings_paused&&(e(r).status==="fermenting"||e(r).status==="conditioning")&&me(Xa)})}var Ja=s(Da,2);{var Ya=me=>{var re=El(),we=a(re),Le=s(a(we),6);Le.__click=m;var et=a(Le);{var Ke=at=>{var it=Il();ge(),l(at,it)},Oe=at=>{var it=Ll();ge(),l(at,it)};v(et,at=>{e(X)?at(Ke):at(Oe,!1)})}t(Le),t(we);var tt=s(we,2);{var ft=at=>{Fa(at,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(tt,at=>{e(r).recipe&&at(ft)})}t(re),u(()=>Le.disabled=e(X)),l(me,re)},Ka=me=>{var re=De(),we=le(re);{var Le=Ke=>{var Oe=Hl(),tt=a(Oe),ft=s(a(tt),6);ft.__click=V;var at=a(ft);{var it=ce=>{var ct=Gl();ge(),l(ce,ct)},qt=ce=>{var ct=Nl();ge(),l(ce,ct)};v(at,ce=>{e(X)?ce(it):ce(qt,!1)})}t(ft),t(tt);var dt=s(tt,2),mt=a(dt);{var Ft=ce=>{Ur(ce,{get recipe(){return e(r).recipe}})};v(mt,ce=>{e(r).recipe&&ce(Ft)})}var Lt=s(mt,2);{var ra=ce=>{Qr(ce,{get recipe(){return e(r).recipe},get batchId(){return e(r).id}})};v(Lt,ce=>{e(r).recipe&&ce(ra)})}t(dt);var bt=s(dt,2);{var Et=ce=>{fl(ce,{get batch(){return e(r)},get recipe(){return e(r).recipe},onUpdate:ct=>o(r,ct,!0)})};v(bt,ce=>{e(r).recipe&&ce(Et)})}var Gt=s(bt,2);{var Nt=ce=>{Na(ce,{get batch(){return e(r)},get liveReading(){return e(Q)},onEdit:()=>o(F,!0)})};v(Gt,ce=>{e(r).device_id&&ce(Nt)})}var Fe=s(Gt,2);{var Ve=ce=>{Fa(ce,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(Fe,ce=>{e(r).recipe&&ce(Ve)})}t(Oe),u(()=>ft.disabled=e(X)),l(Ke,Oe)},et=Ke=>{var Oe=De(),tt=le(Oe);{var ft=it=>{var qt=Jl(),dt=a(qt),mt=s(a(dt),2),Ft=a(mt),Lt=s(a(Ft),2),ra=a(Lt,!0);t(Lt),t(Ft);var bt=s(Ft,2),Et=s(a(bt),2),Gt=a(Et,!0);t(Et),t(bt);var Nt=s(bt,2),Fe=s(a(Nt),2),Ve=a(Fe);t(Fe),t(Nt);var ce=s(Nt,2),ct=s(a(ce),2),Kt=a(ct);{var yt=oe=>{var $=ta();u(Te=>d($,`${Te??""}%`),[()=>((e(r).measured_og-e(r).measured_fg)/(e(r).measured_og-1)*100).toFixed(0)]),l(oe,$)},Tt=oe=>{var $=ta("--");l(oe,$)};v(Kt,oe=>{e(r).measured_og&&e(r).measured_fg?oe(yt):oe(Tt,!1)})}t(ct),t(ce),t(mt),t(dt);var la=s(dt,2),ke=s(a(la),2),rt=a(ke);{var nt=oe=>{var $=Ul(),Te=s(a($),2),st=s(a(Te),2),xt=a(st,!0);t(st),t(Te),t($),u(jt=>d(xt,jt),[()=>pe(e(r).brewing_started_at||e(r).brew_date)]),l(oe,$)};v(rt,oe=>{(e(r).brew_date||e(r).brewing_started_at)&&oe(nt)})}var pt=s(rt,2);{var Qt=oe=>{var $=Vl(),Te=s(a($),2),st=s(a(Te),2),xt=a(st,!0);t(st),t(Te),t($),u(jt=>d(xt,jt),[()=>pe(e(r).fermenting_started_at||e(r).start_time)]),l(oe,$)};v(pt,oe=>{(e(r).start_time||e(r).fermenting_started_at)&&oe(Qt)})}var Ht=s(pt,2);{var ca=oe=>{var $=Wl(),Te=s(a($),2),st=s(a(Te),2),xt=a(st,!0);t(st),t(Te),t($),u(jt=>d(xt,jt),[()=>pe(e(r).conditioning_started_at)]),l(oe,$)};v(Ht,oe=>{e(r).conditioning_started_at&&oe(ca)})}var ua=s(Ht,2);{var ba=oe=>{var $=Xl(),Te=s(a($),2),st=s(a(Te),2),xt=a(st,!0);t(st),t(Te),t($),u(jt=>d(xt,jt),[()=>pe(e(r).completed_at||e(r).end_time)]),l(oe,$)};v(ua,oe=>{(e(r).end_time||e(r).completed_at)&&oe(ba)})}t(ke),t(la);var _a=s(la,2);{var ya=oe=>{Ha(oe,{get notes(){return e(r).notes}})};v(_a,oe=>{e(r).notes&&oe(ya)})}t(qt),u((oe,$,Te)=>{d(ra,oe),d(Gt,$),d(Ve,`${Te??""}%`)},[()=>Z(e(r).measured_og),()=>Z(e(r).measured_fg),()=>e(r).measured_abv?.toFixed(1)??"--"]),l(it,qt)},at=it=>{var qt=di(),dt=le(qt),mt=a(dt),Ft=a(mt);{let ke=A(()=>e(Q)?.sg??e(D)?.measured?.current_sg);Es(Ft,{get batch(){return e(r)},get currentSg(){return e(ke)},get progress(){return e(D)},get liveReading(){return e(Q)}})}var Lt=s(Ft,2);{var ra=ke=>{Fa(ke,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(Lt,ke=>{e(r).recipe&&ke(ra)})}t(mt);var bt=s(mt,2),Et=a(bt);Na(Et,{get batch(){return e(r)},get liveReading(){return e(Q)},onEdit:()=>o(F,!0)});var Gt=s(Et,2);{var Nt=ke=>{Tr(ke,{get batchId(){return e(r).id}})};v(Gt,ke=>{(e(r).status==="fermenting"||e(r).status==="conditioning")&&ke(Nt)})}var Fe=s(Gt,2);{let ke=A(()=>e(Q)?.sg);jr(Fe,{get batchId(){return e(r).id},get measuredOg(){return e(r).measured_og},get currentSg(){return e(ke)},get liveReading(){return e(Q)}})}var Ve=s(Fe,2);{var ce=ke=>{var rt=li();let nt;var pt=a(rt);pt.__click=()=>o(G,!e(G));var Qt=s(a(pt),2),Ht=a(Qt);{var ca=$=>{var Te=Yl();l($,Te)},ua=$=>{var Te=De(),st=le(Te);{var xt=Zt=>{var pa=Kl();l(Zt,pa)},jt=Zt=>{var pa=De(),za=le(pa);{var Ma=vt=>{var ut=Ql(),Bt=a(ut);t(ut),u(zt=>d(Bt,`üéØ ${zt??""}${e(de)??""}`),[()=>J(e(B).target_temp)]),l(vt,ut)};v(za,vt=>{e(G)&&e(B)&&vt(Ma)},!0)}l(Zt,pa)};v(st,Zt=>{e(B)?.cooler_state==="on"?Zt(xt):Zt(jt,!1)},!0)}l($,Te)};v(Ht,$=>{e(B)?.heater_state==="on"?$(ca):$(ua,!1)})}var ba=s(Ht,2);let _a;t(Qt),t(pt);var ya=s(pt,2);{var oe=$=>{var Te=ri(),st=le(Te),xt=a(st);{var jt=vt=>{var ut=Zl(),Bt=a(ut);let zt;var $t=s(Bt,2),Mt=s(a($t),2);let ea;var ha=a(Mt,!0);t(Mt);var ia=s(Mt,2),ga=a(ia,!0);t(ia),t($t),t(ut),u(()=>{zt=Ee(Bt,1,"device-icon-wrap svelte-g5au2j",null,zt,{active:e(B)?.heater_state==="on"}),ea=Ee(Mt,1,"device-state svelte-g5au2j",null,ea,{on:e(B)?.heater_state==="on"}),d(ha,e(B)?.heater_state==="on"?"ON":"OFF"),d(ga,e(r).heater_entity_id)}),l(vt,ut)};v(xt,vt=>{e(r).heater_entity_id&&vt(jt)})}var Zt=s(xt,2);{var pa=vt=>{var ut=$l(),Bt=a(ut);let zt;var $t=s(Bt,2),Mt=s(a($t),2);let ea;var ha=a(Mt,!0);t(Mt);var ia=s(Mt,2),ga=a(ia,!0);t(ia),t($t),t(ut),u(()=>{zt=Ee(Bt,1,"device-icon-wrap svelte-g5au2j",null,zt,{active:e(B)?.cooler_state==="on"}),ea=Ee(Mt,1,"device-state svelte-g5au2j",null,ea,{on:e(B)?.cooler_state==="on"}),d(ha,e(B)?.cooler_state==="on"?"ON":"OFF"),d(ga,e(r).cooler_entity_id)}),l(vt,ut)};v(Zt,vt=>{e(r).cooler_entity_id&&vt(pa)})}t(st);var za=s(st,2);{var Ma=vt=>{var ut=si(),Bt=le(ut),zt=a(Bt),$t=s(a(zt),2),Mt=a($t);t($t),t(zt);var ea=s(zt,2),ha=s(a(ea),2),ia=a(ha);t(ha),t(ea),t(Bt);var ga=s(Bt,2);{var Qa=ht=>{var St=ei(),Ct=s(a(St),2),na=a(Ct);t(Ct);var Ea=s(Ct,2);Ea.__click=()=>M(),t(St),u(es=>{d(na,`Override active: ${es??""}`),Ea.disabled=e(ae)},[()=>e(B).override_state?.toUpperCase()]),l(ht,St)};v(ga,ht=>{e(B).override_active&&ht(Qa)})}var Aa=s(ga,2),Pa=s(a(Aa),2),Oa=a(Pa);{var Za=ht=>{var St=ti(),Ct=le(St);Ct.__click=()=>b("heater","on");var na=s(Ct,2);na.__click=()=>b("heater","off"),u(()=>{Ct.disabled=e(ae),na.disabled=e(ae)}),l(ht,St)};v(Oa,ht=>{e(r).heater_entity_id&&ht(Za)})}var Ia=s(Oa,2);{var $a=ht=>{var St=ai(),Ct=le(St);Ct.__click=()=>b("cooler","on");var na=s(Ct,2);na.__click=()=>b("cooler","off"),u(()=>{Ct.disabled=e(ae),na.disabled=e(ae)}),l(ht,St)};v(Ia,ht=>{e(r).cooler_entity_id&&ht($a)})}var La=s(Ia,2);La.__click=()=>M(),t(Pa),t(Aa),u((ht,St)=>{d(Mt,`${ht??""}${e(de)??""}`),d(ia,`¬±${St??""}${e(de)??""}`),La.disabled=e(ae)},[()=>J(e(B).target_temp),()=>e(B).hysteresis?.toFixed(1)||"--"]),l(vt,ut)};v(za,vt=>{e(B)&&vt(Ma)})}l($,Te)};v(ya,$=>{e(G)||$(oe)})}t(rt),u(()=>{nt=Ee(rt,1,"info-card temp-control-card svelte-g5au2j",null,nt,{"heater-on":e(B)?.heater_state==="on","cooler-on":e(B)?.cooler_state==="on",collapsed:e(G)}),_a=Ee(ba,0,"chevron svelte-g5au2j",null,_a,{rotated:!e(G)})}),l(ke,rt)},ct=ke=>{var rt=De(),nt=le(rt);{var pt=Qt=>{var Ht=vi(),ca=s(a(Ht),2),ua=a(ca);{var ba=oe=>{var $=ii(),Te=a($);t($),u(()=>d(Te,`Heater: ${e(r).heater_entity_id??""}`)),l(oe,$)};v(ua,oe=>{e(r).heater_entity_id&&oe(ba)})}var _a=s(ua,2);{var ya=oe=>{var $=ni(),Te=a($);t($),u(()=>d(Te,`Cooler: ${e(r).cooler_entity_id??""}`)),l(oe,$)};v(_a,oe=>{e(r).cooler_entity_id&&oe(ya)})}ge(2),t(ca),t(Ht),l(Qt,Ht)};v(nt,Qt=>{(e(r).heater_entity_id||e(r).cooler_entity_id)&&e(r).status!=="fermenting"&&Qt(pt)},!0)}l(ke,rt)};v(Ve,ke=>{e(K)&&(e(r).status==="fermenting"||e(r).status==="conditioning")?ke(ce):ke(ct,!1)})}var Kt=s(Ve,2);{var yt=ke=>{Ha(ke,{get notes(){return e(r).notes}})};v(Kt,ke=>{e(r).notes&&ke(yt)})}t(bt),t(dt);var Tt=s(dt,2);{var la=ke=>{var rt=oi(),nt=a(rt);Bs(nt,{get batchId(){return e(r).id},get deviceColor(){return e(r).device_id},get originalGravity(){return e(r).measured_og},get controlEvents(){return ue}}),t(rt),l(ke,rt)};v(Tt,ke=>{e(r).device_id&&ke(la)})}l(it,qt)};v(tt,it=>{e(r).status==="completed"?it(ft):it(at,!1)},!0)}l(Ke,Oe)};v(we,Ke=>{e(r).status==="brewing"?Ke(Le):Ke(et,!1)},!0)}l(me,re)};v(Ja,me=>{e(r).status==="planning"?me(Ya):me(Ka,!1)})}u(()=>{d(ot,`#${(e(r).batch_number||"?")??""}`),d(Je,e(r).name||e(r).recipe?.name||"Unnamed Batch"),Ue.disabled=e(X),gt(Ue,`color: ${e(q).color??""}; background: ${e(q).bg??""};`),Jt!==(Jt=e(r).status)&&(Ue.value=(Ue.__value=e(r).status)??"",cs(Ue,e(r).status))}),l(k,L)};v(qe,k=>{e(F)?k(Ne):k(f,!1)},!0)}l(O,W)};v(Ge,O=>{e(r)?O(T,!1):O(Qe)},!0)}l(ve,Xe)};v(ne,ve=>{e(ye)?ve(N):ve(se,!1)},!0)}l(g,te)};v(Se,g=>{e(be)?g(Re):g(ze,!1)})}t(Be);var Ce=s(Be,2);{var We=g=>{var te=ui();te.__click=()=>o(ie,!1),te.__keydown=T=>T.key==="Escape"&&o(ie,!1);var ne=a(te);ne.__click=T=>T.stopPropagation(),ne.__keydown=T=>T.stopPropagation();var N=s(a(ne),2),se=a(N);t(N);var ve=s(N,2),Xe=a(ve);Xe.__click=()=>o(ie,!1);var Ge=s(Xe,2);Ge.__click=x;var Qe=a(Ge,!0);t(Ge),t(ve),t(ne),t(te),u(()=>{d(se,`Are you sure you want to delete "${(e(r)?.name||"this batch")??""}"? This cannot be undone.`),Xe.disabled=e(C),Ge.disabled=e(C),d(Qe,e(C)?"Deleting...":"Delete Batch")}),l(g,te)};v(Ce,g=>{e(ie)&&g(We)})}l(Me,xe),Xt(),S()}aa(["click","change","keydown"]);export{Pi as component,Ai as universal};
