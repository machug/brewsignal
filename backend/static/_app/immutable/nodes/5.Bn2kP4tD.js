import{d as Qt,f as n,s as d,a as l,c as We,t as Jt,h as ga,e as kt}from"../chunks/orbuQWWI.js";import{d as a,e as s,r as t,t as u,a as Ut,f as oe,h as e,u as O,n as ke,g as Ht,s as U,p as Qe,o as Xa,c as o,az as Ma,b9 as rs,i as Da,aJ as ls,aC as is,ax as ns}from"../chunks/pAodAtlG.js";import{e as Bt,i as Kt}from"../chunks/0whDC7Rl.js";import{i as v}from"../chunks/ucc1DXe2.js";import{h as vs}from"../chunks/DJBMpqSf.js";import{s as Yt,r as wt,a as Ua}from"../chunks/CYuZshLQ.js";import{s as Le}from"../chunks/Cpbxxhlc.js";import{s as Ft}from"../chunks/C-5oeV0L.js";import{b as Ta,i as os,s as ds}from"../chunks/RboyDiSx.js";import{s as cs,a as us}from"../chunks/BkeTWnxc.js";import{p as _s}from"../chunks/CLmf_R32.js";import{g as ps}from"../chunks/BDp9Huq5.js";import{a8 as fs,a9 as gs,aa as hs,ab as ms,ac as bs,Q as va,ad as ys,ae as xs,af as ks,X as ws,S as Ca,ag as ja,a3 as js,ah as Ba}from"../chunks/DsM_eXzM.js";import{b as jt,d as Sa,g as Aa,c as qa}from"../chunks/C54DtTUy.js";import{t as Ha}from"../chunks/DWpXqN03.js";import{B as qs}from"../chunks/CKiN9Vr8.js";import{s as Ss}from"../chunks/GbV1md6Y.js";import{p as sa}from"../chunks/C44MPb_E.js";import{F as Ms}from"../chunks/CfPvXJRK.js";import{b as mt}from"../chunks/Dh5hCwq1.js";import{s as Fa}from"../chunks/BkabqQ1A.js";const Cs=!1,bn=Object.freeze(Object.defineProperty({__proto__:null,prerender:Cs},Symbol.toStringTag,{value:"Module"}));function Bs(Re){return Re>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:Re>=-60?{bars:3,color:"var(--positive)",label:"Good"}:Re>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function Ja(Re){const i=Math.floor((Date.now()-new Date(Re).getTime())/1e3);if(i<10)return"just now";if(i<60)return`${i}s ago`;const g=Math.floor(i/60);if(g<60)return`${g}m ago`;const S=Math.floor(g/60);return S<24?`${S}h ago`:`${Math.floor(S/24)}d ago`}var Fs=n('<div class="accent-bar svelte-1oyrwd9"></div>'),zs=n('<span class="card-icon svelte-1oyrwd9"> </span>'),Ts=n('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),Ds=n('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function xa(Re,i){let g=sa(i,"highlight",3,!1),S=sa(i,"compact",3,!1),L=sa(i,"collapsible",3,!1),B=sa(i,"expanded",3,!1);var K=Ds();let r;var R=a(K);{var q=N=>{var H=Fs();l(N,H)};v(R,N=>{g()&&N(q)})}var Q=s(R,2),de=a(Q),Me=a(de);{var M=N=>{var H=zs(),te=a(H,!0);t(H),u(()=>d(te,i.icon)),l(N,H)};v(Me,N=>{i.icon&&N(M)})}var Y=s(Me,2),X=a(Y,!0);t(Y),t(de);var le=s(de,2);{var P=N=>{var H=Ts();H.__click=function(...me){i.onToggle?.apply(this,me)};var te=a(H);let ee;t(H),u(()=>{Yt(H,"aria-label",B()?"Collapse":"Expand"),ee=Le(te,0,"expand-icon svelte-1oyrwd9",null,ee,{"rotate-180":B()})}),l(N,H)};v(le,N=>{L()&&i.onToggle&&N(P)})}t(Q);var Z=s(Q,2);let $;var re=a(Z);Ss(re,()=>i.children),t(Z),t(K),u(()=>{r=Le(K,1,"batch-card svelte-1oyrwd9",null,r,{highlight:g(),compact:S()}),d(X,i.title),$=Le(Z,1,"card-content svelte-1oyrwd9",null,$,{collapsed:L()&&!B()})}),l(Re,K)}Qt(["click"]);var As=n('<span class="updated-text svelte-t80j9z"> </span>'),Rs=n('<div class="hero-divider svelte-t80j9z"></div> <div class="hero-metric temperature svelte-t80j9z"><span class="hero-value svelte-t80j9z"> <span class="hero-unit svelte-t80j9z"> </span></span> <span class="hero-label svelte-t80j9z">Temperature</span></div>',1),Ps=n('<div class="remaining-text svelte-t80j9z"> </div>'),Ns=n('<div class="progress-section svelte-t80j9z"><div class="progress-labels svelte-t80j9z"><div class="progress-endpoint start svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">OG</span></div> <div class="progress-current svelte-t80j9z"><span class="current-percent svelte-t80j9z"> </span></div> <div class="progress-endpoint end svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">Target FG</span></div></div> <div class="progress-track svelte-t80j9z"><div class="progress-fill svelte-t80j9z"></div> <div><div class="marker-dot svelte-t80j9z"></div> <div class="marker-value svelte-t80j9z"> </div></div></div> <!></div>'),Os=n('<div class="metrics-row svelte-t80j9z"><div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">ABV</span></div> <div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">Attenuation</span></div></div>'),Ls=n('<div class="status-row svelte-t80j9z"><div class="live-indicator svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> <span class="status-text svelte-t80j9z">LIVE</span></div> <!></div> <div class="hero-section svelte-t80j9z"><div class="hero-metric gravity svelte-t80j9z"><span class="hero-value svelte-t80j9z"> </span> <span class="hero-label svelte-t80j9z">Gravity</span></div> <!></div> <!> <!>',1),Es=n('<div class="completed-grid svelte-t80j9z"><div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Original Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Final Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">ABV</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Attenuation</span></div></div>'),Gs=n('<div class="empty-state svelte-t80j9z"><div class="empty-icon svelte-t80j9z">‚óé</div> <p class="empty-text svelte-t80j9z">Set Original Gravity to track fermentation</p></div>');function Is(Re,i){Ut(i,!0);let g=O(()=>i.currentSg??i.progress?.measured?.current_sg),S=O(()=>i.liveReading?.temp??i.progress?.temperature?.current),L=O(()=>i.liveReading?.last_seen),B=O(()=>e(L)?Ja(e(L)):null),K=O(Aa),r=O(()=>{if(!i.batch.measured_og||!e(g))return null;const M=Math.max(0,(i.batch.measured_og-e(g))*131.25),Y=i.batch.measured_og-1,X=Y!==0?Math.max(0,Math.min(100,(i.batch.measured_og-e(g))/Y*100)):0;return{abv:M,attenuation:X}}),R=O(()=>{const M=i.batch.measured_og,Y=i.batch.recipe?.fg;if(!M||!Y||!e(g))return null;const X=M-Y,le=M-e(g);return X<=0?null:Math.max(0,Math.min(100,le/X*100))}),q=O(()=>i.batch.status==="fermenting"||i.batch.status==="conditioning");function Q(M){return M==null?"--":jt(M)}function de(M){return M==null?"--":`${M.toFixed(1)}%`}function Me(M){return M==null?"--":Sa(M)}xa(Re,{title:"Fermentation",children:(M,Y)=>{var X=We(),le=oe(X);{var P=$=>{var re=Ls(),N=oe(re),H=s(a(N),2);{var te=p=>{var c=As(),f=a(c);t(c),u(()=>d(f,`Updated ${e(B)??""}`)),l(p,c)};v(H,p=>{e(B)&&p(te)})}t(N);var ee=s(N,2),me=a(ee),we=a(me),Be=a(we,!0);t(we),ke(2),t(me);var se=s(me,2);{var w=p=>{var c=Rs(),f=s(oe(c),2),k=a(f),y=a(k,!0),F=s(y),V=a(F,!0);t(F),t(k),ke(2),t(f),u(E=>{d(y,E),d(V,e(K))},[()=>Me(e(S))]),l(p,c)};v(se,p=>{e(S)!=null&&p(w)})}t(ee);var m=s(ee,2);{var x=p=>{var c=Ns(),f=a(c),k=a(f),y=a(k),F=a(y,!0);t(y),ke(2),t(k);var V=s(k,2),E=a(V),ce=a(E);t(E),t(V);var ae=s(V,2),_e=a(ae),ie=a(_e,!0);t(_e),ke(2),t(ae),t(f);var je=s(f,2),Ce=a(je),Fe=s(Ce,2);let Ge;var ze=s(a(Fe),2),pe=a(ze,!0);t(ze),t(Fe),t(je);var _=s(je,2);{var j=T=>{var D=Ps(),W=a(D);t(D),u(J=>d(W,`${J??""} points to go`),[()=>i.progress.progress.sg_remaining.toFixed(3)]),l(T,D)};v(_,T=>{i.progress?.progress?.sg_remaining!=null&&i.progress.progress.sg_remaining>0&&T(j)})}t(c),u((T,D,W,J)=>{d(F,T),d(ce,`${D??""}%`),d(ie,W),Ft(Ce,`width: ${e(R)??""}%`),Ge=Le(Fe,1,"progress-marker svelte-t80j9z",null,Ge,{"at-start":e(R)<3}),Ft(Fe,`left: ${e(R)??""}%`),d(pe,J)},[()=>Q(i.batch.measured_og),()=>e(R).toFixed(0),()=>Q(i.batch.recipe.fg),()=>Q(e(g))]),l(p,c)};v(m,p=>{e(R)!==null&&i.batch.measured_og&&i.batch.recipe?.fg&&p(x)})}var b=s(m,2);{var h=p=>{var c=Os(),f=a(c),k=a(f),y=a(k,!0);t(k),ke(2),t(f);var F=s(f,2),V=a(F),E=a(V,!0);t(V),ke(2),t(F),t(c),u((ce,ae)=>{d(y,ce),d(E,ae)},[()=>de(e(r).abv),()=>de(e(r).attenuation)]),l(p,c)};v(b,p=>{e(r)&&p(h)})}u(p=>d(Be,p),[()=>Q(e(g))]),l($,re)},Z=$=>{var re=We(),N=oe(re);{var H=ee=>{const me=O(()=>i.batch.measured_fg??i.progress?.measured?.fg??i.progress?.measured?.current_sg),we=O(()=>i.batch.measured_abv??i.progress?.measured?.abv),Be=O(()=>i.batch.measured_attenuation??i.progress?.measured?.attenuation);var se=Es(),w=a(se),m=a(w),x=a(m,!0);t(m),ke(2),t(w);var b=s(w,2),h=a(b),p=a(h,!0);t(h),ke(2),t(b);var c=s(b,2),f=a(c),k=a(f,!0);t(f),ke(2),t(c);var y=s(c,2),F=a(y),V=a(F,!0);t(F),ke(2),t(y),t(se),u((E,ce,ae,_e)=>{d(x,E),d(p,ce),d(k,ae),d(V,_e)},[()=>Q(i.batch.measured_og),()=>Q(e(me)),()=>e(we)!=null?de(e(we)):"--",()=>e(Be)!=null?de(e(Be)):"--"]),l(ee,se)},te=ee=>{var me=Gs();l(ee,me)};v(N,ee=>{i.batch.measured_og?ee(H):ee(te,!1)},!0)}l($,re)};v(le,$=>{e(g)&&e(q)?$(P):$(Z,!1)})}l(M,X)},$$slots:{default:!0}}),Ht()}var Us=n('<span class="device-last-seen svelte-1kdxwtz"> </span>'),Hs=n('<div class="signal-bar svelte-1kdxwtz"></div>'),Vs=n('<div class="metric-item svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="metric-text svelte-1kdxwtz"> </span></div>'),Ws=n('<div class="metric-item battery svelte-1kdxwtz"><svg class="battery-icon svelte-1kdxwtz" viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="2" y="7" width="18" height="10" rx="2"></rect><rect x="4" y="9" height="6" stroke="none" rx="1"></rect><path d="M20 10v4h2v-4z" stroke="none"></path></svg> <span class="metric-text svelte-1kdxwtz"><!></span></div>'),Xs=n('<div class="device-metrics svelte-1kdxwtz"><!> <!></div>'),Js=n('<div class="device-row svelte-1kdxwtz"><div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!></div> <!>',1),Ks=n('<div class="device-row svelte-1kdxwtz"><div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <span class="device-last-seen svelte-1kdxwtz">No data</span></div>'),Ys=n('<div class="device-info svelte-1kdxwtz"><!></div>'),Qs=n('<button type="button" class="link-btn svelte-1kdxwtz">Link device</button>'),Zs=n('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function Va(Re,i){Ut(i,!0);let g=O(()=>i.liveReading?.device_type==="tilt"),S=O(()=>e(g)&&i.liveReading?.rssi?Bs(i.liveReading.rssi):null),L=O(()=>i.liveReading?.last_seen?Ja(i.liveReading.last_seen):null),B=O(()=>i.liveReading?.battery_percent!=null||i.liveReading?.battery_voltage!=null),K=O(()=>i.liveReading?.battery_percent),r=O(()=>i.liveReading?.battery_voltage),R=O(()=>e(K)?e(K)>50?"var(--positive)":e(K)>20?"var(--warning)":"var(--negative)":"var(--text-muted)"),q=O(()=>{if(!i.liveReading)return i.batch.device_id||"Unknown";const Q=i.liveReading.device_type;return Q==="tilt"?`${i.liveReading.color} Tilt`:Q==="gravitymon"?`GravityMon (${i.liveReading.id})`:Q==="ispindel"?`iSpindel (${i.liveReading.id})`:Q==="floaty"?`Floaty (${i.liveReading.id})`:i.liveReading.color||i.liveReading.id});xa(Re,{title:"Tracking Device",compact:!0,children:(Q,de)=>{var Me=We(),M=oe(Me);{var Y=le=>{var P=Ys(),Z=a(P);{var $=N=>{var H=Js(),te=oe(H),ee=a(te),me=s(a(ee));t(ee);var we=s(ee,2);{var Be=m=>{var x=Us(),b=a(x,!0);t(x),u(()=>d(b,e(L))),l(m,x)};v(we,m=>{e(L)&&m(Be)})}t(te);var se=s(te,2);{var w=m=>{var x=Xs(),b=a(x);{var h=f=>{var k=Vs(),y=a(k);Bt(y,20,()=>Array(4),Kt,(E,ce,ae)=>{var _e=Hs();u(()=>Ft(_e,`height: ${4+ae*2}px; background: ${(ae<e(S).bars?e(S).color:"var(--bg-hover)")??""}; opacity: ${ae<e(S).bars?1:.4};`)),l(E,_e)}),t(y);var F=s(y,2),V=a(F);t(F),t(k),u(()=>{Ft(F,`color: ${e(S).color??""}`),d(V,`${i.liveReading.rssi??""}dBm`)}),l(f,k)};v(b,f=>{e(S)&&f(h)})}var p=s(b,2);{var c=f=>{var k=Ws(),y=a(k),F=s(a(y)),V=s(F);t(y);var E=s(y,2),ce=a(E);{var ae=ie=>{var je=Jt();u(Ce=>d(je,`${Ce??""}%`),[()=>e(K).toFixed(0)]),l(ie,je)},_e=ie=>{var je=We(),Ce=oe(je);{var Fe=Ge=>{var ze=Jt();u(pe=>d(ze,`${pe??""}V`),[()=>e(r).toFixed(2)]),l(Ge,ze)};v(Ce,Ge=>{e(r)!=null&&Ge(Fe)},!0)}l(ie,je)};v(ce,ie=>{e(K)!=null?ie(ae):ie(_e,!1)})}t(E),t(k),u(()=>{Yt(y,"stroke",e(R)),Yt(F,"width",(e(K)??50)*.14),Yt(F,"fill",e(R)),Yt(V,"fill",e(R)),Ft(E,`color: ${e(R)??""}`)}),l(f,k)};v(p,f=>{e(B)&&f(c)})}t(x),l(m,x)};v(se,m=>{(e(S)||e(B))&&m(w)})}u(()=>d(me,` ${e(q)??""}`)),l(N,H)},re=N=>{var H=Ks(),te=a(H),ee=s(a(te));t(te),ke(2),t(H),u(()=>d(ee,` ${i.batch.device_id??""}`)),l(N,H)};v(Z,N=>{i.liveReading?N($):N(re,!1)})}t(P),l(le,P)},X=le=>{var P=Zs(),Z=s(a(P),2);{var $=re=>{var N=Qs();N.__click=function(...H){i.onEdit?.apply(this,H)},l(re,N)};v(Z,re=>{i.onEdit&&re($)})}t(P),l(le,P)};v(M,le=>{i.batch.device_id?le(Y):le(X,!1)})}l(Q,Me)},$$slots:{default:!0}}),Ht()}Qt(["click"]);const $s=131.25;var er=n('<span class="yeast-producer svelte-19u9n31"> </span>'),tr=n('<span class="yeast-temp svelte-19u9n31"> </span>'),ar=n('<div class="yeast-row recipe svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Recipe</span> <span class="yeast-value muted svelte-19u9n31"> </span></div>'),sr=n('<div class="yeast-row actual svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span> <!> <!></div> <!>',1),rr=n('<div class="yeast-row svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span></div>'),lr=n('<div class="yeast-section svelte-19u9n31"><!></div>'),ir=n('<div class="targets-row svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div></div> <!>',1);function za(Re,i){Ut(i,!0);function g(L){return L==null?"--":jt(L)}let S=O(()=>i.recipe.abv!=null?i.recipe.abv:i.recipe.og&&i.recipe.fg?(i.recipe.og-i.recipe.fg)*$s:null);xa(Re,{title:"Recipe Targets",compact:!0,children:(L,B)=>{var K=ir(),r=oe(K),R=a(r),q=s(a(R),2),Q=a(q,!0);t(q),t(R);var de=s(R,2),Me=s(a(de),2),M=a(Me,!0);t(Me),t(de);var Y=s(de,2),X=s(a(Y),2),le=a(X,!0);t(X),t(Y),t(r);var P=s(r,2);{var Z=$=>{var re=lr(),N=a(re);{var H=ee=>{var me=sr(),we=oe(me),Be=s(a(we),2),se=a(Be,!0);t(Be);var w=s(Be,2);{var m=c=>{var f=er(),k=a(f);t(f),u(()=>d(k,`(${i.yeastStrain.producer??""})`)),l(c,f)};v(w,c=>{i.yeastStrain.producer&&c(m)})}var x=s(w,2);{var b=c=>{var f=tr(),k=a(f);t(f),u((y,F)=>d(k,`${y??""}-${F??""}¬∞C`),[()=>i.yeastStrain.temp_low.toFixed(0),()=>i.yeastStrain.temp_high.toFixed(0)]),l(c,f)};v(x,c=>{i.yeastStrain.temp_low&&i.yeastStrain.temp_high&&c(b)})}t(we);var h=s(we,2);{var p=c=>{var f=ar(),k=s(a(f),2),y=a(k,!0);t(k),t(f),u(()=>d(y,i.recipe.yeast_name)),l(c,f)};v(h,c=>{i.recipe.yeast_name&&c(p)})}u(()=>d(se,i.yeastStrain.name)),l(ee,me)},te=ee=>{var me=We(),we=oe(me);{var Be=se=>{var w=rr(),m=s(a(w),2),x=a(m,!0);t(m),t(w),u(()=>d(x,i.recipe.yeast_name)),l(se,w)};v(we,se=>{i.recipe.yeast_name&&se(Be)},!0)}l(ee,me)};v(N,ee=>{i.yeastStrain?ee(H):ee(te,!1)})}t(re),l($,re)};v(P,$=>{(i.yeastStrain||i.recipe.yeast_name)&&$(Z)})}u(($,re,N)=>{d(Q,$),d(M,re),d(le,N)},[()=>g(i.recipe.og),()=>g(i.recipe.fg),()=>e(S)!=null?`${e(S).toFixed(1)}%`:"--"]),l(L,K)},$$slots:{default:!0}}),Ht()}var nr=n('<p class="notes-content svelte-hkv31i"> </p>');function Wa(Re,i){xa(Re,{title:"Notes",children:(g,S)=>{var L=nr(),B=a(L,!0);t(L),u(()=>d(B,i.notes)),l(g,L)},$$slots:{default:!0}})}var vr=n('<div class="ml-panel loading svelte-1xs394q"><p> </p></div>'),or=n('<div class="ml-panel error svelte-1xs394q"><p class="error-text svelte-1xs394q"> </p></div>'),dr=n("<option> </option>"),cr=n('<div class="header-controls svelte-1xs394q"><select class="model-select svelte-1xs394q" title="Select prediction model"></select> <button type="button" class="reload-btn svelte-1xs394q" title="Recalculate predictions from database history"> </button></div>'),ur=n('<span class="accuracy-icon svelte-1xs394q">‚úì</span> <span class="accuracy-title svelte-1xs394q">Excellent Prediction</span>',1),_r=n('<span class="accuracy-icon svelte-1xs394q">‚âà</span> <span class="accuracy-title svelte-1xs394q">Close Prediction</span>',1),pr=n('<span class="accuracy-icon svelte-1xs394q">‚ñ≥</span> <span class="accuracy-title svelte-1xs394q">Prediction Variance</span>',1),fr=n('<div><div class="accuracy-header svelte-1xs394q"><!></div> <p class="accuracy-detail svelte-1xs394q"> <span class="accuracy-diff svelte-1xs394q"> </span></p></div>'),gr=n('<span class="comparison-predicted svelte-1xs394q"> </span>'),hr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model:</span> <span class="model-value model-type svelte-1xs394q"> </span></div>'),mr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),br=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),yr=n('<div class="summary-section svelte-1xs394q"><!> <div class="comparison-grid svelte-1xs394q"><div class="comparison-item svelte-1xs394q"><span class="comparison-label svelte-1xs394q">Final Gravity</span> <div class="comparison-values svelte-1xs394q"><span class="comparison-actual svelte-1xs394q"> </span> <!></div></div></div> <div class="model-info summary-model svelte-1xs394q"><!> <!> <!></div></div>'),xr=n('<span class="anomaly-reasons svelte-1xs394q"> </span>'),kr=n('<div class="anomaly-banner svelte-1xs394q"><span class="anomaly-icon svelte-1xs394q">‚ö†Ô∏è</span> <div class="anomaly-content svelte-1xs394q"><span class="anomaly-label svelte-1xs394q">Anomaly Detected</span> <!></div></div>'),wr=n('<span class="activity-badge svelte-1xs394q"> </span>'),jr=n('<div class="progress-section svelte-1xs394q"><div class="progress-header svelte-1xs394q"><span class="progress-label svelte-1xs394q">Fermentation Progress</span> <!></div> <div class="fermentation-progress-bar svelte-1xs394q"><div class="fermentation-fill svelte-1xs394q"></div></div> <div class="progress-labels svelte-1xs394q"><span class="og-label svelte-1xs394q"> </span> <span class="progress-percent svelte-1xs394q"> </span> <span class="fg-label svelte-1xs394q"> </span></div></div>'),qr=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Predicted FG:</span> <span class="value svelte-1xs394q"> </span></div>'),Sr=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Attenuation:</span> <span class="value attenuation svelte-1xs394q"> </span></div>'),Mr=n('<span class="complete-now svelte-1xs394q">Ready now!</span>'),Cr=n('<span class="days svelte-1xs394q"> </span>'),Br=n(" <!>",1),Fr=n('<div class="metric completion-metric svelte-1xs394q"><span class="label svelte-1xs394q">Est. Completion:</span> <span class="value svelte-1xs394q"><!></span></div>'),zr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model:</span> <span class="model-value model-type svelte-1xs394q"> </span></div>'),Tr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),Dr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),Ar=n('<!> <!> <div class="metrics svelte-1xs394q"><!> <!> <!> <div class="model-info svelte-1xs394q"><!> <!> <!></div></div>',1),Rr=n('<div><div class="panel-header svelte-1xs394q"><h3 class="panel-title svelte-1xs394q"> </h3> <!></div> <!></div>'),Pr=n('<div class="ml-panel disabled svelte-1xs394q"><div class="disabled-header svelte-1xs394q"><p class="unavailable-text svelte-1xs394q"> </p> <button type="button" class="reload-btn svelte-1xs394q" title="Reload predictions from database"> </button></div> <p class="unavailable-hint svelte-1xs394q"><!></p></div>');function Nr(Re,i){Ut(i,!0);let g=sa(i,"batchStatus",3,"fermenting"),S=sa(i,"measuredOg",3,null),L=sa(i,"measuredFg",3,null),B=sa(i,"currentSg",3,null),K=sa(i,"liveReading",3,null),r=U(Qe({available:!1})),R=U(!0),q=U(!1),Q=U(null),de=U("auto");const Me=[{value:"auto",label:"Auto (Best Fit)"},{value:"exponential",label:"Exponential"},{value:"gompertz",label:"Gompertz (S-Curve)"},{value:"logistic",label:"Logistic"}];let M=O(()=>g()==="completed"||g()==="archived"),Y=O(()=>L()??B()),X=O(()=>{if(!e(M)||!e(r).predicted_fg||!e(Y))return null;const m=Math.abs(e(r).predicted_fg-e(Y)),x=Math.round(m*1e3);return{diff:m,points:x,isAccurate:x<=2,isClose:x<=5}});async function le(){o(R,!0),o(Q,null);try{o(r,await gs(i.batchId,e(de)),!0)}catch(m){o(Q,m instanceof Error?m.message:"Failed to load predictions",!0),console.error("Failed to load ML predictions:",m)}finally{o(R,!1)}}async function P(){o(q,!0),o(Q,null);try{const m=await fs(i.batchId);console.log("Reloaded predictions:",m.message),await le()}catch(m){o(Q,m instanceof Error?m.message:"Failed to reload predictions",!0),console.error("Failed to reload predictions:",m)}finally{o(q,!1)}}function Z(){le()}Xa(P);function $(m){return m?new Date(m).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}):"N/A"}function re(m){if(!m)return null;const x=new Date(m),b=new Date,h=x.getTime()-b.getTime();return Math.ceil(h/(1e3*60*60*24))}let N=O(()=>{const m=S()??e(r).predicted_og,x=e(r).predicted_fg,b=B()??K()?.sg;if(!m||!x||!b||m<=x)return null;const h=m-x,c=(m-b)/h*100;return Math.min(100,Math.max(0,c))}),H=O(()=>{const m=S()??e(r).predicted_og,x=B()??K()?.sg;if(!m||!x||m<=1)return null;const b=(m-x)/(m-1)*100;return Math.min(100,Math.max(0,b))}),te=O(()=>{const m=K()?.sg_rate;if(m==null)return null;const x=Math.abs(m);return x>.002?{label:"Very Active",color:"var(--activity-very-active)",emoji:"üî•"}:x>5e-4?{label:"Active",color:"var(--activity-active)",emoji:"‚ú®"}:x>1e-4?{label:"Slowing",color:"var(--activity-slowing)",emoji:"üê¢"}:{label:"Complete",color:"var(--activity-complete)",emoji:"‚úì"}}),ee=O(()=>K()?.is_anomaly??!1),me=O(()=>K()?.anomaly_reasons??[]);var we=We(),Be=oe(we);{var se=m=>{var x=vr(),b=a(x),h=a(b);t(b),t(x),u(()=>d(h,`Loading ${e(M)?"summary":"predictions"}...`)),l(m,x)},w=m=>{var x=We(),b=oe(x);{var h=c=>{var f=or(),k=a(f),y=a(k);t(k),t(f),u(()=>d(y,`‚ö†Ô∏è ${e(Q)??""}`)),l(c,f)},p=c=>{var f=We(),k=oe(f);{var y=V=>{var E=Rr();let ce;var ae=a(E),_e=a(ae),ie=a(_e,!0);t(_e);var je=s(_e,2);{var Ce=pe=>{var _=cr(),j=a(_);j.__change=Z,Bt(j,21,()=>Me,Kt,(W,J)=>{var ne=dr(),fe=a(ne,!0);t(ne);var be={};u(()=>{d(fe,e(J).label),be!==(be=e(J).value)&&(ne.value=(ne.__value=e(J).value)??"")}),l(W,ne)}),t(j);var T=s(j,2);T.__click=P;var D=a(T,!0);t(T),t(_),u(()=>{j.disabled=e(R)||e(q),T.disabled=e(q)||e(R),d(D,e(q)?"Reloading...":"‚Üª")}),Ta(j,()=>e(de),W=>o(de,W)),l(pe,_)};v(je,pe=>{e(M)||pe(Ce)})}t(ae);var Fe=s(ae,2);{var Ge=pe=>{var _=yr(),j=a(_);{var T=G=>{var ve=fr();let A;var I=a(ve),he=a(I);{var Te=Ze=>{var et=ur();ke(2),l(Ze,et)},Je=Ze=>{var et=We(),dt=oe(et);{var Ae=qe=>{var Ke=_r();ke(2),l(qe,Ke)},_t=qe=>{var Ke=pr();ke(2),l(qe,Ke)};v(dt,qe=>{e(X).isClose?qe(Ae):qe(_t,!1)},!0)}l(Ze,et)};v(he,Ze=>{e(X).isAccurate?Ze(Te):Ze(Je,!1)})}t(I);var Ie=s(I,2),Ue=a(Ie),Ne=s(Ue),Ye=a(Ne);t(Ne),t(Ie),t(ve),u((Ze,et)=>{A=Le(ve,1,"accuracy-banner svelte-1xs394q",null,A,{accurate:e(X).isAccurate,close:e(X).isClose&&!e(X).isAccurate}),d(Ue,`Model predicted ${Ze??""}, actual was ${et??""} `),d(Ye,`(${e(X).points??""} points ${e(r).predicted_fg&&e(r).predicted_fg>e(Y)?"high":"low"})`)},[()=>jt(e(r).predicted_fg??0),()=>jt(e(Y))]),l(G,ve)};v(j,G=>{e(X)&&e(Y)&&G(T)})}var D=s(j,2),W=a(D),J=s(a(W),2),ne=a(J),fe=a(ne,!0);t(ne);var be=s(ne,2);{var ye=G=>{var ve=gr(),A=a(ve);t(ve),u(I=>d(A,`ML: ${I??""}`),[()=>jt(e(r).predicted_fg)]),l(G,ve)};v(be,G=>{e(r).predicted_fg&&G(ye)})}t(J),t(W),t(D);var Xe=s(D,2),ft=a(Xe);{var ut=G=>{var ve=hr(),A=s(a(ve),2),I=a(A,!0);t(A),t(ve),u(()=>d(I,e(r).model_type)),l(G,ve)};v(ft,G=>{e(r).model_type&&G(ut)})}var zt=s(ft,2);{var C=G=>{var ve=mr(),A=s(a(ve),2),I=a(A);t(A),t(ve),u(he=>d(I,`${he??""}%`),[()=>(e(r).r_squared*100).toFixed(0)]),l(G,ve)};v(zt,G=>{e(r).r_squared!==void 0&&G(C)})}var z=s(zt,2);{var ge=G=>{var ve=br(),A=s(a(ve),2),I=a(A,!0);t(A),t(ve),u(()=>d(I,e(r).num_readings)),l(G,ve)};v(z,G=>{e(r).num_readings&&G(ge)})}t(Xe),t(_),u(G=>d(fe,G),[()=>jt(e(Y)??0)]),l(pe,_)},ze=pe=>{var _=Ar(),j=oe(_);{var T=A=>{var I=kr(),he=s(a(I),2),Te=s(a(he),2);{var Je=Ie=>{var Ue=xr(),Ne=a(Ue,!0);t(Ue),u(Ye=>d(Ne,Ye),[()=>e(me).join(", ")]),l(Ie,Ue)};v(Te,Ie=>{e(me).length>0&&Ie(Je)})}t(he),t(I),l(A,I)};v(j,A=>{e(ee)&&A(T)})}var D=s(j,2);{var W=A=>{var I=jr(),he=a(I),Te=s(a(he),2);{var Je=qe=>{var Ke=wr(),Tt=a(Ke);t(Ke),u(()=>{Ft(Ke,`color: ${e(te).color??""}`),d(Tt,`${e(te).emoji??""} ${e(te).label??""}`)}),l(qe,Ke)};v(Te,qe=>{e(te)&&qe(Je)})}t(he);var Ie=s(he,2),Ue=a(Ie);t(Ie);var Ne=s(Ie,2),Ye=a(Ne),Ze=a(Ye);t(Ye);var et=s(Ye,2),dt=a(et);t(et);var Ae=s(et,2),_t=a(Ae);t(Ae),t(Ne),t(I),u((qe,Ke,Tt)=>{Ft(Ue,`width: ${e(N)??""}%`),d(Ze,`OG: ${qe??""}`),d(dt,`${Ke??""}%`),d(_t,`FG: ${Tt??""}`)},[()=>jt(S()??e(r).predicted_og??0),()=>e(N).toFixed(0),()=>jt(e(r).predicted_fg??0)]),l(A,I)};v(D,A=>{e(N)!==null&&A(W)})}var J=s(D,2),ne=a(J);{var fe=A=>{var I=qr(),he=s(a(I),2),Te=a(he,!0);t(he),t(I),u(Je=>d(Te,Je),[()=>jt(e(r).predicted_fg)]),l(A,I)};v(ne,A=>{e(r).predicted_fg&&A(fe)})}var be=s(ne,2);{var ye=A=>{var I=Sr(),he=s(a(I),2),Te=a(he);t(he),t(I),u(Je=>d(Te,`${Je??""}%`),[()=>e(H).toFixed(1)]),l(A,I)};v(be,A=>{e(H)!==null&&A(ye)})}var Xe=s(be,2);{var ft=A=>{const I=O(()=>re(e(r).estimated_completion));var he=Fr(),Te=s(a(he),2),Je=a(Te);{var Ie=Ne=>{var Ye=Mr();l(Ne,Ye)},Ue=Ne=>{var Ye=Br(),Ze=oe(Ye),et=s(Ze);{var dt=Ae=>{var _t=Cr(),qe=a(_t);t(_t),u(()=>d(qe,`(${e(I)??""} ${e(I)===1?"day":"days"})`)),l(Ae,_t)};v(et,Ae=>{e(I)!==null&&Ae(dt)})}u(Ae=>d(Ze,`${Ae??""} `),[()=>$(e(r).estimated_completion)]),l(Ne,Ye)};v(Je,Ne=>{e(I)!==null&&e(I)<=0?Ne(Ie):Ne(Ue,!1)})}t(Te),t(he),l(A,he)};v(Xe,A=>{e(r).estimated_completion&&A(ft)})}var ut=s(Xe,2),zt=a(ut);{var C=A=>{var I=zr(),he=s(a(I),2),Te=a(he,!0);t(he),t(I),u(()=>d(Te,e(r).model_type)),l(A,I)};v(zt,A=>{e(r).model_type&&A(C)})}var z=s(zt,2);{var ge=A=>{var I=Tr(),he=s(a(I),2),Te=a(he);t(he),t(I),u(Je=>d(Te,`${Je??""}%`),[()=>(e(r).r_squared*100).toFixed(0)]),l(A,I)};v(z,A=>{e(r).r_squared!==void 0&&A(ge)})}var G=s(z,2);{var ve=A=>{var I=Dr(),he=s(a(I),2),Te=a(he,!0);t(he),t(I),u(()=>d(Te,e(r).num_readings)),l(A,I)};v(G,A=>{e(r).num_readings&&A(ve)})}t(ut),t(J),l(pe,_)};v(Fe,pe=>{e(M)?pe(Ge):pe(ze,!1)})}t(E),u(()=>{ce=Le(E,1,"ml-panel svelte-1xs394q",null,ce,{"has-anomaly":e(ee),completed:e(M)}),d(ie,e(M)?"Fermentation Summary":"Fermentation Intelligence")}),l(V,E)},F=V=>{var E=Pr(),ce=a(E),ae=a(ce),_e=a(ae,!0);t(ae);var ie=s(ae,2);ie.__click=P;var je=a(ie,!0);t(ie),t(ce);var Ce=s(ce,2),Fe=a(Ce);{var Ge=pe=>{var _=Jt("Waiting for fermentation to progress (need visible SG drop)");l(pe,_)},ze=pe=>{var _=We(),j=oe(_);{var T=W=>{var J=Jt("Need more fermentation curve data for reliable prediction");l(W,J)},D=W=>{var J=We(),ne=oe(J);{var fe=ye=>{var Xe=Jt("Need at least 10 readings to make predictions");l(ye,Xe)},be=ye=>{var Xe=Jt();u(()=>d(Xe,e(M)?"No fermentation data recorded":"Predictions will appear once fermentation is underway")),l(ye,Xe)};v(ne,ye=>{e(r).reason==="insufficient_data"?ye(fe):ye(be,!1)},!0)}l(W,J)};v(j,W=>{e(r).reason==="insufficient_curve_data"?W(T):W(D,!1)},!0)}l(pe,_)};v(Fe,pe=>{e(r).reason==="insufficient_fermentation_progress"?pe(Ge):pe(ze,!1)})}t(Ce),t(E),u(()=>{d(_e,e(M)?"Fermentation summary unavailable":"ML predictions unavailable"),ie.disabled=e(q)||e(R),d(je,e(q)?"Reloading...":"‚Üª Reload")}),l(V,E)};v(k,V=>{e(r).available?V(y):V(F,!1)},!0)}l(c,f)};v(b,c=>{e(Q)?c(h):c(p,!1)},!0)}l(m,x)};v(Be,m=>{e(R)?m(se):m(w,!1)})}l(Re,we),Ht()}Qt(["change","click"]);var Or=n('<div class="loading svelte-1hws0u6">Loading alerts...</div>'),Lr=n('<div class="error-banner svelte-1hws0u6"><span> </span> <button type="button" class="dismiss-error svelte-1hws0u6">√ó</button></div>'),Er=n('<button type="button" class="dismiss-all-btn svelte-1hws0u6"> </button>'),Gr=n('<span class="spinner svelte-1hws0u6"></span>'),Ir=ga('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1hws0u6"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg>'),Ur=n('<div class="alert-item svelte-1hws0u6"><div class="alert-icon svelte-1hws0u6"> </div> <div class="alert-content svelte-1hws0u6"><div class="alert-header svelte-1hws0u6"><span class="alert-type svelte-1hws0u6"> </span> <span class="severity-badge svelte-1hws0u6"> </span></div> <p class="alert-message svelte-1hws0u6"> </p> <div class="alert-meta svelte-1hws0u6"><span class="alert-time svelte-1hws0u6"> </span> <span class="alert-separator svelte-1hws0u6">¬∑</span> <span class="alert-time svelte-1hws0u6"> </span></div></div> <button type="button" class="dismiss-btn svelte-1hws0u6" title="Dismiss alert"><!></button></div>'),Hr=n('<!> <div class="alerts-header svelte-1hws0u6"><span class="alert-count svelte-1hws0u6"> </span> <!></div> <div class="alerts-list svelte-1hws0u6"></div>',1);function Vr(Re,i){Ut(i,!0);let g=U(Qe([])),S=U(!0),L=U(null),B=U(null),K=U(!1);Ma(()=>{r()});async function r(){try{o(S,!0),o(L,null),o(g,await hs(i.batchId,!1),!0)}catch(P){o(L,P instanceof Error?P.message:"Failed to load alerts",!0)}finally{o(S,!1)}}async function R(P){try{o(B,P,!0),await ms(i.batchId,P),o(g,e(g).filter(Z=>Z.id!==P),!0)}catch(Z){o(L,Z instanceof Error?Z.message:"Failed to dismiss alert",!0)}finally{o(B,null)}}async function q(){try{o(K,!0),await bs(i.batchId),o(g,[],!0)}catch(P){o(L,P instanceof Error?P.message:"Failed to dismiss alerts",!0)}finally{o(K,!1)}}function Q(P){switch(P){case"critical":return"var(--negative)";case"warning":return"var(--warning)";case"info":return"var(--accent)";default:return"var(--text-muted)"}}function de(P){switch(P){case"stall":return"‚è∏";case"temperature_high":return"üî•";case"temperature_low":return"‚ùÑ";case"anomaly":return"‚ö†";default:return"‚ö†"}}function Me(P){const Z=new Date(P),re=new Date().getTime()-Z.getTime(),N=Math.floor(re/6e4),H=Math.floor(N/60),te=Math.floor(H/24);return te>0?`${te}d ago`:H>0?`${H}h ago`:N>0?`${N}m ago`:"just now"}var M=We(),Y=oe(M);{var X=P=>{xa(P,{title:"Alerts",icon:"üîî",children:(Z,$)=>{var re=Or();l(Z,re)},$$slots:{default:!0}})},le=P=>{var Z=We(),$=oe(Z);{var re=H=>{},N=H=>{xa(H,{title:"Active Alerts",icon:"üîî",highlight:!0,children:(te,ee)=>{var me=Hr(),we=oe(me);{var Be=p=>{var c=Lr(),f=a(c),k=a(f,!0);t(f);var y=s(f,2);y.__click=()=>o(L,null),t(c),u(()=>d(k,e(L))),l(p,c)};v(we,p=>{e(L)&&p(Be)})}var se=s(we,2),w=a(se),m=a(w);t(w);var x=s(w,2);{var b=p=>{var c=Er();c.__click=q;var f=a(c,!0);t(c),u(()=>{c.disabled=e(K),d(f,e(K)?"Dismissing...":"Dismiss All")}),l(p,c)};v(x,p=>{e(g).length>1&&p(b)})}t(se);var h=s(se,2);Bt(h,21,()=>e(g),p=>p.id,(p,c)=>{var f=Ur(),k=a(f),y=a(k,!0);t(k);var F=s(k,2),V=a(F),E=a(V),ce=a(E,!0);t(E);var ae=s(E,2),_e=a(ae,!0);t(ae),t(V);var ie=s(V,2),je=a(ie,!0);t(ie);var Ce=s(ie,2),Fe=a(Ce),Ge=a(Fe);t(Fe);var ze=s(Fe,4),pe=a(ze);t(ze),t(Ce),t(F);var _=s(F,2);_.__click=()=>R(e(c).id);var j=a(_);{var T=W=>{var J=Gr();l(W,J)},D=W=>{var J=Ir();l(W,J)};v(j,W=>{e(B)===e(c).id?W(T):W(D,!1)})}t(_),t(f),u((W,J,ne,fe,be,ye,Xe,ft)=>{Ft(f,`--severity-color: ${W??""}`),d(y,J),d(ce,ne),Ft(ae,`background: ${fe??""}`),d(_e,e(c).severity),d(je,e(c).message),Yt(Fe,"title",`First detected: ${be??""}`),d(Ge,`First: ${ye??""}`),Yt(ze,"title",`Last seen: ${Xe??""}`),d(pe,`Last: ${ft??""}`),_.disabled=e(B)===e(c).id},[()=>Q(e(c).severity),()=>de(e(c).alert_type),()=>e(c).alert_type.replace("_"," "),()=>Q(e(c).severity),()=>new Date(e(c).first_detected_at).toLocaleString(),()=>Me(e(c).first_detected_at),()=>new Date(e(c).last_seen_at).toLocaleString(),()=>Me(e(c).last_seen_at)]),l(p,f)}),t(h),u(()=>d(m,`${e(g).length??""} active`)),l(te,me)},$$slots:{default:!0}})};v($,H=>{e(g).length===0?H(re):H(N,!1)},!0)}l(P,Z)};v(Y,P=>{e(S)?P(X):P(le,!1)})}l(Re,M),Ht()}Qt(["click"]);var Wr=n('<span class="saving-indicator svelte-ukh80y">Syncing...</span>'),Xr=n("<span> </span>"),Jr=n('<div class="timer-idle svelte-ukh80y"><div class="timer-option svelte-ukh80y"><label class="option-label svelte-ukh80y">Mash Duration</label> <div class="duration-input svelte-ukh80y"><button type="button" class="duration-btn svelte-ukh80y">‚àí</button> <span class="duration-value svelte-ukh80y"> </span> <button type="button" class="duration-btn svelte-ukh80y">+</button> <span class="duration-unit svelte-ukh80y">min</span></div></div> <div class="timer-option svelte-ukh80y"><label class="option-label svelte-ukh80y">Boil Duration</label> <div class="duration-display svelte-ukh80y"><span class="duration-value svelte-ukh80y"> </span> <span class="duration-unit svelte-ukh80y">min</span></div></div> <div class="timer-actions svelte-ukh80y"><button type="button" class="start-btn mash svelte-ukh80y"><svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path></svg> Start Mash</button> <button type="button" class="start-btn boil svelte-ukh80y">Skip to Boil</button></div></div>'),Kr=n('<div class="timer-complete svelte-ukh80y"><div class="complete-icon svelte-ukh80y">‚úì</div> <p class="complete-text svelte-ukh80y">Boil complete! Time to chill the wort.</p> <button type="button" class="reset-btn svelte-ukh80y">Reset Timer</button></div>'),Yr=ga('<svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path></svg> Resume',1),Qr=ga('<svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6"></path></svg> Pause',1),Zr=n('<span class="hop-check svelte-ukh80y">‚úì</span>'),$r=n('<div><span class="hop-time svelte-ukh80y"> </span> <span class="hop-name svelte-ukh80y"> </span> <span class="hop-amount svelte-ukh80y"> </span> <!></div>'),el=n('<div class="hop-schedule svelte-ukh80y"><h4 class="schedule-title svelte-ukh80y">Hop Additions</h4> <div class="hop-list svelte-ukh80y"></div></div>'),tl=n('<button type="button" class="next-phase-btn svelte-ukh80y">Mash Done ‚Üí Start Boil</button>'),al=n('<div class="timer-active svelte-ukh80y"><div class="timer-display svelte-ukh80y"><span class="time-value svelte-ukh80y"> </span> <span class="time-label svelte-ukh80y">remaining</span></div> <div class="progress-bar svelte-ukh80y"><div></div></div> <div class="timer-controls svelte-ukh80y"><button type="button" class="control-btn svelte-ukh80y" title="Subtract 1 minute">‚àí1m</button> <button type="button"><!></button> <button type="button" class="control-btn svelte-ukh80y" title="Add 1 minute">+1m</button></div> <!> <div class="phase-actions svelte-ukh80y"><!> <button type="button" class="reset-btn svelte-ukh80y">Reset</button></div></div>'),sl=n('<div class="timer-card svelte-ukh80y"><div class="timer-header svelte-ukh80y"><h3 class="timer-title svelte-ukh80y">Brew Day Timer</h3> <!></div> <!></div>');function rl(Re,i){Ut(i,!0);let g=U(Qe(i.batch.timer_phase||"idle")),S=U(0),L=null,B=U(i.batch.timer_paused_at!=null),K=U(!1),r=U(Qe(new Set)),R=U(60),q=O(()=>i.recipe.boil_time_minutes||60),Q=O(()=>i.recipe.hops?i.recipe.hops.filter(h=>h.timing?.use==="add_to_boil"||!h.timing?.use).map(h=>({name:h.name,amount:h.amount_grams,time:h.timing?.duration?.value||0,unit:h.timing?.duration?.unit||"min"})).sort((h,p)=>p.time-h.time):[]),de=O(()=>{const h=Math.floor(e(S)/60),p=e(S)%60;return`${h.toString().padStart(2,"0")}:${p.toString().padStart(2,"0")}`}),Me=O(()=>e(g)==="mash"?(e(R)*60-e(S))/(e(R)*60)*100:e(g)==="boil"?(e(q)*60-e(S))/(e(q)*60)*100:0),M=O(()=>{switch(e(g)){case"mash":return"Mash";case"boil":return"Boil";case"complete":return"Complete!";default:return"Ready"}});function Y(){if(!i.batch.timer_started_at||!i.batch.timer_duration_seconds)return 0;const h=new Date(i.batch.timer_started_at).getTime(),p=i.batch.timer_duration_seconds*1e3,c=Date.now();if(i.batch.timer_paused_at){const k=new Date(i.batch.timer_paused_at).getTime()-h;return Math.max(0,Math.floor((p-k)/1e3))}else{const f=c-h;return Math.max(0,Math.floor((p-f)/1e3))}}async function X(h,p,c=!1){o(K,!0);try{const f={timer_phase:h,timer_duration_seconds:p};h==="idle"||h==="complete"?(f.timer_started_at=null,f.timer_paused_at=null):c?f.timer_paused_at=new Date().toISOString():(f.timer_started_at=new Date().toISOString(),f.timer_paused_at=null),await va(i.batch.id,f)}catch(f){console.error("Failed to save timer state:",f)}finally{o(K,!1)}}async function le(){o(g,"mash"),o(S,e(R)*60),o(r,new Set,!0),o(B,!1),await X("mash",e(R)*60),Z()}async function P(){o(g,"boil"),o(S,e(q)*60),o(r,new Set,!0),o(B,!1),await X("boil",e(q)*60),Z()}function Z(){L&&clearInterval(L),L=setInterval(()=>{if(!e(B)&&e(S)>0){if(rs(S,-1),e(g)==="boil"){const h=Math.floor(e(S)/60);for(const p of e(Q)){const c=p.time;h===c&&!e(r).has(c)&&(e(r).add(c),te(),ee(`Add ${p.name}`,`${p.amount}g at ${c} minutes`))}}e(S)===0&&(clearInterval(L),L=null,te(),e(g)==="mash"?ee("Mash Complete","Time to sparge and start the boil!"):e(g)==="boil"&&(o(g,"complete"),X("complete",0),ee("Boil Complete","Time to chill the wort!"),i.onComplete?.()))}},1e3)}async function $(){o(B,!e(B)),e(B)?await X(e(g),e(S),!0):await X(e(g),e(S),!1)}async function re(){L&&(clearInterval(L),L=null),o(g,"idle"),o(S,0),o(B,!1),o(r,new Set,!0),await X("idle",0)}function N(){o(S,e(S)+60)}function H(){e(S)>=60&&o(S,e(S)-60)}function te(){try{const h=new(window.AudioContext||window.webkitAudioContext),p=h.createOscillator(),c=h.createGain();p.connect(c),c.connect(h.destination),p.frequency.value=880,p.type="sine",c.gain.value=.3,p.start(),setTimeout(()=>c.gain.value=0,150),setTimeout(()=>c.gain.value=.3,250),setTimeout(()=>c.gain.value=0,400),setTimeout(()=>c.gain.value=.3,500),setTimeout(()=>c.gain.value=0,650),setTimeout(()=>{p.stop(),h.close()},700)}catch(h){console.warn("Audio notification not available:",h)}}function ee(h,p){"Notification"in window&&Notification.permission==="granted"&&new Notification(h,{body:p,icon:"/favicon.png"})}Ma(()=>("Notification"in window&&Notification.permission==="default"&&Notification.requestPermission(),i.batch.timer_phase&&i.batch.timer_phase!=="idle"&&i.batch.timer_phase!=="complete"&&(o(g,i.batch.timer_phase,!0),o(S,Y(),!0),o(B,i.batch.timer_paused_at!=null),!e(B)&&e(S)>0&&Z()),()=>{L&&clearInterval(L)}));var me=sl(),we=a(me),Be=s(a(we),2);{var se=h=>{var p=Wr();l(h,p)},w=h=>{var p=We(),c=oe(p);{var f=k=>{var y=Xr();let F;var V=a(y,!0);t(y),u(()=>{F=Le(y,1,"phase-badge svelte-ukh80y",null,F,{mash:e(g)==="mash",boil:e(g)==="boil"}),d(V,e(M))}),l(k,y)};v(c,k=>{e(g)!=="idle"&&e(g)!=="complete"&&k(f)},!0)}l(h,p)};v(Be,h=>{e(K)?h(se):h(w,!1)})}t(we);var m=s(we,2);{var x=h=>{var p=Jr(),c=a(p),f=s(a(c),2),k=a(f);k.__click=()=>o(R,Math.max(1,e(R)-5),!0);var y=s(k,2),F=a(y,!0);t(y);var V=s(y,2);V.__click=()=>o(R,e(R)+5),ke(2),t(f),t(c);var E=s(c,2),ce=s(a(E),2),ae=a(ce),_e=a(ae,!0);t(ae),ke(2),t(ce),t(E);var ie=s(E,2),je=a(ie);je.__click=le;var Ce=s(je,2);Ce.__click=P,t(ie),t(p),u(()=>{d(F,e(R)),d(_e,e(q))}),l(h,p)},b=h=>{var p=We(),c=oe(p);{var f=y=>{var F=Kr(),V=s(a(F),4);V.__click=re,t(F),l(y,F)},k=y=>{var F=al(),V=a(F),E=a(V),ce=a(E,!0);t(E),ke(2),t(V);var ae=s(V,2),_e=a(ae);let ie;t(ae);var je=s(ae,2),Ce=a(je);Ce.__click=H;var Fe=s(Ce,2);let Ge;Fe.__click=$;var ze=a(Fe);{var pe=be=>{var ye=Yr();ke(),l(be,ye)},_=be=>{var ye=Qr();ke(),l(be,ye)};v(ze,be=>{e(B)?be(pe):be(_,!1)})}t(Fe);var j=s(Fe,2);j.__click=N,t(je);var T=s(je,2);{var D=be=>{var ye=el(),Xe=s(a(ye),2);Bt(Xe,21,()=>e(Q),Kt,(ft,ut)=>{const zt=O(()=>Math.floor(e(S)/60)),C=O(()=>e(ut).time<=e(zt)&&!e(r).has(e(ut).time)),z=O(()=>e(r).has(e(ut).time)||e(ut).time>e(zt));var ge=$r();let G;var ve=a(ge),A=a(ve);t(ve);var I=s(ve,2),he=a(I,!0);t(I);var Te=s(I,2),Je=a(Te);t(Te);var Ie=s(Te,2);{var Ue=Ne=>{var Ye=Zr();l(Ne,Ye)};v(Ie,Ne=>{e(z)&&Ne(Ue)})}t(ge),u(()=>{G=Le(ge,1,"hop-item svelte-ukh80y",null,G,{next:e(C),done:e(z)}),d(A,`${e(ut).time??""}m`),d(he,e(ut).name),d(Je,`${e(ut).amount??""}g`)}),l(ft,ge)}),t(Xe),t(ye),l(be,ye)};v(T,be=>{e(g)==="boil"&&e(Q).length>0&&be(D)})}var W=s(T,2),J=a(W);{var ne=be=>{var ye=tl();ye.__click=P,l(be,ye)};v(J,be=>{e(g)==="mash"&&be(ne)})}var fe=s(J,2);fe.__click=re,t(W),t(F),u(()=>{d(ce,e(de)),ie=Le(_e,1,"progress-fill svelte-ukh80y",null,ie,{mash:e(g)==="mash",boil:e(g)==="boil"}),Ft(_e,`width: ${e(Me)??""}%`),Ge=Le(Fe,1,"control-btn pause svelte-ukh80y",null,Ge,{paused:e(B)})}),l(y,F)};v(c,y=>{e(g)==="complete"?y(f):y(k,!1)},!0)}l(h,p)};v(m,h=>{e(g)==="idle"?h(x):h(b,!1)})}t(me),l(Re,me),Ht()}Qt(["click"]);var ll=n('<label class="next-item svelte-ue9vqt"><input type="checkbox" class="svelte-ue9vqt"/> <span class="item-text svelte-ue9vqt"> </span></label>'),il=n('<div class="next-items svelte-ue9vqt"></div>'),nl=n('<label><input type="checkbox" class="svelte-ue9vqt"/> <span class="item-text svelte-ue9vqt"> </span></label>'),vl=n('<div class="all-items svelte-ue9vqt"></div>'),ol=n('<div class="checklist-compact svelte-ue9vqt"><button type="button" class="checklist-header svelte-ue9vqt"><div class="header-left svelte-ue9vqt"><span><!></span> <span class="title svelte-ue9vqt">Checklist</span> <span class="progress-text svelte-ue9vqt"> </span></div> <div class="header-right svelte-ue9vqt"><div class="mini-progress svelte-ue9vqt"><div class="mini-fill svelte-ue9vqt"></div></div> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></div></button> <!> <!></div>');function dl(Re,i){Ut(i,!0);let g=U(Qe([])),S=U(!1),L=O(()=>`brewday-checklist-${i.batchId}`);function B(){const b=[];return b.push({id:"prep-sanitize",text:"Sanitize equipment",checked:!1,category:"prep"}),b.push({id:"prep-water",text:"Heat strike water",checked:!1,category:"prep"}),i.recipe.fermentables&&i.recipe.fermentables.forEach((h,p)=>{b.push({id:`ferm-${p}`,text:`Mill: ${h.name}`,checked:!1,category:"prep"})}),b.push({id:"mash-dough-in",text:"Dough in",checked:!1,category:"mash"}),b.push({id:"mash-temp",text:"Check mash temp",checked:!1,category:"mash"}),b.push({id:"mash-sparge",text:"Sparge",checked:!1,category:"mash"}),b.push({id:"boil-preboil",text:"Record pre-boil gravity",checked:!1,category:"boil"}),b.push({id:"boil-start",text:"Bring to boil",checked:!1,category:"boil"}),i.recipe.hops&&i.recipe.hops.filter(p=>p.timing?.use==="add_to_boil"||!p.timing?.use).sort((p,c)=>(c.timing?.duration?.value||0)-(p.timing?.duration?.value||0)).forEach((p,c)=>{const f=p.timing?.duration?.value||0;b.push({id:`hop-${c}`,text:`${p.name} @ ${f}min`,checked:!1,category:"boil"})}),b.push({id:"postboil-chill",text:"Chill wort",checked:!1,category:"post-boil"}),b.push({id:"postboil-og",text:"Record OG",checked:!1,category:"post-boil"}),b.push({id:"postboil-transfer",text:"Transfer to fermenter",checked:!1,category:"post-boil"}),b.push({id:"postboil-yeast",text:"Pitch yeast",checked:!1,category:"post-boil"}),b}function K(){try{const b=localStorage.getItem(e(L));if(b){const h=JSON.parse(b),p=B(),c=new Map(h.map(k=>[k.id,k]));for(const k of p){const y=c.get(k.id);y&&(k.checked=y.checked)}const f=h.filter(k=>k.category==="custom");o(g,[...p,...f],!0)}else o(g,B(),!0)}catch{o(g,B(),!0)}}function r(){try{localStorage.setItem(e(L),JSON.stringify(e(g)))}catch(b){console.warn("Failed to save checklist:",b)}}function R(b){o(g,e(g).map(h=>h.id===b?{...h,checked:!h.checked}:h),!0),r()}let q=O(()=>e(g).filter(b=>b.checked).length),Q=O(()=>e(g).length),de=O(()=>e(Q)>0?Math.round(e(q)/e(Q)*100):0),Me=O(()=>e(g).filter(b=>!b.checked).slice(0,3));Ma(()=>{K()});var M=ol(),Y=a(M);Y.__click=()=>o(S,!e(S));var X=a(Y),le=a(X);let P;var Z=a(le);{var $=b=>{var h=Jt("‚úì");l(b,h)},re=b=>{var h=Jt("‚òê");l(b,h)};v(Z,b=>{e(de)===100?b($):b(re,!1)})}t(le);var N=s(le,4),H=a(N);t(N),t(X);var te=s(X,2),ee=a(te),me=a(ee);t(ee);var we=s(ee,2);let Be;t(te),t(Y);var se=s(Y,2);{var w=b=>{var h=il();Bt(h,21,()=>e(Me),p=>p.id,(p,c)=>{var f=ll();f.__click=V=>V.stopPropagation();var k=a(f);wt(k),k.__change=()=>R(e(c).id);var y=s(k,2),F=a(y,!0);t(y),t(f),u(()=>{Ua(k,e(c).checked),d(F,e(c).text)}),l(p,f)}),t(h),l(b,h)};v(se,b=>{!e(S)&&e(Me).length>0&&b(w)})}var m=s(se,2);{var x=b=>{var h=vl();Bt(h,21,()=>e(g),p=>p.id,(p,c)=>{var f=nl();let k;var y=a(f);wt(y),y.__change=()=>R(e(c).id);var F=s(y,2),V=a(F,!0);t(F),t(f),u(()=>{k=Le(f,1,"item-row svelte-ue9vqt",null,k,{checked:e(c).checked}),Ua(y,e(c).checked),d(V,e(c).text)}),l(p,f)}),t(h),l(b,h)};v(m,b=>{e(S)&&b(x)})}t(M),u(()=>{P=Le(le,1,"check-icon svelte-ue9vqt",null,P,{done:e(de)===100}),d(H,`${e(q)??""}/${e(Q)??""}`),Ft(me,`width: ${e(de)??""}%`),Be=Le(we,0,"chevron svelte-ue9vqt",null,Be,{expanded:e(S)})}),l(Re,M),Ht()}Qt(["click","change"]);var cl=n('<span class="save-indicator svelte-1hyfh06"> </span>'),ul=n('<span class="summary-value svelte-1hyfh06"> </span>'),_l=n('<span class="summary-value svelte-1hyfh06"> </span>'),pl=n('<span class="target svelte-1hyfh06"> </span>'),fl=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Mash Temperature</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06"> </span></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Mash pH</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.01" min="4" max="7" class="field-input svelte-1hyfh06" placeholder="--"/></div> <span class="target svelte-1hyfh06">Target: 5.2-5.6</span></div></div> <div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Strike Water Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div></div></div></div>'),gl=n('<span class="summary-value svelte-1hyfh06"> </span>'),hl=n('<span class="summary-value svelte-1hyfh06"> </span>'),ml=n('<span class="target svelte-1hyfh06"> </span>'),bl=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Pre-Boil Gravity</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.001" min="1.000" max="1.200" class="field-input svelte-1hyfh06" placeholder="1.0XX"/></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Pre-Boil Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div></div></div></div>'),yl=n('<span class="summary-value og svelte-1hyfh06"> </span>'),xl=n('<span class="summary-value svelte-1hyfh06"> </span>'),kl=n('<span class="target svelte-1hyfh06"> </span>'),wl=n('<span class="target svelte-1hyfh06"> </span>'),jl=n('<span class="target svelte-1hyfh06"> </span>'),ql=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Original Gravity (OG)</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.001" min="1.000" max="1.200" class="field-input og-input svelte-1hyfh06" placeholder="1.0XX"/></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Post-Boil Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div> <!></div></div> <div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Brewhouse Efficiency</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" min="0" max="100" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">%</span></div> <!></div></div></div>'),Sl=n('<span class="has-notes svelte-1hyfh06">Has notes</span>'),Ml=n('<div class="section-content svelte-1hyfh06"><textarea class="notes-input svelte-1hyfh06" placeholder="Record any deviations, substitutions, or observations..." rows="4"></textarea></div>'),Cl=n('<div class="saving-indicator svelte-1hyfh06"><span class="spinner svelte-1hyfh06"></span> Saving...</div>'),Bl=n('<div class="observations-card svelte-1hyfh06"><div class="card-header svelte-1hyfh06"><h3 class="card-title svelte-1hyfh06">Brew Day Log</h3> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Mash</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Pre-Boil</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Post-Boil / OG</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Brew Day Notes</span> <!> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <!></div>');function Fl(Re,i){Ut(i,!0);let g=U(Qe(i.batch.actual_mash_temp??null)),S=U(Qe(i.batch.actual_mash_ph??null)),L=U(Qe(i.batch.strike_water_volume??null)),B=U(Qe(i.batch.pre_boil_gravity??null)),K=U(Qe(i.batch.pre_boil_volume??null)),r=U(Qe(i.batch.post_boil_volume??null)),R=U(Qe(i.batch.measured_og??null)),q=U(Qe(i.batch.actual_efficiency??null)),Q=U(Qe(i.batch.brew_day_notes??"")),de=U(!1),Me=U(null),M=U("mash"),Y=O(Aa),X=O(()=>i.recipe.mash_temp),le=O(()=>i.recipe.og),P=O(()=>i.recipe.pre_boil_og),Z=O(()=>i.recipe.batch_size_liters),$=O(()=>i.recipe.efficiency_percent);function re(){if(!e(R)||!e(le)||!e($))return null;const C=(e(R)-1)*1e3,z=(e(le)-1)*1e3;return z===0?null:C/z*e($)}Ma(()=>{if(e(R)&&!e(q)){const C=re();C&&o(q,Math.round(C*10)/10)}});async function N(){if(!e(de)){o(de,!0);try{const C={actual_mash_temp:e(g)??void 0,actual_mash_ph:e(S)??void 0,strike_water_volume:e(L)??void 0,pre_boil_gravity:e(B)??void 0,pre_boil_volume:e(K)??void 0,post_boil_volume:e(r)??void 0,measured_og:e(R)??void 0,actual_efficiency:e(q)??void 0,brew_day_notes:e(Q)||void 0},z=await va(i.batch.id,C);o(Me,new Date,!0),i.onUpdate?.(z)}catch(C){console.error("Failed to save observations:",C)}finally{o(de,!1)}}}function H(C){o(M,e(M)===C?null:C,!0)}var te=Bl(),ee=a(te),me=s(a(ee),2);{var we=C=>{var z=cl(),ge=a(z);t(z),u(G=>d(ge,`Saved ${G??""}`),[()=>e(Me).toLocaleTimeString()]),l(C,z)};v(me,C=>{e(Me)&&C(we)})}t(ee);var Be=s(ee,2);let se;var w=a(Be);w.__click=()=>H("mash");var m=s(a(w),2),x=a(m);{var b=C=>{var z=ul(),ge=a(z);t(z),u(G=>d(ge,`${G??""}${e(Y)??""}`),[()=>Sa(e(g))]),l(C,z)};v(x,C=>{e(g)&&C(b)})}var h=s(x,2);{var p=C=>{var z=_l(),ge=a(z);t(z),u(G=>d(ge,`pH ${G??""}`),[()=>e(S).toFixed(2)]),l(C,z)};v(h,C=>{e(S)&&C(p)})}t(m),ke(2),t(w);var c=s(w,2);{var f=C=>{var z=fl(),ge=a(z),G=a(ge),ve=s(a(G),2),A=a(ve);wt(A);var I=s(A,2),he=a(I,!0);t(I),t(ve);var Te=s(ve,2);{var Je=Ae=>{var _t=pl(),qe=a(_t);t(_t),u(Ke=>d(qe,`Target: ${Ke??""}${e(Y)??""}`),[()=>Sa(e(X))]),l(Ae,_t)};v(Te,Ae=>{e(X)&&Ae(Je)})}t(G);var Ie=s(G,2),Ue=s(a(Ie),2),Ne=a(Ue);wt(Ne),t(Ue),ke(2),t(Ie),t(ge);var Ye=s(ge,2),Ze=a(Ye),et=s(a(Ze),2),dt=a(et);wt(dt),ke(2),t(et),t(Ze),t(Ye),t(z),u(()=>d(he,e(Y))),kt("blur",A,N),mt(A,()=>e(g),Ae=>o(g,Ae)),kt("blur",Ne,N),mt(Ne,()=>e(S),Ae=>o(S,Ae)),kt("blur",dt,N),mt(dt,()=>e(L),Ae=>o(L,Ae)),l(C,z)};v(c,C=>{e(M)==="mash"&&C(f)})}t(Be);var k=s(Be,2);let y;var F=a(k);F.__click=()=>H("preboil");var V=s(a(F),2),E=a(V);{var ce=C=>{var z=gl(),ge=a(z,!0);t(z),u(G=>d(ge,G),[()=>jt(e(B))]),l(C,z)};v(E,C=>{e(B)&&C(ce)})}var ae=s(E,2);{var _e=C=>{var z=hl(),ge=a(z);t(z),u(G=>d(ge,`${G??""}L`),[()=>e(K).toFixed(1)]),l(C,z)};v(ae,C=>{e(K)&&C(_e)})}t(V),ke(2),t(F);var ie=s(F,2);{var je=C=>{var z=bl(),ge=a(z),G=a(ge),ve=s(a(G),2),A=a(ve);wt(A),t(ve);var I=s(ve,2);{var he=Ue=>{var Ne=ml(),Ye=a(Ne);t(Ne),u(Ze=>d(Ye,`Target: ${Ze??""}`),[()=>jt(e(P))]),l(Ue,Ne)};v(I,Ue=>{e(P)&&Ue(he)})}t(G);var Te=s(G,2),Je=s(a(Te),2),Ie=a(Je);wt(Ie),ke(2),t(Je),t(Te),t(ge),t(z),kt("blur",A,N),mt(A,()=>e(B),Ue=>o(B,Ue)),kt("blur",Ie,N),mt(Ie,()=>e(K),Ue=>o(K,Ue)),l(C,z)};v(ie,C=>{e(M)==="preboil"&&C(je)})}t(k);var Ce=s(k,2);let Fe;var Ge=a(Ce);Ge.__click=()=>H("postboil");var ze=s(a(Ge),2),pe=a(ze);{var _=C=>{var z=yl(),ge=a(z,!0);t(z),u(G=>d(ge,G),[()=>jt(e(R))]),l(C,z)};v(pe,C=>{e(R)&&C(_)})}var j=s(pe,2);{var T=C=>{var z=xl(),ge=a(z);t(z),u(G=>d(ge,`${G??""}% eff`),[()=>e(q).toFixed(0)]),l(C,z)};v(j,C=>{e(q)&&C(T)})}t(ze),ke(2),t(Ge);var D=s(Ge,2);{var W=C=>{var z=ql(),ge=a(z),G=a(ge),ve=s(a(G),2),A=a(ve);wt(A),t(ve);var I=s(ve,2);{var he=qe=>{var Ke=kl(),Tt=a(Ke);t(Ke),u(oa=>d(Tt,`Target: ${oa??""}`),[()=>jt(e(le))]),l(qe,Ke)};v(I,qe=>{e(le)&&qe(he)})}t(G);var Te=s(G,2),Je=s(a(Te),2),Ie=a(Je);wt(Ie),ke(2),t(Je);var Ue=s(Je,2);{var Ne=qe=>{var Ke=wl(),Tt=a(Ke);t(Ke),u(oa=>d(Tt,`Target: ${oa??""}L`),[()=>e(Z).toFixed(1)]),l(qe,Ke)};v(Ue,qe=>{e(Z)&&qe(Ne)})}t(Te),t(ge);var Ye=s(ge,2),Ze=a(Ye),et=s(a(Ze),2),dt=a(et);wt(dt),ke(2),t(et);var Ae=s(et,2);{var _t=qe=>{var Ke=jl(),Tt=a(Ke);t(Ke),u(oa=>d(Tt,`Target: ${oa??""}%`),[()=>e($).toFixed(0)]),l(qe,Ke)};v(Ae,qe=>{e($)&&qe(_t)})}t(Ze),t(Ye),t(z),kt("blur",A,N),mt(A,()=>e(R),qe=>o(R,qe)),kt("blur",Ie,N),mt(Ie,()=>e(r),qe=>o(r,qe)),kt("blur",dt,N),mt(dt,()=>e(q),qe=>o(q,qe)),l(C,z)};v(D,C=>{e(M)==="postboil"&&C(W)})}t(Ce);var J=s(Ce,2);let ne;var fe=a(J);fe.__click=()=>H("notes");var be=s(a(fe),2);{var ye=C=>{var z=Sl();l(C,z)};v(be,C=>{e(Q)&&C(ye)})}ke(2),t(fe);var Xe=s(fe,2);{var ft=C=>{var z=Ml(),ge=a(z);Da(ge),t(z),kt("blur",ge,N),mt(ge,()=>e(Q),G=>o(Q,G)),l(C,z)};v(Xe,C=>{e(M)==="notes"&&C(ft)})}t(J);var ut=s(J,2);{var zt=C=>{var z=Cl();l(C,z)};v(ut,C=>{e(de)&&C(zt)})}t(te),u(()=>{se=Le(Be,1,"section svelte-1hyfh06",null,se,{expanded:e(M)==="mash"}),y=Le(k,1,"section svelte-1hyfh06",null,y,{expanded:e(M)==="preboil"}),Fe=Le(Ce,1,"section svelte-1hyfh06",null,Fe,{expanded:e(M)==="postboil"}),ne=Le(J,1,"section svelte-1hyfh06",null,ne,{expanded:e(M)==="notes"})}),l(Re,te),Ht()}Qt(["click"]);var zl=n('<span class="packaged-badge svelte-1yofiqc">Packaged</span>'),Tl=n('<span class="save-indicator svelte-1yofiqc">Saved</span>'),Dl=n("<option> </option>"),Al=n("<option> </option>"),Rl=n('<div class="field-row priming-row svelte-1yofiqc"><div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Priming Sugar Type</label> <input type="text" class="field-input svelte-1yofiqc" placeholder="e.g., table sugar, corn sugar"/></div> <div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Amount</label> <div class="input-with-unit svelte-1yofiqc"><input type="number" step="1" class="field-input svelte-1yofiqc" placeholder="--"/> <span class="unit svelte-1yofiqc">g</span></div></div></div>'),Pl=n('<div class="card-content svelte-1yofiqc"><div class="field-row svelte-1yofiqc"><div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Packaged On</label> <input type="date" class="field-input svelte-1yofiqc"/></div> <div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Package Type</label> <select class="field-input svelte-1yofiqc"><option>Select...</option><!></select></div></div> <div class="field-row svelte-1yofiqc"><div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Volume Packaged</label> <div class="input-with-unit svelte-1yofiqc"><input type="number" step="0.1" class="field-input svelte-1yofiqc" placeholder="--"/> <span class="unit svelte-1yofiqc">L</span></div></div> <div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Carbonation Method</label> <select class="field-input svelte-1yofiqc"><option>Select...</option><!></select></div></div> <!> <div class="field full-width svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Packaging Notes</label> <textarea class="notes-input svelte-1yofiqc" placeholder="Any observations about packaging day..." rows="3"></textarea></div></div>'),Nl=n('<div class="saving-indicator svelte-1yofiqc"><span class="spinner svelte-1yofiqc"></span> Saving...</div>'),Ol=n('<div class="packaging-card svelte-1yofiqc"><button type="button" class="card-header svelte-1yofiqc"><div class="header-content svelte-1yofiqc"><h3 class="card-title svelte-1yofiqc">Packaging</h3> <!></div> <div class="header-right svelte-1yofiqc"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div></button> <!> <!></div>');function Ll(Re,i){Ut(i,!0);let g=U(Qe(i.batch.packaged_at?i.batch.packaged_at.split("T")[0]:"")),S=U(Qe(i.batch.packaging_type??"")),L=U(Qe(i.batch.packaging_volume??null)),B=U(Qe(i.batch.carbonation_method??"")),K=U(Qe(i.batch.priming_sugar_type??"")),r=U(Qe(i.batch.priming_sugar_amount??null)),R=U(Qe(i.batch.packaging_notes??"")),q=U(!1),Q=U(null),de=U(!i.batch.packaged_at),Me=O(()=>e(B)==="bottle_conditioned"||e(B)==="keg_conditioned");async function M(){if(!e(q)){o(q,!0);try{const x={packaged_at:e(g)?new Date(e(g)).toISOString():void 0,packaging_type:e(S)||void 0,packaging_volume:e(L)??void 0,carbonation_method:e(B)||void 0,priming_sugar_type:e(Me)&&e(K)||void 0,priming_sugar_amount:e(Me)?e(r)??void 0:void 0,packaging_notes:e(R)||void 0},b=await va(i.batch.id,x);o(Q,new Date,!0),i.onUpdate?.(b)}catch(x){console.error("Failed to save packaging info:",x)}finally{o(q,!1)}}}function Y(){o(de,!e(de))}const X=[{value:"keg",label:"Keg"},{value:"bottles",label:"Bottles"},{value:"cans",label:"Cans"}],le=[{value:"forced",label:"Force Carbonated"},{value:"bottle_conditioned",label:"Bottle Conditioned"},{value:"keg_conditioned",label:"Keg Conditioned"},{value:"natural",label:"Naturally Carbonated"}];var P=Ol(),Z=a(P);Z.__click=Y;var $=a(Z),re=s(a($),2);{var N=x=>{var b=zl();l(x,b)};v(re,x=>{i.batch.packaged_at&&x(N)})}t($);var H=s($,2),te=a(H);{var ee=x=>{var b=Tl();l(x,b)};v(te,x=>{e(Q)&&x(ee)})}var me=s(te,2);let we;t(H),t(Z);var Be=s(Z,2);{var se=x=>{var b=Pl(),h=a(b),p=a(h),c=s(a(p),2);wt(c),t(p);var f=s(p,2),k=s(a(f),2);k.__change=M;var y=a(k);y.value=y.__value="";var F=s(y);Bt(F,17,()=>X,Kt,(_,j)=>{var T=Dl(),D=a(T,!0);t(T);var W={};u(()=>{d(D,e(j).label),W!==(W=e(j).value)&&(T.value=(T.__value=e(j).value)??"")}),l(_,T)}),t(k),t(f),t(h);var V=s(h,2),E=a(V),ce=s(a(E),2),ae=a(ce);wt(ae),ke(2),t(ce),t(E);var _e=s(E,2),ie=s(a(_e),2);ie.__change=M;var je=a(ie);je.value=je.__value="";var Ce=s(je);Bt(Ce,17,()=>le,Kt,(_,j)=>{var T=Al(),D=a(T,!0);t(T);var W={};u(()=>{d(D,e(j).label),W!==(W=e(j).value)&&(T.value=(T.__value=e(j).value)??"")}),l(_,T)}),t(ie),t(_e),t(V);var Fe=s(V,2);{var Ge=_=>{var j=Rl(),T=a(j),D=s(a(T),2);wt(D),t(T);var W=s(T,2),J=s(a(W),2),ne=a(J);wt(ne),ke(2),t(J),t(W),t(j),kt("blur",D,M),mt(D,()=>e(K),fe=>o(K,fe)),kt("blur",ne,M),mt(ne,()=>e(r),fe=>o(r,fe)),l(_,j)};v(Fe,_=>{e(Me)&&_(Ge)})}var ze=s(Fe,2),pe=s(a(ze),2);Da(pe),t(ze),t(b),kt("blur",c,M),mt(c,()=>e(g),_=>o(g,_)),Ta(k,()=>e(S),_=>o(S,_)),kt("blur",ae,M),mt(ae,()=>e(L),_=>o(L,_)),Ta(ie,()=>e(B),_=>o(B,_)),kt("blur",pe,M),mt(pe,()=>e(R),_=>o(R,_)),l(x,b)};v(Be,x=>{e(de)&&x(se)})}var w=s(Be,2);{var m=x=>{var b=Nl();l(x,b)};v(w,x=>{e(q)&&x(m)})}t(P),u(()=>we=Le(me,0,"chevron svelte-1yofiqc",null,we,{expanded:e(de)})),l(Re,P),Ht()}Qt(["click","change"]);var El=n('<span class="note-count svelte-11n209s"> </span>'),Gl=n('<span class="avg-score svelte-11n209s"> </span>'),Il=n('<button type="button" class="add-note-btn svelte-11n209s"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> Add Tasting Note</button>'),Ul=n('<button type="button"> </button>'),Hl=n('<div class="score-category svelte-11n209s"><div class="category-header svelte-11n209s"><span class="category-label svelte-11n209s"> </span> <div class="score-selector svelte-11n209s"></div></div> <textarea class="category-notes svelte-11n209s" rows="2"></textarea></div>'),Vl=n('<div class="note-form svelte-11n209s"><div class="form-header svelte-11n209s"><h4 class="svelte-11n209s"> </h4> <button type="button" class="close-btn svelte-11n209s"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <!> <div class="form-actions svelte-11n209s"><button type="button" class="cancel-btn svelte-11n209s">Cancel</button> <button type="button" class="save-btn svelte-11n209s"> </button></div></div>'),Wl=n('<div><span class="score-label svelte-11n209s"> </span> <span class="score-value svelte-11n209s"> </span></div>'),Xl=n('<p class="note-text svelte-11n209s"> </p>'),Jl=n('<div><div class="note-header svelte-11n209s"><span class="note-date svelte-11n209s"> </span> <div class="note-actions svelte-11n209s"><button type="button" class="action-btn svelte-11n209s" title="Edit"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button> <button type="button" class="action-btn delete svelte-11n209s" title="Delete"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div> <div class="note-scores svelte-11n209s"></div> <!></div>'),Kl=n('<div class="notes-list svelte-11n209s"></div>'),Yl=n('<p class="empty-message svelte-11n209s">No tasting notes yet. Add your first one to track how this batch develops over time.</p>'),Ql=n('<div class="card-content svelte-11n209s"><!> <!> <!></div>'),Zl=n('<div class="tasting-card svelte-11n209s"><button type="button" class="card-header svelte-11n209s"><div class="header-content svelte-11n209s"><h3 class="card-title svelte-11n209s">Tasting Notes</h3> <!></div> <div class="header-right svelte-11n209s"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div></button> <!></div>');function $l(Re,i){Ut(i,!0);let g=U(Qe(i.batch.tasting_notes??[])),S=U(!0),L=U(!1),B=U(null),K=U(!1),r=U(Qe({appearance_score:void 0,appearance_notes:"",aroma_score:void 0,aroma_notes:"",flavor_score:void 0,flavor_notes:"",mouthfeel_score:void 0,mouthfeel_notes:"",overall_score:void 0,overall_notes:""})),R=O(()=>()=>{if(e(g).length===0)return null;const w=e(g).filter(m=>m.overall_score!=null).map(m=>m.overall_score);return w.length===0?null:(w.reduce((m,x)=>m+x,0)/w.length).toFixed(1)});function q(){o(S,!e(S))}function Q(){o(r,{appearance_score:void 0,appearance_notes:"",aroma_score:void 0,aroma_notes:"",flavor_score:void 0,flavor_notes:"",mouthfeel_score:void 0,mouthfeel_notes:"",overall_score:void 0,overall_notes:""},!0),o(B,null),o(L,!1)}function de(){Q(),o(L,!0)}function Me(w){o(r,{appearance_score:w.appearance_score??void 0,appearance_notes:w.appearance_notes??"",aroma_score:w.aroma_score??void 0,aroma_notes:w.aroma_notes??"",flavor_score:w.flavor_score??void 0,flavor_notes:w.flavor_notes??"",mouthfeel_score:w.mouthfeel_score??void 0,mouthfeel_notes:w.mouthfeel_notes??"",overall_score:w.overall_score??void 0,overall_notes:w.overall_notes??""},!0),o(B,w.id,!0),o(L,!0)}async function M(){if(!e(K)){o(K,!0);try{if(e(B)){const w=await ys(i.batch.id,e(B),e(r));o(g,e(g).map(m=>m.id===e(B)?w:m),!0)}else{const w=await xs(i.batch.id,e(r));o(g,[w,...e(g)],!0)}Q(),i.onUpdate?.({...i.batch,tasting_notes:e(g)})}catch(w){console.error("Failed to save tasting note:",w)}finally{o(K,!1)}}}async function Y(w){if(confirm("Delete this tasting note?"))try{await ks(i.batch.id,w),o(g,e(g).filter(m=>m.id!==w),!0),i.onUpdate?.({...i.batch,tasting_notes:e(g)})}catch(m){console.error("Failed to delete tasting note:",m)}}function X(w){return new Date(w).toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric"})}function le(w){return w==null?"-":"‚òÖ".repeat(w)+"‚òÜ".repeat(5-w)}var P=Zl(),Z=a(P);Z.__click=q;var $=a(Z),re=s(a($),2);{var N=w=>{var m=El(),x=a(m,!0);t(m),u(()=>d(x,e(g).length)),l(w,m)};v(re,w=>{e(g).length>0&&w(N)})}t($);var H=s($,2),te=a(H);{var ee=w=>{var m=Gl(),x=a(m);t(m),u(b=>d(x,`Avg: ${b??""}/5`),[()=>e(R)()]),l(w,m)};v(te,w=>{e(R)()&&w(ee)})}var me=s(te,2);let we;t(H),t(Z);var Be=s(Z,2);{var se=w=>{var m=Ql(),x=a(m);{var b=y=>{var F=Il();F.__click=de,l(y,F)};v(x,y=>{e(L)||y(b)})}var h=s(x,2);{var p=y=>{var F=Vl(),V=a(F),E=a(V),ce=a(E);t(E);var ae=s(E,2);ae.__click=Q,t(V);var _e=s(V,2);Bt(_e,16,()=>[{key:"appearance",label:"Appearance"},{key:"aroma",label:"Aroma"},{key:"flavor",label:"Flavor"},{key:"mouthfeel",label:"Mouthfeel"},{key:"overall",label:"Overall"}],Kt,(Ge,ze)=>{var pe=Hl(),_=a(pe),j=a(_),T=a(j,!0);t(j);var D=s(j,2);Bt(D,20,()=>[1,2,3,4,5],Kt,(J,ne)=>{var fe=Ul();let be;fe.__click=()=>{const Xe=`${ze.key}_score`;e(r)[Xe]=ne};var ye=a(fe,!0);t(fe),u(()=>{be=Le(fe,1,"score-btn svelte-11n209s",null,be,{selected:e(r)[`${ze.key}_score`]===ne}),d(ye,ne)}),l(J,fe)}),t(D),t(_);var W=s(_,2);Da(W),t(pe),u(J=>{d(T,ze.label),Yt(W,"placeholder",`Notes on ${J??""}...`)},[()=>ze.label.toLowerCase()]),mt(W,()=>e(r)[`${ze.key}_notes`],J=>e(r)[`${ze.key}_notes`]=J),l(Ge,pe)});var ie=s(_e,2),je=a(ie);je.__click=Q;var Ce=s(je,2);Ce.__click=M;var Fe=a(Ce,!0);t(Ce),t(ie),t(F),u(()=>{d(ce,`${e(B)?"Edit":"New"} Tasting Note`),Ce.disabled=e(K),d(Fe,e(K)?"Saving...":e(B)?"Update":"Save")}),l(y,F)};v(h,y=>{e(L)&&y(p)})}var c=s(h,2);{var f=y=>{var F=Kl();Bt(F,21,()=>e(g),Kt,(V,E)=>{var ce=Jl();let ae;var _e=a(ce),ie=a(_e),je=a(ie,!0);t(ie);var Ce=s(ie,2),Fe=a(Ce);Fe.__click=()=>Me(e(E));var Ge=s(Fe,2);Ge.__click=()=>Y(e(E).id),t(Ce),t(_e);var ze=s(_e,2);Bt(ze,20,()=>[{key:"appearance",label:"App"},{key:"aroma",label:"Aroma"},{key:"flavor",label:"Flav"},{key:"mouthfeel",label:"Mouth"},{key:"overall",label:"Overall"}],Kt,(j,T)=>{var D=Wl();let W;var J=a(D),ne=a(J,!0);t(J);var fe=s(J,2),be=a(fe,!0);t(fe),t(D),u(ye=>{W=Le(D,1,"score-item svelte-11n209s",null,W,{overall:T.key==="overall"}),d(ne,T.label),d(be,ye)},[()=>le(e(E)[`${T.key}_score`])]),l(j,D)}),t(ze);var pe=s(ze,2);{var _=j=>{var T=Xl(),D=a(T,!0);t(T),u(()=>d(D,e(E).overall_notes)),l(j,T)};v(pe,j=>{e(E).overall_notes&&j(_)})}t(ce),u(j=>{ae=Le(ce,1,"note-item svelte-11n209s",null,ae,{editing:e(B)===e(E).id}),d(je,j)},[()=>X(e(E).tasted_at)]),l(V,ce)}),t(F),l(y,F)},k=y=>{var F=We(),V=oe(F);{var E=ce=>{var ae=Yl();l(ce,ae)};v(V,ce=>{e(L)||ce(E)},!0)}l(y,F)};v(c,y=>{e(g).length>0?y(f):y(k,!1)})}t(m),l(w,m)};v(Be,w=>{e(S)&&w(se)})}t(P),u(()=>we=Le(me,0,"chevron svelte-11n209s",null,we,{expanded:e(S)})),l(Re,P),Ht()}Qt(["click"]);var ei=n('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),ti=n('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),ai=n('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),si=n('<span class="recipe-type svelte-g5au2j"> </span>'),ri=n('<a class="recipe-link svelte-g5au2j"> <!></a>'),li=n('<div class="batch-timing svelte-g5au2j"> </div>'),ii=n('<div class="batch-timing svelte-g5au2j"> </div>'),ni=n('<option class="svelte-g5au2j"> </option>'),vi=ga('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" class="svelte-g5au2j"></path><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Resume',1),oi=ga('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Pause',1),di=n('<button type="button"><!></button>'),ci=n('<span class="chilling-icon svelte-g5au2j">üç∫</span> <h3 class="chilling-title svelte-g5au2j">Ready to Pitch!</h3>',1),ui=n('<span class="chilling-icon svelte-g5au2j">‚ùÑÔ∏è</span> <h3 class="chilling-title svelte-g5au2j">Chilling to Pitch Temperature</h3>',1),_i=n('<div class="progress-section svelte-g5au2j"><div class="progress-bar svelte-g5au2j"><div class="progress-fill svelte-g5au2j"></div></div> <span class="progress-text svelte-g5au2j"> </span></div>'),pi=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è No cooler configured - set a cooler entity to enable automated chilling</span>'),fi=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è Temperature control disabled in settings</span>'),gi=n('<span class="status-ready svelte-g5au2j">Wort has reached pitch temperature - ready to add yeast!</span>'),hi=n('<span class="status-active svelte-g5au2j">Cooler will run automatically when temp exceeds target + hysteresis</span>'),mi=n('<div><div class="chilling-header svelte-g5au2j"><!></div> <div class="chilling-content svelte-g5au2j"><div class="temp-display svelte-g5au2j"><div class="temp-current svelte-g5au2j"><span class="temp-label svelte-g5au2j">Current</span> <span class="temp-value svelte-g5au2j"> </span></div> <div class="temp-arrow svelte-g5au2j">‚Üí</div> <div class="temp-target svelte-g5au2j"><span class="temp-label svelte-g5au2j">Target</span> <span class="temp-value svelte-g5au2j"> </span></div></div> <!> <div class="chilling-status svelte-g5au2j"><!></div></div></div>'),bi=n(`<div class="paused-banner svelte-g5au2j"><div class="paused-header svelte-g5au2j"><svg class="paused-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> <h3 class="paused-title svelte-g5au2j">Readings Paused</h3></div> <p class="paused-text svelte-g5au2j">Hydrometer readings are not being stored. Live readings still display but won't be saved to the fermentation history.</p> <button type="button" class="resume-btn svelte-g5au2j"> </button></div>`),yi=n('<span class="btn-spinner svelte-g5au2j"></span> Starting...',1),xi=ga('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" class="svelte-g5au2j"></path><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Start Brew Day',1),ki=n(`<div class="planning-phase svelte-g5au2j"><div class="phase-action-card svelte-g5au2j"><div class="phase-icon svelte-g5au2j">üìã</div> <h2 class="phase-title svelte-g5au2j">Ready to Brew?</h2> <p class="phase-description svelte-g5au2j">Review your recipe below, then start brew day when you're ready to begin.</p> <button type="button" class="start-brewday-btn svelte-g5au2j"><!></button></div> <!></div>`),wi=n('<span class="btn-spinner svelte-g5au2j"></span> Starting...',1),ji=ga('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" class="svelte-g5au2j"></path></svg> Yeast Pitched - Start Fermentation',1),qi=n(`<div class="brewing-phase svelte-g5au2j"><div class="phase-action-card brewing svelte-g5au2j"><div class="phase-icon svelte-g5au2j">üç∫</div> <h2 class="phase-title svelte-g5au2j">Brew Day in Progress</h2> <p class="phase-description svelte-g5au2j">Track your brew day activities. When you've pitched the yeast and fermentation begins, transition to the fermentation phase.</p> <button type="button" class="start-fermentation-btn svelte-g5au2j"><!></button></div> <div class="brewday-tools-grid svelte-g5au2j"><!> <!></div> <!> <!> <!></div>`),Si=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot brewing svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Brew Day</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Mi=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot fermenting svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Fermentation Started</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Ci=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot conditioning svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Conditioning Started</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Bi=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot completed svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Completed</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Fi=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot packaged svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j"> </span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),zi=n('<div class="completed-phase svelte-g5au2j"><div class="batch-summary-card svelte-g5au2j"><h2 class="summary-title svelte-g5au2j">Batch Complete</h2> <div class="summary-stats svelte-g5au2j"><div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Original Gravity</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Final Gravity</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">ABV</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Attenuation</span> <span class="stat-value svelte-g5au2j"><!></span></div></div></div> <div class="timeline-card svelte-g5au2j"><h3 class="timeline-title svelte-g5au2j">Batch Timeline</h3> <div class="timeline svelte-g5au2j"><!> <!> <!> <!> <!></div></div> <!> <!> <!></div>'),Ti=n('<span class="status-badge heater svelte-g5au2j">üî• Heating</span>'),Di=n('<span class="status-badge cooler svelte-g5au2j">‚ùÑÔ∏è Cooling</span>'),Ai=n('<span class="status-badge idle svelte-g5au2j"> </span>'),Ri=n('<div class="device-status heater svelte-g5au2j"><div>üî•</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Heater</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Pi=n('<div class="device-status cooler svelte-g5au2j"><div>‚ùÑÔ∏è</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Cooler</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Ni=n('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">‚ö°</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),Oi=n('<button type="button" class="override-btn heat-on svelte-g5au2j">Force Heat ON</button> <button type="button" class="override-btn heat-off svelte-g5au2j">Force Heat OFF</button>',1),Li=n('<button type="button" class="override-btn cool-on svelte-g5au2j">Force Cool ON</button> <button type="button" class="override-btn cool-off svelte-g5au2j">Force Cool OFF</button>',1),Ei=n('<div class="control-details svelte-g5au2j"><div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns-grid svelte-g5au2j"><!> <!> <button type="button" class="override-btn auto-mode svelte-g5au2j">Auto Mode</button></div></div>',1),Gi=n('<div class="device-status-grid svelte-g5au2j"><!> <!></div> <!>',1),Ii=n('<div><button type="button" class="collapsible-header svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="collapse-indicator svelte-g5au2j"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" class="svelte-g5au2j"></path></svg></div></button> <!></div>'),Ui=n('<span class="svelte-g5au2j"> </span>'),Hi=n('<span class="svelte-g5au2j"> </span>'),Vi=n('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><!> <!> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),Wi=n('<div class="chart-section svelte-g5au2j"><!></div>'),Xi=n('<div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!> <!></div></div> <!>',1),Ji=n('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <!> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j" aria-label="Delete batch"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <!> <!> <!>',1),Ki=n('<div class="modal-overlay svelte-g5au2j" role="presentation"><div class="modal svelte-g5au2j" role="dialog" aria-modal="true" aria-labelledby="delete-modal-title" tabindex="-1"><h2 id="delete-modal-title" class="modal-title svelte-g5au2j">Delete Batch?</h2> <p class="modal-text svelte-g5au2j"> </p> <div class="modal-actions svelte-g5au2j"><button type="button" class="modal-btn cancel svelte-g5au2j">Cancel</button> <button type="button" class="modal-btn delete svelte-g5au2j"> </button></div></div></div>'),Yi=n('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div> <!>',1);function yn(Re,i){Ut(i,!0);const g=()=>us(_s,"$page",S),[S,L]=cs();let B=null,K=null,r=U(null),R=U(null),q=U(null),Q=Qe([]),de=U(!0),Me=U(null),M=U(!1),Y=U(!1),X=U(!1),le=U(!1),P=U(!1),Z=U(!1),$=U(!1),re=O(()=>parseInt(g().params.id??"0"));const N=["planning","brewing","fermenting","conditioning","completed","archived"];let H=O(()=>e(r)?Fa[e(r).status]:Fa.planning),te=O(Aa),ee=O(()=>qa.config.ha_enabled&&qa.config.temp_control_enabled&&(e(r)?.heater_entity_id||e(r)?.cooler_entity_id)),me=O(()=>e(r)?.status==="planning"&&e(r)?.temp_target!=null),we=O(()=>!e(me)||!e(se)?.temp||!e(r)?.temp_target?!1:e(se).temp<=e(r).temp_target),Be=O(()=>{if(!e(me)||!e(se)?.temp||!e(r)?.temp_target)return null;const _=e(r).temp_target+30,j=e(se).temp,T=e(r).temp_target;if(j<=T)return 100;if(j>=_)return 0;const D=(_-j)/(_-T)*100;return Math.min(100,Math.max(0,D))}),se=O(()=>{if(!e(r)?.device_id)return null;const _=Ha.tilts.get(e(r).device_id);if(_)return _;const j=e(r).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!j?.[1])return null;const T=j[1].toUpperCase();for(const D of Ha.tilts.values())if(D.color&&D.color.toUpperCase()===T)return D;return null});async function w(){o(de,!0),o(Me,null);try{if(o(r,await ws(e(re)),!0),e(r).status==="fermenting"||e(r).status==="conditioning"||e(r).status==="completed")try{o(R,await Ca(e(re)),!0)}catch{}if(e(r).heater_entity_id||e(r).cooler_entity_id)try{o(q,await ja(e(re)),!0)}catch{}}catch(_){o(Me,_ instanceof Error?_.message:"Failed to load batch",!0)}finally{o(de,!1)}}async function m(_){if(!(!e(r)||e(Y))&&!(_==="conditioning"&&e(r).status==="fermenting"&&!confirm(`üí° Entering Conditioning Phase

Reminder: Adjust target temperature if cold crashing.
Temperature control will continue during conditioning.

Continue?`))){o(Y,!0);try{o(r,await va(e(r).id,{status:_}),!0),(_==="fermenting"||_==="conditioning")&&o(R,await Ca(e(r).id),!0)}catch(j){console.error("Failed to update status:",j)}finally{o(Y,!1)}}}async function x(){if(!(!e(r)||e(Y))){o(Y,!0);try{o(r,await va(e(r).id,{status:"brewing"}),!0)}catch(_){console.error("Failed to start brew day:",_)}finally{o(Y,!1)}}}async function b(){if(!(!e(r)||e(Y))){o(Y,!0);try{o(r,await va(e(r).id,{status:"fermenting"}),!0),o(R,await Ca(e(r).id),!0)}catch(_){console.error("Failed to start fermentation:",_)}finally{o(Y,!1)}}}async function h(_){if(e(r)&&(o(r,await va(e(r).id,_),!0),o(M,!1),e(r).heater_entity_id||e(r).cooler_entity_id))try{o(q,await ja(e(r).id),!0)}catch{}}async function p(){if(e(r)){o(P,!0);try{await js(e(r).id),ps("/batches")}catch(_){o(Me,_ instanceof Error?_.message:"Failed to delete batch",!0),o(P,!1),o(le,!1)}}}async function c(){if(!(!e(r)||e($))){o($,!0);try{o(r,await va(e(r).id,{readings_paused:!e(r).readings_paused}),!0)}catch(_){console.error("Failed to toggle pause:",_)}finally{o($,!1)}}}async function f(_,j){if(!(!e(r)||e(X))){o(X,!0);try{await Ba(e(r).id,j,60,_),o(q,await ja(e(r).id),!0)}catch(T){console.error("Failed to set override:",T)}finally{o(X,!1)}}}async function k(){if(!(!e(r)||e(X))){o(X,!0);try{e(r).heater_entity_id&&await Ba(e(r).id,null,60,"heater"),e(r).cooler_entity_id&&await Ba(e(r).id,null,60,"cooler"),o(q,await ja(e(r).id),!0)}catch(_){console.error("Failed to clear overrides:",_)}finally{o(X,!1)}}}function y(){if(B?.readyState===WebSocket.OPEN)return;const j=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;B=new WebSocket(j),B.onmessage=async T=>{try{const D=JSON.parse(T.data);D.type==="control_event"&&D.batch_id===e(re)&&e(q)&&(D.action==="heat_on"?o(q,{...e(q),heater_state:"on"},!0):D.action==="heat_off"?o(q,{...e(q),heater_state:"off"},!0):D.action==="cool_on"?o(q,{...e(q),cooler_state:"on"},!0):D.action==="cool_off"&&o(q,{...e(q),cooler_state:"off"},!0))}catch{}},B.onclose=()=>{B=null,K=setTimeout(y,3e3)},B.onerror=()=>{B?.close()}}function F(){K&&(clearTimeout(K),K=null),B?.close(),B=null}function V(_){return _==null?"--":jt(_)}function E(_){return _==null?"--":Sa(_)}function ce(_){return _?new Date(_).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"--"}function ae(_){if(!_)return"--";const j=new Date(_),D=(new Date().getTime()-j.getTime())/(1e3*60*60);if(D<1)return`${Math.round(D*60)}m`;if(D<24)return`${D.toFixed(1)}h`;const W=D/24;return W<7?`${W.toFixed(1)}d`:`${Math.round(W)}d`}function _e(_){return _?new Date(_).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"}):"--"}Xa(()=>{w(),y()}),ls(()=>{F()});var ie=Yi();vs("g5au2j",_=>{is(()=>{ns.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var je=oe(ie),Ce=s(a(je),2);{var Fe=_=>{var j=ei();l(_,j)},Ge=_=>{var j=We(),T=oe(j);{var D=J=>{var ne=ti(),fe=s(a(ne),2),be=a(fe,!0);t(fe);var ye=s(fe,2);ye.__click=w,t(ne),u(()=>d(be,e(Me))),l(J,ne)},W=J=>{var ne=We(),fe=oe(ne);{var be=Xe=>{var ft=ai();l(Xe,ft)},ye=Xe=>{var ft=We(),ut=oe(ft);{var zt=z=>{qs(z,{get batch(){return e(r)},onSubmit:h,onCancel:()=>o(M,!1)})},C=z=>{var ge=Ji(),G=oe(ge),ve=a(G),A=a(ve),I=a(A);t(A);var he=s(A,2),Te=a(he),Je=a(Te,!0);t(Te);var Ie=s(Te,2);{var Ue=De=>{var xe=ri(),Ee=a(xe),tt=s(Ee);{var it=lt=>{var $e=si(),nt=a($e);t($e),u(()=>d(nt,`(${e(r).recipe.type??""})`)),l(lt,$e)};v(tt,lt=>{e(r).recipe.type&&lt(it)})}t(xe),u(()=>{Yt(xe,"href",`/recipes/${e(r).recipe.id??""}`),d(Ee,`${e(r).recipe.name??""} `)}),l(De,xe)};v(Ie,De=>{e(r).recipe&&De(Ue)})}var Ne=s(Ie,2);{var Ye=De=>{var xe=li(),Ee=a(xe);t(xe),u((tt,it)=>d(Ee,`Started ${tt??""} ¬∑ ${it??""} ago`),[()=>ce(e(r).start_time),()=>ae(e(r).start_time)]),l(De,xe)},Ze=De=>{var xe=We(),Ee=oe(xe);{var tt=it=>{var lt=ii(),$e=a(lt);t(lt),u(nt=>d($e,`Brewed ${nt??""}`),[()=>ce(e(r).brew_date)]),l(it,lt)};v(Ee,it=>{e(r).brew_date&&it(tt)},!0)}l(De,xe)};v(Ne,De=>{e(r).start_time?De(Ye):De(Ze,!1)})}t(he),t(ve);var et=s(ve,2),dt=a(et),Ae=a(dt);Ae.__change=De=>m(De.currentTarget.value),Bt(Ae,21,()=>N,Kt,(De,xe)=>{var Ee=ni(),tt=a(Ee,!0);t(Ee);var it={};u(()=>{d(tt,Fa[e(xe)].label),it!==(it=e(xe))&&(Ee.value=(Ee.__value=e(xe))??"")}),l(De,Ee)}),t(Ae);var _t;os(Ae),t(dt);var qe=s(dt,2);{var Ke=De=>{var xe=di();let Ee;xe.__click=c;var tt=a(xe);{var it=$e=>{var nt=vi();ke(),l($e,nt)},lt=$e=>{var nt=oi();ke(),l($e,nt)};v(tt,$e=>{e(r).readings_paused?$e(it):$e(lt,!1)})}t(xe),u(()=>{Ee=Le(xe,1,"pause-btn svelte-g5au2j",null,Ee,{paused:e(r).readings_paused}),xe.disabled=e($),Yt(xe,"title",e(r).readings_paused?"Resume storing readings":"Pause storing readings")}),l(De,xe)};v(qe,De=>{(e(r).status==="fermenting"||e(r).status==="conditioning")&&De(Ke)})}var Tt=s(qe,2);Tt.__click=()=>o(M,!0);var oa=s(Tt,2);oa.__click=()=>o(le,!0),t(et),t(G);var Ra=s(G,2);{var Ka=De=>{var xe=mi();let Ee;var tt=a(xe),it=a(tt);{var lt=He=>{var st=ci();ke(2),l(He,st)},$e=He=>{var st=ui();ke(2),l(He,st)};v(it,He=>{e(we)?He(lt):He($e,!1)})}t(tt);var nt=s(tt,2),Dt=a(nt),vt=a(Dt),gt=s(a(vt),2),Vt=a(gt,!0);t(gt),t(vt);var bt=s(vt,4),At=s(a(bt),2),Wt=a(At,!0);t(At),t(bt),t(Dt);var Zt=s(Dt,2);{var da=He=>{var st=_i(),Se=a(st),yt=a(Se);t(Se);var ra=s(Se,2),Pt=a(ra);t(ra),t(st),u(Xt=>{Ft(yt,`width: ${e(Be)??""}%`),d(Pt,`${Xt??""}% to target`)},[()=>Math.round(e(Be))]),l(He,st)};v(Zt,He=>{e(Be)!=null&&!e(we)&&He(da)})}var Rt=s(Zt,2),$t=a(Rt);{var ea=He=>{var st=pi();l(He,st)},ta=He=>{var st=We(),Se=oe(st);{var yt=Pt=>{var Xt=fi();l(Pt,Xt)},ra=Pt=>{var Xt=We(),ca=oe(Xt);{var Pe=ht=>{var qt=gi();l(ht,qt)},ot=ht=>{var qt=hi();l(ht,qt)};v(ca,ht=>{e(we)?ht(Pe):ht(ot,!1)},!0)}l(Pt,Xt)};v(Se,Pt=>{!qa.config.ha_enabled||!qa.config.temp_control_enabled?Pt(yt):Pt(ra,!1)},!0)}l(He,st)};v($t,He=>{e(r).cooler_entity_id?He(ta,!1):He(ea)})}t(Rt),t(nt),t(xe),u((He,st)=>{Ee=Le(xe,1,"chilling-banner svelte-g5au2j",null,Ee,{ready:e(we)}),d(Vt,He),d(Wt,st)},[()=>e(se)?.temp!=null?E(e(se).temp):"--",()=>e(r).temp_target!=null?E(e(r).temp_target):"--"]),l(De,xe)};v(Ra,De=>{e(me)&&De(Ka)})}var Pa=s(Ra,2);{var Ya=De=>{var xe=bi(),Ee=s(a(xe),4);Ee.__click=c;var tt=a(Ee,!0);t(Ee),t(xe),u(()=>{Ee.disabled=e($),d(tt,e($)?"Resuming...":"Resume Readings")}),l(De,xe)};v(Pa,De=>{e(r).readings_paused&&(e(r).status==="fermenting"||e(r).status==="conditioning")&&De(Ya)})}var Qa=s(Pa,2);{var Za=De=>{var xe=ki(),Ee=a(xe),tt=s(a(Ee),6);tt.__click=x;var it=a(tt);{var lt=vt=>{var gt=yi();ke(),l(vt,gt)},$e=vt=>{var gt=xi();ke(),l(vt,gt)};v(it,vt=>{e(Y)?vt(lt):vt($e,!1)})}t(tt),t(Ee);var nt=s(Ee,2);{var Dt=vt=>{za(vt,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(nt,vt=>{e(r).recipe&&vt(Dt)})}t(xe),u(()=>tt.disabled=e(Y)),l(De,xe)},$a=De=>{var xe=We(),Ee=oe(xe);{var tt=lt=>{var $e=qi(),nt=a($e),Dt=s(a(nt),6);Dt.__click=b;var vt=a(Dt);{var gt=Se=>{var yt=wi();ke(),l(Se,yt)},Vt=Se=>{var yt=ji();ke(),l(Se,yt)};v(vt,Se=>{e(Y)?Se(gt):Se(Vt,!1)})}t(Dt),t(nt);var bt=s(nt,2),At=a(bt);{var Wt=Se=>{rl(Se,{get batch(){return e(r)},get recipe(){return e(r).recipe}})};v(At,Se=>{e(r).recipe&&Se(Wt)})}var Zt=s(At,2);{var da=Se=>{dl(Se,{get recipe(){return e(r).recipe},get batchId(){return e(r).id}})};v(Zt,Se=>{e(r).recipe&&Se(da)})}t(bt);var Rt=s(bt,2);{var $t=Se=>{Fl(Se,{get batch(){return e(r)},get recipe(){return e(r).recipe},onUpdate:yt=>o(r,yt,!0)})};v(Rt,Se=>{e(r).recipe&&Se($t)})}var ea=s(Rt,2);{var ta=Se=>{Va(Se,{get batch(){return e(r)},get liveReading(){return e(se)},onEdit:()=>o(M,!0)})};v(ea,Se=>{e(r).device_id&&Se(ta)})}var He=s(ea,2);{var st=Se=>{za(Se,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(He,Se=>{e(r).recipe&&Se(st)})}t($e),u(()=>Dt.disabled=e(Y)),l(lt,$e)},it=lt=>{var $e=We(),nt=oe($e);{var Dt=gt=>{var Vt=zi(),bt=a(Vt),At=s(a(bt),2),Wt=a(At),Zt=s(a(Wt),2),da=a(Zt,!0);t(Zt),t(Wt);var Rt=s(Wt,2),$t=s(a(Rt),2),ea=a($t,!0);t($t),t(Rt);var ta=s(Rt,2),He=s(a(ta),2),st=a(He);t(He),t(ta);var Se=s(ta,2),yt=s(a(Se),2),ra=a(yt);{var Pt=ue=>{var Oe=Jt();u(Ve=>d(Oe,`${Ve??""}%`),[()=>((e(r).measured_og-e(r).measured_fg)/(e(r).measured_og-1)*100).toFixed(0)]),l(ue,Oe)},Xt=ue=>{var Oe=Jt("--");l(ue,Oe)};v(ra,ue=>{e(r).measured_og&&e(r).measured_fg?ue(Pt):ue(Xt,!1)})}t(yt),t(Se),t(At),t(bt);var ca=s(bt,2),Pe=s(a(ca),2),ot=a(Pe);{var ht=ue=>{var Oe=Si(),Ve=s(a(Oe),2),at=s(a(Ve),2),Mt=a(at,!0);t(at),t(Ve),t(Oe),u(xt=>d(Mt,xt),[()=>_e(e(r).brewing_started_at||e(r).brew_date)]),l(ue,Oe)};v(ot,ue=>{(e(r).brew_date||e(r).brewing_started_at)&&ue(ht)})}var qt=s(ot,2);{var la=ue=>{var Oe=Mi(),Ve=s(a(Oe),2),at=s(a(Ve),2),Mt=a(at,!0);t(at),t(Ve),t(Oe),u(xt=>d(Mt,xt),[()=>_e(e(r).fermenting_started_at||e(r).start_time)]),l(ue,Oe)};v(qt,ue=>{(e(r).start_time||e(r).fermenting_started_at)&&ue(la)})}var aa=s(qt,2);{var ha=ue=>{var Oe=Ci(),Ve=s(a(Oe),2),at=s(a(Ve),2),Mt=a(at,!0);t(at),t(Ve),t(Oe),u(xt=>d(Mt,xt),[()=>_e(e(r).conditioning_started_at)]),l(ue,Oe)};v(aa,ue=>{e(r).conditioning_started_at&&ue(ha)})}var ua=s(aa,2);{var ka=ue=>{var Oe=Bi(),Ve=s(a(Oe),2),at=s(a(Ve),2),Mt=a(at,!0);t(at),t(Ve),t(Oe),u(xt=>d(Mt,xt),[()=>_e(e(r).completed_at||e(r).end_time)]),l(ue,Oe)};v(ua,ue=>{(e(r).end_time||e(r).completed_at)&&ue(ka)})}var ma=s(ua,2);{var wa=ue=>{var Oe=Fi(),Ve=s(a(Oe),2),at=a(Ve),Mt=a(at);t(at);var xt=s(at,2),ct=a(xt,!0);t(xt),t(Ve),t(Oe),u(pt=>{d(Mt,`Packaged (${(e(r).packaging_type||"kegged")??""})`),d(ct,pt)},[()=>_e(e(r).packaged_at)]),l(ue,Oe)};v(ma,ue=>{e(r).packaged_at&&ue(wa)})}t(Pe),t(ca);var Nt=s(ca,2);Ll(Nt,{get batch(){return e(r)},onUpdate:ue=>o(r,ue,!0)});var rt=s(Nt,2);$l(rt,{get batch(){return e(r)},onUpdate:ue=>o(r,ue,!0)});var St=s(rt,2);{var _a=ue=>{Wa(ue,{get notes(){return e(r).notes}})};v(St,ue=>{e(r).notes&&ue(_a)})}t(Vt),u((ue,Oe,Ve)=>{d(da,ue),d(ea,Oe),d(st,`${Ve??""}%`)},[()=>V(e(r).measured_og),()=>V(e(r).measured_fg),()=>e(r).measured_abv?.toFixed(1)??"--"]),l(gt,Vt)},vt=gt=>{var Vt=Xi(),bt=oe(Vt),At=a(bt),Wt=a(At);{let Pe=O(()=>e(se)?.sg??e(R)?.measured?.current_sg);Is(Wt,{get batch(){return e(r)},get currentSg(){return e(Pe)},get progress(){return e(R)},get liveReading(){return e(se)}})}var Zt=s(Wt,2);{var da=Pe=>{za(Pe,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(Zt,Pe=>{e(r).recipe&&Pe(da)})}t(At);var Rt=s(At,2),$t=a(Rt);Va($t,{get batch(){return e(r)},get liveReading(){return e(se)},onEdit:()=>o(M,!0)});var ea=s($t,2);{var ta=Pe=>{Vr(Pe,{get batchId(){return e(r).id}})};v(ea,Pe=>{(e(r).status==="fermenting"||e(r).status==="conditioning")&&Pe(ta)})}var He=s(ea,2);{let Pe=O(()=>e(r).measured_fg??e(R)?.measured?.fg),ot=O(()=>e(se)?.sg??e(R)?.measured?.current_sg);Nr(He,{get batchId(){return e(r).id},get batchStatus(){return e(r).status},get measuredOg(){return e(r).measured_og},get measuredFg(){return e(Pe)},get currentSg(){return e(ot)},get liveReading(){return e(se)}})}var st=s(He,2);{var Se=Pe=>{var ot=Ii();let ht;var qt=a(ot);qt.__click=()=>o(Z,!e(Z));var la=s(a(qt),2),aa=a(la);{var ha=rt=>{var St=Ti();l(rt,St)},ua=rt=>{var St=We(),_a=oe(St);{var ue=Ve=>{var at=Di();l(Ve,at)},Oe=Ve=>{var at=We(),Mt=oe(at);{var xt=ct=>{var pt=Ai(),Ot=a(pt);t(pt),u(Lt=>d(Ot,`üéØ ${Lt??""}${e(te)??""}`),[()=>E(e(q).target_temp)]),l(ct,pt)};v(Mt,ct=>{e(Z)&&e(q)&&ct(xt)},!0)}l(Ve,at)};v(_a,Ve=>{e(q)?.cooler_state==="on"?Ve(ue):Ve(Oe,!1)},!0)}l(rt,St)};v(aa,rt=>{e(q)?.heater_state==="on"?rt(ha):rt(ua,!1)})}var ka=s(aa,2);let ma;t(la),t(qt);var wa=s(qt,2);{var Nt=rt=>{var St=Gi(),_a=oe(St),ue=a(_a);{var Oe=ct=>{var pt=Ri(),Ot=a(pt);let Lt;var ia=s(Ot,2),Et=s(a(ia),2);let na;var ba=a(Et,!0);t(Et);var pa=s(Et,2),ya=a(pa,!0);t(pa),t(ia),t(pt),u(()=>{Lt=Le(Ot,1,"device-icon-wrap svelte-g5au2j",null,Lt,{active:e(q)?.heater_state==="on"}),na=Le(Et,1,"device-state svelte-g5au2j",null,na,{on:e(q)?.heater_state==="on"}),d(ba,e(q)?.heater_state==="on"?"ON":"OFF"),d(ya,e(r).heater_entity_id)}),l(ct,pt)};v(ue,ct=>{e(r).heater_entity_id&&ct(Oe)})}var Ve=s(ue,2);{var at=ct=>{var pt=Pi(),Ot=a(pt);let Lt;var ia=s(Ot,2),Et=s(a(ia),2);let na;var ba=a(Et,!0);t(Et);var pa=s(Et,2),ya=a(pa,!0);t(pa),t(ia),t(pt),u(()=>{Lt=Le(Ot,1,"device-icon-wrap svelte-g5au2j",null,Lt,{active:e(q)?.cooler_state==="on"}),na=Le(Et,1,"device-state svelte-g5au2j",null,na,{on:e(q)?.cooler_state==="on"}),d(ba,e(q)?.cooler_state==="on"?"ON":"OFF"),d(ya,e(r).cooler_entity_id)}),l(ct,pt)};v(Ve,ct=>{e(r).cooler_entity_id&&ct(at)})}t(_a);var Mt=s(_a,2);{var xt=ct=>{var pt=Ei(),Ot=oe(pt),Lt=a(Ot),ia=s(a(Lt),2),Et=a(ia);t(ia),t(Lt);var na=s(Lt,2),ba=s(a(na),2),pa=a(ba);t(ba),t(na),t(Ot);var ya=s(Ot,2);{var es=Ct=>{var Gt=Ni(),It=s(a(Gt),2),fa=a(It);t(It);var Ia=s(It,2);Ia.__click=()=>k(),t(Gt),u(ss=>{d(fa,`Override active: ${ss??""}`),Ia.disabled=e(X)},[()=>e(q).override_state?.toUpperCase()]),l(Ct,Gt)};v(ya,Ct=>{e(q).override_active&&Ct(es)})}var Na=s(ya,2),Oa=s(a(Na),2),La=a(Oa);{var ts=Ct=>{var Gt=Oi(),It=oe(Gt);It.__click=()=>f("heater","on");var fa=s(It,2);fa.__click=()=>f("heater","off"),u(()=>{It.disabled=e(X),fa.disabled=e(X)}),l(Ct,Gt)};v(La,Ct=>{e(r).heater_entity_id&&Ct(ts)})}var Ea=s(La,2);{var as=Ct=>{var Gt=Li(),It=oe(Gt);It.__click=()=>f("cooler","on");var fa=s(It,2);fa.__click=()=>f("cooler","off"),u(()=>{It.disabled=e(X),fa.disabled=e(X)}),l(Ct,Gt)};v(Ea,Ct=>{e(r).cooler_entity_id&&Ct(as)})}var Ga=s(Ea,2);Ga.__click=()=>k(),t(Oa),t(Na),u((Ct,Gt)=>{d(Et,`${Ct??""}${e(te)??""}`),d(pa,`¬±${Gt??""}${e(te)??""}`),Ga.disabled=e(X)},[()=>E(e(q).target_temp),()=>e(q).hysteresis?.toFixed(1)||"--"]),l(ct,pt)};v(Mt,ct=>{e(q)&&ct(xt)})}l(rt,St)};v(wa,rt=>{e(Z)||rt(Nt)})}t(ot),u(()=>{ht=Le(ot,1,"info-card temp-control-card svelte-g5au2j",null,ht,{"heater-on":e(q)?.heater_state==="on","cooler-on":e(q)?.cooler_state==="on",collapsed:e(Z)}),ma=Le(ka,0,"chevron svelte-g5au2j",null,ma,{rotated:!e(Z)})}),l(Pe,ot)},yt=Pe=>{var ot=We(),ht=oe(ot);{var qt=la=>{var aa=Vi(),ha=s(a(aa),2),ua=a(ha);{var ka=Nt=>{var rt=Ui(),St=a(rt);t(rt),u(()=>d(St,`Heater: ${e(r).heater_entity_id??""}`)),l(Nt,rt)};v(ua,Nt=>{e(r).heater_entity_id&&Nt(ka)})}var ma=s(ua,2);{var wa=Nt=>{var rt=Hi(),St=a(rt);t(rt),u(()=>d(St,`Cooler: ${e(r).cooler_entity_id??""}`)),l(Nt,rt)};v(ma,Nt=>{e(r).cooler_entity_id&&Nt(wa)})}ke(2),t(ha),t(aa),l(la,aa)};v(ht,la=>{(e(r).heater_entity_id||e(r).cooler_entity_id)&&e(r).status!=="fermenting"&&la(qt)},!0)}l(Pe,ot)};v(st,Pe=>{e(ee)&&(e(r).status==="fermenting"||e(r).status==="conditioning")?Pe(Se):Pe(yt,!1)})}var ra=s(st,2);{var Pt=Pe=>{Wa(Pe,{get notes(){return e(r).notes}})};v(ra,Pe=>{e(r).notes&&Pe(Pt)})}t(Rt),t(bt);var Xt=s(bt,2);{var ca=Pe=>{var ot=Wi(),ht=a(ot);Ms(ht,{get batchId(){return e(r).id},get deviceColor(){return e(r).device_id},get originalGravity(){return e(r).measured_og},get controlEvents(){return Q}}),t(ot),l(Pe,ot)};v(Xt,Pe=>{e(r).device_id&&Pe(ca)})}l(gt,Vt)};v(nt,gt=>{e(r).status==="completed"?gt(Dt):gt(vt,!1)},!0)}l(lt,$e)};v(Ee,lt=>{e(r).status==="brewing"?lt(tt):lt(it,!1)},!0)}l(De,xe)};v(Qa,De=>{e(r).status==="planning"?De(Za):De($a,!1)})}u(()=>{d(I,`#${(e(r).batch_number||"?")??""}`),d(Je,e(r).name||e(r).recipe?.name||"Unnamed Batch"),Ae.disabled=e(Y),Ft(Ae,`color: ${e(H).color??""}; background: ${e(H).bg??""};`),_t!==(_t=e(r).status)&&(Ae.value=(Ae.__value=e(r).status)??"",ds(Ae,e(r).status))}),l(z,ge)};v(ut,z=>{e(M)?z(zt):z(C,!1)},!0)}l(Xe,ft)};v(fe,Xe=>{e(r)?Xe(ye,!1):Xe(be)},!0)}l(J,ne)};v(T,J=>{e(Me)?J(D):J(W,!1)},!0)}l(_,j)};v(Ce,_=>{e(de)?_(Fe):_(Ge,!1)})}t(je);var ze=s(je,2);{var pe=_=>{var j=Ki();j.__click=()=>o(le,!1),j.__keydown=ye=>ye.key==="Escape"&&o(le,!1);var T=a(j);T.__click=ye=>ye.stopPropagation(),T.__keydown=ye=>ye.stopPropagation();var D=s(a(T),2),W=a(D);t(D);var J=s(D,2),ne=a(J);ne.__click=()=>o(le,!1);var fe=s(ne,2);fe.__click=p;var be=a(fe,!0);t(fe),t(J),t(T),t(j),u(()=>{d(W,`Are you sure you want to delete "${(e(r)?.name||"this batch")??""}"? This cannot be undone.`),ne.disabled=e(P),fe.disabled=e(P),d(be,e(P)?"Deleting...":"Delete Batch")}),l(_,j)};v(ze,_=>{e(le)&&_(pe)})}l(Re,ie),Ht(),L()}Qt(["click","change","keydown"]);export{yn as component,bn as universal};
