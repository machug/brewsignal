import{d as Vt,f as n,s as c,a as l,c as Oe,t as ia,h as ga,e as ht}from"../chunks/orbuQWWI.js";import{d as a,e as s,r as t,t as _,a as Ot,f as ge,h as e,u as X,n as we,g as Lt,s as I,p as He,o as Wa,c as d,az as Ma,b9 as ss,ay as rs,i as Da,aJ as ls,aC as is,ax as ns}from"../chunks/pAodAtlG.js";import{e as wt,i as Nt}from"../chunks/0whDC7Rl.js";import{i as o}from"../chunks/ucc1DXe2.js";import{h as vs}from"../chunks/DJBMpqSf.js";import{s as Ht,r as mt,a as os}from"../chunks/CYuZshLQ.js";import{s as Ne}from"../chunks/Cpbxxhlc.js";import{s as jt}from"../chunks/C-5oeV0L.js";import{b as Ta,i as ds,s as cs}from"../chunks/RboyDiSx.js";import{s as us,a as _s}from"../chunks/BkeTWnxc.js";import{p as ps}from"../chunks/DcO5m26n.js";import{g as fs}from"../chunks/ThpalHzM.js";import{a8 as gs,a9 as hs,aa as ms,ab as bs,ac as ys,Q as pa,ad as ks,ae as xs,af as ws,X as js,S as Ba,ag as ja,a3 as qs,ah as Ca}from"../chunks/D-LVxhuj.js";import{d as Ut,e as Sa,g as Aa,c as qa}from"../chunks/D9t2HWx4.js";import{t as Ha}from"../chunks/DWpXqN03.js";import{B as Ss}from"../chunks/h5B_HAMR.js";import{s as Ms}from"../chunks/GbV1md6Y.js";import{p as fa}from"../chunks/C44MPb_E.js";import{F as Bs}from"../chunks/EeV2KrKI.js";import{b as ot}from"../chunks/Dh5hCwq1.js";import{s as za}from"../chunks/BkabqQ1A.js";const Cs=!1,on=Object.freeze(Object.defineProperty({__proto__:null,prerender:Cs},Symbol.toStringTag,{value:"Module"}));function zs(Be){return Be>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:Be>=-60?{bars:3,color:"var(--positive)",label:"Good"}:Be>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function Xa(Be){const i=Math.floor((Date.now()-new Date(Be).getTime())/1e3);if(i<10)return"just now";if(i<60)return`${i}s ago`;const g=Math.floor(i/60);if(g<60)return`${g}m ago`;const q=Math.floor(g/60);return q<24?`${q}h ago`:`${Math.floor(q/24)}d ago`}var Fs=n('<div class="accent-bar svelte-1oyrwd9"></div>'),Ts=n('<span class="card-icon svelte-1oyrwd9"> </span>'),Ds=n('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),As=n('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function ka(Be,i){let g=fa(i,"highlight",3,!1),q=fa(i,"compact",3,!1),S=fa(i,"collapsible",3,!1),m=fa(i,"expanded",3,!1);var P=As();let r;var E=a(P);{var M=D=>{var N=Fs();l(D,N)};o(E,D=>{g()&&D(M)})}var se=s(E,2),me=a(se),be=a(me);{var F=D=>{var N=Ts(),ne=a(N,!0);t(N),_(()=>c(ne,i.icon)),l(D,N)};o(be,D=>{i.icon&&D(F)})}var $=s(be,2),ie=a($,!0);t($),t(me);var de=s(me,2);{var T=D=>{var N=Ds();N.__click=function(...x){i.onToggle?.apply(this,x)};var ne=a(N);let te;t(N),_(()=>{Ht(N,"aria-label",m()?"Collapse":"Expand"),te=Ne(ne,0,"expand-icon svelte-1oyrwd9",null,te,{"rotate-180":m()})}),l(D,N)};o(de,D=>{S()&&i.onToggle&&D(T)})}t(se);var U=s(se,2);let K;var re=a(U);Ms(re,()=>i.children),t(U),t(P),_(()=>{r=Ne(P,1,"batch-card svelte-1oyrwd9",null,r,{highlight:g(),compact:q()}),c(ie,i.title),K=Ne(U,1,"card-content svelte-1oyrwd9",null,K,{collapsed:S()&&!m()})}),l(Be,P)}Vt(["click"]);var Rs=n('<span class="updated-text svelte-t80j9z"> </span>'),Ps=n('<div class="hero-divider svelte-t80j9z"></div> <div class="hero-metric temperature svelte-t80j9z"><span class="hero-value svelte-t80j9z"> <span class="hero-unit svelte-t80j9z"> </span></span> <span class="hero-label svelte-t80j9z">Temperature</span></div>',1),Ns=n('<div class="remaining-text svelte-t80j9z"> </div>'),Os=n('<div class="progress-section svelte-t80j9z"><div class="progress-labels svelte-t80j9z"><div class="progress-endpoint start svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">OG</span></div> <div class="progress-current svelte-t80j9z"><span class="current-percent svelte-t80j9z"> </span></div> <div class="progress-endpoint end svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">Target FG</span></div></div> <div class="progress-track svelte-t80j9z"><div class="progress-fill svelte-t80j9z"></div> <div><div class="marker-dot svelte-t80j9z"></div> <div class="marker-value svelte-t80j9z"> </div></div></div> <!></div>'),Ls=n('<div class="metrics-row svelte-t80j9z"><div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">ABV</span></div> <div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">Attenuation</span></div></div>'),Es=n('<div class="status-row svelte-t80j9z"><div class="live-indicator svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> <span class="status-text svelte-t80j9z">LIVE</span></div> <!></div> <div class="hero-section svelte-t80j9z"><div class="hero-metric gravity svelte-t80j9z"><span class="hero-value svelte-t80j9z"> </span> <span class="hero-label svelte-t80j9z">Gravity</span></div> <!></div> <!> <!>',1),Is=n('<div class="completed-grid svelte-t80j9z"><div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Original Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Final Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">ABV</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Attenuation</span></div></div>'),Gs=n('<div class="empty-state svelte-t80j9z"><div class="empty-icon svelte-t80j9z">‚óé</div> <p class="empty-text svelte-t80j9z">Set Original Gravity to track fermentation</p></div>');function Hs(Be,i){Ot(i,!0);let g=X(()=>i.currentSg??i.progress?.measured?.current_sg),q=X(()=>i.liveReading?.temp??i.progress?.temperature?.current),S=X(()=>i.liveReading?.last_seen),m=X(()=>e(S)?Xa(e(S)):null),P=X(Aa),r=X(()=>{if(!i.batch.measured_og||!e(g))return null;const F=Math.max(0,(i.batch.measured_og-e(g))*131.25),$=i.batch.measured_og-1,ie=$!==0?Math.max(0,Math.min(100,(i.batch.measured_og-e(g))/$*100)):0;return{abv:F,attenuation:ie}}),E=X(()=>{const F=i.batch.measured_og,$=i.batch.recipe?.fg;if(!F||!$||!e(g))return null;const ie=F-$,de=F-e(g);return ie<=0?null:Math.max(0,Math.min(100,de/ie*100))}),M=X(()=>i.batch.status==="fermenting"||i.batch.status==="conditioning");function se(F){return F==null?"--":Ut(F)}function me(F){return F==null?"--":`${F.toFixed(1)}%`}function be(F){return F==null?"--":Sa(F)}ka(Be,{title:"Fermentation",children:(F,$)=>{var ie=Oe(),de=ge(ie);{var T=K=>{var re=Es(),D=ge(re),N=s(a(D),2);{var ne=k=>{var h=Rs(),y=a(h);t(h),_(()=>c(y,`Updated ${e(m)??""}`)),l(k,h)};o(N,k=>{e(m)&&k(ne)})}t(D);var te=s(D,2),x=a(te),V=a(x),ue=a(V,!0);t(V),we(2),t(x);var ae=s(x,2);{var v=k=>{var h=Ps(),y=s(ge(h),2),B=a(y),w=a(B,!0),A=s(w),W=a(A,!0);t(A),t(B),we(2),t(y),_(O=>{c(w,O),c(W,e(P))},[()=>be(e(q))]),l(k,h)};o(ae,k=>{e(q)!=null&&k(v)})}t(te);var u=s(te,2);{var p=k=>{var h=Os(),y=a(h),B=a(y),w=a(B),A=a(w,!0);t(w),we(2),t(B);var W=s(B,2),O=a(W),ce=a(O);t(O),t(W);var ee=s(W,2),Q=a(ee),ve=a(Q,!0);t(Q),we(2),t(ee),t(y);var ye=s(y,2),ke=a(ye),Se=s(ke,2);let je;var _e=s(a(Se),2),ze=a(_e,!0);t(_e),t(Se),t(ye);var f=s(ye,2);{var C=z=>{var R=Ns(),H=a(R);t(R),_(Y=>c(H,`${Y??""} points to go`),[()=>i.progress.progress.sg_remaining.toFixed(3)]),l(z,R)};o(f,z=>{i.progress?.progress?.sg_remaining!=null&&i.progress.progress.sg_remaining>0&&z(C)})}t(h),_((z,R,H,Y)=>{c(A,z),c(ce,`${R??""}%`),c(ve,H),jt(ke,`width: ${e(E)??""}%`),je=Ne(Se,1,"progress-marker svelte-t80j9z",null,je,{"at-start":e(E)<3}),jt(Se,`left: ${e(E)??""}%`),c(ze,Y)},[()=>se(i.batch.measured_og),()=>e(E).toFixed(0),()=>se(i.batch.recipe.fg),()=>se(e(g))]),l(k,h)};o(u,k=>{e(E)!==null&&i.batch.measured_og&&i.batch.recipe?.fg&&k(p)})}var L=s(u,2);{var fe=k=>{var h=Ls(),y=a(h),B=a(y),w=a(B,!0);t(B),we(2),t(y);var A=s(y,2),W=a(A),O=a(W,!0);t(W),we(2),t(A),t(h),_((ce,ee)=>{c(w,ce),c(O,ee)},[()=>me(e(r).abv),()=>me(e(r).attenuation)]),l(k,h)};o(L,k=>{e(r)&&k(fe)})}_(k=>c(ue,k),[()=>se(e(g))]),l(K,re)},U=K=>{var re=Oe(),D=ge(re);{var N=te=>{var x=Is(),V=a(x),ue=a(V),ae=a(ue,!0);t(ue),we(2),t(V);var v=s(V,2),u=a(v),p=a(u,!0);t(u),we(2),t(v);var L=s(v,2),fe=a(L),k=a(fe,!0);t(fe),we(2),t(L);var h=s(L,2),y=a(h),B=a(y,!0);t(y),we(2),t(h),t(x),_((w,A,W,O)=>{c(ae,w),c(p,A),c(k,W),c(B,O)},[()=>se(i.batch.measured_og),()=>se(i.batch.measured_fg),()=>i.batch.measured_abv!=null?me(i.batch.measured_abv):"--",()=>i.batch.measured_attenuation!=null?me(i.batch.measured_attenuation):"--"]),l(te,x)},ne=te=>{var x=Gs();l(te,x)};o(D,te=>{i.batch.measured_og?te(N):te(ne,!1)},!0)}l(K,re)};o(de,K=>{e(g)&&e(M)?K(T):K(U,!1)})}l(F,ie)},$$slots:{default:!0}}),Lt()}var Us=n('<span class="device-last-seen svelte-1kdxwtz"> </span>'),Vs=n('<div class="signal-bar svelte-1kdxwtz"></div>'),Ws=n('<div class="metric-item svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="metric-text svelte-1kdxwtz"> </span></div>'),Xs=n('<div class="metric-item battery svelte-1kdxwtz"><svg class="battery-icon svelte-1kdxwtz" viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="2" y="7" width="18" height="10" rx="2"></rect><rect x="4" y="9" height="6" stroke="none" rx="1"></rect><path d="M20 10v4h2v-4z" stroke="none"></path></svg> <span class="metric-text svelte-1kdxwtz"><!></span></div>'),Js=n('<div class="device-metrics svelte-1kdxwtz"><!> <!></div>'),Ks=n('<div class="device-row svelte-1kdxwtz"><div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!></div> <!>',1),Ys=n('<div class="device-row svelte-1kdxwtz"><div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <span class="device-last-seen svelte-1kdxwtz">No data</span></div>'),Qs=n('<div class="device-info svelte-1kdxwtz"><!></div>'),Zs=n('<button type="button" class="link-btn svelte-1kdxwtz">Link device</button>'),$s=n('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function Ua(Be,i){Ot(i,!0);let g=X(()=>i.liveReading?.device_type==="tilt"),q=X(()=>e(g)&&i.liveReading?.rssi?zs(i.liveReading.rssi):null),S=X(()=>i.liveReading?.last_seen?Xa(i.liveReading.last_seen):null),m=X(()=>i.liveReading?.battery_percent!=null||i.liveReading?.battery_voltage!=null),P=X(()=>i.liveReading?.battery_percent),r=X(()=>i.liveReading?.battery_voltage),E=X(()=>e(P)?e(P)>50?"var(--positive)":e(P)>20?"var(--warning)":"var(--negative)":"var(--text-muted)"),M=X(()=>{if(!i.liveReading)return i.batch.device_id||"Unknown";const se=i.liveReading.device_type;return se==="tilt"?`${i.liveReading.color} Tilt`:se==="gravitymon"?`GravityMon (${i.liveReading.id})`:se==="ispindel"?`iSpindel (${i.liveReading.id})`:se==="floaty"?`Floaty (${i.liveReading.id})`:i.liveReading.color||i.liveReading.id});ka(Be,{title:"Tracking Device",compact:!0,children:(se,me)=>{var be=Oe(),F=ge(be);{var $=de=>{var T=Qs(),U=a(T);{var K=D=>{var N=Ks(),ne=ge(N),te=a(ne),x=s(a(te));t(te);var V=s(te,2);{var ue=u=>{var p=Us(),L=a(p,!0);t(p),_(()=>c(L,e(S))),l(u,p)};o(V,u=>{e(S)&&u(ue)})}t(ne);var ae=s(ne,2);{var v=u=>{var p=Js(),L=a(p);{var fe=y=>{var B=Ws(),w=a(B);wt(w,20,()=>Array(4),Nt,(O,ce,ee)=>{var Q=Vs();_(()=>jt(Q,`height: ${4+ee*2}px; background: ${(ee<e(q).bars?e(q).color:"var(--bg-hover)")??""}; opacity: ${ee<e(q).bars?1:.4};`)),l(O,Q)}),t(w);var A=s(w,2),W=a(A);t(A),t(B),_(()=>{jt(A,`color: ${e(q).color??""}`),c(W,`${i.liveReading.rssi??""}dBm`)}),l(y,B)};o(L,y=>{e(q)&&y(fe)})}var k=s(L,2);{var h=y=>{var B=Xs(),w=a(B),A=s(a(w)),W=s(A);t(w);var O=s(w,2),ce=a(O);{var ee=ve=>{var ye=ia();_(ke=>c(ye,`${ke??""}%`),[()=>e(P).toFixed(0)]),l(ve,ye)},Q=ve=>{var ye=Oe(),ke=ge(ye);{var Se=je=>{var _e=ia();_(ze=>c(_e,`${ze??""}V`),[()=>e(r).toFixed(2)]),l(je,_e)};o(ke,je=>{e(r)!=null&&je(Se)},!0)}l(ve,ye)};o(ce,ve=>{e(P)!=null?ve(ee):ve(Q,!1)})}t(O),t(B),_(()=>{Ht(w,"stroke",e(E)),Ht(A,"width",(e(P)??50)*.14),Ht(A,"fill",e(E)),Ht(W,"fill",e(E)),jt(O,`color: ${e(E)??""}`)}),l(y,B)};o(k,y=>{e(m)&&y(h)})}t(p),l(u,p)};o(ae,u=>{(e(q)||e(m))&&u(v)})}_(()=>c(x,` ${e(M)??""}`)),l(D,N)},re=D=>{var N=Ys(),ne=a(N),te=s(a(ne));t(ne),we(2),t(N),_(()=>c(te,` ${i.batch.device_id??""}`)),l(D,N)};o(U,D=>{i.liveReading?D(K):D(re,!1)})}t(T),l(de,T)},ie=de=>{var T=$s(),U=s(a(T),2);{var K=re=>{var D=Zs();D.__click=function(...N){i.onEdit?.apply(this,N)},l(re,D)};o(U,re=>{i.onEdit&&re(K)})}t(T),l(de,T)};o(F,de=>{i.batch.device_id?de($):de(ie,!1)})}l(se,be)},$$slots:{default:!0}}),Lt()}Vt(["click"]);const er=131.25;var tr=n('<span class="yeast-producer svelte-19u9n31"> </span>'),ar=n('<span class="yeast-temp svelte-19u9n31"> </span>'),sr=n('<div class="yeast-row recipe svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Recipe</span> <span class="yeast-value muted svelte-19u9n31"> </span></div>'),rr=n('<div class="yeast-row actual svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span> <!> <!></div> <!>',1),lr=n('<div class="yeast-row svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span></div>'),ir=n('<div class="yeast-section svelte-19u9n31"><!></div>'),nr=n('<div class="targets-row svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div></div> <!>',1);function Fa(Be,i){Ot(i,!0);function g(S){return S==null?"--":Ut(S)}let q=X(()=>i.recipe.abv!=null?i.recipe.abv:i.recipe.og&&i.recipe.fg?(i.recipe.og-i.recipe.fg)*er:null);ka(Be,{title:"Recipe Targets",compact:!0,children:(S,m)=>{var P=nr(),r=ge(P),E=a(r),M=s(a(E),2),se=a(M,!0);t(M),t(E);var me=s(E,2),be=s(a(me),2),F=a(be,!0);t(be),t(me);var $=s(me,2),ie=s(a($),2),de=a(ie,!0);t(ie),t($),t(r);var T=s(r,2);{var U=K=>{var re=ir(),D=a(re);{var N=te=>{var x=rr(),V=ge(x),ue=s(a(V),2),ae=a(ue,!0);t(ue);var v=s(ue,2);{var u=h=>{var y=tr(),B=a(y);t(y),_(()=>c(B,`(${i.yeastStrain.producer??""})`)),l(h,y)};o(v,h=>{i.yeastStrain.producer&&h(u)})}var p=s(v,2);{var L=h=>{var y=ar(),B=a(y);t(y),_((w,A)=>c(B,`${w??""}-${A??""}¬∞C`),[()=>i.yeastStrain.temp_low.toFixed(0),()=>i.yeastStrain.temp_high.toFixed(0)]),l(h,y)};o(p,h=>{i.yeastStrain.temp_low&&i.yeastStrain.temp_high&&h(L)})}t(V);var fe=s(V,2);{var k=h=>{var y=sr(),B=s(a(y),2),w=a(B,!0);t(B),t(y),_(()=>c(w,i.recipe.yeast_name)),l(h,y)};o(fe,h=>{i.recipe.yeast_name&&h(k)})}_(()=>c(ae,i.yeastStrain.name)),l(te,x)},ne=te=>{var x=Oe(),V=ge(x);{var ue=ae=>{var v=lr(),u=s(a(v),2),p=a(u,!0);t(u),t(v),_(()=>c(p,i.recipe.yeast_name)),l(ae,v)};o(V,ae=>{i.recipe.yeast_name&&ae(ue)},!0)}l(te,x)};o(D,te=>{i.yeastStrain?te(N):te(ne,!1)})}t(re),l(K,re)};o(T,K=>{(i.yeastStrain||i.recipe.yeast_name)&&K(U)})}_((K,re,D)=>{c(se,K),c(F,re),c(de,D)},[()=>g(i.recipe.og),()=>g(i.recipe.fg),()=>e(q)!=null?`${e(q).toFixed(1)}%`:"--"]),l(S,P)},$$slots:{default:!0}}),Lt()}var vr=n('<p class="notes-content svelte-hkv31i"> </p>');function Va(Be,i){ka(Be,{title:"Notes",children:(g,q)=>{var S=vr(),m=a(S,!0);t(S),_(()=>c(m,i.notes)),l(g,S)},$$slots:{default:!0}})}var or=n('<div class="ml-panel loading svelte-1xs394q"><p>Loading predictions...</p></div>'),dr=n('<div class="ml-panel error svelte-1xs394q"><p class="error-text svelte-1xs394q"> </p></div>'),cr=n("<option> </option>"),ur=n('<span class="anomaly-reasons svelte-1xs394q"> </span>'),_r=n('<div class="anomaly-banner svelte-1xs394q"><span class="anomaly-icon svelte-1xs394q">‚ö†Ô∏è</span> <div class="anomaly-content svelte-1xs394q"><span class="anomaly-label svelte-1xs394q">Anomaly Detected</span> <!></div></div>'),pr=n('<span class="activity-badge svelte-1xs394q"> </span>'),fr=n('<div class="progress-section svelte-1xs394q"><div class="progress-header svelte-1xs394q"><span class="progress-label svelte-1xs394q">Fermentation Progress</span> <!></div> <div class="fermentation-progress-bar svelte-1xs394q"><div class="fermentation-fill svelte-1xs394q"></div></div> <div class="progress-labels svelte-1xs394q"><span class="og-label svelte-1xs394q"> </span> <span class="progress-percent svelte-1xs394q"> </span> <span class="fg-label svelte-1xs394q"> </span></div></div>'),gr=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Predicted FG:</span> <span class="value svelte-1xs394q"> </span></div>'),hr=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Attenuation:</span> <span class="value attenuation svelte-1xs394q"> </span></div>'),mr=n('<span class="complete-now svelte-1xs394q">Ready now!</span>'),br=n('<span class="days svelte-1xs394q"> </span>'),yr=n(" <!>",1),kr=n('<div class="metric completion-metric svelte-1xs394q"><span class="label svelte-1xs394q">Est. Completion:</span> <span class="value svelte-1xs394q"><!></span></div>'),xr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model:</span> <span class="model-value model-type svelte-1xs394q"> </span></div>'),wr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),jr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),qr=n('<div><div class="panel-header svelte-1xs394q"><h3 class="panel-title svelte-1xs394q">Fermentation Intelligence</h3> <div class="header-controls svelte-1xs394q"><select class="model-select svelte-1xs394q" title="Select prediction model"></select> <button type="button" class="reload-btn svelte-1xs394q" title="Recalculate predictions from database history"> </button></div></div> <!> <!> <div class="metrics svelte-1xs394q"><!> <!> <!> <div class="model-info svelte-1xs394q"><!> <!> <!></div></div></div>'),Sr=n('<div class="ml-panel disabled svelte-1xs394q"><div class="disabled-header svelte-1xs394q"><p class="unavailable-text svelte-1xs394q">ML predictions unavailable</p> <button type="button" class="reload-btn svelte-1xs394q" title="Reload predictions from database"> </button></div> <p class="unavailable-hint svelte-1xs394q"><!></p></div>');function Mr(Be,i){Ot(i,!0);let g=fa(i,"measuredOg",3,null),q=fa(i,"currentSg",3,null),S=fa(i,"liveReading",3,null),m=I(He({available:!1})),P=I(!0),r=I(!1),E=I(null),M=I("auto");const se=[{value:"auto",label:"Auto (Best Fit)"},{value:"exponential",label:"Exponential"},{value:"gompertz",label:"Gompertz (S-Curve)"},{value:"logistic",label:"Logistic"}];async function me(){d(P,!0),d(E,null);try{d(m,await hs(i.batchId,e(M)),!0)}catch(x){d(E,x instanceof Error?x.message:"Failed to load predictions",!0),console.error("Failed to load ML predictions:",x)}finally{d(P,!1)}}async function be(){d(r,!0),d(E,null);try{const x=await gs(i.batchId);console.log("Reloaded predictions:",x.message),await me()}catch(x){d(E,x instanceof Error?x.message:"Failed to reload predictions",!0),console.error("Failed to reload predictions:",x)}finally{d(r,!1)}}function F(){me()}Wa(be);function $(x){return x?new Date(x).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}):"N/A"}function ie(x){if(!x)return null;const V=new Date(x),ue=new Date,ae=V.getTime()-ue.getTime();return Math.ceil(ae/(1e3*60*60*24))}let de=X(()=>{const x=g()??e(m).predicted_og,V=e(m).predicted_fg,ue=q()??S()?.sg;if(!x||!V||!ue||x<=V)return null;const ae=x-V,u=(x-ue)/ae*100;return Math.min(100,Math.max(0,u))}),T=X(()=>{const x=g()??e(m).predicted_og,V=q()??S()?.sg;if(!x||!V||x<=1)return null;const ue=(x-V)/(x-1)*100;return Math.min(100,Math.max(0,ue))}),U=X(()=>{const x=S()?.sg_rate;if(x==null)return null;const V=Math.abs(x);return V>.002?{label:"Very Active",color:"var(--activity-very-active)",emoji:"üî•"}:V>5e-4?{label:"Active",color:"var(--activity-active)",emoji:"‚ú®"}:V>1e-4?{label:"Slowing",color:"var(--activity-slowing)",emoji:"üê¢"}:{label:"Complete",color:"var(--activity-complete)",emoji:"‚úì"}}),K=X(()=>S()?.is_anomaly??!1),re=X(()=>S()?.anomaly_reasons??[]);var D=Oe(),N=ge(D);{var ne=x=>{var V=or();l(x,V)},te=x=>{var V=Oe(),ue=ge(V);{var ae=u=>{var p=dr(),L=a(p),fe=a(L);t(L),t(p),_(()=>c(fe,`‚ö†Ô∏è ${e(E)??""}`)),l(u,p)},v=u=>{var p=Oe(),L=ge(p);{var fe=h=>{var y=qr();let B;var w=a(y),A=s(a(w),2),W=a(A);W.__change=F,wt(W,21,()=>se,Nt,(G,J)=>{var oe=cr(),Ae=a(oe,!0);t(oe);var Xe={};_(()=>{c(Ae,e(J).label),Xe!==(Xe=e(J).value)&&(oe.value=(oe.__value=e(J).value)??"")}),l(G,oe)}),t(W);var O=s(W,2);O.__click=be;var ce=a(O,!0);t(O),t(A),t(w);var ee=s(w,2);{var Q=G=>{var J=_r(),oe=s(a(J),2),Ae=s(a(oe),2);{var Xe=b=>{var j=ur(),Z=a(j,!0);t(j),_(le=>c(Z,le),[()=>e(re).join(", ")]),l(b,j)};o(Ae,b=>{e(re).length>0&&b(Xe)})}t(oe),t(J),l(G,J)};o(ee,G=>{e(K)&&G(Q)})}var ve=s(ee,2);{var ye=G=>{var J=fr(),oe=a(J),Ae=s(a(oe),2);{var Xe=Ze=>{var $e=pr(),at=a($e);t($e),_(()=>{jt($e,`color: ${e(U).color??""}`),c(at,`${e(U).emoji??""} ${e(U).label??""}`)}),l(Ze,$e)};o(Ae,Ze=>{e(U)&&Ze(Xe)})}t(oe);var b=s(oe,2),j=a(b);t(b);var Z=s(b,2),le=a(Z),Ee=a(le);t(le);var Ie=s(le,2),_t=a(Ie);t(Ie);var tt=s(Ie,2),Je=a(tt);t(tt),t(Z),t(J),_((Ze,$e,at)=>{jt(j,`width: ${e(de)??""}%`),c(Ee,`OG: ${Ze??""}`),c(_t,`${$e??""}%`),c(Je,`FG: ${at??""}`)},[()=>Ut(g()??e(m).predicted_og??0),()=>e(de).toFixed(0),()=>Ut(e(m).predicted_fg??0)]),l(G,J)};o(ve,G=>{e(de)!==null&&G(ye)})}var ke=s(ve,2),Se=a(ke);{var je=G=>{var J=gr(),oe=s(a(J),2),Ae=a(oe,!0);t(oe),t(J),_(Xe=>c(Ae,Xe),[()=>Ut(e(m).predicted_fg)]),l(G,J)};o(Se,G=>{e(m).predicted_fg&&G(je)})}var _e=s(Se,2);{var ze=G=>{var J=hr(),oe=s(a(J),2),Ae=a(oe);t(oe),t(J),_(Xe=>c(Ae,`${Xe??""}%`),[()=>e(T).toFixed(1)]),l(G,J)};o(_e,G=>{e(T)!==null&&G(ze)})}var f=s(_e,2);{var C=G=>{const J=X(()=>ie(e(m).estimated_completion));var oe=kr(),Ae=s(a(oe),2),Xe=a(Ae);{var b=Z=>{var le=mr();l(Z,le)},j=Z=>{var le=yr(),Ee=ge(le),Ie=s(Ee);{var _t=tt=>{var Je=br(),Ze=a(Je);t(Je),_(()=>c(Ze,`(${e(J)??""} ${e(J)===1?"day":"days"})`)),l(tt,Je)};o(Ie,tt=>{e(J)!==null&&tt(_t)})}_(tt=>c(Ee,`${tt??""} `),[()=>$(e(m).estimated_completion)]),l(Z,le)};o(Xe,Z=>{e(J)!==null&&e(J)<=0?Z(b):Z(j,!1)})}t(Ae),t(oe),l(G,oe)};o(f,G=>{e(m).estimated_completion&&G(C)})}var z=s(f,2),R=a(z);{var H=G=>{var J=xr(),oe=s(a(J),2),Ae=a(oe,!0);t(oe),t(J),_(()=>c(Ae,e(m).model_type)),l(G,J)};o(R,G=>{e(m).model_type&&G(H)})}var Y=s(R,2);{var Fe=G=>{var J=wr(),oe=s(a(J),2),Ae=a(oe);t(oe),t(J),_(Xe=>c(Ae,`${Xe??""}%`),[()=>(e(m).r_squared*100).toFixed(0)]),l(G,J)};o(Y,G=>{e(m).r_squared!==void 0&&G(Fe)})}var qe=s(Y,2);{var Le=G=>{var J=jr(),oe=s(a(J),2),Ae=a(oe,!0);t(oe),t(J),_(()=>c(Ae,e(m).num_readings)),l(G,J)};o(qe,G=>{e(m).num_readings&&G(Le)})}t(z),t(ke),t(y),_(()=>{B=Ne(y,1,"ml-panel svelte-1xs394q",null,B,{"has-anomaly":e(K)}),W.disabled=e(P)||e(r),O.disabled=e(r)||e(P),c(ce,e(r)?"Reloading...":"‚Üª")}),Ta(W,()=>e(M),G=>d(M,G)),l(h,y)},k=h=>{var y=Sr(),B=a(y),w=s(a(B),2);w.__click=be;var A=a(w,!0);t(w),t(B);var W=s(B,2),O=a(W);{var ce=Q=>{var ve=ia("Waiting for fermentation to progress (need visible SG drop)");l(Q,ve)},ee=Q=>{var ve=Oe(),ye=ge(ve);{var ke=je=>{var _e=ia("Need more fermentation curve data for reliable prediction");l(je,_e)},Se=je=>{var _e=Oe(),ze=ge(_e);{var f=z=>{var R=ia("Need at least 10 readings to make predictions");l(z,R)},C=z=>{var R=ia("Predictions will appear once fermentation is underway");l(z,R)};o(ze,z=>{e(m).reason==="insufficient_data"?z(f):z(C,!1)},!0)}l(je,_e)};o(ye,je=>{e(m).reason==="insufficient_curve_data"?je(ke):je(Se,!1)},!0)}l(Q,ve)};o(O,Q=>{e(m).reason==="insufficient_fermentation_progress"?Q(ce):Q(ee,!1)})}t(W),t(y),_(()=>{w.disabled=e(r)||e(P),c(A,e(r)?"Reloading...":"‚Üª Reload")}),l(h,y)};o(L,h=>{e(m).available?h(fe):h(k,!1)},!0)}l(u,p)};o(ue,u=>{e(E)?u(ae):u(v,!1)},!0)}l(x,V)};o(N,x=>{e(P)?x(ne):x(te,!1)})}l(Be,D),Lt()}Vt(["change","click"]);var Br=n('<div class="loading svelte-1hws0u6">Loading alerts...</div>'),Cr=n('<div class="error-banner svelte-1hws0u6"><span> </span> <button type="button" class="dismiss-error svelte-1hws0u6">√ó</button></div>'),zr=n('<button type="button" class="dismiss-all-btn svelte-1hws0u6"> </button>'),Fr=n('<span class="spinner svelte-1hws0u6"></span>'),Tr=ga('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1hws0u6"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg>'),Dr=n('<div class="alert-item svelte-1hws0u6"><div class="alert-icon svelte-1hws0u6"> </div> <div class="alert-content svelte-1hws0u6"><div class="alert-header svelte-1hws0u6"><span class="alert-type svelte-1hws0u6"> </span> <span class="severity-badge svelte-1hws0u6"> </span></div> <p class="alert-message svelte-1hws0u6"> </p> <div class="alert-meta svelte-1hws0u6"><span class="alert-time svelte-1hws0u6"> </span> <span class="alert-separator svelte-1hws0u6">¬∑</span> <span class="alert-time svelte-1hws0u6"> </span></div></div> <button type="button" class="dismiss-btn svelte-1hws0u6" title="Dismiss alert"><!></button></div>'),Ar=n('<!> <div class="alerts-header svelte-1hws0u6"><span class="alert-count svelte-1hws0u6"> </span> <!></div> <div class="alerts-list svelte-1hws0u6"></div>',1);function Rr(Be,i){Ot(i,!0);let g=I(He([])),q=I(!0),S=I(null),m=I(null),P=I(!1);Ma(()=>{r()});async function r(){try{d(q,!0),d(S,null),d(g,await ms(i.batchId,!1),!0)}catch(T){d(S,T instanceof Error?T.message:"Failed to load alerts",!0)}finally{d(q,!1)}}async function E(T){try{d(m,T,!0),await bs(i.batchId,T),d(g,e(g).filter(U=>U.id!==T),!0)}catch(U){d(S,U instanceof Error?U.message:"Failed to dismiss alert",!0)}finally{d(m,null)}}async function M(){try{d(P,!0),await ys(i.batchId),d(g,[],!0)}catch(T){d(S,T instanceof Error?T.message:"Failed to dismiss alerts",!0)}finally{d(P,!1)}}function se(T){switch(T){case"critical":return"var(--negative)";case"warning":return"var(--warning)";case"info":return"var(--accent)";default:return"var(--text-muted)"}}function me(T){switch(T){case"stall":return"‚è∏";case"temperature_high":return"üî•";case"temperature_low":return"‚ùÑ";case"anomaly":return"‚ö†";default:return"‚ö†"}}function be(T){const U=new Date(T),re=new Date().getTime()-U.getTime(),D=Math.floor(re/6e4),N=Math.floor(D/60),ne=Math.floor(N/24);return ne>0?`${ne}d ago`:N>0?`${N}h ago`:D>0?`${D}m ago`:"just now"}var F=Oe(),$=ge(F);{var ie=T=>{ka(T,{title:"Alerts",icon:"üîî",children:(U,K)=>{var re=Br();l(U,re)},$$slots:{default:!0}})},de=T=>{var U=Oe(),K=ge(U);{var re=N=>{},D=N=>{ka(N,{title:"Active Alerts",icon:"üîî",highlight:!0,children:(ne,te)=>{var x=Ar(),V=ge(x);{var ue=k=>{var h=Cr(),y=a(h),B=a(y,!0);t(y);var w=s(y,2);w.__click=()=>d(S,null),t(h),_(()=>c(B,e(S))),l(k,h)};o(V,k=>{e(S)&&k(ue)})}var ae=s(V,2),v=a(ae),u=a(v);t(v);var p=s(v,2);{var L=k=>{var h=zr();h.__click=M;var y=a(h,!0);t(h),_(()=>{h.disabled=e(P),c(y,e(P)?"Dismissing...":"Dismiss All")}),l(k,h)};o(p,k=>{e(g).length>1&&k(L)})}t(ae);var fe=s(ae,2);wt(fe,21,()=>e(g),k=>k.id,(k,h)=>{var y=Dr(),B=a(y),w=a(B,!0);t(B);var A=s(B,2),W=a(A),O=a(W),ce=a(O,!0);t(O);var ee=s(O,2),Q=a(ee,!0);t(ee),t(W);var ve=s(W,2),ye=a(ve,!0);t(ve);var ke=s(ve,2),Se=a(ke),je=a(Se);t(Se);var _e=s(Se,4),ze=a(_e);t(_e),t(ke),t(A);var f=s(A,2);f.__click=()=>E(e(h).id);var C=a(f);{var z=H=>{var Y=Fr();l(H,Y)},R=H=>{var Y=Tr();l(H,Y)};o(C,H=>{e(m)===e(h).id?H(z):H(R,!1)})}t(f),t(y),_((H,Y,Fe,qe,Le,G,J,oe)=>{jt(y,`--severity-color: ${H??""}`),c(w,Y),c(ce,Fe),jt(ee,`background: ${qe??""}`),c(Q,e(h).severity),c(ye,e(h).message),Ht(Se,"title",`First detected: ${Le??""}`),c(je,`First: ${G??""}`),Ht(_e,"title",`Last seen: ${J??""}`),c(ze,`Last: ${oe??""}`),f.disabled=e(m)===e(h).id},[()=>se(e(h).severity),()=>me(e(h).alert_type),()=>e(h).alert_type.replace("_"," "),()=>se(e(h).severity),()=>new Date(e(h).first_detected_at).toLocaleString(),()=>be(e(h).first_detected_at),()=>new Date(e(h).last_seen_at).toLocaleString(),()=>be(e(h).last_seen_at)]),l(k,y)}),t(fe),_(()=>c(u,`${e(g).length??""} active`)),l(ne,x)},$$slots:{default:!0}})};o(K,N=>{e(g).length===0?N(re):N(D,!1)},!0)}l(T,U)};o($,T=>{e(q)?T(ie):T(de,!1)})}l(Be,F),Lt()}Vt(["click"]);var Pr=n("<span> </span>"),Nr=n('<div class="timer-idle svelte-ukh80y"><div class="timer-option svelte-ukh80y"><label class="option-label svelte-ukh80y">Mash Duration</label> <div class="duration-input svelte-ukh80y"><button type="button" class="duration-btn svelte-ukh80y">‚àí</button> <span class="duration-value svelte-ukh80y"> </span> <button type="button" class="duration-btn svelte-ukh80y">+</button> <span class="duration-unit svelte-ukh80y">min</span></div></div> <div class="timer-option svelte-ukh80y"><label class="option-label svelte-ukh80y">Boil Duration</label> <div class="duration-display svelte-ukh80y"><span class="duration-value svelte-ukh80y"> </span> <span class="duration-unit svelte-ukh80y">min</span></div></div> <div class="timer-actions svelte-ukh80y"><button type="button" class="start-btn mash svelte-ukh80y"><svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path></svg> Start Mash</button> <button type="button" class="start-btn boil svelte-ukh80y">Skip to Boil</button></div></div>'),Or=n('<div class="timer-complete svelte-ukh80y"><div class="complete-icon svelte-ukh80y">‚úì</div> <p class="complete-text svelte-ukh80y">Boil complete! Time to chill the wort.</p> <button type="button" class="reset-btn svelte-ukh80y">Reset Timer</button></div>'),Lr=ga('<svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path></svg> Resume',1),Er=ga('<svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6"></path></svg> Pause',1),Ir=n('<span class="hop-check svelte-ukh80y">‚úì</span>'),Gr=n('<div><span class="hop-time svelte-ukh80y"> </span> <span class="hop-name svelte-ukh80y"> </span> <span class="hop-amount svelte-ukh80y"> </span> <!></div>'),Hr=n('<div class="hop-schedule svelte-ukh80y"><h4 class="schedule-title svelte-ukh80y">Hop Additions</h4> <div class="hop-list svelte-ukh80y"></div></div>'),Ur=n('<button type="button" class="next-phase-btn svelte-ukh80y">Mash Done ‚Üí Start Boil</button>'),Vr=n('<div class="timer-active svelte-ukh80y"><div class="timer-display svelte-ukh80y"><span class="time-value svelte-ukh80y"> </span> <span class="time-label svelte-ukh80y">remaining</span></div> <div class="progress-bar svelte-ukh80y"><div></div></div> <div class="timer-controls svelte-ukh80y"><button type="button" class="control-btn svelte-ukh80y" title="Subtract 1 minute">‚àí1m</button> <button type="button"><!></button> <button type="button" class="control-btn svelte-ukh80y" title="Add 1 minute">+1m</button></div> <!> <div class="phase-actions svelte-ukh80y"><!> <button type="button" class="reset-btn svelte-ukh80y">Reset</button></div></div>'),Wr=n('<div class="timer-card svelte-ukh80y"><div class="timer-header svelte-ukh80y"><h3 class="timer-title svelte-ukh80y">Brew Day Timer</h3> <!></div> <!></div>');function Xr(Be,i){Ot(i,!0);let g=I("idle"),q=I(0),S=null,m=I(!1),P=I(He(new Set)),r=I(60),E=X(()=>i.recipe.boil_time_minutes||60),M=X(()=>i.recipe.hops?i.recipe.hops.filter(v=>v.timing?.use==="add_to_boil"||!v.timing?.use).map(v=>({name:v.name,amount:v.amount_grams,time:v.timing?.duration?.value||0,unit:v.timing?.duration?.unit||"min"})).sort((v,u)=>u.time-v.time):[]),se=X(()=>{const v=Math.floor(e(q)/60),u=e(q)%60;return`${v.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`}),me=X(()=>e(g)==="mash"?(e(r)*60-e(q))/(e(r)*60)*100:e(g)==="boil"?(e(E)*60-e(q))/(e(E)*60)*100:0),be=X(()=>{switch(e(g)){case"mash":return"Mash";case"boil":return"Boil";case"complete":return"Complete!";default:return"Ready"}});function F(){d(g,"mash"),d(q,e(r)*60),d(P,new Set,!0),ie()}function $(){d(g,"boil"),d(q,e(E)*60),d(P,new Set,!0),ie()}function ie(){S&&clearInterval(S),d(m,!1),S=setInterval(()=>{if(!e(m)&&e(q)>0){if(ss(q,-1),e(g)==="boil"){const v=Math.floor(e(q)/60);for(const u of e(M)){const p=u.time;v===p&&!e(P).has(p)&&(e(P).add(p),re(),D(`Add ${u.name}`,`${u.amount}g at ${p} minutes`))}}e(q)===0&&(clearInterval(S),S=null,re(),e(g)==="mash"?D("Mash Complete","Time to sparge and start the boil!"):e(g)==="boil"&&(d(g,"complete"),D("Boil Complete","Time to chill the wort!"),i.onComplete?.()))}},1e3)}function de(){d(m,!e(m))}function T(){S&&(clearInterval(S),S=null),d(g,"idle"),d(q,0),d(m,!1),d(P,new Set,!0)}function U(){d(q,e(q)+60)}function K(){e(q)>=60&&d(q,e(q)-60)}function re(){try{const v=new(window.AudioContext||window.webkitAudioContext),u=v.createOscillator(),p=v.createGain();u.connect(p),p.connect(v.destination),u.frequency.value=880,u.type="sine",p.gain.value=.3,u.start(),setTimeout(()=>p.gain.value=0,150),setTimeout(()=>p.gain.value=.3,250),setTimeout(()=>p.gain.value=0,400),setTimeout(()=>p.gain.value=.3,500),setTimeout(()=>p.gain.value=0,650),setTimeout(()=>{u.stop(),v.close()},700)}catch(v){console.warn("Audio notification not available:",v)}}function D(v,u){"Notification"in window&&Notification.permission==="granted"&&new Notification(v,{body:u,icon:"/favicon.png"})}Ma(()=>("Notification"in window&&Notification.permission==="default"&&Notification.requestPermission(),()=>{S&&clearInterval(S)}));var N=Wr(),ne=a(N),te=s(a(ne),2);{var x=v=>{var u=Pr();let p;var L=a(u,!0);t(u),_(()=>{p=Ne(u,1,"phase-badge svelte-ukh80y",null,p,{mash:e(g)==="mash",boil:e(g)==="boil"}),c(L,e(be))}),l(v,u)};o(te,v=>{e(g)!=="idle"&&e(g)!=="complete"&&v(x)})}t(ne);var V=s(ne,2);{var ue=v=>{var u=Nr(),p=a(u),L=s(a(p),2),fe=a(L);fe.__click=()=>d(r,Math.max(1,e(r)-5),!0);var k=s(fe,2),h=a(k,!0);t(k);var y=s(k,2);y.__click=()=>d(r,e(r)+5),we(2),t(L),t(p);var B=s(p,2),w=s(a(B),2),A=a(w),W=a(A,!0);t(A),we(2),t(w),t(B);var O=s(B,2),ce=a(O);ce.__click=F;var ee=s(ce,2);ee.__click=$,t(O),t(u),_(()=>{c(h,e(r)),c(W,e(E))}),l(v,u)},ae=v=>{var u=Oe(),p=ge(u);{var L=k=>{var h=Or(),y=s(a(h),4);y.__click=T,t(h),l(k,h)},fe=k=>{var h=Vr(),y=a(h),B=a(y),w=a(B,!0);t(B),we(2),t(y);var A=s(y,2),W=a(A);let O;t(A);var ce=s(A,2),ee=a(ce);ee.__click=K;var Q=s(ee,2);let ve;Q.__click=de;var ye=a(Q);{var ke=H=>{var Y=Lr();we(),l(H,Y)},Se=H=>{var Y=Er();we(),l(H,Y)};o(ye,H=>{e(m)?H(ke):H(Se,!1)})}t(Q);var je=s(Q,2);je.__click=U,t(ce);var _e=s(ce,2);{var ze=H=>{var Y=Hr(),Fe=s(a(Y),2);wt(Fe,21,()=>e(M),Nt,(qe,Le)=>{const G=X(()=>Math.floor(e(q)/60)),J=X(()=>e(Le).time<=e(G)&&!e(P).has(e(Le).time)),oe=X(()=>e(P).has(e(Le).time)||e(Le).time>e(G));var Ae=Gr();let Xe;var b=a(Ae),j=a(b);t(b);var Z=s(b,2),le=a(Z,!0);t(Z);var Ee=s(Z,2),Ie=a(Ee);t(Ee);var _t=s(Ee,2);{var tt=Je=>{var Ze=Ir();l(Je,Ze)};o(_t,Je=>{e(oe)&&Je(tt)})}t(Ae),_(()=>{Xe=Ne(Ae,1,"hop-item svelte-ukh80y",null,Xe,{next:e(J),done:e(oe)}),c(j,`${e(Le).time??""}m`),c(le,e(Le).name),c(Ie,`${e(Le).amount??""}g`)}),l(qe,Ae)}),t(Fe),t(Y),l(H,Y)};o(_e,H=>{e(g)==="boil"&&e(M).length>0&&H(ze)})}var f=s(_e,2),C=a(f);{var z=H=>{var Y=Ur();Y.__click=$,l(H,Y)};o(C,H=>{e(g)==="mash"&&H(z)})}var R=s(C,2);R.__click=T,t(f),t(h),_(()=>{c(w,e(se)),O=Ne(W,1,"progress-fill svelte-ukh80y",null,O,{mash:e(g)==="mash",boil:e(g)==="boil"}),jt(W,`width: ${e(me)??""}%`),ve=Ne(Q,1,"control-btn pause svelte-ukh80y",null,ve,{paused:e(m)})}),l(k,h)};o(p,k=>{e(g)==="complete"?k(L):k(fe,!1)},!0)}l(v,u)};o(V,v=>{e(g)==="idle"?v(ue):v(ae,!1)})}t(N),l(Be,N),Lt()}Vt(["click"]);var Jr=n('<button type="button" class="remove-btn svelte-ue9vqt" title="Remove item">√ó</button>'),Kr=n('<label><input type="checkbox" class="svelte-ue9vqt"/> <span class="item-text svelte-ue9vqt"> </span> <!></label>'),Yr=n('<div class="category-group svelte-ue9vqt"><h4 class="category-title svelte-ue9vqt"> </h4> <div class="items-list svelte-ue9vqt"></div></div>'),Qr=n('<div class="add-form svelte-ue9vqt"><input type="text" class="add-input svelte-ue9vqt" placeholder="Add custom item..."/> <button type="button" class="add-btn svelte-ue9vqt">Add</button> <button type="button" class="cancel-btn svelte-ue9vqt">Cancel</button></div>'),Zr=n('<button type="button" class="show-add-btn svelte-ue9vqt"><svg class="btn-icon svelte-ue9vqt" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path></svg> Add custom item</button>'),$r=n('<div class="checklist-card svelte-ue9vqt"><div class="checklist-header svelte-ue9vqt"><div class="header-left svelte-ue9vqt"><h3 class="checklist-title svelte-ue9vqt">Brew Day Checklist</h3> <span class="progress-badge svelte-ue9vqt"> </span></div> <button type="button" class="reset-btn svelte-ue9vqt" title="Reset all items"><svg class="btn-icon svelte-ue9vqt" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg></button></div> <div class="progress-bar svelte-ue9vqt"><div class="progress-fill svelte-ue9vqt"></div></div> <div class="checklist-groups svelte-ue9vqt"></div> <div class="add-section svelte-ue9vqt"><!></div></div>');function el(Be,i){Ot(i,!0);let g=I(He([])),q=I(""),S=I(!1),m=X(()=>`brewday-checklist-${i.batchId}`);function P(){const v=[];return v.push({id:"prep-sanitize",text:"Sanitize all equipment",checked:!1,category:"prep"}),v.push({id:"prep-water",text:`Heat strike water (${i.recipe.batch_size_liters?Math.round(i.recipe.batch_size_liters*1.3):"--"}L)`,checked:!1,category:"prep"}),i.recipe.fermentables&&i.recipe.fermentables.forEach((u,p)=>{const L=u.amount_kg?`${(u.amount_kg*1e3).toFixed(0)}g`:"";v.push({id:`ferm-${p}`,text:`Mill grain: ${u.name} ${L}`,checked:!1,category:"prep"})}),v.push({id:"mash-dough-in",text:"Dough in - add grain to strike water",checked:!1,category:"mash"}),v.push({id:"mash-temp",text:"Check mash temperature",checked:!1,category:"mash"}),v.push({id:"mash-rest",text:"Mash rest complete",checked:!1,category:"mash"}),v.push({id:"mash-sparge",text:"Sparge and collect wort",checked:!1,category:"mash"}),v.push({id:"boil-preboil",text:"Record pre-boil gravity",checked:!1,category:"boil"}),v.push({id:"boil-start",text:"Bring to boil",checked:!1,category:"boil"}),i.recipe.hops&&i.recipe.hops.filter(p=>p.timing?.use==="add_to_boil"||!p.timing?.use).sort((p,L)=>(L.timing?.duration?.value||0)-(p.timing?.duration?.value||0)).forEach((p,L)=>{const fe=p.timing?.duration?.value||0,k=p.amount_grams?`${p.amount_grams}g`:"";v.push({id:`hop-${L}`,text:`Add ${p.name} ${k} @ ${fe}min`,checked:!1,category:"boil"})}),v.push({id:"postboil-flame-off",text:"Flame off / end boil",checked:!1,category:"post-boil"}),v.push({id:"postboil-chill",text:"Chill wort to pitch temp",checked:!1,category:"post-boil"}),v.push({id:"postboil-og",text:"Record original gravity (OG)",checked:!1,category:"post-boil"}),v.push({id:"postboil-transfer",text:"Transfer to fermenter",checked:!1,category:"post-boil"}),v.push({id:"postboil-yeast",text:"Pitch yeast",checked:!1,category:"post-boil"}),v.push({id:"postboil-airlock",text:"Seal fermenter and add airlock",checked:!1,category:"post-boil"}),v}function r(){try{const v=localStorage.getItem(e(m));if(v){const u=JSON.parse(v),p=P(),L=new Map(u.map(k=>[k.id,k]));for(const k of p){const h=L.get(k.id);h&&(k.checked=h.checked)}const fe=u.filter(k=>k.category==="custom");d(g,[...p,...fe],!0)}else d(g,P(),!0)}catch{d(g,P(),!0)}}function E(){try{localStorage.setItem(e(m),JSON.stringify(e(g)))}catch(v){console.warn("Failed to save checklist:",v)}}function M(v){d(g,e(g).map(u=>u.id===v?{...u,checked:!u.checked}:u),!0),E()}function se(){if(!e(q).trim())return;const v={id:`custom-${Date.now()}`,text:e(q).trim(),checked:!1,category:"custom"};d(g,[...e(g),v],!0),d(q,""),d(S,!1),E()}function me(v){d(g,e(g).filter(u=>u.id!==v),!0),E()}function be(){confirm("Reset all checklist items to unchecked?")&&(d(g,e(g).map(v=>({...v,checked:!1})),!0),E())}let F=X(()=>{if(e(g).length===0)return 0;const v=e(g).filter(u=>u.checked).length;return Math.round(v/e(g).length*100)}),$=X(()=>{const v={prep:[],mash:[],boil:[],"post-boil":[],custom:[]};for(const u of e(g))v[u.category].push(u);return v});const ie={prep:"Preparation",mash:"Mash",boil:"Boil","post-boil":"Post-Boil",custom:"Custom"};Ma(()=>{r()});var de=$r(),T=a(de),U=a(T),K=s(a(U),2),re=a(K);t(K),t(U);var D=s(U,2);D.__click=be,t(T);var N=s(T,2),ne=a(N);t(N);var te=s(N,2);wt(te,21,()=>Object.entries(e($)),Nt,(v,u)=>{var p=X(()=>rs(e(u),2));let L=()=>e(p)[0],fe=()=>e(p)[1];var k=Oe(),h=ge(k);{var y=B=>{var w=Yr(),A=a(w),W=a(A,!0);t(A);var O=s(A,2);wt(O,21,fe,ce=>ce.id,(ce,ee)=>{var Q=Kr();let ve;var ye=a(Q);mt(ye),ye.__change=()=>M(e(ee).id);var ke=s(ye,2),Se=a(ke,!0);t(ke);var je=s(ke,2);{var _e=ze=>{var f=Jr();f.__click=()=>me(e(ee).id),l(ze,f)};o(je,ze=>{e(ee).category==="custom"&&ze(_e)})}t(Q),_(()=>{ve=Ne(Q,1,"checklist-item svelte-ue9vqt",null,ve,{checked:e(ee).checked}),os(ye,e(ee).checked),c(Se,e(ee).text)}),l(ce,Q)}),t(O),t(w),_(()=>c(W,ie[L()])),l(B,w)};o(h,B=>{fe().length>0&&B(y)})}l(v,k)}),t(te);var x=s(te,2),V=a(x);{var ue=v=>{var u=Qr(),p=a(u);mt(p),p.__keydown=k=>k.key==="Enter"&&se();var L=s(p,2);L.__click=se;var fe=s(L,2);fe.__click=()=>{d(S,!1),d(q,"")},t(u),ot(p,()=>e(q),k=>d(q,k)),l(v,u)},ae=v=>{var u=Zr();u.__click=()=>d(S,!0),l(v,u)};o(V,v=>{e(S)?v(ue):v(ae,!1)})}t(x),t(de),_(()=>{c(re,`${e(F)??""}%`),jt(ne,`width: ${e(F)??""}%`)}),l(Be,de),Lt()}Vt(["click","change","keydown"]);var tl=n('<span class="save-indicator svelte-1hyfh06"> </span>'),al=n('<span class="summary-value svelte-1hyfh06"> </span>'),sl=n('<span class="summary-value svelte-1hyfh06"> </span>'),rl=n('<span class="target svelte-1hyfh06"> </span>'),ll=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Mash Temperature</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06"> </span></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Mash pH</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.01" min="4" max="7" class="field-input svelte-1hyfh06" placeholder="--"/></div> <span class="target svelte-1hyfh06">Target: 5.2-5.6</span></div></div> <div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Strike Water Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div></div></div></div>'),il=n('<span class="summary-value svelte-1hyfh06"> </span>'),nl=n('<span class="summary-value svelte-1hyfh06"> </span>'),vl=n('<span class="target svelte-1hyfh06"> </span>'),ol=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Pre-Boil Gravity</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.001" min="1.000" max="1.200" class="field-input svelte-1hyfh06" placeholder="1.0XX"/></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Pre-Boil Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div></div></div></div>'),dl=n('<span class="summary-value og svelte-1hyfh06"> </span>'),cl=n('<span class="summary-value svelte-1hyfh06"> </span>'),ul=n('<span class="target svelte-1hyfh06"> </span>'),_l=n('<span class="target svelte-1hyfh06"> </span>'),pl=n('<span class="target svelte-1hyfh06"> </span>'),fl=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Original Gravity (OG)</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.001" min="1.000" max="1.200" class="field-input og-input svelte-1hyfh06" placeholder="1.0XX"/></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Post-Boil Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div> <!></div></div> <div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Brewhouse Efficiency</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" min="0" max="100" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">%</span></div> <!></div></div></div>'),gl=n('<span class="has-notes svelte-1hyfh06">Has notes</span>'),hl=n('<div class="section-content svelte-1hyfh06"><textarea class="notes-input svelte-1hyfh06" placeholder="Record any deviations, substitutions, or observations..." rows="4"></textarea></div>'),ml=n('<div class="saving-indicator svelte-1hyfh06"><span class="spinner svelte-1hyfh06"></span> Saving...</div>'),bl=n('<div class="observations-card svelte-1hyfh06"><div class="card-header svelte-1hyfh06"><h3 class="card-title svelte-1hyfh06">Brew Day Log</h3> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Mash</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Pre-Boil</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Post-Boil / OG</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Brew Day Notes</span> <!> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <!></div>');function yl(Be,i){Ot(i,!0);let g=I(He(i.batch.actual_mash_temp??null)),q=I(He(i.batch.actual_mash_ph??null)),S=I(He(i.batch.strike_water_volume??null)),m=I(He(i.batch.pre_boil_gravity??null)),P=I(He(i.batch.pre_boil_volume??null)),r=I(He(i.batch.post_boil_volume??null)),E=I(He(i.batch.measured_og??null)),M=I(He(i.batch.actual_efficiency??null)),se=I(He(i.batch.brew_day_notes??"")),me=I(!1),be=I(null),F=I("mash"),$=X(Aa),ie=X(()=>i.recipe.mash_temp),de=X(()=>i.recipe.og),T=X(()=>i.recipe.pre_boil_og),U=X(()=>i.recipe.batch_size_liters),K=X(()=>i.recipe.efficiency);function re(){if(!e(E)||!e(de)||!e(K))return null;const b=(e(E)-1)*1e3,j=(e(de)-1)*1e3;return j===0?null:b/j*e(K)}Ma(()=>{if(e(E)&&!e(M)){const b=re();b&&d(M,Math.round(b*10)/10)}});async function D(){if(!e(me)){d(me,!0);try{const b={actual_mash_temp:e(g)??void 0,actual_mash_ph:e(q)??void 0,strike_water_volume:e(S)??void 0,pre_boil_gravity:e(m)??void 0,pre_boil_volume:e(P)??void 0,post_boil_volume:e(r)??void 0,measured_og:e(E)??void 0,actual_efficiency:e(M)??void 0,brew_day_notes:e(se)||void 0},j=await pa(i.batch.id,b);d(be,new Date,!0),i.onUpdate?.(j)}catch(b){console.error("Failed to save observations:",b)}finally{d(me,!1)}}}function N(b){d(F,e(F)===b?null:b,!0)}var ne=bl(),te=a(ne),x=s(a(te),2);{var V=b=>{var j=tl(),Z=a(j);t(j),_(le=>c(Z,`Saved ${le??""}`),[()=>e(be).toLocaleTimeString()]),l(b,j)};o(x,b=>{e(be)&&b(V)})}t(te);var ue=s(te,2);let ae;var v=a(ue);v.__click=()=>N("mash");var u=s(a(v),2),p=a(u);{var L=b=>{var j=al(),Z=a(j);t(j),_(le=>c(Z,`${le??""}${e($)??""}`),[()=>Sa(e(g))]),l(b,j)};o(p,b=>{e(g)&&b(L)})}var fe=s(p,2);{var k=b=>{var j=sl(),Z=a(j);t(j),_(le=>c(Z,`pH ${le??""}`),[()=>e(q).toFixed(2)]),l(b,j)};o(fe,b=>{e(q)&&b(k)})}t(u),we(2),t(v);var h=s(v,2);{var y=b=>{var j=ll(),Z=a(j),le=a(Z),Ee=s(a(le),2),Ie=a(Ee);mt(Ie);var _t=s(Ie,2),tt=a(_t,!0);t(_t),t(Ee);var Je=s(Ee,2);{var Ze=Ke=>{var ea=rl(),Ue=a(ea);t(ea),_(dt=>c(Ue,`Target: ${dt??""}${e($)??""}`),[()=>Sa(e(ie))]),l(Ke,ea)};o(Je,Ke=>{e(ie)&&Ke(Ze)})}t(le);var $e=s(le,2),at=s(a($e),2),zt=a(at);mt(zt),t(at),we(2),t($e),t(Z);var Wt=s(Z,2),Xt=a(Wt),Jt=s(a(Xt),2),Ft=a(Jt);mt(Ft),we(2),t(Jt),t(Xt),t(Wt),t(j),_(()=>c(tt,e($))),ht("blur",Ie,D),ot(Ie,()=>e(g),Ke=>d(g,Ke)),ht("blur",zt,D),ot(zt,()=>e(q),Ke=>d(q,Ke)),ht("blur",Ft,D),ot(Ft,()=>e(S),Ke=>d(S,Ke)),l(b,j)};o(h,b=>{e(F)==="mash"&&b(y)})}t(ue);var B=s(ue,2);let w;var A=a(B);A.__click=()=>N("preboil");var W=s(a(A),2),O=a(W);{var ce=b=>{var j=il(),Z=a(j,!0);t(j),_(le=>c(Z,le),[()=>Ut(e(m))]),l(b,j)};o(O,b=>{e(m)&&b(ce)})}var ee=s(O,2);{var Q=b=>{var j=nl(),Z=a(j);t(j),_(le=>c(Z,`${le??""}L`),[()=>e(P).toFixed(1)]),l(b,j)};o(ee,b=>{e(P)&&b(Q)})}t(W),we(2),t(A);var ve=s(A,2);{var ye=b=>{var j=ol(),Z=a(j),le=a(Z),Ee=s(a(le),2),Ie=a(Ee);mt(Ie),t(Ee);var _t=s(Ee,2);{var tt=at=>{var zt=vl(),Wt=a(zt);t(zt),_(Xt=>c(Wt,`Target: ${Xt??""}`),[()=>Ut(e(T))]),l(at,zt)};o(_t,at=>{e(T)&&at(tt)})}t(le);var Je=s(le,2),Ze=s(a(Je),2),$e=a(Ze);mt($e),we(2),t(Ze),t(Je),t(Z),t(j),ht("blur",Ie,D),ot(Ie,()=>e(m),at=>d(m,at)),ht("blur",$e,D),ot($e,()=>e(P),at=>d(P,at)),l(b,j)};o(ve,b=>{e(F)==="preboil"&&b(ye)})}t(B);var ke=s(B,2);let Se;var je=a(ke);je.__click=()=>N("postboil");var _e=s(a(je),2),ze=a(_e);{var f=b=>{var j=dl(),Z=a(j,!0);t(j),_(le=>c(Z,le),[()=>Ut(e(E))]),l(b,j)};o(ze,b=>{e(E)&&b(f)})}var C=s(ze,2);{var z=b=>{var j=cl(),Z=a(j);t(j),_(le=>c(Z,`${le??""}% eff`),[()=>e(M).toFixed(0)]),l(b,j)};o(C,b=>{e(M)&&b(z)})}t(_e),we(2),t(je);var R=s(je,2);{var H=b=>{var j=fl(),Z=a(j),le=a(Z),Ee=s(a(le),2),Ie=a(Ee);mt(Ie),t(Ee);var _t=s(Ee,2);{var tt=Ue=>{var dt=ul(),ta=a(dt);t(dt),_(na=>c(ta,`Target: ${na??""}`),[()=>Ut(e(de))]),l(Ue,dt)};o(_t,Ue=>{e(de)&&Ue(tt)})}t(le);var Je=s(le,2),Ze=s(a(Je),2),$e=a(Ze);mt($e),we(2),t(Ze);var at=s(Ze,2);{var zt=Ue=>{var dt=_l(),ta=a(dt);t(dt),_(na=>c(ta,`Target: ${na??""}L`),[()=>e(U).toFixed(1)]),l(Ue,dt)};o(at,Ue=>{e(U)&&Ue(zt)})}t(Je),t(Z);var Wt=s(Z,2),Xt=a(Wt),Jt=s(a(Xt),2),Ft=a(Jt);mt(Ft),we(2),t(Jt);var Ke=s(Jt,2);{var ea=Ue=>{var dt=pl(),ta=a(dt);t(dt),_(na=>c(ta,`Target: ${na??""}%`),[()=>e(K).toFixed(0)]),l(Ue,dt)};o(Ke,Ue=>{e(K)&&Ue(ea)})}t(Xt),t(Wt),t(j),ht("blur",Ie,D),ot(Ie,()=>e(E),Ue=>d(E,Ue)),ht("blur",$e,D),ot($e,()=>e(r),Ue=>d(r,Ue)),ht("blur",Ft,D),ot(Ft,()=>e(M),Ue=>d(M,Ue)),l(b,j)};o(R,b=>{e(F)==="postboil"&&b(H)})}t(ke);var Y=s(ke,2);let Fe;var qe=a(Y);qe.__click=()=>N("notes");var Le=s(a(qe),2);{var G=b=>{var j=gl();l(b,j)};o(Le,b=>{e(se)&&b(G)})}we(2),t(qe);var J=s(qe,2);{var oe=b=>{var j=hl(),Z=a(j);Da(Z),t(j),ht("blur",Z,D),ot(Z,()=>e(se),le=>d(se,le)),l(b,j)};o(J,b=>{e(F)==="notes"&&b(oe)})}t(Y);var Ae=s(Y,2);{var Xe=b=>{var j=ml();l(b,j)};o(Ae,b=>{e(me)&&b(Xe)})}t(ne),_(()=>{ae=Ne(ue,1,"section svelte-1hyfh06",null,ae,{expanded:e(F)==="mash"}),w=Ne(B,1,"section svelte-1hyfh06",null,w,{expanded:e(F)==="preboil"}),Se=Ne(ke,1,"section svelte-1hyfh06",null,Se,{expanded:e(F)==="postboil"}),Fe=Ne(Y,1,"section svelte-1hyfh06",null,Fe,{expanded:e(F)==="notes"})}),l(Be,ne),Lt()}Vt(["click"]);var kl=n('<span class="packaged-badge svelte-1yofiqc">Packaged</span>'),xl=n('<span class="save-indicator svelte-1yofiqc">Saved</span>'),wl=n("<option> </option>"),jl=n("<option> </option>"),ql=n('<div class="field-row priming-row svelte-1yofiqc"><div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Priming Sugar Type</label> <input type="text" class="field-input svelte-1yofiqc" placeholder="e.g., table sugar, corn sugar"/></div> <div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Amount</label> <div class="input-with-unit svelte-1yofiqc"><input type="number" step="1" class="field-input svelte-1yofiqc" placeholder="--"/> <span class="unit svelte-1yofiqc">g</span></div></div></div>'),Sl=n('<div class="card-content svelte-1yofiqc"><div class="field-row svelte-1yofiqc"><div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Packaged On</label> <input type="date" class="field-input svelte-1yofiqc"/></div> <div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Package Type</label> <select class="field-input svelte-1yofiqc"><option>Select...</option><!></select></div></div> <div class="field-row svelte-1yofiqc"><div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Volume Packaged</label> <div class="input-with-unit svelte-1yofiqc"><input type="number" step="0.1" class="field-input svelte-1yofiqc" placeholder="--"/> <span class="unit svelte-1yofiqc">L</span></div></div> <div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Carbonation Method</label> <select class="field-input svelte-1yofiqc"><option>Select...</option><!></select></div></div> <!> <div class="field full-width svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Packaging Notes</label> <textarea class="notes-input svelte-1yofiqc" placeholder="Any observations about packaging day..." rows="3"></textarea></div></div>'),Ml=n('<div class="saving-indicator svelte-1yofiqc"><span class="spinner svelte-1yofiqc"></span> Saving...</div>'),Bl=n('<div class="packaging-card svelte-1yofiqc"><button type="button" class="card-header svelte-1yofiqc"><div class="header-content svelte-1yofiqc"><h3 class="card-title svelte-1yofiqc">Packaging</h3> <!></div> <div class="header-right svelte-1yofiqc"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div></button> <!> <!></div>');function Cl(Be,i){Ot(i,!0);let g=I(He(i.batch.packaged_at?i.batch.packaged_at.split("T")[0]:"")),q=I(He(i.batch.packaging_type??"")),S=I(He(i.batch.packaging_volume??null)),m=I(He(i.batch.carbonation_method??"")),P=I(He(i.batch.priming_sugar_type??"")),r=I(He(i.batch.priming_sugar_amount??null)),E=I(He(i.batch.packaging_notes??"")),M=I(!1),se=I(null),me=I(!i.batch.packaged_at),be=X(()=>e(m)==="bottle_conditioned"||e(m)==="keg_conditioned");async function F(){if(!e(M)){d(M,!0);try{const p={packaged_at:e(g)?new Date(e(g)).toISOString():void 0,packaging_type:e(q)||void 0,packaging_volume:e(S)??void 0,carbonation_method:e(m)||void 0,priming_sugar_type:e(be)&&e(P)||void 0,priming_sugar_amount:e(be)?e(r)??void 0:void 0,packaging_notes:e(E)||void 0},L=await pa(i.batch.id,p);d(se,new Date,!0),i.onUpdate?.(L)}catch(p){console.error("Failed to save packaging info:",p)}finally{d(M,!1)}}}function $(){d(me,!e(me))}const ie=[{value:"keg",label:"Keg"},{value:"bottles",label:"Bottles"},{value:"cans",label:"Cans"}],de=[{value:"forced",label:"Force Carbonated"},{value:"bottle_conditioned",label:"Bottle Conditioned"},{value:"keg_conditioned",label:"Keg Conditioned"},{value:"natural",label:"Naturally Carbonated"}];var T=Bl(),U=a(T);U.__click=$;var K=a(U),re=s(a(K),2);{var D=p=>{var L=kl();l(p,L)};o(re,p=>{i.batch.packaged_at&&p(D)})}t(K);var N=s(K,2),ne=a(N);{var te=p=>{var L=xl();l(p,L)};o(ne,p=>{e(se)&&p(te)})}var x=s(ne,2);let V;t(N),t(U);var ue=s(U,2);{var ae=p=>{var L=Sl(),fe=a(L),k=a(fe),h=s(a(k),2);mt(h),t(k);var y=s(k,2),B=s(a(y),2);B.__change=F;var w=a(B);w.value=w.__value="";var A=s(w);wt(A,17,()=>ie,Nt,(f,C)=>{var z=wl(),R=a(z,!0);t(z);var H={};_(()=>{c(R,e(C).label),H!==(H=e(C).value)&&(z.value=(z.__value=e(C).value)??"")}),l(f,z)}),t(B),t(y),t(fe);var W=s(fe,2),O=a(W),ce=s(a(O),2),ee=a(ce);mt(ee),we(2),t(ce),t(O);var Q=s(O,2),ve=s(a(Q),2);ve.__change=F;var ye=a(ve);ye.value=ye.__value="";var ke=s(ye);wt(ke,17,()=>de,Nt,(f,C)=>{var z=jl(),R=a(z,!0);t(z);var H={};_(()=>{c(R,e(C).label),H!==(H=e(C).value)&&(z.value=(z.__value=e(C).value)??"")}),l(f,z)}),t(ve),t(Q),t(W);var Se=s(W,2);{var je=f=>{var C=ql(),z=a(C),R=s(a(z),2);mt(R),t(z);var H=s(z,2),Y=s(a(H),2),Fe=a(Y);mt(Fe),we(2),t(Y),t(H),t(C),ht("blur",R,F),ot(R,()=>e(P),qe=>d(P,qe)),ht("blur",Fe,F),ot(Fe,()=>e(r),qe=>d(r,qe)),l(f,C)};o(Se,f=>{e(be)&&f(je)})}var _e=s(Se,2),ze=s(a(_e),2);Da(ze),t(_e),t(L),ht("blur",h,F),ot(h,()=>e(g),f=>d(g,f)),Ta(B,()=>e(q),f=>d(q,f)),ht("blur",ee,F),ot(ee,()=>e(S),f=>d(S,f)),Ta(ve,()=>e(m),f=>d(m,f)),ht("blur",ze,F),ot(ze,()=>e(E),f=>d(E,f)),l(p,L)};o(ue,p=>{e(me)&&p(ae)})}var v=s(ue,2);{var u=p=>{var L=Ml();l(p,L)};o(v,p=>{e(M)&&p(u)})}t(T),_(()=>V=Ne(x,0,"chevron svelte-1yofiqc",null,V,{expanded:e(me)})),l(Be,T),Lt()}Vt(["click","change"]);var zl=n('<span class="note-count svelte-11n209s"> </span>'),Fl=n('<span class="avg-score svelte-11n209s"> </span>'),Tl=n('<button type="button" class="add-note-btn svelte-11n209s"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> Add Tasting Note</button>'),Dl=n('<button type="button"> </button>'),Al=n('<div class="score-category svelte-11n209s"><div class="category-header svelte-11n209s"><span class="category-label svelte-11n209s"> </span> <div class="score-selector svelte-11n209s"></div></div> <textarea class="category-notes svelte-11n209s" rows="2"></textarea></div>'),Rl=n('<div class="note-form svelte-11n209s"><div class="form-header svelte-11n209s"><h4 class="svelte-11n209s"> </h4> <button type="button" class="close-btn svelte-11n209s"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <!> <div class="form-actions svelte-11n209s"><button type="button" class="cancel-btn svelte-11n209s">Cancel</button> <button type="button" class="save-btn svelte-11n209s"> </button></div></div>'),Pl=n('<div><span class="score-label svelte-11n209s"> </span> <span class="score-value svelte-11n209s"> </span></div>'),Nl=n('<p class="note-text svelte-11n209s"> </p>'),Ol=n('<div><div class="note-header svelte-11n209s"><span class="note-date svelte-11n209s"> </span> <div class="note-actions svelte-11n209s"><button type="button" class="action-btn svelte-11n209s" title="Edit"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button> <button type="button" class="action-btn delete svelte-11n209s" title="Delete"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div> <div class="note-scores svelte-11n209s"></div> <!></div>'),Ll=n('<div class="notes-list svelte-11n209s"></div>'),El=n('<p class="empty-message svelte-11n209s">No tasting notes yet. Add your first one to track how this batch develops over time.</p>'),Il=n('<div class="card-content svelte-11n209s"><!> <!> <!></div>'),Gl=n('<div class="tasting-card svelte-11n209s"><button type="button" class="card-header svelte-11n209s"><div class="header-content svelte-11n209s"><h3 class="card-title svelte-11n209s">Tasting Notes</h3> <!></div> <div class="header-right svelte-11n209s"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div></button> <!></div>');function Hl(Be,i){Ot(i,!0);let g=I(He(i.batch.tasting_notes??[])),q=I(!0),S=I(!1),m=I(null),P=I(!1),r=I(He({appearance_score:void 0,appearance_notes:"",aroma_score:void 0,aroma_notes:"",flavor_score:void 0,flavor_notes:"",mouthfeel_score:void 0,mouthfeel_notes:"",overall_score:void 0,overall_notes:""})),E=X(()=>()=>{if(e(g).length===0)return null;const v=e(g).filter(u=>u.overall_score!=null).map(u=>u.overall_score);return v.length===0?null:(v.reduce((u,p)=>u+p,0)/v.length).toFixed(1)});function M(){d(q,!e(q))}function se(){d(r,{appearance_score:void 0,appearance_notes:"",aroma_score:void 0,aroma_notes:"",flavor_score:void 0,flavor_notes:"",mouthfeel_score:void 0,mouthfeel_notes:"",overall_score:void 0,overall_notes:""},!0),d(m,null),d(S,!1)}function me(){se(),d(S,!0)}function be(v){d(r,{appearance_score:v.appearance_score??void 0,appearance_notes:v.appearance_notes??"",aroma_score:v.aroma_score??void 0,aroma_notes:v.aroma_notes??"",flavor_score:v.flavor_score??void 0,flavor_notes:v.flavor_notes??"",mouthfeel_score:v.mouthfeel_score??void 0,mouthfeel_notes:v.mouthfeel_notes??"",overall_score:v.overall_score??void 0,overall_notes:v.overall_notes??""},!0),d(m,v.id,!0),d(S,!0)}async function F(){if(!e(P)){d(P,!0);try{if(e(m)){const v=await ks(i.batch.id,e(m),e(r));d(g,e(g).map(u=>u.id===e(m)?v:u),!0)}else{const v=await xs(i.batch.id,e(r));d(g,[v,...e(g)],!0)}se(),i.onUpdate?.({...i.batch,tasting_notes:e(g)})}catch(v){console.error("Failed to save tasting note:",v)}finally{d(P,!1)}}}async function $(v){if(confirm("Delete this tasting note?"))try{await ws(i.batch.id,v),d(g,e(g).filter(u=>u.id!==v),!0),i.onUpdate?.({...i.batch,tasting_notes:e(g)})}catch(u){console.error("Failed to delete tasting note:",u)}}function ie(v){return new Date(v).toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric"})}function de(v){return v==null?"-":"‚òÖ".repeat(v)+"‚òÜ".repeat(5-v)}var T=Gl(),U=a(T);U.__click=M;var K=a(U),re=s(a(K),2);{var D=v=>{var u=zl(),p=a(u,!0);t(u),_(()=>c(p,e(g).length)),l(v,u)};o(re,v=>{e(g).length>0&&v(D)})}t(K);var N=s(K,2),ne=a(N);{var te=v=>{var u=Fl(),p=a(u);t(u),_(L=>c(p,`Avg: ${L??""}/5`),[()=>e(E)()]),l(v,u)};o(ne,v=>{e(E)()&&v(te)})}var x=s(ne,2);let V;t(N),t(U);var ue=s(U,2);{var ae=v=>{var u=Il(),p=a(u);{var L=w=>{var A=Tl();A.__click=me,l(w,A)};o(p,w=>{e(S)||w(L)})}var fe=s(p,2);{var k=w=>{var A=Rl(),W=a(A),O=a(W),ce=a(O);t(O);var ee=s(O,2);ee.__click=se,t(W);var Q=s(W,2);wt(Q,16,()=>[{key:"appearance",label:"Appearance"},{key:"aroma",label:"Aroma"},{key:"flavor",label:"Flavor"},{key:"mouthfeel",label:"Mouthfeel"},{key:"overall",label:"Overall"}],Nt,(je,_e)=>{var ze=Al(),f=a(ze),C=a(f),z=a(C,!0);t(C);var R=s(C,2);wt(R,20,()=>[1,2,3,4,5],Nt,(Y,Fe)=>{var qe=Dl();let Le;qe.__click=()=>{const J=`${_e.key}_score`;e(r)[J]=Fe};var G=a(qe,!0);t(qe),_(()=>{Le=Ne(qe,1,"score-btn svelte-11n209s",null,Le,{selected:e(r)[`${_e.key}_score`]===Fe}),c(G,Fe)}),l(Y,qe)}),t(R),t(f);var H=s(f,2);Da(H),t(ze),_(Y=>{c(z,_e.label),Ht(H,"placeholder",`Notes on ${Y??""}...`)},[()=>_e.label.toLowerCase()]),ot(H,()=>e(r)[`${_e.key}_notes`],Y=>e(r)[`${_e.key}_notes`]=Y),l(je,ze)});var ve=s(Q,2),ye=a(ve);ye.__click=se;var ke=s(ye,2);ke.__click=F;var Se=a(ke,!0);t(ke),t(ve),t(A),_(()=>{c(ce,`${e(m)?"Edit":"New"} Tasting Note`),ke.disabled=e(P),c(Se,e(P)?"Saving...":e(m)?"Update":"Save")}),l(w,A)};o(fe,w=>{e(S)&&w(k)})}var h=s(fe,2);{var y=w=>{var A=Ll();wt(A,21,()=>e(g),Nt,(W,O)=>{var ce=Ol();let ee;var Q=a(ce),ve=a(Q),ye=a(ve,!0);t(ve);var ke=s(ve,2),Se=a(ke);Se.__click=()=>be(e(O));var je=s(Se,2);je.__click=()=>$(e(O).id),t(ke),t(Q);var _e=s(Q,2);wt(_e,20,()=>[{key:"appearance",label:"App"},{key:"aroma",label:"Aroma"},{key:"flavor",label:"Flav"},{key:"mouthfeel",label:"Mouth"},{key:"overall",label:"Overall"}],Nt,(C,z)=>{var R=Pl();let H;var Y=a(R),Fe=a(Y,!0);t(Y);var qe=s(Y,2),Le=a(qe,!0);t(qe),t(R),_(G=>{H=Ne(R,1,"score-item svelte-11n209s",null,H,{overall:z.key==="overall"}),c(Fe,z.label),c(Le,G)},[()=>de(e(O)[`${z.key}_score`])]),l(C,R)}),t(_e);var ze=s(_e,2);{var f=C=>{var z=Nl(),R=a(z,!0);t(z),_(()=>c(R,e(O).overall_notes)),l(C,z)};o(ze,C=>{e(O).overall_notes&&C(f)})}t(ce),_(C=>{ee=Ne(ce,1,"note-item svelte-11n209s",null,ee,{editing:e(m)===e(O).id}),c(ye,C)},[()=>ie(e(O).tasted_at)]),l(W,ce)}),t(A),l(w,A)},B=w=>{var A=Oe(),W=ge(A);{var O=ce=>{var ee=El();l(ce,ee)};o(W,ce=>{e(S)||ce(O)},!0)}l(w,A)};o(h,w=>{e(g).length>0?w(y):w(B,!1)})}t(u),l(v,u)};o(ue,v=>{e(q)&&v(ae)})}t(T),_(()=>V=Ne(x,0,"chevron svelte-11n209s",null,V,{expanded:e(q)})),l(Be,T),Lt()}Vt(["click"]);var Ul=n('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),Vl=n('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),Wl=n('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),Xl=n('<span class="recipe-type svelte-g5au2j"> </span>'),Jl=n('<a class="recipe-link svelte-g5au2j"> <!></a>'),Kl=n('<div class="batch-timing svelte-g5au2j"> </div>'),Yl=n('<div class="batch-timing svelte-g5au2j"> </div>'),Ql=n('<option class="svelte-g5au2j"> </option>'),Zl=ga('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" class="svelte-g5au2j"></path><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Resume',1),$l=ga('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Pause',1),ei=n('<button type="button"><!></button>'),ti=n('<span class="chilling-icon svelte-g5au2j">üç∫</span> <h3 class="chilling-title svelte-g5au2j">Ready to Pitch!</h3>',1),ai=n('<span class="chilling-icon svelte-g5au2j">‚ùÑÔ∏è</span> <h3 class="chilling-title svelte-g5au2j">Chilling to Pitch Temperature</h3>',1),si=n('<div class="progress-section svelte-g5au2j"><div class="progress-bar svelte-g5au2j"><div class="progress-fill svelte-g5au2j"></div></div> <span class="progress-text svelte-g5au2j"> </span></div>'),ri=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è No cooler configured - set a cooler entity to enable automated chilling</span>'),li=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è Temperature control disabled in settings</span>'),ii=n('<span class="status-ready svelte-g5au2j">Wort has reached pitch temperature - ready to add yeast!</span>'),ni=n('<span class="status-active svelte-g5au2j">Cooler will run automatically when temp exceeds target + hysteresis</span>'),vi=n('<div><div class="chilling-header svelte-g5au2j"><!></div> <div class="chilling-content svelte-g5au2j"><div class="temp-display svelte-g5au2j"><div class="temp-current svelte-g5au2j"><span class="temp-label svelte-g5au2j">Current</span> <span class="temp-value svelte-g5au2j"> </span></div> <div class="temp-arrow svelte-g5au2j">‚Üí</div> <div class="temp-target svelte-g5au2j"><span class="temp-label svelte-g5au2j">Target</span> <span class="temp-value svelte-g5au2j"> </span></div></div> <!> <div class="chilling-status svelte-g5au2j"><!></div></div></div>'),oi=n(`<div class="paused-banner svelte-g5au2j"><div class="paused-header svelte-g5au2j"><svg class="paused-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> <h3 class="paused-title svelte-g5au2j">Readings Paused</h3></div> <p class="paused-text svelte-g5au2j">Hydrometer readings are not being stored. Live readings still display but won't be saved to the fermentation history.</p> <button type="button" class="resume-btn svelte-g5au2j"> </button></div>`),di=n('<span class="btn-spinner svelte-g5au2j"></span> Starting...',1),ci=ga('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" class="svelte-g5au2j"></path><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Start Brew Day',1),ui=n(`<div class="planning-phase svelte-g5au2j"><div class="phase-action-card svelte-g5au2j"><div class="phase-icon svelte-g5au2j">üìã</div> <h2 class="phase-title svelte-g5au2j">Ready to Brew?</h2> <p class="phase-description svelte-g5au2j">Review your recipe below, then start brew day when you're ready to begin.</p> <button type="button" class="start-brewday-btn svelte-g5au2j"><!></button></div> <!></div>`),_i=n('<span class="btn-spinner svelte-g5au2j"></span> Starting...',1),pi=ga('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" class="svelte-g5au2j"></path></svg> Yeast Pitched - Start Fermentation',1),fi=n(`<div class="brewing-phase svelte-g5au2j"><div class="phase-action-card brewing svelte-g5au2j"><div class="phase-icon svelte-g5au2j">üç∫</div> <h2 class="phase-title svelte-g5au2j">Brew Day in Progress</h2> <p class="phase-description svelte-g5au2j">Track your brew day activities. When you've pitched the yeast and fermentation begins, transition to the fermentation phase.</p> <button type="button" class="start-fermentation-btn svelte-g5au2j"><!></button></div> <div class="brewday-tools-grid svelte-g5au2j"><!> <!></div> <!> <!> <!></div>`),gi=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot brewing svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Brew Day</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),hi=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot fermenting svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Fermentation Started</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),mi=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot conditioning svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Conditioning Started</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),bi=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot completed svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Completed</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),yi=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot packaged svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j"> </span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),ki=n('<div class="completed-phase svelte-g5au2j"><div class="batch-summary-card svelte-g5au2j"><h2 class="summary-title svelte-g5au2j">Batch Complete</h2> <div class="summary-stats svelte-g5au2j"><div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Original Gravity</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Final Gravity</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">ABV</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Attenuation</span> <span class="stat-value svelte-g5au2j"><!></span></div></div></div> <div class="timeline-card svelte-g5au2j"><h3 class="timeline-title svelte-g5au2j">Batch Timeline</h3> <div class="timeline svelte-g5au2j"><!> <!> <!> <!> <!></div></div> <!> <!> <!></div>'),xi=n('<span class="status-badge heater svelte-g5au2j">üî• Heating</span>'),wi=n('<span class="status-badge cooler svelte-g5au2j">‚ùÑÔ∏è Cooling</span>'),ji=n('<span class="status-badge idle svelte-g5au2j"> </span>'),qi=n('<div class="device-status heater svelte-g5au2j"><div>üî•</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Heater</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Si=n('<div class="device-status cooler svelte-g5au2j"><div>‚ùÑÔ∏è</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Cooler</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Mi=n('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">‚ö°</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),Bi=n('<button type="button" class="override-btn heat-on svelte-g5au2j">Force Heat ON</button> <button type="button" class="override-btn heat-off svelte-g5au2j">Force Heat OFF</button>',1),Ci=n('<button type="button" class="override-btn cool-on svelte-g5au2j">Force Cool ON</button> <button type="button" class="override-btn cool-off svelte-g5au2j">Force Cool OFF</button>',1),zi=n('<div class="control-details svelte-g5au2j"><div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns-grid svelte-g5au2j"><!> <!> <button type="button" class="override-btn auto-mode svelte-g5au2j">Auto Mode</button></div></div>',1),Fi=n('<div class="device-status-grid svelte-g5au2j"><!> <!></div> <!>',1),Ti=n('<div><button type="button" class="collapsible-header svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="collapse-indicator svelte-g5au2j"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" class="svelte-g5au2j"></path></svg></div></button> <!></div>'),Di=n('<span class="svelte-g5au2j"> </span>'),Ai=n('<span class="svelte-g5au2j"> </span>'),Ri=n('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><!> <!> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),Pi=n('<div class="chart-section svelte-g5au2j"><!></div>'),Ni=n('<div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!> <!></div></div> <!>',1),Oi=n('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <!> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j" aria-label="Delete batch"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <!> <!> <!>',1),Li=n('<div class="modal-overlay svelte-g5au2j" role="presentation"><div class="modal svelte-g5au2j" role="dialog" aria-modal="true" aria-labelledby="delete-modal-title" tabindex="-1"><h2 id="delete-modal-title" class="modal-title svelte-g5au2j">Delete Batch?</h2> <p class="modal-text svelte-g5au2j"> </p> <div class="modal-actions svelte-g5au2j"><button type="button" class="modal-btn cancel svelte-g5au2j">Cancel</button> <button type="button" class="modal-btn delete svelte-g5au2j"> </button></div></div></div>'),Ei=n('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div> <!>',1);function dn(Be,i){Ot(i,!0);const g=()=>_s(ps,"$page",q),[q,S]=us();let m=null,P=null,r=I(null),E=I(null),M=I(null),se=He([]),me=I(!0),be=I(null),F=I(!1),$=I(!1),ie=I(!1),de=I(!1),T=I(!1),U=I(!1),K=I(!1),re=X(()=>parseInt(g().params.id??"0"));const D=["planning","brewing","fermenting","conditioning","completed","archived"];let N=X(()=>e(r)?za[e(r).status]:za.planning),ne=X(Aa),te=X(()=>qa.config.ha_enabled&&qa.config.temp_control_enabled&&(e(r)?.heater_entity_id||e(r)?.cooler_entity_id)),x=X(()=>e(r)?.status==="planning"&&e(r)?.temp_target!=null),V=X(()=>!e(x)||!e(ae)?.temp||!e(r)?.temp_target?!1:e(ae).temp<=e(r).temp_target),ue=X(()=>{if(!e(x)||!e(ae)?.temp||!e(r)?.temp_target)return null;const f=e(r).temp_target+30,C=e(ae).temp,z=e(r).temp_target;if(C<=z)return 100;if(C>=f)return 0;const R=(f-C)/(f-z)*100;return Math.min(100,Math.max(0,R))}),ae=X(()=>{if(!e(r)?.device_id)return null;const f=Ha.tilts.get(e(r).device_id);if(f)return f;const C=e(r).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!C?.[1])return null;const z=C[1].toUpperCase();for(const R of Ha.tilts.values())if(R.color&&R.color.toUpperCase()===z)return R;return null});async function v(){d(me,!0),d(be,null);try{if(d(r,await js(e(re)),!0),e(r).status==="fermenting"||e(r).status==="conditioning")try{d(E,await Ba(e(re)),!0)}catch{}if(e(r).heater_entity_id||e(r).cooler_entity_id)try{d(M,await ja(e(re)),!0)}catch{}}catch(f){d(be,f instanceof Error?f.message:"Failed to load batch",!0)}finally{d(me,!1)}}async function u(f){if(!(!e(r)||e($))&&!(f==="conditioning"&&e(r).status==="fermenting"&&!confirm(`üí° Entering Conditioning Phase

Reminder: Adjust target temperature if cold crashing.
Temperature control will continue during conditioning.

Continue?`))){d($,!0);try{d(r,await pa(e(r).id,{status:f}),!0),(f==="fermenting"||f==="conditioning")&&d(E,await Ba(e(r).id),!0)}catch(C){console.error("Failed to update status:",C)}finally{d($,!1)}}}async function p(){if(!(!e(r)||e($))){d($,!0);try{d(r,await pa(e(r).id,{status:"brewing"}),!0)}catch(f){console.error("Failed to start brew day:",f)}finally{d($,!1)}}}async function L(){if(!(!e(r)||e($))){d($,!0);try{d(r,await pa(e(r).id,{status:"fermenting"}),!0),d(E,await Ba(e(r).id),!0)}catch(f){console.error("Failed to start fermentation:",f)}finally{d($,!1)}}}async function fe(f){if(e(r)&&(d(r,await pa(e(r).id,f),!0),d(F,!1),e(r).heater_entity_id||e(r).cooler_entity_id))try{d(M,await ja(e(r).id),!0)}catch{}}async function k(){if(e(r)){d(T,!0);try{await qs(e(r).id),fs("/batches")}catch(f){d(be,f instanceof Error?f.message:"Failed to delete batch",!0),d(T,!1),d(de,!1)}}}async function h(){if(!(!e(r)||e(K))){d(K,!0);try{d(r,await pa(e(r).id,{readings_paused:!e(r).readings_paused}),!0)}catch(f){console.error("Failed to toggle pause:",f)}finally{d(K,!1)}}}async function y(f,C){if(!(!e(r)||e(ie))){d(ie,!0);try{await Ca(e(r).id,C,60,f),d(M,await ja(e(r).id),!0)}catch(z){console.error("Failed to set override:",z)}finally{d(ie,!1)}}}async function B(){if(!(!e(r)||e(ie))){d(ie,!0);try{e(r).heater_entity_id&&await Ca(e(r).id,null,60,"heater"),e(r).cooler_entity_id&&await Ca(e(r).id,null,60,"cooler"),d(M,await ja(e(r).id),!0)}catch(f){console.error("Failed to clear overrides:",f)}finally{d(ie,!1)}}}function w(){if(m?.readyState===WebSocket.OPEN)return;const C=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;m=new WebSocket(C),m.onmessage=async z=>{try{const R=JSON.parse(z.data);R.type==="control_event"&&R.batch_id===e(re)&&e(M)&&(R.action==="heat_on"?d(M,{...e(M),heater_state:"on"},!0):R.action==="heat_off"?d(M,{...e(M),heater_state:"off"},!0):R.action==="cool_on"?d(M,{...e(M),cooler_state:"on"},!0):R.action==="cool_off"&&d(M,{...e(M),cooler_state:"off"},!0))}catch{}},m.onclose=()=>{m=null,P=setTimeout(w,3e3)},m.onerror=()=>{m?.close()}}function A(){P&&(clearTimeout(P),P=null),m?.close(),m=null}function W(f){return f==null?"--":Ut(f)}function O(f){return f==null?"--":Sa(f)}function ce(f){return f?new Date(f).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"--"}function ee(f){if(!f)return"--";const C=new Date(f),R=(new Date().getTime()-C.getTime())/(1e3*60*60);if(R<1)return`${Math.round(R*60)}m`;if(R<24)return`${R.toFixed(1)}h`;const H=R/24;return H<7?`${H.toFixed(1)}d`:`${Math.round(H)}d`}function Q(f){return f?new Date(f).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"}):"--"}Wa(()=>{v(),w()}),ls(()=>{A()});var ve=Ei();vs("g5au2j",f=>{is(()=>{ns.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var ye=ge(ve),ke=s(a(ye),2);{var Se=f=>{var C=Ul();l(f,C)},je=f=>{var C=Oe(),z=ge(C);{var R=Y=>{var Fe=Vl(),qe=s(a(Fe),2),Le=a(qe,!0);t(qe);var G=s(qe,2);G.__click=v,t(Fe),_(()=>c(Le,e(be))),l(Y,Fe)},H=Y=>{var Fe=Oe(),qe=ge(Fe);{var Le=J=>{var oe=Wl();l(J,oe)},G=J=>{var oe=Oe(),Ae=ge(oe);{var Xe=j=>{Ss(j,{get batch(){return e(r)},onSubmit:fe,onCancel:()=>d(F,!1)})},b=j=>{var Z=Oi(),le=ge(Z),Ee=a(le),Ie=a(Ee),_t=a(Ie);t(Ie);var tt=s(Ie,2),Je=a(tt),Ze=a(Je,!0);t(Je);var $e=s(Je,2);{var at=Me=>{var he=Jl(),De=a(he),Ve=s(De);{var st=et=>{var Ge=Xl(),rt=a(Ge);t(Ge),_(()=>c(rt,`(${e(r).recipe.type??""})`)),l(et,Ge)};o(Ve,et=>{e(r).recipe.type&&et(st)})}t(he),_(()=>{Ht(he,"href",`/recipes/${e(r).recipe.id??""}`),c(De,`${e(r).recipe.name??""} `)}),l(Me,he)};o($e,Me=>{e(r).recipe&&Me(at)})}var zt=s($e,2);{var Wt=Me=>{var he=Kl(),De=a(he);t(he),_((Ve,st)=>c(De,`Started ${Ve??""} ¬∑ ${st??""} ago`),[()=>ce(e(r).start_time),()=>ee(e(r).start_time)]),l(Me,he)},Xt=Me=>{var he=Oe(),De=ge(he);{var Ve=st=>{var et=Yl(),Ge=a(et);t(et),_(rt=>c(Ge,`Brewed ${rt??""}`),[()=>ce(e(r).brew_date)]),l(st,et)};o(De,st=>{e(r).brew_date&&st(Ve)},!0)}l(Me,he)};o(zt,Me=>{e(r).start_time?Me(Wt):Me(Xt,!1)})}t(tt),t(Ee);var Jt=s(Ee,2),Ft=a(Jt),Ke=a(Ft);Ke.__change=Me=>u(Me.currentTarget.value),wt(Ke,21,()=>D,Nt,(Me,he)=>{var De=Ql(),Ve=a(De,!0);t(De);var st={};_(()=>{c(Ve,za[e(he)].label),st!==(st=e(he))&&(De.value=(De.__value=e(he))??"")}),l(Me,De)}),t(Ke);var ea;ds(Ke),t(Ft);var Ue=s(Ft,2);{var dt=Me=>{var he=ei();let De;he.__click=h;var Ve=a(he);{var st=Ge=>{var rt=Zl();we(),l(Ge,rt)},et=Ge=>{var rt=$l();we(),l(Ge,rt)};o(Ve,Ge=>{e(r).readings_paused?Ge(st):Ge(et,!1)})}t(he),_(()=>{De=Ne(he,1,"pause-btn svelte-g5au2j",null,De,{paused:e(r).readings_paused}),he.disabled=e(K),Ht(he,"title",e(r).readings_paused?"Resume storing readings":"Pause storing readings")}),l(Me,he)};o(Ue,Me=>{(e(r).status==="fermenting"||e(r).status==="conditioning")&&Me(dt)})}var ta=s(Ue,2);ta.__click=()=>d(F,!0);var na=s(ta,2);na.__click=()=>d(de,!0),t(Jt),t(le);var Ra=s(le,2);{var Ja=Me=>{var he=vi();let De;var Ve=a(he),st=a(Ve);{var et=Re=>{var Ye=ti();we(2),l(Re,Ye)},Ge=Re=>{var Ye=ai();we(2),l(Re,Ye)};o(st,Re=>{e(V)?Re(et):Re(Ge,!1)})}t(Ve);var rt=s(Ve,2),qt=a(rt),lt=a(qt),ct=s(a(lt),2),Et=a(ct,!0);t(ct),t(lt);var pt=s(lt,4),St=s(a(pt),2),It=a(St,!0);t(St),t(pt),t(qt);var Kt=s(qt,2);{var va=Re=>{var Ye=si(),xe=a(Ye),ft=a(xe);t(xe);var aa=s(xe,2),Bt=a(aa);t(aa),t(Ye),_(Gt=>{jt(ft,`width: ${e(ue)??""}%`),c(Bt,`${Gt??""}% to target`)},[()=>Math.round(e(ue))]),l(Re,Ye)};o(Kt,Re=>{e(ue)!=null&&!e(V)&&Re(va)})}var Mt=s(Kt,2),Yt=a(Mt);{var Qt=Re=>{var Ye=ri();l(Re,Ye)},Zt=Re=>{var Ye=Oe(),xe=ge(Ye);{var ft=Bt=>{var Gt=li();l(Bt,Gt)},aa=Bt=>{var Gt=Oe(),oa=ge(Gt);{var Ce=ut=>{var bt=ii();l(ut,bt)},nt=ut=>{var bt=ni();l(ut,bt)};o(oa,ut=>{e(V)?ut(Ce):ut(nt,!1)},!0)}l(Bt,Gt)};o(xe,Bt=>{!qa.config.ha_enabled||!qa.config.temp_control_enabled?Bt(ft):Bt(aa,!1)},!0)}l(Re,Ye)};o(Yt,Re=>{e(r).cooler_entity_id?Re(Zt,!1):Re(Qt)})}t(Mt),t(rt),t(he),_((Re,Ye)=>{De=Ne(he,1,"chilling-banner svelte-g5au2j",null,De,{ready:e(V)}),c(Et,Re),c(It,Ye)},[()=>e(ae)?.temp!=null?O(e(ae).temp):"--",()=>e(r).temp_target!=null?O(e(r).temp_target):"--"]),l(Me,he)};o(Ra,Me=>{e(x)&&Me(Ja)})}var Pa=s(Ra,2);{var Ka=Me=>{var he=oi(),De=s(a(he),4);De.__click=h;var Ve=a(De,!0);t(De),t(he),_(()=>{De.disabled=e(K),c(Ve,e(K)?"Resuming...":"Resume Readings")}),l(Me,he)};o(Pa,Me=>{e(r).readings_paused&&(e(r).status==="fermenting"||e(r).status==="conditioning")&&Me(Ka)})}var Ya=s(Pa,2);{var Qa=Me=>{var he=ui(),De=a(he),Ve=s(a(De),6);Ve.__click=p;var st=a(Ve);{var et=lt=>{var ct=di();we(),l(lt,ct)},Ge=lt=>{var ct=ci();we(),l(lt,ct)};o(st,lt=>{e($)?lt(et):lt(Ge,!1)})}t(Ve),t(De);var rt=s(De,2);{var qt=lt=>{Fa(lt,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};o(rt,lt=>{e(r).recipe&&lt(qt)})}t(he),_(()=>Ve.disabled=e($)),l(Me,he)},Za=Me=>{var he=Oe(),De=ge(he);{var Ve=et=>{var Ge=fi(),rt=a(Ge),qt=s(a(rt),6);qt.__click=L;var lt=a(qt);{var ct=xe=>{var ft=_i();we(),l(xe,ft)},Et=xe=>{var ft=pi();we(),l(xe,ft)};o(lt,xe=>{e($)?xe(ct):xe(Et,!1)})}t(qt),t(rt);var pt=s(rt,2),St=a(pt);{var It=xe=>{Xr(xe,{get recipe(){return e(r).recipe}})};o(St,xe=>{e(r).recipe&&xe(It)})}var Kt=s(St,2);{var va=xe=>{el(xe,{get recipe(){return e(r).recipe},get batchId(){return e(r).id}})};o(Kt,xe=>{e(r).recipe&&xe(va)})}t(pt);var Mt=s(pt,2);{var Yt=xe=>{yl(xe,{get batch(){return e(r)},get recipe(){return e(r).recipe},onUpdate:ft=>d(r,ft,!0)})};o(Mt,xe=>{e(r).recipe&&xe(Yt)})}var Qt=s(Mt,2);{var Zt=xe=>{Ua(xe,{get batch(){return e(r)},get liveReading(){return e(ae)},onEdit:()=>d(F,!0)})};o(Qt,xe=>{e(r).device_id&&xe(Zt)})}var Re=s(Qt,2);{var Ye=xe=>{Fa(xe,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};o(Re,xe=>{e(r).recipe&&xe(Ye)})}t(Ge),_(()=>qt.disabled=e($)),l(et,Ge)},st=et=>{var Ge=Oe(),rt=ge(Ge);{var qt=ct=>{var Et=ki(),pt=a(Et),St=s(a(pt),2),It=a(St),Kt=s(a(It),2),va=a(Kt,!0);t(Kt),t(It);var Mt=s(It,2),Yt=s(a(Mt),2),Qt=a(Yt,!0);t(Yt),t(Mt);var Zt=s(Mt,2),Re=s(a(Zt),2),Ye=a(Re);t(Re),t(Zt);var xe=s(Zt,2),ft=s(a(xe),2),aa=a(ft);{var Bt=pe=>{var Te=ia();_(Pe=>c(Te,`${Pe??""}%`),[()=>((e(r).measured_og-e(r).measured_fg)/(e(r).measured_og-1)*100).toFixed(0)]),l(pe,Te)},Gt=pe=>{var Te=ia("--");l(pe,Te)};o(aa,pe=>{e(r).measured_og&&e(r).measured_fg?pe(Bt):pe(Gt,!1)})}t(ft),t(xe),t(St),t(pt);var oa=s(pt,2),Ce=s(a(oa),2),nt=a(Ce);{var ut=pe=>{var Te=gi(),Pe=s(a(Te),2),We=s(a(Pe),2),kt=a(We,!0);t(We),t(Pe),t(Te),_(gt=>c(kt,gt),[()=>Q(e(r).brewing_started_at||e(r).brew_date)]),l(pe,Te)};o(nt,pe=>{(e(r).brew_date||e(r).brewing_started_at)&&pe(ut)})}var bt=s(nt,2);{var sa=pe=>{var Te=hi(),Pe=s(a(Te),2),We=s(a(Pe),2),kt=a(We,!0);t(We),t(Pe),t(Te),_(gt=>c(kt,gt),[()=>Q(e(r).fermenting_started_at||e(r).start_time)]),l(pe,Te)};o(bt,pe=>{(e(r).start_time||e(r).fermenting_started_at)&&pe(sa)})}var $t=s(bt,2);{var ha=pe=>{var Te=mi(),Pe=s(a(Te),2),We=s(a(Pe),2),kt=a(We,!0);t(We),t(Pe),t(Te),_(gt=>c(kt,gt),[()=>Q(e(r).conditioning_started_at)]),l(pe,Te)};o($t,pe=>{e(r).conditioning_started_at&&pe(ha)})}var da=s($t,2);{var xa=pe=>{var Te=bi(),Pe=s(a(Te),2),We=s(a(Pe),2),kt=a(We,!0);t(We),t(Pe),t(Te),_(gt=>c(kt,gt),[()=>Q(e(r).completed_at||e(r).end_time)]),l(pe,Te)};o(da,pe=>{(e(r).end_time||e(r).completed_at)&&pe(xa)})}var ma=s(da,2);{var wa=pe=>{var Te=yi(),Pe=s(a(Te),2),We=a(Pe),kt=a(We);t(We);var gt=s(We,2),it=a(gt,!0);t(gt),t(Pe),t(Te),_(vt=>{c(kt,`Packaged (${(e(r).packaging_type||"kegged")??""})`),c(it,vt)},[()=>Q(e(r).packaged_at)]),l(pe,Te)};o(ma,pe=>{e(r).packaged_at&&pe(wa)})}t(Ce),t(oa);var Ct=s(oa,2);Cl(Ct,{get batch(){return e(r)},onUpdate:pe=>d(r,pe,!0)});var Qe=s(Ct,2);Hl(Qe,{get batch(){return e(r)},onUpdate:pe=>d(r,pe,!0)});var yt=s(Qe,2);{var ca=pe=>{Va(pe,{get notes(){return e(r).notes}})};o(yt,pe=>{e(r).notes&&pe(ca)})}t(Et),_((pe,Te,Pe)=>{c(va,pe),c(Qt,Te),c(Ye,`${Pe??""}%`)},[()=>W(e(r).measured_og),()=>W(e(r).measured_fg),()=>e(r).measured_abv?.toFixed(1)??"--"]),l(ct,Et)},lt=ct=>{var Et=Ni(),pt=ge(Et),St=a(pt),It=a(St);{let Ce=X(()=>e(ae)?.sg??e(E)?.measured?.current_sg);Hs(It,{get batch(){return e(r)},get currentSg(){return e(Ce)},get progress(){return e(E)},get liveReading(){return e(ae)}})}var Kt=s(It,2);{var va=Ce=>{Fa(Ce,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};o(Kt,Ce=>{e(r).recipe&&Ce(va)})}t(St);var Mt=s(St,2),Yt=a(Mt);Ua(Yt,{get batch(){return e(r)},get liveReading(){return e(ae)},onEdit:()=>d(F,!0)});var Qt=s(Yt,2);{var Zt=Ce=>{Rr(Ce,{get batchId(){return e(r).id}})};o(Qt,Ce=>{(e(r).status==="fermenting"||e(r).status==="conditioning")&&Ce(Zt)})}var Re=s(Qt,2);{let Ce=X(()=>e(ae)?.sg);Mr(Re,{get batchId(){return e(r).id},get measuredOg(){return e(r).measured_og},get currentSg(){return e(Ce)},get liveReading(){return e(ae)}})}var Ye=s(Re,2);{var xe=Ce=>{var nt=Ti();let ut;var bt=a(nt);bt.__click=()=>d(U,!e(U));var sa=s(a(bt),2),$t=a(sa);{var ha=Qe=>{var yt=xi();l(Qe,yt)},da=Qe=>{var yt=Oe(),ca=ge(yt);{var pe=Pe=>{var We=wi();l(Pe,We)},Te=Pe=>{var We=Oe(),kt=ge(We);{var gt=it=>{var vt=ji(),Tt=a(vt);t(vt),_(Dt=>c(Tt,`üéØ ${Dt??""}${e(ne)??""}`),[()=>O(e(M).target_temp)]),l(it,vt)};o(kt,it=>{e(U)&&e(M)&&it(gt)},!0)}l(Pe,We)};o(ca,Pe=>{e(M)?.cooler_state==="on"?Pe(pe):Pe(Te,!1)},!0)}l(Qe,yt)};o($t,Qe=>{e(M)?.heater_state==="on"?Qe(ha):Qe(da,!1)})}var xa=s($t,2);let ma;t(sa),t(bt);var wa=s(bt,2);{var Ct=Qe=>{var yt=Fi(),ca=ge(yt),pe=a(ca);{var Te=it=>{var vt=qi(),Tt=a(vt);let Dt;var ra=s(Tt,2),At=s(a(ra),2);let la;var ba=a(At,!0);t(At);var ua=s(At,2),ya=a(ua,!0);t(ua),t(ra),t(vt),_(()=>{Dt=Ne(Tt,1,"device-icon-wrap svelte-g5au2j",null,Dt,{active:e(M)?.heater_state==="on"}),la=Ne(At,1,"device-state svelte-g5au2j",null,la,{on:e(M)?.heater_state==="on"}),c(ba,e(M)?.heater_state==="on"?"ON":"OFF"),c(ya,e(r).heater_entity_id)}),l(it,vt)};o(pe,it=>{e(r).heater_entity_id&&it(Te)})}var Pe=s(pe,2);{var We=it=>{var vt=Si(),Tt=a(vt);let Dt;var ra=s(Tt,2),At=s(a(ra),2);let la;var ba=a(At,!0);t(At);var ua=s(At,2),ya=a(ua,!0);t(ua),t(ra),t(vt),_(()=>{Dt=Ne(Tt,1,"device-icon-wrap svelte-g5au2j",null,Dt,{active:e(M)?.cooler_state==="on"}),la=Ne(At,1,"device-state svelte-g5au2j",null,la,{on:e(M)?.cooler_state==="on"}),c(ba,e(M)?.cooler_state==="on"?"ON":"OFF"),c(ya,e(r).cooler_entity_id)}),l(it,vt)};o(Pe,it=>{e(r).cooler_entity_id&&it(We)})}t(ca);var kt=s(ca,2);{var gt=it=>{var vt=zi(),Tt=ge(vt),Dt=a(Tt),ra=s(a(Dt),2),At=a(ra);t(ra),t(Dt);var la=s(Dt,2),ba=s(a(la),2),ua=a(ba);t(ba),t(la),t(Tt);var ya=s(Tt,2);{var $a=xt=>{var Rt=Mi(),Pt=s(a(Rt),2),_a=a(Pt);t(Pt);var Ga=s(Pt,2);Ga.__click=()=>B(),t(Rt),_(as=>{c(_a,`Override active: ${as??""}`),Ga.disabled=e(ie)},[()=>e(M).override_state?.toUpperCase()]),l(xt,Rt)};o(ya,xt=>{e(M).override_active&&xt($a)})}var Na=s(ya,2),Oa=s(a(Na),2),La=a(Oa);{var es=xt=>{var Rt=Bi(),Pt=ge(Rt);Pt.__click=()=>y("heater","on");var _a=s(Pt,2);_a.__click=()=>y("heater","off"),_(()=>{Pt.disabled=e(ie),_a.disabled=e(ie)}),l(xt,Rt)};o(La,xt=>{e(r).heater_entity_id&&xt(es)})}var Ea=s(La,2);{var ts=xt=>{var Rt=Ci(),Pt=ge(Rt);Pt.__click=()=>y("cooler","on");var _a=s(Pt,2);_a.__click=()=>y("cooler","off"),_(()=>{Pt.disabled=e(ie),_a.disabled=e(ie)}),l(xt,Rt)};o(Ea,xt=>{e(r).cooler_entity_id&&xt(ts)})}var Ia=s(Ea,2);Ia.__click=()=>B(),t(Oa),t(Na),_((xt,Rt)=>{c(At,`${xt??""}${e(ne)??""}`),c(ua,`¬±${Rt??""}${e(ne)??""}`),Ia.disabled=e(ie)},[()=>O(e(M).target_temp),()=>e(M).hysteresis?.toFixed(1)||"--"]),l(it,vt)};o(kt,it=>{e(M)&&it(gt)})}l(Qe,yt)};o(wa,Qe=>{e(U)||Qe(Ct)})}t(nt),_(()=>{ut=Ne(nt,1,"info-card temp-control-card svelte-g5au2j",null,ut,{"heater-on":e(M)?.heater_state==="on","cooler-on":e(M)?.cooler_state==="on",collapsed:e(U)}),ma=Ne(xa,0,"chevron svelte-g5au2j",null,ma,{rotated:!e(U)})}),l(Ce,nt)},ft=Ce=>{var nt=Oe(),ut=ge(nt);{var bt=sa=>{var $t=Ri(),ha=s(a($t),2),da=a(ha);{var xa=Ct=>{var Qe=Di(),yt=a(Qe);t(Qe),_(()=>c(yt,`Heater: ${e(r).heater_entity_id??""}`)),l(Ct,Qe)};o(da,Ct=>{e(r).heater_entity_id&&Ct(xa)})}var ma=s(da,2);{var wa=Ct=>{var Qe=Ai(),yt=a(Qe);t(Qe),_(()=>c(yt,`Cooler: ${e(r).cooler_entity_id??""}`)),l(Ct,Qe)};o(ma,Ct=>{e(r).cooler_entity_id&&Ct(wa)})}we(2),t(ha),t($t),l(sa,$t)};o(ut,sa=>{(e(r).heater_entity_id||e(r).cooler_entity_id)&&e(r).status!=="fermenting"&&sa(bt)},!0)}l(Ce,nt)};o(Ye,Ce=>{e(te)&&(e(r).status==="fermenting"||e(r).status==="conditioning")?Ce(xe):Ce(ft,!1)})}var aa=s(Ye,2);{var Bt=Ce=>{Va(Ce,{get notes(){return e(r).notes}})};o(aa,Ce=>{e(r).notes&&Ce(Bt)})}t(Mt),t(pt);var Gt=s(pt,2);{var oa=Ce=>{var nt=Pi(),ut=a(nt);Bs(ut,{get batchId(){return e(r).id},get deviceColor(){return e(r).device_id},get originalGravity(){return e(r).measured_og},get controlEvents(){return se}}),t(nt),l(Ce,nt)};o(Gt,Ce=>{e(r).device_id&&Ce(oa)})}l(ct,Et)};o(rt,ct=>{e(r).status==="completed"?ct(qt):ct(lt,!1)},!0)}l(et,Ge)};o(De,et=>{e(r).status==="brewing"?et(Ve):et(st,!1)},!0)}l(Me,he)};o(Ya,Me=>{e(r).status==="planning"?Me(Qa):Me(Za,!1)})}_(()=>{c(_t,`#${(e(r).batch_number||"?")??""}`),c(Ze,e(r).name||e(r).recipe?.name||"Unnamed Batch"),Ke.disabled=e($),jt(Ke,`color: ${e(N).color??""}; background: ${e(N).bg??""};`),ea!==(ea=e(r).status)&&(Ke.value=(Ke.__value=e(r).status)??"",cs(Ke,e(r).status))}),l(j,Z)};o(Ae,j=>{e(F)?j(Xe):j(b,!1)},!0)}l(J,oe)};o(qe,J=>{e(r)?J(G,!1):J(Le)},!0)}l(Y,Fe)};o(z,Y=>{e(be)?Y(R):Y(H,!1)},!0)}l(f,C)};o(ke,f=>{e(me)?f(Se):f(je,!1)})}t(ye);var _e=s(ye,2);{var ze=f=>{var C=Li();C.__click=()=>d(de,!1),C.__keydown=G=>G.key==="Escape"&&d(de,!1);var z=a(C);z.__click=G=>G.stopPropagation(),z.__keydown=G=>G.stopPropagation();var R=s(a(z),2),H=a(R);t(R);var Y=s(R,2),Fe=a(Y);Fe.__click=()=>d(de,!1);var qe=s(Fe,2);qe.__click=k;var Le=a(qe,!0);t(qe),t(Y),t(z),t(C),_(()=>{c(H,`Are you sure you want to delete "${(e(r)?.name||"this batch")??""}"? This cannot be undone.`),Fe.disabled=e(T),qe.disabled=e(T),c(Le,e(T)?"Deleting...":"Delete Batch")}),l(f,C)};o(_e,f=>{e(de)&&f(ze)})}l(Be,ve),Lt(),S()}Vt(["click","change","keydown"]);export{dn as component,on as universal};
