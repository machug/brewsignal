import{d as sa,f as n,s as o,a as l,c as He,t as ea,h as _a,e as Mt}from"../chunks/orbuQWWI.js";import{d as a,e as s,r as t,t as c,a as Yt,f as ie,h as e,u as L,n as fe,g as Kt,s as U,p as $e,o as Xa,c as d,az as Ma,b9 as rs,i as Da,aJ as ls,aC as is,ax as ns}from"../chunks/pAodAtlG.js";import{e as Pt,i as ta}from"../chunks/0whDC7Rl.js";import{i as v}from"../chunks/ucc1DXe2.js";import{h as vs}from"../chunks/DJBMpqSf.js";import{s as aa,r as Ct,a as Ua}from"../chunks/CYuZshLQ.js";import{s as Le}from"../chunks/Cpbxxhlc.js";import{s as Ft}from"../chunks/C-5oeV0L.js";import{b as Ta,i as os,s as ds}from"../chunks/RboyDiSx.js";import{s as cs,a as us}from"../chunks/BkeTWnxc.js";import{p as _s}from"../chunks/BsjLcXci.js";import{g as ps}from"../chunks/tW1n3Gtr.js";import{a8 as fs,a9 as gs,aa as hs,ab as ms,ac as bs,Q as ua,ad as ys,ae as xs,af as ks,X as ws,S as Ca,ag as ja,a3 as js,ah as Ba}from"../chunks/DsM_eXzM.js";import{b as Bt,d as Sa,g as Aa,c as qa}from"../chunks/C54DtTUy.js";import{t as Va}from"../chunks/DWpXqN03.js";import{B as qs}from"../chunks/CKiN9Vr8.js";import{s as Ss}from"../chunks/GbV1md6Y.js";import{p as na}from"../chunks/C44MPb_E.js";import{F as Ms}from"../chunks/CfPvXJRK.js";import{b as jt}from"../chunks/Dh5hCwq1.js";import{s as Fa}from"../chunks/BkabqQ1A.js";const Cs=!1,qn=Object.freeze(Object.defineProperty({__proto__:null,prerender:Cs},Symbol.toStringTag,{value:"Module"}));function Bs(Re){return Re>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:Re>=-60?{bars:3,color:"var(--positive)",label:"Good"}:Re>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function Ja(Re){const i=Math.floor((Date.now()-new Date(Re).getTime())/1e3);if(i<10)return"just now";if(i<60)return`${i}s ago`;const g=Math.floor(i/60);if(g<60)return`${g}m ago`;const S=Math.floor(g/60);return S<24?`${S}h ago`:`${Math.floor(S/24)}d ago`}var Fs=n('<div class="accent-bar svelte-1oyrwd9"></div>'),zs=n('<span class="card-icon svelte-1oyrwd9"> </span>'),Ts=n('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),Ds=n('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function ka(Re,i){let g=na(i,"highlight",3,!1),S=na(i,"compact",3,!1),E=na(i,"collapsible",3,!1),B=na(i,"expanded",3,!1);var K=Ds();let r;var P=a(K);{var q=O=>{var V=Fs();l(O,V)};v(P,O=>{g()&&O(q)})}var Q=s(P,2),ce=a(Q),Be=a(ce);{var M=O=>{var V=zs(),ae=a(V,!0);t(V),c(()=>o(ae,i.icon)),l(O,V)};v(Be,O=>{i.icon&&O(M)})}var X=s(Be,2),J=a(X,!0);t(X),t(ce);var ne=s(ce,2);{var R=O=>{var V=Ts();V.__click=function(...ue){i.onToggle?.apply(this,ue)};var ae=a(V);let te;t(V),c(()=>{aa(V,"aria-label",B()?"Collapse":"Expand"),te=Le(ae,0,"expand-icon svelte-1oyrwd9",null,te,{"rotate-180":B()})}),l(O,V)};v(ne,O=>{E()&&i.onToggle&&O(R)})}t(Q);var $=s(Q,2);let ee;var le=a($);Ss(le,()=>i.children),t($),t(K),c(()=>{r=Le(K,1,"batch-card svelte-1oyrwd9",null,r,{highlight:g(),compact:S()}),o(J,i.title),ee=Le($,1,"card-content svelte-1oyrwd9",null,ee,{collapsed:E()&&!B()})}),l(Re,K)}sa(["click"]);var As=n('<span class="updated-text svelte-t80j9z"> </span>'),Ps=n('<div class="hero-divider svelte-t80j9z"></div> <div class="hero-metric temperature svelte-t80j9z"><span class="hero-value svelte-t80j9z"> <span class="hero-unit svelte-t80j9z"> </span></span> <span class="hero-label svelte-t80j9z">Temperature</span></div>',1),Rs=n('<div class="remaining-text svelte-t80j9z"> </div>'),Ns=n('<div class="progress-section svelte-t80j9z"><div class="progress-labels svelte-t80j9z"><div class="progress-endpoint start svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">OG</span></div> <div class="progress-current svelte-t80j9z"><span class="current-percent svelte-t80j9z"> </span></div> <div class="progress-endpoint end svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">Target FG</span></div></div> <div class="progress-track svelte-t80j9z"><div class="progress-fill svelte-t80j9z"></div> <div><div class="marker-dot svelte-t80j9z"></div> <div class="marker-value svelte-t80j9z"> </div></div></div> <!></div>'),Os=n('<div class="metrics-row svelte-t80j9z"><div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">ABV</span></div> <div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">Attenuation</span></div></div>'),Ls=n('<div class="status-row svelte-t80j9z"><div class="live-indicator svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> <span class="status-text svelte-t80j9z">LIVE</span></div> <!></div> <div class="hero-section svelte-t80j9z"><div class="hero-metric gravity svelte-t80j9z"><span class="hero-value svelte-t80j9z"> </span> <span class="hero-label svelte-t80j9z">Gravity</span></div> <!></div> <!> <!>',1),Es=n('<div class="completed-grid svelte-t80j9z"><div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Original Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Final Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">ABV</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Attenuation</span></div></div>'),Gs=n('<div class="empty-state svelte-t80j9z"><div class="empty-icon svelte-t80j9z">‚óé</div> <p class="empty-text svelte-t80j9z">Set Original Gravity to track fermentation</p></div>');function Is(Re,i){Yt(i,!0);let g=L(()=>i.currentSg??i.progress?.measured?.current_sg),S=L(()=>i.liveReading?.temp??i.progress?.temperature?.current),E=L(()=>i.liveReading?.last_seen),B=L(()=>e(E)?Ja(e(E)):null),K=L(Aa),r=L(()=>{if(!i.batch.measured_og||!e(g))return null;const M=Math.max(0,(i.batch.measured_og-e(g))*131.25),X=i.batch.measured_og-1,J=X!==0?Math.max(0,Math.min(100,(i.batch.measured_og-e(g))/X*100)):0;return{abv:M,attenuation:J}}),P=L(()=>{const M=i.batch.measured_og,X=i.batch.recipe?.fg;if(!M||!X||!e(g))return null;const J=M-X,ne=M-e(g);return J<=0?null:Math.max(0,Math.min(100,ne/J*100))}),q=L(()=>i.batch.status==="fermenting"||i.batch.status==="conditioning");function Q(M){return M==null?"--":Bt(M)}function ce(M){return M==null?"--":`${M.toFixed(1)}%`}function Be(M){return M==null?"--":Sa(M)}ka(Re,{title:"Fermentation",children:(M,X)=>{var J=He(),ne=ie(J);{var R=ee=>{var le=Ls(),O=ie(le),V=s(a(O),2);{var ae=p=>{var u=As(),f=a(u);t(u),c(()=>o(f,`Updated ${e(B)??""}`)),l(p,u)};v(V,p=>{e(B)&&p(ae)})}t(O);var te=s(O,2),ue=a(te),ge=a(ue),qe=a(ge,!0);t(ge),fe(2),t(ue);var se=s(ue,2);{var w=p=>{var u=Ps(),f=s(ie(u),2),k=a(f),y=a(k,!0),F=s(y),H=a(F,!0);t(F),t(k),fe(2),t(f),c(N=>{o(y,N),o(H,e(K))},[()=>Be(e(S))]),l(p,u)};v(se,p=>{e(S)!=null&&p(w)})}t(te);var m=s(te,2);{var x=p=>{var u=Ns(),f=a(u),k=a(f),y=a(k),F=a(y,!0);t(y),fe(2),t(k);var H=s(k,2),N=a(H),_e=a(N);t(N),t(H);var re=s(H,2),he=a(re),ve=a(he,!0);t(he),fe(2),t(re),t(f);var Se=s(f,2),Fe=a(Se),ze=s(Fe,2);let Ge;var Te=s(a(ze),2),me=a(Te,!0);t(Te),t(ze),t(Se);var _=s(Se,2);{var j=T=>{var D=Rs(),W=a(D);t(D),c(Y=>o(W,`${Y??""} points to go`),[()=>i.progress.progress.sg_remaining.toFixed(3)]),l(T,D)};v(_,T=>{i.progress?.progress?.sg_remaining!=null&&i.progress.progress.sg_remaining>0&&T(j)})}t(u),c((T,D,W,Y)=>{o(F,T),o(_e,`${D??""}%`),o(ve,W),Ft(Fe,`width: ${e(P)??""}%`),Ge=Le(ze,1,"progress-marker svelte-t80j9z",null,Ge,{"at-start":e(P)<3}),Ft(ze,`left: ${e(P)??""}%`),o(me,Y)},[()=>Q(i.batch.measured_og),()=>e(P).toFixed(0),()=>Q(i.batch.recipe.fg),()=>Q(e(g))]),l(p,u)};v(m,p=>{e(P)!==null&&i.batch.measured_og&&i.batch.recipe?.fg&&p(x)})}var b=s(m,2);{var h=p=>{var u=Os(),f=a(u),k=a(f),y=a(k,!0);t(k),fe(2),t(f);var F=s(f,2),H=a(F),N=a(H,!0);t(H),fe(2),t(F),t(u),c((_e,re)=>{o(y,_e),o(N,re)},[()=>ce(e(r).abv),()=>ce(e(r).attenuation)]),l(p,u)};v(b,p=>{e(r)&&p(h)})}c(p=>o(qe,p),[()=>Q(e(g))]),l(ee,le)},$=ee=>{var le=He(),O=ie(le);{var V=te=>{const ue=L(()=>i.batch.measured_fg??i.progress?.measured?.fg??i.progress?.measured?.current_sg),ge=L(()=>i.batch.measured_abv??i.progress?.measured?.abv),qe=L(()=>i.batch.measured_attenuation??i.progress?.measured?.attenuation);var se=Es(),w=a(se),m=a(w),x=a(m,!0);t(m),fe(2),t(w);var b=s(w,2),h=a(b),p=a(h,!0);t(h),fe(2),t(b);var u=s(b,2),f=a(u),k=a(f,!0);t(f),fe(2),t(u);var y=s(u,2),F=a(y),H=a(F,!0);t(F),fe(2),t(y),t(se),c((N,_e,re,he)=>{o(x,N),o(p,_e),o(k,re),o(H,he)},[()=>Q(i.batch.measured_og),()=>Q(e(ue)),()=>e(ge)!=null?ce(e(ge)):"--",()=>e(qe)!=null?ce(e(qe)):"--"]),l(te,se)},ae=te=>{var ue=Gs();l(te,ue)};v(O,te=>{i.batch.measured_og?te(V):te(ae,!1)},!0)}l(ee,le)};v(ne,ee=>{e(g)&&e(q)?ee(R):ee($,!1)})}l(M,J)},$$slots:{default:!0}}),Kt()}var Us=n('<span class="device-last-seen svelte-1kdxwtz"> </span>'),Vs=n('<div class="signal-bar svelte-1kdxwtz"></div>'),Hs=n('<div class="metric-item svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="metric-text svelte-1kdxwtz"> </span></div>'),Ws=n('<div class="metric-item battery svelte-1kdxwtz"><svg class="battery-icon svelte-1kdxwtz" viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="2" y="7" width="18" height="10" rx="2"></rect><rect x="4" y="9" height="6" stroke="none" rx="1"></rect><path d="M20 10v4h2v-4z" stroke="none"></path></svg> <span class="metric-text svelte-1kdxwtz"><!></span></div>'),Xs=n('<div class="device-metrics svelte-1kdxwtz"><!> <!></div>'),Js=n('<div class="device-row svelte-1kdxwtz"><div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!></div> <!>',1),Ys=n('<div class="device-row svelte-1kdxwtz"><div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <span class="device-last-seen svelte-1kdxwtz">No data</span></div>'),Ks=n('<div class="device-info svelte-1kdxwtz"><!></div>'),Qs=n('<button type="button" class="link-btn svelte-1kdxwtz">Link device</button>'),Zs=n('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function Ha(Re,i){Yt(i,!0);let g=L(()=>i.liveReading?.device_type==="tilt"),S=L(()=>e(g)&&i.liveReading?.rssi?Bs(i.liveReading.rssi):null),E=L(()=>i.liveReading?.last_seen?Ja(i.liveReading.last_seen):null),B=L(()=>i.liveReading?.battery_percent!=null||i.liveReading?.battery_voltage!=null),K=L(()=>i.liveReading?.battery_percent),r=L(()=>i.liveReading?.battery_voltage),P=L(()=>e(K)?e(K)>50?"var(--positive)":e(K)>20?"var(--warning)":"var(--negative)":"var(--text-muted)"),q=L(()=>{if(!i.liveReading)return i.batch.device_id||"Unknown";const Q=i.liveReading.device_type;return Q==="tilt"?`${i.liveReading.color} Tilt`:Q==="gravitymon"?`GravityMon (${i.liveReading.id})`:Q==="ispindel"?`iSpindel (${i.liveReading.id})`:Q==="floaty"?`Floaty (${i.liveReading.id})`:i.liveReading.color||i.liveReading.id});ka(Re,{title:"Tracking Device",compact:!0,children:(Q,ce)=>{var Be=He(),M=ie(Be);{var X=ne=>{var R=Ks(),$=a(R);{var ee=O=>{var V=Js(),ae=ie(V),te=a(ae),ue=s(a(te));t(te);var ge=s(te,2);{var qe=m=>{var x=Us(),b=a(x,!0);t(x),c(()=>o(b,e(E))),l(m,x)};v(ge,m=>{e(E)&&m(qe)})}t(ae);var se=s(ae,2);{var w=m=>{var x=Xs(),b=a(x);{var h=f=>{var k=Hs(),y=a(k);Pt(y,20,()=>Array(4),ta,(N,_e,re)=>{var he=Vs();c(()=>Ft(he,`height: ${4+re*2}px; background: ${(re<e(S).bars?e(S).color:"var(--bg-hover)")??""}; opacity: ${re<e(S).bars?1:.4};`)),l(N,he)}),t(y);var F=s(y,2),H=a(F);t(F),t(k),c(()=>{Ft(F,`color: ${e(S).color??""}`),o(H,`${i.liveReading.rssi??""}dBm`)}),l(f,k)};v(b,f=>{e(S)&&f(h)})}var p=s(b,2);{var u=f=>{var k=Ws(),y=a(k),F=s(a(y)),H=s(F);t(y);var N=s(y,2),_e=a(N);{var re=ve=>{var Se=ea();c(Fe=>o(Se,`${Fe??""}%`),[()=>e(K).toFixed(0)]),l(ve,Se)},he=ve=>{var Se=He(),Fe=ie(Se);{var ze=Ge=>{var Te=ea();c(me=>o(Te,`${me??""}V`),[()=>e(r).toFixed(2)]),l(Ge,Te)};v(Fe,Ge=>{e(r)!=null&&Ge(ze)},!0)}l(ve,Se)};v(_e,ve=>{e(K)!=null?ve(re):ve(he,!1)})}t(N),t(k),c(()=>{aa(y,"stroke",e(P)),aa(F,"width",(e(K)??50)*.14),aa(F,"fill",e(P)),aa(H,"fill",e(P)),Ft(N,`color: ${e(P)??""}`)}),l(f,k)};v(p,f=>{e(B)&&f(u)})}t(x),l(m,x)};v(se,m=>{(e(S)||e(B))&&m(w)})}c(()=>o(ue,` ${e(q)??""}`)),l(O,V)},le=O=>{var V=Ys(),ae=a(V),te=s(a(ae));t(ae),fe(2),t(V),c(()=>o(te,` ${i.batch.device_id??""}`)),l(O,V)};v($,O=>{i.liveReading?O(ee):O(le,!1)})}t(R),l(ne,R)},J=ne=>{var R=Zs(),$=s(a(R),2);{var ee=le=>{var O=Qs();O.__click=function(...V){i.onEdit?.apply(this,V)},l(le,O)};v($,le=>{i.onEdit&&le(ee)})}t(R),l(ne,R)};v(M,ne=>{i.batch.device_id?ne(X):ne(J,!1)})}l(Q,Be)},$$slots:{default:!0}}),Kt()}sa(["click"]);const $s=131.25;var er=n('<span class="yeast-producer svelte-19u9n31"> </span>'),tr=n('<span class="yeast-temp svelte-19u9n31"> </span>'),ar=n('<div class="yeast-row recipe svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Recipe</span> <span class="yeast-value muted svelte-19u9n31"> </span></div>'),sr=n('<div class="yeast-row actual svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span> <!> <!></div> <!>',1),rr=n('<div class="yeast-row svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span></div>'),lr=n('<div class="yeast-section svelte-19u9n31"><!></div>'),ir=n('<div class="targets-row svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div></div> <!>',1);function za(Re,i){Yt(i,!0);function g(E){return E==null?"--":Bt(E)}let S=L(()=>i.recipe.abv!=null?i.recipe.abv:i.recipe.og&&i.recipe.fg?(i.recipe.og-i.recipe.fg)*$s:null);ka(Re,{title:"Recipe Targets",compact:!0,children:(E,B)=>{var K=ir(),r=ie(K),P=a(r),q=s(a(P),2),Q=a(q,!0);t(q),t(P);var ce=s(P,2),Be=s(a(ce),2),M=a(Be,!0);t(Be),t(ce);var X=s(ce,2),J=s(a(X),2),ne=a(J,!0);t(J),t(X),t(r);var R=s(r,2);{var $=ee=>{var le=lr(),O=a(le);{var V=te=>{var ue=sr(),ge=ie(ue),qe=s(a(ge),2),se=a(qe,!0);t(qe);var w=s(qe,2);{var m=u=>{var f=er(),k=a(f);t(f),c(()=>o(k,`(${i.yeastStrain.producer??""})`)),l(u,f)};v(w,u=>{i.yeastStrain.producer&&u(m)})}var x=s(w,2);{var b=u=>{var f=tr(),k=a(f);t(f),c((y,F)=>o(k,`${y??""}-${F??""}¬∞C`),[()=>i.yeastStrain.temp_low.toFixed(0),()=>i.yeastStrain.temp_high.toFixed(0)]),l(u,f)};v(x,u=>{i.yeastStrain.temp_low&&i.yeastStrain.temp_high&&u(b)})}t(ge);var h=s(ge,2);{var p=u=>{var f=ar(),k=s(a(f),2),y=a(k,!0);t(k),t(f),c(()=>o(y,i.recipe.yeast_name)),l(u,f)};v(h,u=>{i.recipe.yeast_name&&u(p)})}c(()=>o(se,i.yeastStrain.name)),l(te,ue)},ae=te=>{var ue=He(),ge=ie(ue);{var qe=se=>{var w=rr(),m=s(a(w),2),x=a(m,!0);t(m),t(w),c(()=>o(x,i.recipe.yeast_name)),l(se,w)};v(ge,se=>{i.recipe.yeast_name&&se(qe)},!0)}l(te,ue)};v(O,te=>{i.yeastStrain?te(V):te(ae,!1)})}t(le),l(ee,le)};v(R,ee=>{(i.yeastStrain||i.recipe.yeast_name)&&ee($)})}c((ee,le,O)=>{o(Q,ee),o(M,le),o(ne,O)},[()=>g(i.recipe.og),()=>g(i.recipe.fg),()=>e(S)!=null?`${e(S).toFixed(1)}%`:"--"]),l(E,K)},$$slots:{default:!0}}),Kt()}var nr=n('<p class="notes-content svelte-hkv31i"> </p>');function Wa(Re,i){ka(Re,{title:"Notes",children:(g,S)=>{var E=nr(),B=a(E,!0);t(E),c(()=>o(B,i.notes)),l(g,E)},$$slots:{default:!0}})}var vr=n('<div class="ml-panel loading svelte-1xs394q"><p> </p></div>'),or=n('<div class="ml-panel error svelte-1xs394q"><p class="error-text svelte-1xs394q"> </p></div>'),dr=n("<option> </option>"),cr=n('<div class="header-controls svelte-1xs394q"><select class="model-select svelte-1xs394q" title="Select prediction model"></select> <button type="button" class="reload-btn svelte-1xs394q" title="Recalculate predictions from database history"> </button></div>'),ur=n('<span class="accuracy-icon svelte-1xs394q">‚úì</span> <span class="accuracy-title svelte-1xs394q">Excellent Prediction</span>',1),_r=n('<span class="accuracy-icon svelte-1xs394q">‚âà</span> <span class="accuracy-title svelte-1xs394q">Close Prediction</span>',1),pr=n('<span class="accuracy-icon svelte-1xs394q">‚ñ≥</span> <span class="accuracy-title svelte-1xs394q">Prediction Variance</span>',1),fr=n('<div><div class="accuracy-header svelte-1xs394q"><!></div> <p class="accuracy-detail svelte-1xs394q"> <span class="accuracy-diff svelte-1xs394q"> </span></p></div>'),gr=n('<span class="comparison-predicted svelte-1xs394q"> </span>'),hr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model:</span> <span class="model-value model-type svelte-1xs394q"> </span></div>'),mr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),br=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),yr=n('<div class="summary-section svelte-1xs394q"><!> <div class="comparison-grid svelte-1xs394q"><div class="comparison-item svelte-1xs394q"><span class="comparison-label svelte-1xs394q">Final Gravity</span> <div class="comparison-values svelte-1xs394q"><span class="comparison-actual svelte-1xs394q"> </span> <!></div></div></div> <div class="model-info summary-model svelte-1xs394q"><!> <!> <!></div></div>'),xr=n('<span class="anomaly-reasons svelte-1xs394q"> </span>'),kr=n('<div class="anomaly-banner svelte-1xs394q"><span class="anomaly-icon svelte-1xs394q">‚ö†Ô∏è</span> <div class="anomaly-content svelte-1xs394q"><span class="anomaly-label svelte-1xs394q">Anomaly Detected</span> <!></div></div>'),wr=n('<span class="activity-badge svelte-1xs394q"> </span>'),jr=n('<div class="progress-section svelte-1xs394q"><div class="progress-header svelte-1xs394q"><span class="progress-label svelte-1xs394q">Fermentation Progress</span> <!></div> <div class="fermentation-progress-bar svelte-1xs394q"><div class="fermentation-fill svelte-1xs394q"></div></div> <div class="progress-labels svelte-1xs394q"><span class="og-label svelte-1xs394q"> </span> <span class="progress-percent svelte-1xs394q"> </span> <span class="fg-label svelte-1xs394q"> </span></div></div>'),qr=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Predicted FG:</span> <span class="value svelte-1xs394q"> </span></div>'),Sr=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Attenuation:</span> <span class="value attenuation svelte-1xs394q"> </span></div>'),Mr=n('<span class="complete-now svelte-1xs394q">Ready now!</span>'),Cr=n('<span class="days svelte-1xs394q"> </span>'),Br=n(" <!>",1),Fr=n('<div class="metric completion-metric svelte-1xs394q"><span class="label svelte-1xs394q">Est. Completion:</span> <span class="value svelte-1xs394q"><!></span></div>'),zr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model:</span> <span class="model-value model-type svelte-1xs394q"> </span></div>'),Tr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),Dr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),Ar=n('<!> <!> <div class="metrics svelte-1xs394q"><!> <!> <!> <div class="model-info svelte-1xs394q"><!> <!> <!></div></div>',1),Pr=n('<div><div class="panel-header svelte-1xs394q"><h3 class="panel-title svelte-1xs394q"> </h3> <!></div> <!></div>'),Rr=n('<div class="ml-panel disabled svelte-1xs394q"><div class="disabled-header svelte-1xs394q"><p class="unavailable-text svelte-1xs394q"> </p> <button type="button" class="reload-btn svelte-1xs394q" title="Reload predictions from database"> </button></div> <p class="unavailable-hint svelte-1xs394q"><!></p></div>');function Nr(Re,i){Yt(i,!0);let g=na(i,"batchStatus",3,"fermenting"),S=na(i,"measuredOg",3,null),E=na(i,"measuredFg",3,null),B=na(i,"currentSg",3,null),K=na(i,"liveReading",3,null),r=U($e({available:!1})),P=U(!0),q=U(!1),Q=U(null),ce=U("auto");const Be=[{value:"auto",label:"Auto (Best Fit)"},{value:"exponential",label:"Exponential"},{value:"gompertz",label:"Gompertz (S-Curve)"},{value:"logistic",label:"Logistic"}];let M=L(()=>g()==="completed"||g()==="archived"),X=L(()=>E()??B()),J=L(()=>{if(!e(M)||!e(r).predicted_fg||!e(X))return null;const m=Math.abs(e(r).predicted_fg-e(X)),x=Math.round(m*1e3);return{diff:m,points:x,isAccurate:x<=2,isClose:x<=5}});async function ne(){d(P,!0),d(Q,null);try{d(r,await gs(i.batchId,e(ce)),!0)}catch(m){d(Q,m instanceof Error?m.message:"Failed to load predictions",!0),console.error("Failed to load ML predictions:",m)}finally{d(P,!1)}}async function R(){d(q,!0),d(Q,null);try{const m=await fs(i.batchId);console.log("Reloaded predictions:",m.message),await ne()}catch(m){d(Q,m instanceof Error?m.message:"Failed to reload predictions",!0),console.error("Failed to reload predictions:",m)}finally{d(q,!1)}}function $(){ne()}Xa(R);function ee(m){return m?new Date(m).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}):"N/A"}function le(m){if(!m)return null;const x=new Date(m),b=new Date,h=x.getTime()-b.getTime();return Math.ceil(h/(1e3*60*60*24))}let O=L(()=>{const m=S()??e(r).predicted_og,x=e(r).predicted_fg,b=B()??K()?.sg;if(!m||!x||!b||m<=x)return null;const h=m-x,u=(m-b)/h*100;return Math.min(100,Math.max(0,u))}),V=L(()=>{const m=S()??e(r).predicted_og,x=B()??K()?.sg;if(!m||!x||m<=1)return null;const b=(m-x)/(m-1)*100;return Math.min(100,Math.max(0,b))}),ae=L(()=>{const m=K()?.sg_rate;if(m==null)return null;const x=Math.abs(m);return x>.002?{label:"Very Active",color:"var(--activity-very-active)",emoji:"üî•"}:x>5e-4?{label:"Active",color:"var(--activity-active)",emoji:"‚ú®"}:x>1e-4?{label:"Slowing",color:"var(--activity-slowing)",emoji:"üê¢"}:{label:"Complete",color:"var(--activity-complete)",emoji:"‚úì"}}),te=L(()=>K()?.is_anomaly??!1),ue=L(()=>K()?.anomaly_reasons??[]);var ge=He(),qe=ie(ge);{var se=m=>{var x=vr(),b=a(x),h=a(b);t(b),t(x),c(()=>o(h,`Loading ${e(M)?"summary":"predictions"}...`)),l(m,x)},w=m=>{var x=He(),b=ie(x);{var h=u=>{var f=or(),k=a(f),y=a(k);t(k),t(f),c(()=>o(y,`‚ö†Ô∏è ${e(Q)??""}`)),l(u,f)},p=u=>{var f=He(),k=ie(f);{var y=H=>{var N=Pr();let _e;var re=a(N),he=a(re),ve=a(he,!0);t(he);var Se=s(he,2);{var Fe=me=>{var _=cr(),j=a(_);j.__change=$,Pt(j,21,()=>Be,ta,(W,Y)=>{var oe=dr(),be=a(oe,!0);t(oe);var ke={};c(()=>{o(be,e(Y).label),ke!==(ke=e(Y).value)&&(oe.value=(oe.__value=e(Y).value)??"")}),l(W,oe)}),t(j);var T=s(j,2);T.__click=R;var D=a(T,!0);t(T),t(_),c(()=>{j.disabled=e(P)||e(q),T.disabled=e(q)||e(P),o(D,e(q)?"Reloading...":"‚Üª")}),Ta(j,()=>e(ce),W=>d(ce,W)),l(me,_)};v(Se,me=>{e(M)||me(Fe)})}t(re);var ze=s(re,2);{var Ge=me=>{var _=yr(),j=a(_);{var T=G=>{var de=fr();let A;var I=a(de),xe=a(I);{var De=et=>{var at=ur();fe(2),l(et,at)},Ke=et=>{var at=He(),ft=ie(at);{var Pe=Me=>{var Qe=_r();fe(2),l(Me,Qe)},yt=Me=>{var Qe=pr();fe(2),l(Me,Qe)};v(ft,Me=>{e(J).isClose?Me(Pe):Me(yt,!1)},!0)}l(et,at)};v(xe,et=>{e(J).isAccurate?et(De):et(Ke,!1)})}t(I);var Ie=s(I,2),We=a(Ie),Ne=s(We),Ze=a(Ne);t(Ne),t(Ie),t(de),c((et,at)=>{A=Le(de,1,"accuracy-banner svelte-1xs394q",null,A,{accurate:e(J).isAccurate,close:e(J).isClose&&!e(J).isAccurate}),o(We,`Model predicted ${et??""}, actual was ${at??""} `),o(Ze,`(${e(J).points??""} points ${e(r).predicted_fg&&e(r).predicted_fg>e(X)?"high":"low"})`)},[()=>Bt(e(r).predicted_fg??0),()=>Bt(e(X))]),l(G,de)};v(j,G=>{e(J)&&e(X)&&G(T)})}var D=s(j,2),W=a(D),Y=s(a(W),2),oe=a(Y),be=a(oe,!0);t(oe);var ke=s(oe,2);{var we=G=>{var de=gr(),A=a(de);t(de),c(I=>o(A,`ML: ${I??""}`),[()=>Bt(e(r).predicted_fg)]),l(G,de)};v(ke,G=>{e(r).predicted_fg&&G(we)})}t(Y),t(W),t(D);var Ye=s(D,2),wt=a(Ye);{var bt=G=>{var de=hr(),A=s(a(de),2),I=a(A,!0);t(A),t(de),c(()=>o(I,e(r).model_type)),l(G,de)};v(wt,G=>{e(r).model_type&&G(bt)})}var Rt=s(wt,2);{var C=G=>{var de=mr(),A=s(a(de),2),I=a(A);t(A),t(de),c(xe=>o(I,`${xe??""}%`),[()=>(e(r).r_squared*100).toFixed(0)]),l(G,de)};v(Rt,G=>{e(r).r_squared!==void 0&&G(C)})}var z=s(Rt,2);{var ye=G=>{var de=br(),A=s(a(de),2),I=a(A,!0);t(A),t(de),c(()=>o(I,e(r).num_readings)),l(G,de)};v(z,G=>{e(r).num_readings&&G(ye)})}t(Ye),t(_),c(G=>o(be,G),[()=>Bt(e(X)??0)]),l(me,_)},Te=me=>{var _=Ar(),j=ie(_);{var T=A=>{var I=kr(),xe=s(a(I),2),De=s(a(xe),2);{var Ke=Ie=>{var We=xr(),Ne=a(We,!0);t(We),c(Ze=>o(Ne,Ze),[()=>e(ue).join(", ")]),l(Ie,We)};v(De,Ie=>{e(ue).length>0&&Ie(Ke)})}t(xe),t(I),l(A,I)};v(j,A=>{e(te)&&A(T)})}var D=s(j,2);{var W=A=>{var I=jr(),xe=a(I),De=s(a(xe),2);{var Ke=Me=>{var Qe=wr(),Nt=a(Qe);t(Qe),c(()=>{Ft(Qe,`color: ${e(ae).color??""}`),o(Nt,`${e(ae).emoji??""} ${e(ae).label??""}`)}),l(Me,Qe)};v(De,Me=>{e(ae)&&Me(Ke)})}t(xe);var Ie=s(xe,2),We=a(Ie);t(Ie);var Ne=s(Ie,2),Ze=a(Ne),et=a(Ze);t(Ze);var at=s(Ze,2),ft=a(at);t(at);var Pe=s(at,2),yt=a(Pe);t(Pe),t(Ne),t(I),c((Me,Qe,Nt)=>{Ft(We,`width: ${e(O)??""}%`),o(et,`OG: ${Me??""}`),o(ft,`${Qe??""}%`),o(yt,`FG: ${Nt??""}`)},[()=>Bt(S()??e(r).predicted_og??0),()=>e(O).toFixed(0),()=>Bt(e(r).predicted_fg??0)]),l(A,I)};v(D,A=>{e(O)!==null&&A(W)})}var Y=s(D,2),oe=a(Y);{var be=A=>{var I=qr(),xe=s(a(I),2),De=a(xe,!0);t(xe),t(I),c(Ke=>o(De,Ke),[()=>Bt(e(r).predicted_fg)]),l(A,I)};v(oe,A=>{e(r).predicted_fg&&A(be)})}var ke=s(oe,2);{var we=A=>{var I=Sr(),xe=s(a(I),2),De=a(xe);t(xe),t(I),c(Ke=>o(De,`${Ke??""}%`),[()=>e(V).toFixed(1)]),l(A,I)};v(ke,A=>{e(V)!==null&&A(we)})}var Ye=s(ke,2);{var wt=A=>{const I=L(()=>le(e(r).estimated_completion));var xe=Fr(),De=s(a(xe),2),Ke=a(De);{var Ie=Ne=>{var Ze=Mr();l(Ne,Ze)},We=Ne=>{var Ze=Br(),et=ie(Ze),at=s(et);{var ft=Pe=>{var yt=Cr(),Me=a(yt);t(yt),c(()=>o(Me,`(${e(I)??""} ${e(I)===1?"day":"days"})`)),l(Pe,yt)};v(at,Pe=>{e(I)!==null&&Pe(ft)})}c(Pe=>o(et,`${Pe??""} `),[()=>ee(e(r).estimated_completion)]),l(Ne,Ze)};v(Ke,Ne=>{e(I)!==null&&e(I)<=0?Ne(Ie):Ne(We,!1)})}t(De),t(xe),l(A,xe)};v(Ye,A=>{e(r).estimated_completion&&A(wt)})}var bt=s(Ye,2),Rt=a(bt);{var C=A=>{var I=zr(),xe=s(a(I),2),De=a(xe,!0);t(xe),t(I),c(()=>o(De,e(r).model_type)),l(A,I)};v(Rt,A=>{e(r).model_type&&A(C)})}var z=s(Rt,2);{var ye=A=>{var I=Tr(),xe=s(a(I),2),De=a(xe);t(xe),t(I),c(Ke=>o(De,`${Ke??""}%`),[()=>(e(r).r_squared*100).toFixed(0)]),l(A,I)};v(z,A=>{e(r).r_squared!==void 0&&A(ye)})}var G=s(z,2);{var de=A=>{var I=Dr(),xe=s(a(I),2),De=a(xe,!0);t(xe),t(I),c(()=>o(De,e(r).num_readings)),l(A,I)};v(G,A=>{e(r).num_readings&&A(de)})}t(bt),t(Y),l(me,_)};v(ze,me=>{e(M)?me(Ge):me(Te,!1)})}t(N),c(()=>{_e=Le(N,1,"ml-panel svelte-1xs394q",null,_e,{"has-anomaly":e(te),completed:e(M)}),o(ve,e(M)?"Fermentation Summary":"Fermentation Intelligence")}),l(H,N)},F=H=>{var N=Rr(),_e=a(N),re=a(_e),he=a(re,!0);t(re);var ve=s(re,2);ve.__click=R;var Se=a(ve,!0);t(ve),t(_e);var Fe=s(_e,2),ze=a(Fe);{var Ge=me=>{var _=ea("Waiting for fermentation to progress (need visible SG drop)");l(me,_)},Te=me=>{var _=He(),j=ie(_);{var T=W=>{var Y=ea("Need more fermentation curve data for reliable prediction");l(W,Y)},D=W=>{var Y=He(),oe=ie(Y);{var be=we=>{var Ye=ea("Need at least 10 readings to make predictions");l(we,Ye)},ke=we=>{var Ye=ea();c(()=>o(Ye,e(M)?"No fermentation data recorded":"Predictions will appear once fermentation is underway")),l(we,Ye)};v(oe,we=>{e(r).reason==="insufficient_data"?we(be):we(ke,!1)},!0)}l(W,Y)};v(j,W=>{e(r).reason==="insufficient_curve_data"?W(T):W(D,!1)},!0)}l(me,_)};v(ze,me=>{e(r).reason==="insufficient_fermentation_progress"?me(Ge):me(Te,!1)})}t(Fe),t(N),c(()=>{o(he,e(M)?"Fermentation summary unavailable":"ML predictions unavailable"),ve.disabled=e(q)||e(P),o(Se,e(q)?"Reloading...":"‚Üª Reload")}),l(H,N)};v(k,H=>{e(r).available?H(y):H(F,!1)},!0)}l(u,f)};v(b,u=>{e(Q)?u(h):u(p,!1)},!0)}l(m,x)};v(qe,m=>{e(P)?m(se):m(w,!1)})}l(Re,ge),Kt()}sa(["change","click"]);var Or=n('<div class="loading svelte-1hws0u6">Loading alerts...</div>'),Lr=n('<div class="error-banner svelte-1hws0u6"><span> </span> <button type="button" class="dismiss-error svelte-1hws0u6">√ó</button></div>'),Er=n('<button type="button" class="dismiss-all-btn svelte-1hws0u6"> </button>'),Gr=n('<span class="spinner svelte-1hws0u6"></span>'),Ir=_a('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1hws0u6"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg>'),Ur=n('<div class="alert-item svelte-1hws0u6"><div class="alert-icon svelte-1hws0u6"> </div> <div class="alert-content svelte-1hws0u6"><div class="alert-header svelte-1hws0u6"><span class="alert-type svelte-1hws0u6"> </span> <span class="severity-badge svelte-1hws0u6"> </span></div> <p class="alert-message svelte-1hws0u6"> </p> <div class="alert-meta svelte-1hws0u6"><span class="alert-time svelte-1hws0u6"> </span> <span class="alert-separator svelte-1hws0u6">¬∑</span> <span class="alert-time svelte-1hws0u6"> </span></div></div> <button type="button" class="dismiss-btn svelte-1hws0u6" title="Dismiss alert"><!></button></div>'),Vr=n('<!> <div class="alerts-header svelte-1hws0u6"><span class="alert-count svelte-1hws0u6"> </span> <!></div> <div class="alerts-list svelte-1hws0u6"></div>',1);function Hr(Re,i){Yt(i,!0);let g=U($e([])),S=U(!0),E=U(null),B=U(null),K=U(!1);Ma(()=>{r()});async function r(){try{d(S,!0),d(E,null),d(g,await hs(i.batchId,!1),!0)}catch(R){d(E,R instanceof Error?R.message:"Failed to load alerts",!0)}finally{d(S,!1)}}async function P(R){try{d(B,R,!0),await ms(i.batchId,R),d(g,e(g).filter($=>$.id!==R),!0)}catch($){d(E,$ instanceof Error?$.message:"Failed to dismiss alert",!0)}finally{d(B,null)}}async function q(){try{d(K,!0),await bs(i.batchId),d(g,[],!0)}catch(R){d(E,R instanceof Error?R.message:"Failed to dismiss alerts",!0)}finally{d(K,!1)}}function Q(R){switch(R){case"critical":return"var(--negative)";case"warning":return"var(--warning)";case"info":return"var(--accent)";default:return"var(--text-muted)"}}function ce(R){switch(R){case"stall":return"‚è∏";case"temperature_high":return"üî•";case"temperature_low":return"‚ùÑ";case"anomaly":return"‚ö†";default:return"‚ö†"}}function Be(R){const $=new Date(R),le=new Date().getTime()-$.getTime(),O=Math.floor(le/6e4),V=Math.floor(O/60),ae=Math.floor(V/24);return ae>0?`${ae}d ago`:V>0?`${V}h ago`:O>0?`${O}m ago`:"just now"}var M=He(),X=ie(M);{var J=R=>{ka(R,{title:"Alerts",icon:"üîî",children:($,ee)=>{var le=Or();l($,le)},$$slots:{default:!0}})},ne=R=>{var $=He(),ee=ie($);{var le=V=>{},O=V=>{ka(V,{title:"Active Alerts",icon:"üîî",highlight:!0,children:(ae,te)=>{var ue=Vr(),ge=ie(ue);{var qe=p=>{var u=Lr(),f=a(u),k=a(f,!0);t(f);var y=s(f,2);y.__click=()=>d(E,null),t(u),c(()=>o(k,e(E))),l(p,u)};v(ge,p=>{e(E)&&p(qe)})}var se=s(ge,2),w=a(se),m=a(w);t(w);var x=s(w,2);{var b=p=>{var u=Er();u.__click=q;var f=a(u,!0);t(u),c(()=>{u.disabled=e(K),o(f,e(K)?"Dismissing...":"Dismiss All")}),l(p,u)};v(x,p=>{e(g).length>1&&p(b)})}t(se);var h=s(se,2);Pt(h,21,()=>e(g),p=>p.id,(p,u)=>{var f=Ur(),k=a(f),y=a(k,!0);t(k);var F=s(k,2),H=a(F),N=a(H),_e=a(N,!0);t(N);var re=s(N,2),he=a(re,!0);t(re),t(H);var ve=s(H,2),Se=a(ve,!0);t(ve);var Fe=s(ve,2),ze=a(Fe),Ge=a(ze);t(ze);var Te=s(ze,4),me=a(Te);t(Te),t(Fe),t(F);var _=s(F,2);_.__click=()=>P(e(u).id);var j=a(_);{var T=W=>{var Y=Gr();l(W,Y)},D=W=>{var Y=Ir();l(W,Y)};v(j,W=>{e(B)===e(u).id?W(T):W(D,!1)})}t(_),t(f),c((W,Y,oe,be,ke,we,Ye,wt)=>{Ft(f,`--severity-color: ${W??""}`),o(y,Y),o(_e,oe),Ft(re,`background: ${be??""}`),o(he,e(u).severity),o(Se,e(u).message),aa(ze,"title",`First detected: ${ke??""}`),o(Ge,`First: ${we??""}`),aa(Te,"title",`Last seen: ${Ye??""}`),o(me,`Last: ${wt??""}`),_.disabled=e(B)===e(u).id},[()=>Q(e(u).severity),()=>ce(e(u).alert_type),()=>e(u).alert_type.replace("_"," "),()=>Q(e(u).severity),()=>new Date(e(u).first_detected_at).toLocaleString(),()=>Be(e(u).first_detected_at),()=>new Date(e(u).last_seen_at).toLocaleString(),()=>Be(e(u).last_seen_at)]),l(p,f)}),t(h),c(()=>o(m,`${e(g).length??""} active`)),l(ae,ue)},$$slots:{default:!0}})};v(ee,V=>{e(g).length===0?V(le):V(O,!1)},!0)}l(R,$)};v(X,R=>{e(S)?R(J):R(ne,!1)})}l(Re,M),Kt()}sa(["click"]);var Wr=n('<span class="saving-indicator svelte-ukh80y">Syncing...</span>'),Xr=n("<span> </span>"),Jr=n('<div class="timer-idle svelte-ukh80y"><div class="timer-option svelte-ukh80y"><label class="option-label svelte-ukh80y">Mash Duration</label> <div class="duration-input svelte-ukh80y"><button type="button" class="duration-btn svelte-ukh80y">‚àí</button> <span class="duration-value svelte-ukh80y"> </span> <button type="button" class="duration-btn svelte-ukh80y">+</button> <span class="duration-unit svelte-ukh80y">min</span></div></div> <div class="timer-option svelte-ukh80y"><label class="option-label svelte-ukh80y">Boil Duration</label> <div class="duration-display svelte-ukh80y"><span class="duration-value svelte-ukh80y"> </span> <span class="duration-unit svelte-ukh80y">min</span></div></div> <div class="timer-actions svelte-ukh80y"><button type="button" class="start-btn mash svelte-ukh80y"><svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path></svg> Start Mash</button> <button type="button" class="start-btn boil svelte-ukh80y">Skip to Boil</button></div></div>'),Yr=n('<div class="timer-complete svelte-ukh80y"><div class="complete-icon svelte-ukh80y">‚úì</div> <p class="complete-text svelte-ukh80y">Boil complete! Time to chill the wort.</p> <button type="button" class="reset-btn svelte-ukh80y">Reset Timer</button></div>'),Kr=_a('<svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path></svg> Resume',1),Qr=_a('<svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6"></path></svg> Pause',1),Zr=n('<span class="hop-check svelte-ukh80y">‚úì</span>'),$r=n('<div><span class="hop-time svelte-ukh80y"> </span> <span class="hop-name svelte-ukh80y"> </span> <span class="hop-amount svelte-ukh80y"> </span> <!></div>'),el=n('<div class="hop-schedule svelte-ukh80y"><h4 class="schedule-title svelte-ukh80y">Hop Additions</h4> <div class="hop-list svelte-ukh80y"></div></div>'),tl=n('<button type="button" class="next-phase-btn svelte-ukh80y">Mash Done ‚Üí Start Boil</button>'),al=n('<div class="timer-active svelte-ukh80y"><div class="timer-display svelte-ukh80y"><span class="time-value svelte-ukh80y"> </span> <span class="time-label svelte-ukh80y">remaining</span></div> <div class="progress-bar svelte-ukh80y"><div></div></div> <div class="timer-controls svelte-ukh80y"><button type="button" class="control-btn svelte-ukh80y" title="Subtract 1 minute">‚àí1m</button> <button type="button"><!></button> <button type="button" class="control-btn svelte-ukh80y" title="Add 1 minute">+1m</button></div> <!> <div class="phase-actions svelte-ukh80y"><!> <button type="button" class="reset-btn svelte-ukh80y">Reset</button></div></div>'),sl=n('<div class="timer-card svelte-ukh80y"><div class="timer-header svelte-ukh80y"><h3 class="timer-title svelte-ukh80y">Brew Day Timer</h3> <!></div> <!></div>');function rl(Re,i){Yt(i,!0);let g=U($e(i.batch.timer_phase||"idle")),S=U(0),E=null,B=U(i.batch.timer_paused_at!=null),K=U(!1),r=U($e(new Set)),P=U(60),q=L(()=>i.recipe.boil_time_minutes||60),Q=L(()=>i.recipe.hops?i.recipe.hops.filter(h=>h.timing?.use==="add_to_boil"||!h.timing?.use).map(h=>({name:h.name,amount:h.amount_grams,time:h.timing?.duration?.value||0,unit:h.timing?.duration?.unit||"min"})).sort((h,p)=>p.time-h.time):[]),ce=L(()=>{const h=Math.floor(e(S)/60),p=e(S)%60;return`${h.toString().padStart(2,"0")}:${p.toString().padStart(2,"0")}`}),Be=L(()=>e(g)==="mash"?(e(P)*60-e(S))/(e(P)*60)*100:e(g)==="boil"?(e(q)*60-e(S))/(e(q)*60)*100:0),M=L(()=>{switch(e(g)){case"mash":return"Mash";case"boil":return"Boil";case"complete":return"Complete!";default:return"Ready"}});function X(){if(!i.batch.timer_started_at||!i.batch.timer_duration_seconds)return 0;const h=new Date(i.batch.timer_started_at).getTime(),p=i.batch.timer_duration_seconds*1e3,u=Date.now();if(i.batch.timer_paused_at){const k=new Date(i.batch.timer_paused_at).getTime()-h;return Math.max(0,Math.floor((p-k)/1e3))}else{const f=u-h;return Math.max(0,Math.floor((p-f)/1e3))}}async function J(h,p,u=!1){d(K,!0);try{const f={timer_phase:h,timer_duration_seconds:p};h==="idle"||h==="complete"?(f.timer_started_at=null,f.timer_paused_at=null):u?f.timer_paused_at=new Date().toISOString():(f.timer_started_at=new Date().toISOString(),f.timer_paused_at=null),await ua(i.batch.id,f)}catch(f){console.error("Failed to save timer state:",f)}finally{d(K,!1)}}async function ne(){d(g,"mash"),d(S,e(P)*60),d(r,new Set,!0),d(B,!1),await J("mash",e(P)*60),$()}async function R(){d(g,"boil"),d(S,e(q)*60),d(r,new Set,!0),d(B,!1),await J("boil",e(q)*60),$()}function $(){E&&clearInterval(E),E=setInterval(()=>{if(!e(B)&&e(S)>0){if(rs(S,-1),e(g)==="boil"){const h=Math.floor(e(S)/60);for(const p of e(Q)){const u=p.time;h===u&&!e(r).has(u)&&(e(r).add(u),ae(),te(`Add ${p.name}`,`${p.amount}g at ${u} minutes`))}}e(S)===0&&(clearInterval(E),E=null,ae(),e(g)==="mash"?te("Mash Complete","Time to sparge and start the boil!"):e(g)==="boil"&&(d(g,"complete"),J("complete",0),te("Boil Complete","Time to chill the wort!"),i.onComplete?.()))}},1e3)}async function ee(){d(B,!e(B)),e(B)?await J(e(g),e(S),!0):await J(e(g),e(S),!1)}async function le(){E&&(clearInterval(E),E=null),d(g,"idle"),d(S,0),d(B,!1),d(r,new Set,!0),await J("idle",0)}function O(){d(S,e(S)+60)}function V(){e(S)>=60&&d(S,e(S)-60)}function ae(){try{const h=new(window.AudioContext||window.webkitAudioContext),p=h.createOscillator(),u=h.createGain();p.connect(u),u.connect(h.destination),p.frequency.value=880,p.type="sine",u.gain.value=.3,p.start(),setTimeout(()=>u.gain.value=0,150),setTimeout(()=>u.gain.value=.3,250),setTimeout(()=>u.gain.value=0,400),setTimeout(()=>u.gain.value=.3,500),setTimeout(()=>u.gain.value=0,650),setTimeout(()=>{p.stop(),h.close()},700)}catch(h){console.warn("Audio notification not available:",h)}}function te(h,p){"Notification"in window&&Notification.permission==="granted"&&new Notification(h,{body:p,icon:"/favicon.png"})}Ma(()=>("Notification"in window&&Notification.permission==="default"&&Notification.requestPermission(),i.batch.timer_phase&&i.batch.timer_phase!=="idle"&&i.batch.timer_phase!=="complete"&&(d(g,i.batch.timer_phase,!0),d(S,X(),!0),d(B,i.batch.timer_paused_at!=null),!e(B)&&e(S)>0&&$()),()=>{E&&clearInterval(E)}));var ue=sl(),ge=a(ue),qe=s(a(ge),2);{var se=h=>{var p=Wr();l(h,p)},w=h=>{var p=He(),u=ie(p);{var f=k=>{var y=Xr();let F;var H=a(y,!0);t(y),c(()=>{F=Le(y,1,"phase-badge svelte-ukh80y",null,F,{mash:e(g)==="mash",boil:e(g)==="boil"}),o(H,e(M))}),l(k,y)};v(u,k=>{e(g)!=="idle"&&e(g)!=="complete"&&k(f)},!0)}l(h,p)};v(qe,h=>{e(K)?h(se):h(w,!1)})}t(ge);var m=s(ge,2);{var x=h=>{var p=Jr(),u=a(p),f=s(a(u),2),k=a(f);k.__click=()=>d(P,Math.max(1,e(P)-5),!0);var y=s(k,2),F=a(y,!0);t(y);var H=s(y,2);H.__click=()=>d(P,e(P)+5),fe(2),t(f),t(u);var N=s(u,2),_e=s(a(N),2),re=a(_e),he=a(re,!0);t(re),fe(2),t(_e),t(N);var ve=s(N,2),Se=a(ve);Se.__click=ne;var Fe=s(Se,2);Fe.__click=R,t(ve),t(p),c(()=>{o(F,e(P)),o(he,e(q))}),l(h,p)},b=h=>{var p=He(),u=ie(p);{var f=y=>{var F=Yr(),H=s(a(F),4);H.__click=le,t(F),l(y,F)},k=y=>{var F=al(),H=a(F),N=a(H),_e=a(N,!0);t(N),fe(2),t(H);var re=s(H,2),he=a(re);let ve;t(re);var Se=s(re,2),Fe=a(Se);Fe.__click=V;var ze=s(Fe,2);let Ge;ze.__click=ee;var Te=a(ze);{var me=ke=>{var we=Kr();fe(),l(ke,we)},_=ke=>{var we=Qr();fe(),l(ke,we)};v(Te,ke=>{e(B)?ke(me):ke(_,!1)})}t(ze);var j=s(ze,2);j.__click=O,t(Se);var T=s(Se,2);{var D=ke=>{var we=el(),Ye=s(a(we),2);Pt(Ye,21,()=>e(Q),ta,(wt,bt)=>{const Rt=L(()=>Math.floor(e(S)/60)),C=L(()=>e(bt).time<=e(Rt)&&!e(r).has(e(bt).time)),z=L(()=>e(r).has(e(bt).time)||e(bt).time>e(Rt));var ye=$r();let G;var de=a(ye),A=a(de);t(de);var I=s(de,2),xe=a(I,!0);t(I);var De=s(I,2),Ke=a(De);t(De);var Ie=s(De,2);{var We=Ne=>{var Ze=Zr();l(Ne,Ze)};v(Ie,Ne=>{e(z)&&Ne(We)})}t(ye),c(()=>{G=Le(ye,1,"hop-item svelte-ukh80y",null,G,{next:e(C),done:e(z)}),o(A,`${e(bt).time??""}m`),o(xe,e(bt).name),o(Ke,`${e(bt).amount??""}g`)}),l(wt,ye)}),t(Ye),t(we),l(ke,we)};v(T,ke=>{e(g)==="boil"&&e(Q).length>0&&ke(D)})}var W=s(T,2),Y=a(W);{var oe=ke=>{var we=tl();we.__click=R,l(ke,we)};v(Y,ke=>{e(g)==="mash"&&ke(oe)})}var be=s(Y,2);be.__click=le,t(W),t(F),c(()=>{o(_e,e(ce)),ve=Le(he,1,"progress-fill svelte-ukh80y",null,ve,{mash:e(g)==="mash",boil:e(g)==="boil"}),Ft(he,`width: ${e(Be)??""}%`),Ge=Le(ze,1,"control-btn pause svelte-ukh80y",null,Ge,{paused:e(B)})}),l(y,F)};v(u,y=>{e(g)==="complete"?y(f):y(k,!1)},!0)}l(h,p)};v(m,h=>{e(g)==="idle"?h(x):h(b,!1)})}t(ue),l(Re,ue),Kt()}sa(["click"]);var ll=n('<label class="next-item svelte-ue9vqt"><input type="checkbox" class="svelte-ue9vqt"/> <span class="item-text svelte-ue9vqt"> </span></label>'),il=n('<div class="next-items svelte-ue9vqt"></div>'),nl=n('<label><input type="checkbox" class="svelte-ue9vqt"/> <span class="item-text svelte-ue9vqt"> </span></label>'),vl=n('<div class="all-items svelte-ue9vqt"></div>'),ol=n('<div class="checklist-compact svelte-ue9vqt"><button type="button" class="checklist-header svelte-ue9vqt"><div class="header-left svelte-ue9vqt"><span><!></span> <span class="title svelte-ue9vqt">Checklist</span> <span class="progress-text svelte-ue9vqt"> </span></div> <div class="header-right svelte-ue9vqt"><div class="mini-progress svelte-ue9vqt"><div class="mini-fill svelte-ue9vqt"></div></div> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></div></button> <!> <!></div>');function dl(Re,i){Yt(i,!0);let g=U($e([])),S=U(!1),E=L(()=>`brewday-checklist-${i.batchId}`);function B(){const b=[];return b.push({id:"prep-sanitize",text:"Sanitize equipment",checked:!1,category:"prep"}),b.push({id:"prep-water",text:"Heat strike water",checked:!1,category:"prep"}),i.recipe.fermentables&&i.recipe.fermentables.forEach((h,p)=>{b.push({id:`ferm-${p}`,text:`Mill: ${h.name}`,checked:!1,category:"prep"})}),b.push({id:"mash-dough-in",text:"Dough in",checked:!1,category:"mash"}),b.push({id:"mash-temp",text:"Check mash temp",checked:!1,category:"mash"}),b.push({id:"mash-sparge",text:"Sparge",checked:!1,category:"mash"}),b.push({id:"boil-preboil",text:"Record pre-boil gravity",checked:!1,category:"boil"}),b.push({id:"boil-start",text:"Bring to boil",checked:!1,category:"boil"}),i.recipe.hops&&i.recipe.hops.filter(p=>p.timing?.use==="add_to_boil"||!p.timing?.use).sort((p,u)=>(u.timing?.duration?.value||0)-(p.timing?.duration?.value||0)).forEach((p,u)=>{const f=p.timing?.duration?.value||0;b.push({id:`hop-${u}`,text:`${p.name} @ ${f}min`,checked:!1,category:"boil"})}),b.push({id:"postboil-chill",text:"Chill wort",checked:!1,category:"post-boil"}),b.push({id:"postboil-og",text:"Record OG",checked:!1,category:"post-boil"}),b.push({id:"postboil-transfer",text:"Transfer to fermenter",checked:!1,category:"post-boil"}),b.push({id:"postboil-yeast",text:"Pitch yeast",checked:!1,category:"post-boil"}),b}function K(){try{const b=localStorage.getItem(e(E));if(b){const h=JSON.parse(b),p=B(),u=new Map(h.map(k=>[k.id,k]));for(const k of p){const y=u.get(k.id);y&&(k.checked=y.checked)}const f=h.filter(k=>k.category==="custom");d(g,[...p,...f],!0)}else d(g,B(),!0)}catch{d(g,B(),!0)}}function r(){try{localStorage.setItem(e(E),JSON.stringify(e(g)))}catch(b){console.warn("Failed to save checklist:",b)}}function P(b){d(g,e(g).map(h=>h.id===b?{...h,checked:!h.checked}:h),!0),r()}let q=L(()=>e(g).filter(b=>b.checked).length),Q=L(()=>e(g).length),ce=L(()=>e(Q)>0?Math.round(e(q)/e(Q)*100):0),Be=L(()=>e(g).filter(b=>!b.checked).slice(0,3));Ma(()=>{K()});var M=ol(),X=a(M);X.__click=()=>d(S,!e(S));var J=a(X),ne=a(J);let R;var $=a(ne);{var ee=b=>{var h=ea("‚úì");l(b,h)},le=b=>{var h=ea("‚òê");l(b,h)};v($,b=>{e(ce)===100?b(ee):b(le,!1)})}t(ne);var O=s(ne,4),V=a(O);t(O),t(J);var ae=s(J,2),te=a(ae),ue=a(te);t(te);var ge=s(te,2);let qe;t(ae),t(X);var se=s(X,2);{var w=b=>{var h=il();Pt(h,21,()=>e(Be),p=>p.id,(p,u)=>{var f=ll();f.__click=H=>H.stopPropagation();var k=a(f);Ct(k),k.__change=()=>P(e(u).id);var y=s(k,2),F=a(y,!0);t(y),t(f),c(()=>{Ua(k,e(u).checked),o(F,e(u).text)}),l(p,f)}),t(h),l(b,h)};v(se,b=>{!e(S)&&e(Be).length>0&&b(w)})}var m=s(se,2);{var x=b=>{var h=vl();Pt(h,21,()=>e(g),p=>p.id,(p,u)=>{var f=nl();let k;var y=a(f);Ct(y),y.__change=()=>P(e(u).id);var F=s(y,2),H=a(F,!0);t(F),t(f),c(()=>{k=Le(f,1,"item-row svelte-ue9vqt",null,k,{checked:e(u).checked}),Ua(y,e(u).checked),o(H,e(u).text)}),l(p,f)}),t(h),l(b,h)};v(m,b=>{e(S)&&b(x)})}t(M),c(()=>{R=Le(ne,1,"check-icon svelte-ue9vqt",null,R,{done:e(ce)===100}),o(V,`${e(q)??""}/${e(Q)??""}`),Ft(ue,`width: ${e(ce)??""}%`),qe=Le(ge,0,"chevron svelte-ue9vqt",null,qe,{expanded:e(S)})}),l(Re,M),Kt()}sa(["click","change"]);var cl=n('<span class="save-indicator svelte-1hyfh06"> </span>'),ul=n('<span class="summary-value svelte-1hyfh06"> </span>'),_l=n('<span class="summary-value svelte-1hyfh06"> </span>'),pl=n('<span class="target svelte-1hyfh06"> </span>'),fl=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Mash Temperature</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06"> </span></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Mash pH</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.01" min="4" max="7" class="field-input svelte-1hyfh06" placeholder="--"/></div> <span class="target svelte-1hyfh06">Target: 5.2-5.6</span></div></div> <div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Strike Water Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div></div></div></div>'),gl=n('<span class="summary-value svelte-1hyfh06"> </span>'),hl=n('<span class="summary-value svelte-1hyfh06"> </span>'),ml=n('<span class="target svelte-1hyfh06"> </span>'),bl=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Pre-Boil Gravity</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.001" min="1.000" max="1.200" class="field-input svelte-1hyfh06" placeholder="1.0XX"/></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Pre-Boil Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div></div></div></div>'),yl=n('<span class="summary-value og svelte-1hyfh06"> </span>'),xl=n('<span class="summary-value svelte-1hyfh06"> </span>'),kl=n('<span class="target svelte-1hyfh06"> </span>'),wl=n('<span class="target svelte-1hyfh06"> </span>'),jl=n('<span class="target svelte-1hyfh06"> </span>'),ql=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Original Gravity (OG)</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.001" min="1.000" max="1.200" class="field-input og-input svelte-1hyfh06" placeholder="1.0XX"/></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Post-Boil Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div> <!></div></div> <div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Brewhouse Efficiency</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" min="0" max="100" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">%</span></div> <!></div></div></div>'),Sl=n('<span class="has-notes svelte-1hyfh06">Has notes</span>'),Ml=n('<div class="section-content svelte-1hyfh06"><textarea class="notes-input svelte-1hyfh06" placeholder="Record any deviations, substitutions, or observations..." rows="4"></textarea></div>'),Cl=n('<div class="saving-indicator svelte-1hyfh06"><span class="spinner svelte-1hyfh06"></span> Saving...</div>'),Bl=n('<div class="observations-card svelte-1hyfh06"><div class="card-header svelte-1hyfh06"><h3 class="card-title svelte-1hyfh06">Brew Day Log</h3> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Mash</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Pre-Boil</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Post-Boil / OG</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Brew Day Notes</span> <!> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <!></div>');function Fl(Re,i){Yt(i,!0);let g=U($e(i.batch.actual_mash_temp??null)),S=U($e(i.batch.actual_mash_ph??null)),E=U($e(i.batch.strike_water_volume??null)),B=U($e(i.batch.pre_boil_gravity??null)),K=U($e(i.batch.pre_boil_volume??null)),r=U($e(i.batch.post_boil_volume??null)),P=U($e(i.batch.measured_og??null)),q=U($e(i.batch.actual_efficiency??null)),Q=U($e(i.batch.brew_day_notes??"")),ce=U(!1),Be=U(null),M=U("mash"),X=L(Aa),J=L(()=>i.recipe.mash_temp),ne=L(()=>i.recipe.og),R=L(()=>i.recipe.pre_boil_og),$=L(()=>i.recipe.batch_size_liters),ee=L(()=>i.recipe.efficiency_percent);function le(){if(!e(P)||!e(ne)||!e(ee))return null;const C=(e(P)-1)*1e3,z=(e(ne)-1)*1e3;return z===0?null:C/z*e(ee)}Ma(()=>{if(e(P)&&!e(q)){const C=le();C&&d(q,Math.round(C*10)/10)}});async function O(){if(!e(ce)){d(ce,!0);try{const C={actual_mash_temp:e(g)??void 0,actual_mash_ph:e(S)??void 0,strike_water_volume:e(E)??void 0,pre_boil_gravity:e(B)??void 0,pre_boil_volume:e(K)??void 0,post_boil_volume:e(r)??void 0,measured_og:e(P)??void 0,actual_efficiency:e(q)??void 0,brew_day_notes:e(Q)||void 0},z=await ua(i.batch.id,C);d(Be,new Date,!0),i.onUpdate?.(z)}catch(C){console.error("Failed to save observations:",C)}finally{d(ce,!1)}}}function V(C){d(M,e(M)===C?null:C,!0)}var ae=Bl(),te=a(ae),ue=s(a(te),2);{var ge=C=>{var z=cl(),ye=a(z);t(z),c(G=>o(ye,`Saved ${G??""}`),[()=>e(Be).toLocaleTimeString()]),l(C,z)};v(ue,C=>{e(Be)&&C(ge)})}t(te);var qe=s(te,2);let se;var w=a(qe);w.__click=()=>V("mash");var m=s(a(w),2),x=a(m);{var b=C=>{var z=ul(),ye=a(z);t(z),c(G=>o(ye,`${G??""}${e(X)??""}`),[()=>Sa(e(g))]),l(C,z)};v(x,C=>{e(g)&&C(b)})}var h=s(x,2);{var p=C=>{var z=_l(),ye=a(z);t(z),c(G=>o(ye,`pH ${G??""}`),[()=>e(S).toFixed(2)]),l(C,z)};v(h,C=>{e(S)&&C(p)})}t(m),fe(2),t(w);var u=s(w,2);{var f=C=>{var z=fl(),ye=a(z),G=a(ye),de=s(a(G),2),A=a(de);Ct(A);var I=s(A,2),xe=a(I,!0);t(I),t(de);var De=s(de,2);{var Ke=Pe=>{var yt=pl(),Me=a(yt);t(yt),c(Qe=>o(Me,`Target: ${Qe??""}${e(X)??""}`),[()=>Sa(e(J))]),l(Pe,yt)};v(De,Pe=>{e(J)&&Pe(Ke)})}t(G);var Ie=s(G,2),We=s(a(Ie),2),Ne=a(We);Ct(Ne),t(We),fe(2),t(Ie),t(ye);var Ze=s(ye,2),et=a(Ze),at=s(a(et),2),ft=a(at);Ct(ft),fe(2),t(at),t(et),t(Ze),t(z),c(()=>o(xe,e(X))),Mt("blur",A,O),jt(A,()=>e(g),Pe=>d(g,Pe)),Mt("blur",Ne,O),jt(Ne,()=>e(S),Pe=>d(S,Pe)),Mt("blur",ft,O),jt(ft,()=>e(E),Pe=>d(E,Pe)),l(C,z)};v(u,C=>{e(M)==="mash"&&C(f)})}t(qe);var k=s(qe,2);let y;var F=a(k);F.__click=()=>V("preboil");var H=s(a(F),2),N=a(H);{var _e=C=>{var z=gl(),ye=a(z,!0);t(z),c(G=>o(ye,G),[()=>Bt(e(B))]),l(C,z)};v(N,C=>{e(B)&&C(_e)})}var re=s(N,2);{var he=C=>{var z=hl(),ye=a(z);t(z),c(G=>o(ye,`${G??""}L`),[()=>e(K).toFixed(1)]),l(C,z)};v(re,C=>{e(K)&&C(he)})}t(H),fe(2),t(F);var ve=s(F,2);{var Se=C=>{var z=bl(),ye=a(z),G=a(ye),de=s(a(G),2),A=a(de);Ct(A),t(de);var I=s(de,2);{var xe=We=>{var Ne=ml(),Ze=a(Ne);t(Ne),c(et=>o(Ze,`Target: ${et??""}`),[()=>Bt(e(R))]),l(We,Ne)};v(I,We=>{e(R)&&We(xe)})}t(G);var De=s(G,2),Ke=s(a(De),2),Ie=a(Ke);Ct(Ie),fe(2),t(Ke),t(De),t(ye),t(z),Mt("blur",A,O),jt(A,()=>e(B),We=>d(B,We)),Mt("blur",Ie,O),jt(Ie,()=>e(K),We=>d(K,We)),l(C,z)};v(ve,C=>{e(M)==="preboil"&&C(Se)})}t(k);var Fe=s(k,2);let ze;var Ge=a(Fe);Ge.__click=()=>V("postboil");var Te=s(a(Ge),2),me=a(Te);{var _=C=>{var z=yl(),ye=a(z,!0);t(z),c(G=>o(ye,G),[()=>Bt(e(P))]),l(C,z)};v(me,C=>{e(P)&&C(_)})}var j=s(me,2);{var T=C=>{var z=xl(),ye=a(z);t(z),c(G=>o(ye,`${G??""}% eff`),[()=>e(q).toFixed(0)]),l(C,z)};v(j,C=>{e(q)&&C(T)})}t(Te),fe(2),t(Ge);var D=s(Ge,2);{var W=C=>{var z=ql(),ye=a(z),G=a(ye),de=s(a(G),2),A=a(de);Ct(A),t(de);var I=s(de,2);{var xe=Me=>{var Qe=kl(),Nt=a(Qe);t(Qe),c(pa=>o(Nt,`Target: ${pa??""}`),[()=>Bt(e(ne))]),l(Me,Qe)};v(I,Me=>{e(ne)&&Me(xe)})}t(G);var De=s(G,2),Ke=s(a(De),2),Ie=a(Ke);Ct(Ie),fe(2),t(Ke);var We=s(Ke,2);{var Ne=Me=>{var Qe=wl(),Nt=a(Qe);t(Qe),c(pa=>o(Nt,`Target: ${pa??""}L`),[()=>e($).toFixed(1)]),l(Me,Qe)};v(We,Me=>{e($)&&Me(Ne)})}t(De),t(ye);var Ze=s(ye,2),et=a(Ze),at=s(a(et),2),ft=a(at);Ct(ft),fe(2),t(at);var Pe=s(at,2);{var yt=Me=>{var Qe=jl(),Nt=a(Qe);t(Qe),c(pa=>o(Nt,`Target: ${pa??""}%`),[()=>e(ee).toFixed(0)]),l(Me,Qe)};v(Pe,Me=>{e(ee)&&Me(yt)})}t(et),t(Ze),t(z),Mt("blur",A,O),jt(A,()=>e(P),Me=>d(P,Me)),Mt("blur",Ie,O),jt(Ie,()=>e(r),Me=>d(r,Me)),Mt("blur",ft,O),jt(ft,()=>e(q),Me=>d(q,Me)),l(C,z)};v(D,C=>{e(M)==="postboil"&&C(W)})}t(Fe);var Y=s(Fe,2);let oe;var be=a(Y);be.__click=()=>V("notes");var ke=s(a(be),2);{var we=C=>{var z=Sl();l(C,z)};v(ke,C=>{e(Q)&&C(we)})}fe(2),t(be);var Ye=s(be,2);{var wt=C=>{var z=Ml(),ye=a(z);Da(ye),t(z),Mt("blur",ye,O),jt(ye,()=>e(Q),G=>d(Q,G)),l(C,z)};v(Ye,C=>{e(M)==="notes"&&C(wt)})}t(Y);var bt=s(Y,2);{var Rt=C=>{var z=Cl();l(C,z)};v(bt,C=>{e(ce)&&C(Rt)})}t(ae),c(()=>{se=Le(qe,1,"section svelte-1hyfh06",null,se,{expanded:e(M)==="mash"}),y=Le(k,1,"section svelte-1hyfh06",null,y,{expanded:e(M)==="preboil"}),ze=Le(Fe,1,"section svelte-1hyfh06",null,ze,{expanded:e(M)==="postboil"}),oe=Le(Y,1,"section svelte-1hyfh06",null,oe,{expanded:e(M)==="notes"})}),l(Re,ae),Kt()}sa(["click"]);var zl=n('<span class="packaged-badge svelte-1yofiqc">Packaged</span>'),Tl=n('<span class="save-indicator svelte-1yofiqc">Saved</span>'),Dl=n("<option> </option>"),Al=n("<option> </option>"),Pl=n('<div class="field-row priming-row svelte-1yofiqc"><div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Priming Sugar Type</label> <input type="text" class="field-input svelte-1yofiqc" placeholder="e.g., table sugar, corn sugar"/></div> <div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Amount</label> <div class="input-with-unit svelte-1yofiqc"><input type="number" step="1" class="field-input svelte-1yofiqc" placeholder="--"/> <span class="unit svelte-1yofiqc">g</span></div></div></div>'),Rl=n('<div class="card-content svelte-1yofiqc"><div class="field-row svelte-1yofiqc"><div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Packaged On</label> <input type="date" class="field-input svelte-1yofiqc"/></div> <div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Package Type</label> <select class="field-input svelte-1yofiqc"><option>Select...</option><!></select></div></div> <div class="field-row svelte-1yofiqc"><div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Volume Packaged</label> <div class="input-with-unit svelte-1yofiqc"><input type="number" step="0.1" class="field-input svelte-1yofiqc" placeholder="--"/> <span class="unit svelte-1yofiqc">L</span></div></div> <div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Carbonation Method</label> <select class="field-input svelte-1yofiqc"><option>Select...</option><!></select></div></div> <!> <div class="field full-width svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Packaging Notes</label> <textarea class="notes-input svelte-1yofiqc" placeholder="Any observations about packaging day..." rows="3"></textarea></div></div>'),Nl=n('<div class="saving-indicator svelte-1yofiqc"><span class="spinner svelte-1yofiqc"></span> Saving...</div>'),Ol=n('<div class="packaging-card svelte-1yofiqc"><button type="button" class="card-header svelte-1yofiqc"><div class="header-content svelte-1yofiqc"><h3 class="card-title svelte-1yofiqc">Packaging</h3> <!></div> <div class="header-right svelte-1yofiqc"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div></button> <!> <!></div>');function Ll(Re,i){Yt(i,!0);let g=U($e(i.batch.packaged_at?i.batch.packaged_at.split("T")[0]:"")),S=U($e(i.batch.packaging_type??"")),E=U($e(i.batch.packaging_volume??null)),B=U($e(i.batch.carbonation_method??"")),K=U($e(i.batch.priming_sugar_type??"")),r=U($e(i.batch.priming_sugar_amount??null)),P=U($e(i.batch.packaging_notes??"")),q=U(!1),Q=U(null),ce=U(!i.batch.packaged_at),Be=L(()=>e(B)==="bottle_conditioned"||e(B)==="keg_conditioned");async function M(){if(!e(q)){d(q,!0);try{const x={packaged_at:e(g)?new Date(e(g)).toISOString():void 0,packaging_type:e(S)||void 0,packaging_volume:e(E)??void 0,carbonation_method:e(B)||void 0,priming_sugar_type:e(Be)&&e(K)||void 0,priming_sugar_amount:e(Be)?e(r)??void 0:void 0,packaging_notes:e(P)||void 0},b=await ua(i.batch.id,x);d(Q,new Date,!0),i.onUpdate?.(b)}catch(x){console.error("Failed to save packaging info:",x)}finally{d(q,!1)}}}function X(){d(ce,!e(ce))}const J=[{value:"keg",label:"Keg"},{value:"bottles",label:"Bottles"},{value:"cans",label:"Cans"}],ne=[{value:"forced",label:"Force Carbonated"},{value:"bottle_conditioned",label:"Bottle Conditioned"},{value:"keg_conditioned",label:"Keg Conditioned"},{value:"natural",label:"Naturally Carbonated"}];var R=Ol(),$=a(R);$.__click=X;var ee=a($),le=s(a(ee),2);{var O=x=>{var b=zl();l(x,b)};v(le,x=>{i.batch.packaged_at&&x(O)})}t(ee);var V=s(ee,2),ae=a(V);{var te=x=>{var b=Tl();l(x,b)};v(ae,x=>{e(Q)&&x(te)})}var ue=s(ae,2);let ge;t(V),t($);var qe=s($,2);{var se=x=>{var b=Rl(),h=a(b),p=a(h),u=s(a(p),2);Ct(u),t(p);var f=s(p,2),k=s(a(f),2);k.__change=M;var y=a(k);y.value=y.__value="";var F=s(y);Pt(F,17,()=>J,ta,(_,j)=>{var T=Dl(),D=a(T,!0);t(T);var W={};c(()=>{o(D,e(j).label),W!==(W=e(j).value)&&(T.value=(T.__value=e(j).value)??"")}),l(_,T)}),t(k),t(f),t(h);var H=s(h,2),N=a(H),_e=s(a(N),2),re=a(_e);Ct(re),fe(2),t(_e),t(N);var he=s(N,2),ve=s(a(he),2);ve.__change=M;var Se=a(ve);Se.value=Se.__value="";var Fe=s(Se);Pt(Fe,17,()=>ne,ta,(_,j)=>{var T=Al(),D=a(T,!0);t(T);var W={};c(()=>{o(D,e(j).label),W!==(W=e(j).value)&&(T.value=(T.__value=e(j).value)??"")}),l(_,T)}),t(ve),t(he),t(H);var ze=s(H,2);{var Ge=_=>{var j=Pl(),T=a(j),D=s(a(T),2);Ct(D),t(T);var W=s(T,2),Y=s(a(W),2),oe=a(Y);Ct(oe),fe(2),t(Y),t(W),t(j),Mt("blur",D,M),jt(D,()=>e(K),be=>d(K,be)),Mt("blur",oe,M),jt(oe,()=>e(r),be=>d(r,be)),l(_,j)};v(ze,_=>{e(Be)&&_(Ge)})}var Te=s(ze,2),me=s(a(Te),2);Da(me),t(Te),t(b),Mt("blur",u,M),jt(u,()=>e(g),_=>d(g,_)),Ta(k,()=>e(S),_=>d(S,_)),Mt("blur",re,M),jt(re,()=>e(E),_=>d(E,_)),Ta(ve,()=>e(B),_=>d(B,_)),Mt("blur",me,M),jt(me,()=>e(P),_=>d(P,_)),l(x,b)};v(qe,x=>{e(ce)&&x(se)})}var w=s(qe,2);{var m=x=>{var b=Nl();l(x,b)};v(w,x=>{e(q)&&x(m)})}t(R),c(()=>ge=Le(ue,0,"chevron svelte-1yofiqc",null,ge,{expanded:e(ce)})),l(Re,R),Kt()}sa(["click","change"]);var El=n('<span class="note-count svelte-11n209s"> </span>'),Gl=n('<span class="avg-score svelte-11n209s"> </span>'),Il=n('<button type="button" class="add-note-btn svelte-11n209s"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> Add Tasting Note</button>'),Ul=n('<button type="button"> </button>'),Vl=n('<div class="score-category svelte-11n209s"><div class="category-header svelte-11n209s"><span class="category-label svelte-11n209s"> </span> <div class="score-selector svelte-11n209s"></div></div> <textarea class="category-notes svelte-11n209s" rows="2"></textarea></div>'),Hl=n('<div class="note-form svelte-11n209s"><div class="form-header svelte-11n209s"><h4 class="svelte-11n209s"> </h4> <button type="button" class="close-btn svelte-11n209s"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <!> <div class="form-actions svelte-11n209s"><button type="button" class="cancel-btn svelte-11n209s">Cancel</button> <button type="button" class="save-btn svelte-11n209s"> </button></div></div>'),Wl=n('<div><span class="score-label svelte-11n209s"> </span> <span class="score-value svelte-11n209s"> </span></div>'),Xl=n('<p class="note-text svelte-11n209s"> </p>'),Jl=n('<div><div class="note-header svelte-11n209s"><span class="note-date svelte-11n209s"> </span> <div class="note-actions svelte-11n209s"><button type="button" class="action-btn svelte-11n209s" title="Edit"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button> <button type="button" class="action-btn delete svelte-11n209s" title="Delete"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div> <div class="note-scores svelte-11n209s"></div> <!></div>'),Yl=n('<div class="notes-list svelte-11n209s"></div>'),Kl=n('<p class="empty-message svelte-11n209s">No tasting notes yet. Add your first one to track how this batch develops over time.</p>'),Ql=n('<div class="card-content svelte-11n209s"><!> <!> <!></div>'),Zl=n('<div class="tasting-card svelte-11n209s"><button type="button" class="card-header svelte-11n209s"><div class="header-content svelte-11n209s"><h3 class="card-title svelte-11n209s">Tasting Notes</h3> <!></div> <div class="header-right svelte-11n209s"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div></button> <!></div>');function $l(Re,i){Yt(i,!0);let g=U($e(i.batch.tasting_notes??[])),S=U(!0),E=U(!1),B=U(null),K=U(!1),r=U($e({appearance_score:void 0,appearance_notes:"",aroma_score:void 0,aroma_notes:"",flavor_score:void 0,flavor_notes:"",mouthfeel_score:void 0,mouthfeel_notes:"",overall_score:void 0,overall_notes:""})),P=L(()=>()=>{if(e(g).length===0)return null;const w=e(g).filter(m=>m.overall_score!=null).map(m=>m.overall_score);return w.length===0?null:(w.reduce((m,x)=>m+x,0)/w.length).toFixed(1)});function q(){d(S,!e(S))}function Q(){d(r,{appearance_score:void 0,appearance_notes:"",aroma_score:void 0,aroma_notes:"",flavor_score:void 0,flavor_notes:"",mouthfeel_score:void 0,mouthfeel_notes:"",overall_score:void 0,overall_notes:""},!0),d(B,null),d(E,!1)}function ce(){Q(),d(E,!0)}function Be(w){d(r,{appearance_score:w.appearance_score??void 0,appearance_notes:w.appearance_notes??"",aroma_score:w.aroma_score??void 0,aroma_notes:w.aroma_notes??"",flavor_score:w.flavor_score??void 0,flavor_notes:w.flavor_notes??"",mouthfeel_score:w.mouthfeel_score??void 0,mouthfeel_notes:w.mouthfeel_notes??"",overall_score:w.overall_score??void 0,overall_notes:w.overall_notes??""},!0),d(B,w.id,!0),d(E,!0)}async function M(){if(!e(K)){d(K,!0);try{if(e(B)){const w=await ys(i.batch.id,e(B),e(r));d(g,e(g).map(m=>m.id===e(B)?w:m),!0)}else{const w=await xs(i.batch.id,e(r));d(g,[w,...e(g)],!0)}Q(),i.onUpdate?.({...i.batch,tasting_notes:e(g)})}catch(w){console.error("Failed to save tasting note:",w)}finally{d(K,!1)}}}async function X(w){if(confirm("Delete this tasting note?"))try{await ks(i.batch.id,w),d(g,e(g).filter(m=>m.id!==w),!0),i.onUpdate?.({...i.batch,tasting_notes:e(g)})}catch(m){console.error("Failed to delete tasting note:",m)}}function J(w){return new Date(w).toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric"})}function ne(w){return w==null?"-":"‚òÖ".repeat(w)+"‚òÜ".repeat(5-w)}var R=Zl(),$=a(R);$.__click=q;var ee=a($),le=s(a(ee),2);{var O=w=>{var m=El(),x=a(m,!0);t(m),c(()=>o(x,e(g).length)),l(w,m)};v(le,w=>{e(g).length>0&&w(O)})}t(ee);var V=s(ee,2),ae=a(V);{var te=w=>{var m=Gl(),x=a(m);t(m),c(b=>o(x,`Avg: ${b??""}/5`),[()=>e(P)()]),l(w,m)};v(ae,w=>{e(P)()&&w(te)})}var ue=s(ae,2);let ge;t(V),t($);var qe=s($,2);{var se=w=>{var m=Ql(),x=a(m);{var b=y=>{var F=Il();F.__click=ce,l(y,F)};v(x,y=>{e(E)||y(b)})}var h=s(x,2);{var p=y=>{var F=Hl(),H=a(F),N=a(H),_e=a(N);t(N);var re=s(N,2);re.__click=Q,t(H);var he=s(H,2);Pt(he,16,()=>[{key:"appearance",label:"Appearance"},{key:"aroma",label:"Aroma"},{key:"flavor",label:"Flavor"},{key:"mouthfeel",label:"Mouthfeel"},{key:"overall",label:"Overall"}],ta,(Ge,Te)=>{var me=Vl(),_=a(me),j=a(_),T=a(j,!0);t(j);var D=s(j,2);Pt(D,20,()=>[1,2,3,4,5],ta,(Y,oe)=>{var be=Ul();let ke;be.__click=()=>{const Ye=`${Te.key}_score`;e(r)[Ye]=oe};var we=a(be,!0);t(be),c(()=>{ke=Le(be,1,"score-btn svelte-11n209s",null,ke,{selected:e(r)[`${Te.key}_score`]===oe}),o(we,oe)}),l(Y,be)}),t(D),t(_);var W=s(_,2);Da(W),t(me),c(Y=>{o(T,Te.label),aa(W,"placeholder",`Notes on ${Y??""}...`)},[()=>Te.label.toLowerCase()]),jt(W,()=>e(r)[`${Te.key}_notes`],Y=>e(r)[`${Te.key}_notes`]=Y),l(Ge,me)});var ve=s(he,2),Se=a(ve);Se.__click=Q;var Fe=s(Se,2);Fe.__click=M;var ze=a(Fe,!0);t(Fe),t(ve),t(F),c(()=>{o(_e,`${e(B)?"Edit":"New"} Tasting Note`),Fe.disabled=e(K),o(ze,e(K)?"Saving...":e(B)?"Update":"Save")}),l(y,F)};v(h,y=>{e(E)&&y(p)})}var u=s(h,2);{var f=y=>{var F=Yl();Pt(F,21,()=>e(g),ta,(H,N)=>{var _e=Jl();let re;var he=a(_e),ve=a(he),Se=a(ve,!0);t(ve);var Fe=s(ve,2),ze=a(Fe);ze.__click=()=>Be(e(N));var Ge=s(ze,2);Ge.__click=()=>X(e(N).id),t(Fe),t(he);var Te=s(he,2);Pt(Te,20,()=>[{key:"appearance",label:"App"},{key:"aroma",label:"Aroma"},{key:"flavor",label:"Flav"},{key:"mouthfeel",label:"Mouth"},{key:"overall",label:"Overall"}],ta,(j,T)=>{var D=Wl();let W;var Y=a(D),oe=a(Y,!0);t(Y);var be=s(Y,2),ke=a(be,!0);t(be),t(D),c(we=>{W=Le(D,1,"score-item svelte-11n209s",null,W,{overall:T.key==="overall"}),o(oe,T.label),o(ke,we)},[()=>ne(e(N)[`${T.key}_score`])]),l(j,D)}),t(Te);var me=s(Te,2);{var _=j=>{var T=Xl(),D=a(T,!0);t(T),c(()=>o(D,e(N).overall_notes)),l(j,T)};v(me,j=>{e(N).overall_notes&&j(_)})}t(_e),c(j=>{re=Le(_e,1,"note-item svelte-11n209s",null,re,{editing:e(B)===e(N).id}),o(Se,j)},[()=>J(e(N).tasted_at)]),l(H,_e)}),t(F),l(y,F)},k=y=>{var F=He(),H=ie(F);{var N=_e=>{var re=Kl();l(_e,re)};v(H,_e=>{e(E)||_e(N)},!0)}l(y,F)};v(u,y=>{e(g).length>0?y(f):y(k,!1)})}t(m),l(w,m)};v(qe,w=>{e(S)&&w(se)})}t(R),c(()=>ge=Le(ue,0,"chevron svelte-11n209s",null,ge,{expanded:e(S)})),l(Re,R),Kt()}sa(["click"]);var ei=n('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),ti=n('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),ai=n('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),si=n('<span class="recipe-type svelte-g5au2j"> </span>'),ri=n('<a class="recipe-link svelte-g5au2j"> <!></a>'),li=n('<div class="batch-timing svelte-g5au2j"> </div>'),ii=n('<div class="batch-timing svelte-g5au2j"> </div>'),ni=n('<option class="svelte-g5au2j"> </option>'),vi=_a('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" class="svelte-g5au2j"></path><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Resume',1),oi=_a('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Pause',1),di=n('<button type="button"><!></button>'),ci=n('<span class="chilling-icon svelte-g5au2j">üç∫</span> <h3 class="chilling-title svelte-g5au2j">Ready to Pitch!</h3>',1),ui=n('<span class="chilling-icon svelte-g5au2j">‚ùÑÔ∏è</span> <h3 class="chilling-title svelte-g5au2j">Chilling to Pitch Temperature</h3>',1),_i=n('<div class="progress-section svelte-g5au2j"><div class="progress-bar svelte-g5au2j"><div class="progress-fill svelte-g5au2j"></div></div> <span class="progress-text svelte-g5au2j"> </span></div>'),pi=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è No cooler configured - set a cooler entity to enable automated chilling</span>'),fi=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è Temperature control disabled in settings</span>'),gi=n('<span class="status-ready svelte-g5au2j">Wort has reached pitch temperature - ready to add yeast!</span>'),hi=n('<span class="status-active svelte-g5au2j">Cooler will run automatically when temp exceeds target + hysteresis</span>'),mi=n('<div><div class="chilling-header svelte-g5au2j"><!></div> <div class="chilling-content svelte-g5au2j"><div class="temp-display svelte-g5au2j"><div class="temp-current svelte-g5au2j"><span class="temp-label svelte-g5au2j">Current</span> <span class="temp-value svelte-g5au2j"> </span></div> <div class="temp-arrow svelte-g5au2j">‚Üí</div> <div class="temp-target svelte-g5au2j"><span class="temp-label svelte-g5au2j">Target</span> <span class="temp-value svelte-g5au2j"> </span></div></div> <!> <div class="chilling-status svelte-g5au2j"><!></div></div></div>'),bi=n(`<div class="paused-banner svelte-g5au2j"><div class="paused-header svelte-g5au2j"><svg class="paused-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> <h3 class="paused-title svelte-g5au2j">Readings Paused</h3></div> <p class="paused-text svelte-g5au2j">Hydrometer readings are not being stored. Live readings still display but won't be saved to the fermentation history.</p> <button type="button" class="resume-btn svelte-g5au2j"> </button></div>`),yi=n('<span class="btn-spinner svelte-g5au2j"></span> Starting...',1),xi=_a('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" class="svelte-g5au2j"></path><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Start Brew Day',1),ki=n(`<div class="planning-phase svelte-g5au2j"><div class="phase-action-card svelte-g5au2j"><div class="phase-icon svelte-g5au2j">üìã</div> <h2 class="phase-title svelte-g5au2j">Ready to Brew?</h2> <p class="phase-description svelte-g5au2j">Review your recipe below, then start brew day when you're ready to begin.</p> <button type="button" class="start-brewday-btn svelte-g5au2j"><!></button></div> <!></div>`),wi=n('<div class="chilling-progress svelte-g5au2j"><div class="progress-bar svelte-g5au2j"><div class="progress-fill svelte-g5au2j"></div></div> <span class="progress-text svelte-g5au2j"> </span></div>'),ji=n(`<div class="phase-action-card chilling svelte-g5au2j"><div class="phase-icon svelte-g5au2j">‚ùÑÔ∏è</div> <h2 class="phase-title svelte-g5au2j">Chilling to Pitch Temperature</h2> <p class="phase-description svelte-g5au2j">Wort is being cooled to pitch temperature. The cooler will run automatically.
							Once target is reached, you can pitch the yeast.</p> <div class="chilling-temp-display svelte-g5au2j"><div class="temp-current svelte-g5au2j"><span class="temp-label svelte-g5au2j">Current</span> <span class="temp-value svelte-g5au2j"> </span></div> <div class="temp-arrow svelte-g5au2j">‚Üí</div> <div class="temp-target svelte-g5au2j"><span class="temp-label svelte-g5au2j">Target</span> <span class="temp-value svelte-g5au2j"> </span></div></div> <!></div>`),qi=n('<span class="btn-spinner svelte-g5au2j"></span> Starting...',1),Si=_a('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" class="svelte-g5au2j"></path></svg> Yeast Pitched - Start Fermentation',1),Mi=n('<div class="phase-action-card ready-to-pitch svelte-g5au2j"><div class="phase-icon svelte-g5au2j">üç∫</div> <h2 class="phase-title svelte-g5au2j">Ready to Pitch!</h2> <p class="phase-description svelte-g5au2j"> </p> <button type="button" class="start-fermentation-btn svelte-g5au2j"><!></button></div>'),Ci=n('<span class="btn-spinner svelte-g5au2j"></span> Starting...',1),Bi=_a('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" class="svelte-g5au2j"></path></svg> Yeast Pitched - Start Fermentation',1),Fi=n(`<div class="phase-action-card brewing svelte-g5au2j"><div class="phase-icon svelte-g5au2j">üç∫</div> <h2 class="phase-title svelte-g5au2j">Brew Day in Progress</h2> <p class="phase-description svelte-g5au2j">Track your brew day activities. When you've pitched the yeast and fermentation begins, transition to the fermentation phase.</p> <button type="button" class="start-fermentation-btn svelte-g5au2j"><!></button></div>`),zi=n('<div class="brewing-phase svelte-g5au2j"><!> <div class="brewday-tools-grid svelte-g5au2j"><!> <!></div> <!> <!> <!></div>'),Ti=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot brewing svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Brew Day</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Di=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot fermenting svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Fermentation Started</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Ai=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot conditioning svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Conditioning Started</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Pi=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot completed svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Completed</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Ri=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot packaged svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j"> </span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Ni=n('<div class="completed-phase svelte-g5au2j"><div class="batch-summary-card svelte-g5au2j"><h2 class="summary-title svelte-g5au2j">Batch Complete</h2> <div class="summary-stats svelte-g5au2j"><div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Original Gravity</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Final Gravity</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">ABV</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Attenuation</span> <span class="stat-value svelte-g5au2j"><!></span></div></div></div> <div class="timeline-card svelte-g5au2j"><h3 class="timeline-title svelte-g5au2j">Batch Timeline</h3> <div class="timeline svelte-g5au2j"><!> <!> <!> <!> <!></div></div> <!> <!> <!></div>'),Oi=n('<span class="status-badge heater svelte-g5au2j">üî• Heating</span>'),Li=n('<span class="status-badge cooler svelte-g5au2j">‚ùÑÔ∏è Cooling</span>'),Ei=n('<span class="status-badge idle svelte-g5au2j"> </span>'),Gi=n('<div class="device-status heater svelte-g5au2j"><div>üî•</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Heater</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Ii=n('<div class="device-status cooler svelte-g5au2j"><div>‚ùÑÔ∏è</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Cooler</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Ui=n('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">‚ö°</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),Vi=n('<button type="button" class="override-btn heat-on svelte-g5au2j">Force Heat ON</button> <button type="button" class="override-btn heat-off svelte-g5au2j">Force Heat OFF</button>',1),Hi=n('<button type="button" class="override-btn cool-on svelte-g5au2j">Force Cool ON</button> <button type="button" class="override-btn cool-off svelte-g5au2j">Force Cool OFF</button>',1),Wi=n('<div class="control-details svelte-g5au2j"><div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns-grid svelte-g5au2j"><!> <!> <button type="button" class="override-btn auto-mode svelte-g5au2j">Auto Mode</button></div></div>',1),Xi=n('<div class="device-status-grid svelte-g5au2j"><!> <!></div> <!>',1),Ji=n('<div><button type="button" class="collapsible-header svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="collapse-indicator svelte-g5au2j"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" class="svelte-g5au2j"></path></svg></div></button> <!></div>'),Yi=n('<span class="svelte-g5au2j"> </span>'),Ki=n('<span class="svelte-g5au2j"> </span>'),Qi=n('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><!> <!> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),Zi=n('<div class="chart-section svelte-g5au2j"><!></div>'),$i=n('<div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!> <!></div></div> <!>',1),en=n('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <!> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j" aria-label="Delete batch"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <!> <!> <!>',1),tn=n('<div class="modal-overlay svelte-g5au2j" role="presentation"><div class="modal svelte-g5au2j" role="dialog" aria-modal="true" aria-labelledby="delete-modal-title" tabindex="-1"><h2 id="delete-modal-title" class="modal-title svelte-g5au2j">Delete Batch?</h2> <p class="modal-text svelte-g5au2j"> </p> <div class="modal-actions svelte-g5au2j"><button type="button" class="modal-btn cancel svelte-g5au2j">Cancel</button> <button type="button" class="modal-btn delete svelte-g5au2j"> </button></div></div></div>'),an=n('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div> <!>',1);function Sn(Re,i){Yt(i,!0);const g=()=>us(_s,"$page",S),[S,E]=cs();let B=null,K=null,r=U(null),P=U(null),q=U(null),Q=$e([]),ce=U(!0),Be=U(null),M=U(!1),X=U(!1),J=U(!1),ne=U(!1),R=U(!1),$=U(!1),ee=U(!1),le=L(()=>parseInt(g().params.id??"0"));const O=["planning","brewing","fermenting","conditioning","completed","archived"];let V=L(()=>e(r)?Fa[e(r).status]:Fa.planning),ae=L(Aa),te=L(()=>qa.config.ha_enabled&&qa.config.temp_control_enabled&&(e(r)?.heater_entity_id||e(r)?.cooler_entity_id)),ue=L(()=>(e(r)?.status==="planning"||e(r)?.status==="brewing")&&e(r)?.temp_target!=null),ge=L(()=>!e(ue)||!e(se)?.temp||!e(r)?.temp_target?!1:e(se).temp<=e(r).temp_target),qe=L(()=>{if(!e(ue)||!e(se)?.temp||!e(r)?.temp_target)return null;const _=e(r).temp_target+30,j=e(se).temp,T=e(r).temp_target;if(j<=T)return 100;if(j>=_)return 0;const D=(_-j)/(_-T)*100;return Math.min(100,Math.max(0,D))}),se=L(()=>{if(!e(r)?.device_id)return null;const _=Va.tilts.get(e(r).device_id);if(_)return _;const j=e(r).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!j?.[1])return null;const T=j[1].toUpperCase();for(const D of Va.tilts.values())if(D.color&&D.color.toUpperCase()===T)return D;return null});async function w(){d(ce,!0),d(Be,null);try{if(d(r,await ws(e(le)),!0),e(r).status==="fermenting"||e(r).status==="conditioning"||e(r).status==="completed")try{d(P,await Ca(e(le)),!0)}catch{}if(e(r).heater_entity_id||e(r).cooler_entity_id)try{d(q,await ja(e(le)),!0)}catch{}}catch(_){d(Be,_ instanceof Error?_.message:"Failed to load batch",!0)}finally{d(ce,!1)}}async function m(_){if(!(!e(r)||e(X))&&!(_==="conditioning"&&e(r).status==="fermenting"&&!confirm(`üí° Entering Conditioning Phase

Reminder: Adjust target temperature if cold crashing.
Temperature control will continue during conditioning.

Continue?`))){d(X,!0);try{d(r,await ua(e(r).id,{status:_}),!0),(_==="fermenting"||_==="conditioning")&&d(P,await Ca(e(r).id),!0)}catch(j){console.error("Failed to update status:",j)}finally{d(X,!1)}}}async function x(){if(!(!e(r)||e(X))){d(X,!0);try{d(r,await ua(e(r).id,{status:"brewing"}),!0)}catch(_){console.error("Failed to start brew day:",_)}finally{d(X,!1)}}}async function b(){if(!(!e(r)||e(X))){d(X,!0);try{d(r,await ua(e(r).id,{status:"fermenting"}),!0),d(P,await Ca(e(r).id),!0)}catch(_){console.error("Failed to start fermentation:",_)}finally{d(X,!1)}}}async function h(_){if(e(r)&&(d(r,await ua(e(r).id,_),!0),d(M,!1),e(r).heater_entity_id||e(r).cooler_entity_id))try{d(q,await ja(e(r).id),!0)}catch{}}async function p(){if(e(r)){d(R,!0);try{await js(e(r).id),ps("/batches")}catch(_){d(Be,_ instanceof Error?_.message:"Failed to delete batch",!0),d(R,!1),d(ne,!1)}}}async function u(){if(!(!e(r)||e(ee))){d(ee,!0);try{d(r,await ua(e(r).id,{readings_paused:!e(r).readings_paused}),!0)}catch(_){console.error("Failed to toggle pause:",_)}finally{d(ee,!1)}}}async function f(_,j){if(!(!e(r)||e(J))){d(J,!0);try{await Ba(e(r).id,j,60,_),d(q,await ja(e(r).id),!0)}catch(T){console.error("Failed to set override:",T)}finally{d(J,!1)}}}async function k(){if(!(!e(r)||e(J))){d(J,!0);try{e(r).heater_entity_id&&await Ba(e(r).id,null,60,"heater"),e(r).cooler_entity_id&&await Ba(e(r).id,null,60,"cooler"),d(q,await ja(e(r).id),!0)}catch(_){console.error("Failed to clear overrides:",_)}finally{d(J,!1)}}}function y(){if(B?.readyState===WebSocket.OPEN)return;const j=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;B=new WebSocket(j),B.onmessage=async T=>{try{const D=JSON.parse(T.data);D.type==="control_event"&&D.batch_id===e(le)&&e(q)&&(D.action==="heat_on"?d(q,{...e(q),heater_state:"on"},!0):D.action==="heat_off"?d(q,{...e(q),heater_state:"off"},!0):D.action==="cool_on"?d(q,{...e(q),cooler_state:"on"},!0):D.action==="cool_off"&&d(q,{...e(q),cooler_state:"off"},!0))}catch{}},B.onclose=()=>{B=null,K=setTimeout(y,3e3)},B.onerror=()=>{B?.close()}}function F(){K&&(clearTimeout(K),K=null),B?.close(),B=null}function H(_){return _==null?"--":Bt(_)}function N(_){return _==null?"--":Sa(_)}function _e(_){return _?new Date(_).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"--"}function re(_){if(!_)return"--";const j=new Date(_),D=(new Date().getTime()-j.getTime())/(1e3*60*60);if(D<1)return`${Math.round(D*60)}m`;if(D<24)return`${D.toFixed(1)}h`;const W=D/24;return W<7?`${W.toFixed(1)}d`:`${Math.round(W)}d`}function he(_){return _?new Date(_).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"}):"--"}Xa(()=>{w(),y()}),ls(()=>{F()});var ve=an();vs("g5au2j",_=>{is(()=>{ns.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var Se=ie(ve),Fe=s(a(Se),2);{var ze=_=>{var j=ei();l(_,j)},Ge=_=>{var j=He(),T=ie(j);{var D=Y=>{var oe=ti(),be=s(a(oe),2),ke=a(be,!0);t(be);var we=s(be,2);we.__click=w,t(oe),c(()=>o(ke,e(Be))),l(Y,oe)},W=Y=>{var oe=He(),be=ie(oe);{var ke=Ye=>{var wt=ai();l(Ye,wt)},we=Ye=>{var wt=He(),bt=ie(wt);{var Rt=z=>{qs(z,{get batch(){return e(r)},onSubmit:h,onCancel:()=>d(M,!1)})},C=z=>{var ye=en(),G=ie(ye),de=a(G),A=a(de),I=a(A);t(A);var xe=s(A,2),De=a(xe),Ke=a(De,!0);t(De);var Ie=s(De,2);{var We=Ae=>{var je=ri(),Ee=a(je),st=s(Ee);{var _t=dt=>{var tt=si(),gt=a(tt);t(tt),c(()=>o(gt,`(${e(r).recipe.type??""})`)),l(dt,tt)};v(st,dt=>{e(r).recipe.type&&dt(_t)})}t(je),c(()=>{aa(je,"href",`/recipes/${e(r).recipe.id??""}`),o(Ee,`${e(r).recipe.name??""} `)}),l(Ae,je)};v(Ie,Ae=>{e(r).recipe&&Ae(We)})}var Ne=s(Ie,2);{var Ze=Ae=>{var je=li(),Ee=a(je);t(je),c((st,_t)=>o(Ee,`Started ${st??""} ¬∑ ${_t??""} ago`),[()=>_e(e(r).start_time),()=>re(e(r).start_time)]),l(Ae,je)},et=Ae=>{var je=He(),Ee=ie(je);{var st=_t=>{var dt=ii(),tt=a(dt);t(dt),c(gt=>o(tt,`Brewed ${gt??""}`),[()=>_e(e(r).brew_date)]),l(_t,dt)};v(Ee,_t=>{e(r).brew_date&&_t(st)},!0)}l(Ae,je)};v(Ne,Ae=>{e(r).start_time?Ae(Ze):Ae(et,!1)})}t(xe),t(de);var at=s(de,2),ft=a(at),Pe=a(ft);Pe.__change=Ae=>m(Ae.currentTarget.value),Pt(Pe,21,()=>O,ta,(Ae,je)=>{var Ee=ni(),st=a(Ee,!0);t(Ee);var _t={};c(()=>{o(st,Fa[e(je)].label),_t!==(_t=e(je))&&(Ee.value=(Ee.__value=e(je))??"")}),l(Ae,Ee)}),t(Pe);var yt;os(Pe),t(ft);var Me=s(ft,2);{var Qe=Ae=>{var je=di();let Ee;je.__click=u;var st=a(je);{var _t=tt=>{var gt=vi();fe(),l(tt,gt)},dt=tt=>{var gt=oi();fe(),l(tt,gt)};v(st,tt=>{e(r).readings_paused?tt(_t):tt(dt,!1)})}t(je),c(()=>{Ee=Le(je,1,"pause-btn svelte-g5au2j",null,Ee,{paused:e(r).readings_paused}),je.disabled=e(ee),aa(je,"title",e(r).readings_paused?"Resume storing readings":"Pause storing readings")}),l(Ae,je)};v(Me,Ae=>{(e(r).status==="fermenting"||e(r).status==="conditioning")&&Ae(Qe)})}var Nt=s(Me,2);Nt.__click=()=>d(M,!0);var pa=s(Nt,2);pa.__click=()=>d(ne,!0),t(at),t(G);var Pa=s(G,2);{var Ya=Ae=>{var je=mi();let Ee;var st=a(je),_t=a(st);{var dt=Z=>{var Ue=ci();fe(2),l(Z,Ue)},tt=Z=>{var Ue=ui();fe(2),l(Z,Ue)};v(_t,Z=>{e(ge)?Z(dt):Z(tt,!1)})}t(st);var gt=s(st,2),ra=a(gt),pt=a(ra),ht=s(a(pt),2),It=a(ht,!0);t(ht),t(pt);var Ot=s(pt,4),Ut=s(a(Ot),2),Qt=a(Ut,!0);t(Ut),t(Ot),t(ra);var Zt=s(ra,2);{var fa=Z=>{var Ue=_i(),xt=a(Ue),qt=a(xt);t(xt);var zt=s(xt,2),it=a(zt);t(zt),t(Ue),c(nt=>{Ft(qt,`width: ${e(qe)??""}%`),o(it,`${nt??""}% to target`)},[()=>Math.round(e(qe))]),l(Z,Ue)};v(Zt,Z=>{e(qe)!=null&&!e(ge)&&Z(fa)})}var Lt=s(Zt,2),la=a(Lt);{var va=Z=>{var Ue=pi();l(Z,Ue)},ia=Z=>{var Ue=He(),xt=ie(Ue);{var qt=it=>{var nt=fi();l(it,nt)},zt=it=>{var nt=He(),ut=ie(nt);{var Ce=vt=>{var Ve=gi();l(vt,Ve)},Xe=vt=>{var Ve=hi();l(vt,Ve)};v(ut,vt=>{e(ge)?vt(Ce):vt(Xe,!1)},!0)}l(it,nt)};v(xt,it=>{!qa.config.ha_enabled||!qa.config.temp_control_enabled?it(qt):it(zt,!1)},!0)}l(Z,Ue)};v(la,Z=>{e(r).cooler_entity_id?Z(ia,!1):Z(va)})}t(Lt),t(gt),t(je),c((Z,Ue)=>{Ee=Le(je,1,"chilling-banner svelte-g5au2j",null,Ee,{ready:e(ge)}),o(It,Z),o(Qt,Ue)},[()=>e(se)?.temp!=null?N(e(se).temp):"--",()=>e(r).temp_target!=null?N(e(r).temp_target):"--"]),l(Ae,je)};v(Pa,Ae=>{e(ue)&&Ae(Ya)})}var Ra=s(Pa,2);{var Ka=Ae=>{var je=bi(),Ee=s(a(je),4);Ee.__click=u;var st=a(Ee,!0);t(Ee),t(je),c(()=>{Ee.disabled=e(ee),o(st,e(ee)?"Resuming...":"Resume Readings")}),l(Ae,je)};v(Ra,Ae=>{e(r).readings_paused&&(e(r).status==="fermenting"||e(r).status==="conditioning")&&Ae(Ka)})}var Qa=s(Ra,2);{var Za=Ae=>{var je=ki(),Ee=a(je),st=s(a(Ee),6);st.__click=x;var _t=a(st);{var dt=pt=>{var ht=yi();fe(),l(pt,ht)},tt=pt=>{var ht=xi();fe(),l(pt,ht)};v(_t,pt=>{e(X)?pt(dt):pt(tt,!1)})}t(st),t(Ee);var gt=s(Ee,2);{var ra=pt=>{za(pt,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(gt,pt=>{e(r).recipe&&pt(ra)})}t(je),c(()=>st.disabled=e(X)),l(Ae,je)},$a=Ae=>{var je=He(),Ee=ie(je);{var st=dt=>{var tt=zi(),gt=a(tt);{var ra=Z=>{var Ue=ji(),xt=s(a(Ue),6),qt=a(xt),zt=s(a(qt),2),it=a(zt,!0);t(zt),t(qt);var nt=s(qt,4),ut=s(a(nt),2),Ce=a(ut,!0);t(ut),t(nt),t(xt);var Xe=s(xt,2);{var vt=Ve=>{var ct=wi(),rt=a(ct),Et=a(rt);t(rt);var $t=s(rt,2),ga=a($t);t($t),t(ct),c(oa=>{Ft(Et,`width: ${e(qe)??""}%`),o(ga,`${oa??""}% to pitch temp`)},[()=>Math.round(e(qe))]),l(Ve,ct)};v(Xe,Ve=>{e(qe)!=null&&Ve(vt)})}t(Ue),c((Ve,ct)=>{o(it,Ve),o(Ce,ct)},[()=>e(se)?.temp!=null?N(e(se).temp):"--",()=>e(r).temp_target!=null?N(e(r).temp_target):"--"]),l(Z,Ue)},pt=Z=>{var Ue=He(),xt=ie(Ue);{var qt=it=>{var nt=Mi(),ut=s(a(nt),4),Ce=a(ut);t(ut);var Xe=s(ut,2);Xe.__click=b;var vt=a(Xe);{var Ve=rt=>{var Et=qi();fe(),l(rt,Et)},ct=rt=>{var Et=Si();fe(),l(rt,Et)};v(vt,rt=>{e(X)?rt(Ve):rt(ct,!1)})}t(Xe),t(nt),c(rt=>{o(Ce,`Wort has reached pitch temperature (${rt??""}${e(ae)??""}).
							Pitch the yeast and start fermentation.`),Xe.disabled=e(X)},[()=>N(e(r).temp_target)]),l(it,nt)},zt=it=>{var nt=Fi(),ut=s(a(nt),6);ut.__click=b;var Ce=a(ut);{var Xe=Ve=>{var ct=Ci();fe(),l(Ve,ct)},vt=Ve=>{var ct=Bi();fe(),l(Ve,ct)};v(Ce,Ve=>{e(X)?Ve(Xe):Ve(vt,!1)})}t(ut),t(nt),c(()=>ut.disabled=e(X)),l(it,nt)};v(xt,it=>{e(ue)&&e(ge)?it(qt):it(zt,!1)},!0)}l(Z,Ue)};v(gt,Z=>{e(ue)&&!e(ge)?Z(ra):Z(pt,!1)})}var ht=s(gt,2),It=a(ht);{var Ot=Z=>{rl(Z,{get batch(){return e(r)},get recipe(){return e(r).recipe}})};v(It,Z=>{e(r).recipe&&Z(Ot)})}var Ut=s(It,2);{var Qt=Z=>{dl(Z,{get recipe(){return e(r).recipe},get batchId(){return e(r).id}})};v(Ut,Z=>{e(r).recipe&&Z(Qt)})}t(ht);var Zt=s(ht,2);{var fa=Z=>{Fl(Z,{get batch(){return e(r)},get recipe(){return e(r).recipe},onUpdate:Ue=>d(r,Ue,!0)})};v(Zt,Z=>{e(r).recipe&&Z(fa)})}var Lt=s(Zt,2);{var la=Z=>{Ha(Z,{get batch(){return e(r)},get liveReading(){return e(se)},onEdit:()=>d(M,!0)})};v(Lt,Z=>{e(r).device_id&&Z(la)})}var va=s(Lt,2);{var ia=Z=>{za(Z,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(va,Z=>{e(r).recipe&&Z(ia)})}t(tt),l(dt,tt)},_t=dt=>{var tt=He(),gt=ie(tt);{var ra=ht=>{var It=Ni(),Ot=a(It),Ut=s(a(Ot),2),Qt=a(Ut),Zt=s(a(Qt),2),fa=a(Zt,!0);t(Zt),t(Qt);var Lt=s(Qt,2),la=s(a(Lt),2),va=a(la,!0);t(la),t(Lt);var ia=s(Lt,2),Z=s(a(ia),2),Ue=a(Z);t(Z),t(ia);var xt=s(ia,2),qt=s(a(xt),2),zt=a(qt);{var it=pe=>{var Oe=ea();c(Je=>o(Oe,`${Je??""}%`),[()=>((e(r).measured_og-e(r).measured_fg)/(e(r).measured_og-1)*100).toFixed(0)]),l(pe,Oe)},nt=pe=>{var Oe=ea("--");l(pe,Oe)};v(zt,pe=>{e(r).measured_og&&e(r).measured_fg?pe(it):pe(nt,!1)})}t(qt),t(xt),t(Ut),t(Ot);var ut=s(Ot,2),Ce=s(a(ut),2),Xe=a(Ce);{var vt=pe=>{var Oe=Ti(),Je=s(a(Oe),2),lt=s(a(Je),2),Dt=a(lt,!0);t(lt),t(Je),t(Oe),c(St=>o(Dt,St),[()=>he(e(r).brewing_started_at||e(r).brew_date)]),l(pe,Oe)};v(Xe,pe=>{(e(r).brew_date||e(r).brewing_started_at)&&pe(vt)})}var Ve=s(Xe,2);{var ct=pe=>{var Oe=Di(),Je=s(a(Oe),2),lt=s(a(Je),2),Dt=a(lt,!0);t(lt),t(Je),t(Oe),c(St=>o(Dt,St),[()=>he(e(r).fermenting_started_at||e(r).start_time)]),l(pe,Oe)};v(Ve,pe=>{(e(r).start_time||e(r).fermenting_started_at)&&pe(ct)})}var rt=s(Ve,2);{var Et=pe=>{var Oe=Ai(),Je=s(a(Oe),2),lt=s(a(Je),2),Dt=a(lt,!0);t(lt),t(Je),t(Oe),c(St=>o(Dt,St),[()=>he(e(r).conditioning_started_at)]),l(pe,Oe)};v(rt,pe=>{e(r).conditioning_started_at&&pe(Et)})}var $t=s(rt,2);{var ga=pe=>{var Oe=Pi(),Je=s(a(Oe),2),lt=s(a(Je),2),Dt=a(lt,!0);t(lt),t(Je),t(Oe),c(St=>o(Dt,St),[()=>he(e(r).completed_at||e(r).end_time)]),l(pe,Oe)};v($t,pe=>{(e(r).end_time||e(r).completed_at)&&pe(ga)})}var oa=s($t,2);{var wa=pe=>{var Oe=Ri(),Je=s(a(Oe),2),lt=a(Je),Dt=a(lt);t(lt);var St=s(lt,2),mt=a(St,!0);t(St),t(Je),t(Oe),c(kt=>{o(Dt,`Packaged (${(e(r).packaging_type||"kegged")??""})`),o(mt,kt)},[()=>he(e(r).packaged_at)]),l(pe,Oe)};v(oa,pe=>{e(r).packaged_at&&pe(wa)})}t(Ce),t(ut);var Gt=s(ut,2);Ll(Gt,{get batch(){return e(r)},onUpdate:pe=>d(r,pe,!0)});var ot=s(Gt,2);$l(ot,{get batch(){return e(r)},onUpdate:pe=>d(r,pe,!0)});var Tt=s(ot,2);{var ha=pe=>{Wa(pe,{get notes(){return e(r).notes}})};v(Tt,pe=>{e(r).notes&&pe(ha)})}t(It),c((pe,Oe,Je)=>{o(fa,pe),o(va,Oe),o(Ue,`${Je??""}%`)},[()=>H(e(r).measured_og),()=>H(e(r).measured_fg),()=>e(r).measured_abv?.toFixed(1)??"--"]),l(ht,It)},pt=ht=>{var It=$i(),Ot=ie(It),Ut=a(Ot),Qt=a(Ut);{let Ce=L(()=>e(se)?.sg??e(P)?.measured?.current_sg);Is(Qt,{get batch(){return e(r)},get currentSg(){return e(Ce)},get progress(){return e(P)},get liveReading(){return e(se)}})}var Zt=s(Qt,2);{var fa=Ce=>{za(Ce,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(Zt,Ce=>{e(r).recipe&&Ce(fa)})}t(Ut);var Lt=s(Ut,2),la=a(Lt);Ha(la,{get batch(){return e(r)},get liveReading(){return e(se)},onEdit:()=>d(M,!0)});var va=s(la,2);{var ia=Ce=>{Hr(Ce,{get batchId(){return e(r).id}})};v(va,Ce=>{(e(r).status==="fermenting"||e(r).status==="conditioning")&&Ce(ia)})}var Z=s(va,2);{let Ce=L(()=>e(r).measured_fg??e(P)?.measured?.fg),Xe=L(()=>e(se)?.sg??e(P)?.measured?.current_sg);Nr(Z,{get batchId(){return e(r).id},get batchStatus(){return e(r).status},get measuredOg(){return e(r).measured_og},get measuredFg(){return e(Ce)},get currentSg(){return e(Xe)},get liveReading(){return e(se)}})}var Ue=s(Z,2);{var xt=Ce=>{var Xe=Ji();let vt;var Ve=a(Xe);Ve.__click=()=>d($,!e($));var ct=s(a(Ve),2),rt=a(ct);{var Et=ot=>{var Tt=Oi();l(ot,Tt)},$t=ot=>{var Tt=He(),ha=ie(Tt);{var pe=Je=>{var lt=Li();l(Je,lt)},Oe=Je=>{var lt=He(),Dt=ie(lt);{var St=mt=>{var kt=Ei(),Vt=a(kt);t(kt),c(Ht=>o(Vt,`üéØ ${Ht??""}${e(ae)??""}`),[()=>N(e(q).target_temp)]),l(mt,kt)};v(Dt,mt=>{e($)&&e(q)&&mt(St)},!0)}l(Je,lt)};v(ha,Je=>{e(q)?.cooler_state==="on"?Je(pe):Je(Oe,!1)},!0)}l(ot,Tt)};v(rt,ot=>{e(q)?.heater_state==="on"?ot(Et):ot($t,!1)})}var ga=s(rt,2);let oa;t(ct),t(Ve);var wa=s(Ve,2);{var Gt=ot=>{var Tt=Xi(),ha=ie(Tt),pe=a(ha);{var Oe=mt=>{var kt=Gi(),Vt=a(kt);let Ht;var da=s(Vt,2),Wt=s(a(da),2);let ca;var ya=a(Wt,!0);t(Wt);var ma=s(Wt,2),xa=a(ma,!0);t(ma),t(da),t(kt),c(()=>{Ht=Le(Vt,1,"device-icon-wrap svelte-g5au2j",null,Ht,{active:e(q)?.heater_state==="on"}),ca=Le(Wt,1,"device-state svelte-g5au2j",null,ca,{on:e(q)?.heater_state==="on"}),o(ya,e(q)?.heater_state==="on"?"ON":"OFF"),o(xa,e(r).heater_entity_id)}),l(mt,kt)};v(pe,mt=>{e(r).heater_entity_id&&mt(Oe)})}var Je=s(pe,2);{var lt=mt=>{var kt=Ii(),Vt=a(kt);let Ht;var da=s(Vt,2),Wt=s(a(da),2);let ca;var ya=a(Wt,!0);t(Wt);var ma=s(Wt,2),xa=a(ma,!0);t(ma),t(da),t(kt),c(()=>{Ht=Le(Vt,1,"device-icon-wrap svelte-g5au2j",null,Ht,{active:e(q)?.cooler_state==="on"}),ca=Le(Wt,1,"device-state svelte-g5au2j",null,ca,{on:e(q)?.cooler_state==="on"}),o(ya,e(q)?.cooler_state==="on"?"ON":"OFF"),o(xa,e(r).cooler_entity_id)}),l(mt,kt)};v(Je,mt=>{e(r).cooler_entity_id&&mt(lt)})}t(ha);var Dt=s(ha,2);{var St=mt=>{var kt=Wi(),Vt=ie(kt),Ht=a(Vt),da=s(a(Ht),2),Wt=a(da);t(da),t(Ht);var ca=s(Ht,2),ya=s(a(ca),2),ma=a(ya);t(ya),t(ca),t(Vt);var xa=s(Vt,2);{var es=At=>{var Xt=Ui(),Jt=s(a(Xt),2),ba=a(Jt);t(Jt);var Ia=s(Jt,2);Ia.__click=()=>k(),t(Xt),c(ss=>{o(ba,`Override active: ${ss??""}`),Ia.disabled=e(J)},[()=>e(q).override_state?.toUpperCase()]),l(At,Xt)};v(xa,At=>{e(q).override_active&&At(es)})}var Na=s(xa,2),Oa=s(a(Na),2),La=a(Oa);{var ts=At=>{var Xt=Vi(),Jt=ie(Xt);Jt.__click=()=>f("heater","on");var ba=s(Jt,2);ba.__click=()=>f("heater","off"),c(()=>{Jt.disabled=e(J),ba.disabled=e(J)}),l(At,Xt)};v(La,At=>{e(r).heater_entity_id&&At(ts)})}var Ea=s(La,2);{var as=At=>{var Xt=Hi(),Jt=ie(Xt);Jt.__click=()=>f("cooler","on");var ba=s(Jt,2);ba.__click=()=>f("cooler","off"),c(()=>{Jt.disabled=e(J),ba.disabled=e(J)}),l(At,Xt)};v(Ea,At=>{e(r).cooler_entity_id&&At(as)})}var Ga=s(Ea,2);Ga.__click=()=>k(),t(Oa),t(Na),c((At,Xt)=>{o(Wt,`${At??""}${e(ae)??""}`),o(ma,`¬±${Xt??""}${e(ae)??""}`),Ga.disabled=e(J)},[()=>N(e(q).target_temp),()=>e(q).hysteresis?.toFixed(1)||"--"]),l(mt,kt)};v(Dt,mt=>{e(q)&&mt(St)})}l(ot,Tt)};v(wa,ot=>{e($)||ot(Gt)})}t(Xe),c(()=>{vt=Le(Xe,1,"info-card temp-control-card svelte-g5au2j",null,vt,{"heater-on":e(q)?.heater_state==="on","cooler-on":e(q)?.cooler_state==="on",collapsed:e($)}),oa=Le(ga,0,"chevron svelte-g5au2j",null,oa,{rotated:!e($)})}),l(Ce,Xe)},qt=Ce=>{var Xe=He(),vt=ie(Xe);{var Ve=ct=>{var rt=Qi(),Et=s(a(rt),2),$t=a(Et);{var ga=Gt=>{var ot=Yi(),Tt=a(ot);t(ot),c(()=>o(Tt,`Heater: ${e(r).heater_entity_id??""}`)),l(Gt,ot)};v($t,Gt=>{e(r).heater_entity_id&&Gt(ga)})}var oa=s($t,2);{var wa=Gt=>{var ot=Ki(),Tt=a(ot);t(ot),c(()=>o(Tt,`Cooler: ${e(r).cooler_entity_id??""}`)),l(Gt,ot)};v(oa,Gt=>{e(r).cooler_entity_id&&Gt(wa)})}fe(2),t(Et),t(rt),l(ct,rt)};v(vt,ct=>{(e(r).heater_entity_id||e(r).cooler_entity_id)&&e(r).status!=="fermenting"&&ct(Ve)},!0)}l(Ce,Xe)};v(Ue,Ce=>{e(te)&&(e(r).status==="fermenting"||e(r).status==="conditioning")?Ce(xt):Ce(qt,!1)})}var zt=s(Ue,2);{var it=Ce=>{Wa(Ce,{get notes(){return e(r).notes}})};v(zt,Ce=>{e(r).notes&&Ce(it)})}t(Lt),t(Ot);var nt=s(Ot,2);{var ut=Ce=>{var Xe=Zi(),vt=a(Xe);Ms(vt,{get batchId(){return e(r).id},get deviceColor(){return e(r).device_id},get originalGravity(){return e(r).measured_og},get controlEvents(){return Q}}),t(Xe),l(Ce,Xe)};v(nt,Ce=>{e(r).device_id&&Ce(ut)})}l(ht,It)};v(gt,ht=>{e(r).status==="completed"?ht(ra):ht(pt,!1)},!0)}l(dt,tt)};v(Ee,dt=>{e(r).status==="brewing"?dt(st):dt(_t,!1)},!0)}l(Ae,je)};v(Qa,Ae=>{e(r).status==="planning"?Ae(Za):Ae($a,!1)})}c(()=>{o(I,`#${(e(r).batch_number||"?")??""}`),o(Ke,e(r).name||e(r).recipe?.name||"Unnamed Batch"),Pe.disabled=e(X),Ft(Pe,`color: ${e(V).color??""}; background: ${e(V).bg??""};`),yt!==(yt=e(r).status)&&(Pe.value=(Pe.__value=e(r).status)??"",ds(Pe,e(r).status))}),l(z,ye)};v(bt,z=>{e(M)?z(Rt):z(C,!1)},!0)}l(Ye,wt)};v(be,Ye=>{e(r)?Ye(we,!1):Ye(ke)},!0)}l(Y,oe)};v(T,Y=>{e(Be)?Y(D):Y(W,!1)},!0)}l(_,j)};v(Fe,_=>{e(ce)?_(ze):_(Ge,!1)})}t(Se);var Te=s(Se,2);{var me=_=>{var j=tn();j.__click=()=>d(ne,!1),j.__keydown=we=>we.key==="Escape"&&d(ne,!1);var T=a(j);T.__click=we=>we.stopPropagation(),T.__keydown=we=>we.stopPropagation();var D=s(a(T),2),W=a(D);t(D);var Y=s(D,2),oe=a(Y);oe.__click=()=>d(ne,!1);var be=s(oe,2);be.__click=p;var ke=a(be,!0);t(be),t(Y),t(T),t(j),c(()=>{o(W,`Are you sure you want to delete "${(e(r)?.name||"this batch")??""}"? This cannot be undone.`),oe.disabled=e(R),be.disabled=e(R),o(ke,e(R)?"Deleting...":"Delete Batch")}),l(_,j)};v(Te,_=>{e(ne)&&_(me)})}l(Re,ve),Kt(),E()}sa(["click","change","keydown"]);export{Sn as component,qn as universal};
