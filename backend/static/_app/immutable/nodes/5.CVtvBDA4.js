import{d as Jt,f as n,s as c,a as i,c as we,t as It,h as Yt}from"../chunks/orbuQWWI.js";import{d as a,e as s,r as t,t as p,a as Ot,f as W,h as e,u as A,n as ze,g as Et,s as pe,p as na,o as Aa,c as d,az as ha,b9 as $a,ay as es,aJ as ts,aC as as,ax as ss}from"../chunks/pAodAtlG.js";import{e as Wt,i as va}from"../chunks/0whDC7Rl.js";import{i as v}from"../chunks/ucc1DXe2.js";import{h as rs}from"../chunks/DJBMpqSf.js";import{s as Mt,r as Fa,a as is}from"../chunks/CYuZshLQ.js";import{s as Ee}from"../chunks/Cpbxxhlc.js";import{s as rt}from"../chunks/C-5oeV0L.js";import{b as ls,i as ns,s as vs}from"../chunks/RboyDiSx.js";import{s as os,a as ds}from"../chunks/BkeTWnxc.js";import{p as cs}from"../chunks/Dwut1BaV.js";import{g as us}from"../chunks/BskkZCIj.js";import{a8 as _s,a9 as ps,aa as gs,ab as ms,ac as fs,X as hs,S as pa,ad as oa,a3 as bs,Q as la,ae as ga}from"../chunks/BKVJalqB.js";import{d as ta,e as Pa,g as Ia,c as da}from"../chunks/D9t2HWx4.js";import{t as Ra}from"../chunks/DWpXqN03.js";import{B as ys}from"../chunks/D0ubrFx-.js";import{s as xs}from"../chunks/GbV1md6Y.js";import{p as Vt}from"../chunks/C44MPb_E.js";import{F as ks}from"../chunks/Bb2uDevi.js";import{b as js}from"../chunks/Dh5hCwq1.js";import{s as ma}from"../chunks/BkabqQ1A.js";const ws=!1,_l=Object.freeze(Object.defineProperty({__proto__:null,prerender:ws},Symbol.toStringTag,{value:"Module"}));function zs(ke){return ke>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:ke>=-60?{bars:3,color:"var(--positive)",label:"Good"}:ke>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function Oa(ke){const l=Math.floor((Date.now()-new Date(ke).getTime())/1e3);if(l<10)return"just now";if(l<60)return`${l}s ago`;const m=Math.floor(l/60);if(m<60)return`${m}m ago`;const k=Math.floor(m/60);return k<24?`${k}h ago`:`${Math.floor(k/24)}d ago`}var Cs=n('<div class="accent-bar svelte-1oyrwd9"></div>'),qs=n('<span class="card-icon svelte-1oyrwd9"> </span>'),Ss=n('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),Ms=n('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function aa(ke,l){let m=Vt(l,"highlight",3,!1),k=Vt(l,"compact",3,!1),z=Vt(l,"collapsible",3,!1),x=Vt(l,"expanded",3,!1);var T=Ms();let r;var P=a(T);{var C=M=>{var S=Cs();i(M,S)};v(P,M=>{m()&&M(C)})}var de=s(P,2),be=a(de),fe=a(be);{var I=M=>{var S=qs(),le=a(S,!0);t(S),p(()=>c(le,l.icon)),i(M,S)};v(fe,M=>{l.icon&&M(I)})}var J=s(fe,2),ae=a(J,!0);t(J),t(be);var ie=s(be,2);{var w=M=>{var S=Ss();S.__click=function(...b){l.onToggle?.apply(this,b)};var le=a(S);let ee;t(S),p(()=>{Mt(S,"aria-label",x()?"Collapse":"Expand"),ee=Ee(le,0,"expand-icon svelte-1oyrwd9",null,ee,{"rotate-180":x()})}),i(M,S)};v(ie,M=>{z()&&l.onToggle&&M(w)})}t(de);var E=s(de,2);let Y;var K=a(E);xs(K,()=>l.children),t(E),t(T),p(()=>{r=Ee(T,1,"batch-card svelte-1oyrwd9",null,r,{highlight:m(),compact:k()}),c(ae,l.title),Y=Ee(E,1,"card-content svelte-1oyrwd9",null,Y,{collapsed:z()&&!x()})}),i(ke,T)}Jt(["click"]);var Bs=n('<span class="updated-text svelte-t80j9z"> </span>'),Fs=n('<div class="hero-divider svelte-t80j9z"></div> <div class="hero-metric temperature svelte-t80j9z"><span class="hero-value svelte-t80j9z"> <span class="hero-unit svelte-t80j9z"> </span></span> <span class="hero-label svelte-t80j9z">Temperature</span></div>',1),Rs=n('<div class="remaining-text svelte-t80j9z"> </div>'),Ts=n('<div class="progress-section svelte-t80j9z"><div class="progress-labels svelte-t80j9z"><div class="progress-endpoint start svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">OG</span></div> <div class="progress-current svelte-t80j9z"><span class="current-percent svelte-t80j9z"> </span></div> <div class="progress-endpoint end svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">Target FG</span></div></div> <div class="progress-track svelte-t80j9z"><div class="progress-fill svelte-t80j9z"></div> <div><div class="marker-dot svelte-t80j9z"></div> <div class="marker-value svelte-t80j9z"> </div></div></div> <!></div>'),Ds=n('<div class="metrics-row svelte-t80j9z"><div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">ABV</span></div> <div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">Attenuation</span></div></div>'),As=n('<div class="status-row svelte-t80j9z"><div class="live-indicator svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> <span class="status-text svelte-t80j9z">LIVE</span></div> <!></div> <div class="hero-section svelte-t80j9z"><div class="hero-metric gravity svelte-t80j9z"><span class="hero-value svelte-t80j9z"> </span> <span class="hero-label svelte-t80j9z">Gravity</span></div> <!></div> <!> <!>',1),Ps=n('<div class="completed-grid svelte-t80j9z"><div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Original Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Final Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">ABV</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Attenuation</span></div></div>'),Is=n('<div class="empty-state svelte-t80j9z"><div class="empty-icon svelte-t80j9z">‚óé</div> <p class="empty-text svelte-t80j9z">Set Original Gravity to track fermentation</p></div>');function Os(ke,l){Ot(l,!0);let m=A(()=>l.currentSg??l.progress?.measured?.current_sg),k=A(()=>l.liveReading?.temp??l.progress?.temperature?.current),z=A(()=>l.liveReading?.last_seen),x=A(()=>e(z)?Oa(e(z)):null),T=A(Ia),r=A(()=>{if(!l.batch.measured_og||!e(m))return null;const I=Math.max(0,(l.batch.measured_og-e(m))*131.25),J=l.batch.measured_og-1,ae=J!==0?Math.max(0,Math.min(100,(l.batch.measured_og-e(m))/J*100)):0;return{abv:I,attenuation:ae}}),P=A(()=>{const I=l.batch.measured_og,J=l.batch.recipe?.fg;if(!I||!J||!e(m))return null;const ae=I-J,ie=I-e(m);return ae<=0?null:Math.max(0,Math.min(100,ie/ae*100))}),C=A(()=>l.batch.status==="fermenting"||l.batch.status==="conditioning");function de(I){return I==null?"--":ta(I)}function be(I){return I==null?"--":`${I.toFixed(1)}%`}function fe(I){return I==null?"--":Pa(I)}aa(ke,{title:"Fermentation",children:(I,J)=>{var ae=we(),ie=W(ae);{var w=Y=>{var K=As(),M=W(K),S=s(a(M),2);{var le=y=>{var _=Bs(),h=a(_);t(_),p(()=>c(h,`Updated ${e(x)??""}`)),i(y,_)};v(S,y=>{e(x)&&y(le)})}t(M);var ee=s(M,2),b=a(ee),D=a(b),ce=a(D,!0);t(D),ze(2),t(b);var Q=s(b,2);{var o=y=>{var _=Fs(),h=s(W(_),2),j=a(h),R=a(j,!0),L=s(R),X=a(L,!0);t(L),t(j),ze(2),t(h),p(U=>{c(R,U),c(X,e(T))},[()=>fe(e(k))]),i(y,_)};v(Q,y=>{e(k)!=null&&y(o)})}t(ee);var u=s(ee,2);{var f=y=>{var _=Ts(),h=a(_),j=a(h),R=a(j),L=a(R,!0);t(R),ze(2),t(j);var X=s(j,2),U=a(X),ye=a(U);t(U),t(X);var ne=s(X,2),re=a(ne),ge=a(re,!0);t(re),ze(2),t(ne),t(h);var xe=s(h,2),Be=a(xe),Fe=s(Be,2);let qe;var Ce=s(a(Fe),2),Ne=a(Ce,!0);t(Ce),t(Fe),t(xe);var g=s(xe,2);{var Z=se=>{var O=Rs(),te=a(O);t(O),p(ve=>c(te,`${ve??""} points to go`),[()=>l.progress.progress.sg_remaining.toFixed(3)]),i(se,O)};v(g,se=>{l.progress?.progress?.sg_remaining!=null&&l.progress.progress.sg_remaining>0&&se(Z)})}t(_),p((se,O,te,ve)=>{c(L,se),c(ye,`${O??""}%`),c(ge,te),rt(Be,`width: ${e(P)??""}%`),qe=Ee(Fe,1,"progress-marker svelte-t80j9z",null,qe,{"at-start":e(P)<3}),rt(Fe,`left: ${e(P)??""}%`),c(Ne,ve)},[()=>de(l.batch.measured_og),()=>e(P).toFixed(0),()=>de(l.batch.recipe.fg),()=>de(e(m))]),i(y,_)};v(u,y=>{e(P)!==null&&l.batch.measured_og&&l.batch.recipe?.fg&&y(f)})}var N=s(u,2);{var ue=y=>{var _=Ds(),h=a(_),j=a(h),R=a(j,!0);t(j),ze(2),t(h);var L=s(h,2),X=a(L),U=a(X,!0);t(X),ze(2),t(L),t(_),p((ye,ne)=>{c(R,ye),c(U,ne)},[()=>be(e(r).abv),()=>be(e(r).attenuation)]),i(y,_)};v(N,y=>{e(r)&&y(ue)})}p(y=>c(ce,y),[()=>de(e(m))]),i(Y,K)},E=Y=>{var K=we(),M=W(K);{var S=ee=>{var b=Ps(),D=a(b),ce=a(D),Q=a(ce,!0);t(ce),ze(2),t(D);var o=s(D,2),u=a(o),f=a(u,!0);t(u),ze(2),t(o);var N=s(o,2),ue=a(N),y=a(ue,!0);t(ue),ze(2),t(N);var _=s(N,2),h=a(_),j=a(h,!0);t(h),ze(2),t(_),t(b),p((R,L,X,U)=>{c(Q,R),c(f,L),c(y,X),c(j,U)},[()=>de(l.batch.measured_og),()=>de(l.batch.measured_fg),()=>l.batch.measured_abv!=null?be(l.batch.measured_abv):"--",()=>l.batch.measured_attenuation!=null?be(l.batch.measured_attenuation):"--"]),i(ee,b)},le=ee=>{var b=Is();i(ee,b)};v(M,ee=>{l.batch.measured_og?ee(S):ee(le,!1)},!0)}i(Y,K)};v(ie,Y=>{e(m)&&e(C)?Y(w):Y(E,!1)})}i(I,ae)},$$slots:{default:!0}}),Et()}var Es=n('<span class="device-last-seen svelte-1kdxwtz"> </span>'),Ns=n('<div class="signal-bar svelte-1kdxwtz"></div>'),Ls=n('<div class="metric-item svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="metric-text svelte-1kdxwtz"> </span></div>'),Gs=n('<div class="metric-item battery svelte-1kdxwtz"><svg class="battery-icon svelte-1kdxwtz" viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="2" y="7" width="18" height="10" rx="2"></rect><rect x="4" y="9" height="6" stroke="none" rx="1"></rect><path d="M20 10v4h2v-4z" stroke="none"></path></svg> <span class="metric-text svelte-1kdxwtz"><!></span></div>'),Hs=n('<div class="device-metrics svelte-1kdxwtz"><!> <!></div>'),Us=n('<div class="device-row svelte-1kdxwtz"><div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!></div> <!>',1),Vs=n('<div class="device-row svelte-1kdxwtz"><div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <span class="device-last-seen svelte-1kdxwtz">No data</span></div>'),Ws=n('<div class="device-info svelte-1kdxwtz"><!></div>'),Js=n('<button type="button" class="link-btn svelte-1kdxwtz">Link device</button>'),Ys=n('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function Ta(ke,l){Ot(l,!0);let m=A(()=>l.liveReading?.device_type==="tilt"),k=A(()=>e(m)&&l.liveReading?.rssi?zs(l.liveReading.rssi):null),z=A(()=>l.liveReading?.last_seen?Oa(l.liveReading.last_seen):null),x=A(()=>l.liveReading?.battery_percent!=null||l.liveReading?.battery_voltage!=null),T=A(()=>l.liveReading?.battery_percent),r=A(()=>l.liveReading?.battery_voltage),P=A(()=>e(T)?e(T)>50?"var(--positive)":e(T)>20?"var(--warning)":"var(--negative)":"var(--text-muted)"),C=A(()=>{if(!l.liveReading)return l.batch.device_id||"Unknown";const de=l.liveReading.device_type;return de==="tilt"?`${l.liveReading.color} Tilt`:de==="gravitymon"?`GravityMon (${l.liveReading.id})`:de==="ispindel"?`iSpindel (${l.liveReading.id})`:de==="floaty"?`Floaty (${l.liveReading.id})`:l.liveReading.color||l.liveReading.id});aa(ke,{title:"Tracking Device",compact:!0,children:(de,be)=>{var fe=we(),I=W(fe);{var J=ie=>{var w=Ws(),E=a(w);{var Y=M=>{var S=Us(),le=W(S),ee=a(le),b=s(a(ee));t(ee);var D=s(ee,2);{var ce=u=>{var f=Es(),N=a(f,!0);t(f),p(()=>c(N,e(z))),i(u,f)};v(D,u=>{e(z)&&u(ce)})}t(le);var Q=s(le,2);{var o=u=>{var f=Hs(),N=a(f);{var ue=h=>{var j=Ls(),R=a(j);Wt(R,20,()=>Array(4),va,(U,ye,ne)=>{var re=Ns();p(()=>rt(re,`height: ${4+ne*2}px; background: ${(ne<e(k).bars?e(k).color:"var(--bg-hover)")??""}; opacity: ${ne<e(k).bars?1:.4};`)),i(U,re)}),t(R);var L=s(R,2),X=a(L);t(L),t(j),p(()=>{rt(L,`color: ${e(k).color??""}`),c(X,`${l.liveReading.rssi??""}dBm`)}),i(h,j)};v(N,h=>{e(k)&&h(ue)})}var y=s(N,2);{var _=h=>{var j=Gs(),R=a(j),L=s(a(R)),X=s(L);t(R);var U=s(R,2),ye=a(U);{var ne=ge=>{var xe=It();p(Be=>c(xe,`${Be??""}%`),[()=>e(T).toFixed(0)]),i(ge,xe)},re=ge=>{var xe=we(),Be=W(xe);{var Fe=qe=>{var Ce=It();p(Ne=>c(Ce,`${Ne??""}V`),[()=>e(r).toFixed(2)]),i(qe,Ce)};v(Be,qe=>{e(r)!=null&&qe(Fe)},!0)}i(ge,xe)};v(ye,ge=>{e(T)!=null?ge(ne):ge(re,!1)})}t(U),t(j),p(()=>{Mt(R,"stroke",e(P)),Mt(L,"width",(e(T)??50)*.14),Mt(L,"fill",e(P)),Mt(X,"fill",e(P)),rt(U,`color: ${e(P)??""}`)}),i(h,j)};v(y,h=>{e(x)&&h(_)})}t(f),i(u,f)};v(Q,u=>{(e(k)||e(x))&&u(o)})}p(()=>c(b,` ${e(C)??""}`)),i(M,S)},K=M=>{var S=Vs(),le=a(S),ee=s(a(le));t(le),ze(2),t(S),p(()=>c(ee,` ${l.batch.device_id??""}`)),i(M,S)};v(E,M=>{l.liveReading?M(Y):M(K,!1)})}t(w),i(ie,w)},ae=ie=>{var w=Ys(),E=s(a(w),2);{var Y=K=>{var M=Js();M.__click=function(...S){l.onEdit?.apply(this,S)},i(K,M)};v(E,K=>{l.onEdit&&K(Y)})}t(w),i(ie,w)};v(I,ie=>{l.batch.device_id?ie(J):ie(ae,!1)})}i(de,fe)},$$slots:{default:!0}}),Et()}Jt(["click"]);const Ks=131.25;var Qs=n('<span class="yeast-producer svelte-19u9n31"> </span>'),Xs=n('<span class="yeast-temp svelte-19u9n31"> </span>'),Zs=n('<div class="yeast-row recipe svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Recipe</span> <span class="yeast-value muted svelte-19u9n31"> </span></div>'),$s=n('<div class="yeast-row actual svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span> <!> <!></div> <!>',1),er=n('<div class="yeast-row svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span></div>'),tr=n('<div class="yeast-section svelte-19u9n31"><!></div>'),ar=n('<div class="targets-row svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div></div> <!>',1);function fa(ke,l){Ot(l,!0);function m(z){return z==null?"--":ta(z)}let k=A(()=>l.recipe.abv!=null?l.recipe.abv:l.recipe.og&&l.recipe.fg?(l.recipe.og-l.recipe.fg)*Ks:null);aa(ke,{title:"Recipe Targets",compact:!0,children:(z,x)=>{var T=ar(),r=W(T),P=a(r),C=s(a(P),2),de=a(C,!0);t(C),t(P);var be=s(P,2),fe=s(a(be),2),I=a(fe,!0);t(fe),t(be);var J=s(be,2),ae=s(a(J),2),ie=a(ae,!0);t(ae),t(J),t(r);var w=s(r,2);{var E=Y=>{var K=tr(),M=a(K);{var S=ee=>{var b=$s(),D=W(b),ce=s(a(D),2),Q=a(ce,!0);t(ce);var o=s(ce,2);{var u=_=>{var h=Qs(),j=a(h);t(h),p(()=>c(j,`(${l.yeastStrain.producer??""})`)),i(_,h)};v(o,_=>{l.yeastStrain.producer&&_(u)})}var f=s(o,2);{var N=_=>{var h=Xs(),j=a(h);t(h),p((R,L)=>c(j,`${R??""}-${L??""}¬∞C`),[()=>l.yeastStrain.temp_low.toFixed(0),()=>l.yeastStrain.temp_high.toFixed(0)]),i(_,h)};v(f,_=>{l.yeastStrain.temp_low&&l.yeastStrain.temp_high&&_(N)})}t(D);var ue=s(D,2);{var y=_=>{var h=Zs(),j=s(a(h),2),R=a(j,!0);t(j),t(h),p(()=>c(R,l.recipe.yeast_name)),i(_,h)};v(ue,_=>{l.recipe.yeast_name&&_(y)})}p(()=>c(Q,l.yeastStrain.name)),i(ee,b)},le=ee=>{var b=we(),D=W(b);{var ce=Q=>{var o=er(),u=s(a(o),2),f=a(u,!0);t(u),t(o),p(()=>c(f,l.recipe.yeast_name)),i(Q,o)};v(D,Q=>{l.recipe.yeast_name&&Q(ce)},!0)}i(ee,b)};v(M,ee=>{l.yeastStrain?ee(S):ee(le,!1)})}t(K),i(Y,K)};v(w,Y=>{(l.yeastStrain||l.recipe.yeast_name)&&Y(E)})}p((Y,K,M)=>{c(de,Y),c(I,K),c(ie,M)},[()=>m(l.recipe.og),()=>m(l.recipe.fg),()=>e(k)!=null?`${e(k).toFixed(1)}%`:"--"]),i(z,T)},$$slots:{default:!0}}),Et()}var sr=n('<p class="notes-content svelte-hkv31i"> </p>');function Da(ke,l){aa(ke,{title:"Notes",children:(m,k)=>{var z=sr(),x=a(z,!0);t(z),p(()=>c(x,l.notes)),i(m,z)},$$slots:{default:!0}})}var rr=n('<div class="ml-panel loading svelte-1xs394q"><p>Loading predictions...</p></div>'),ir=n('<div class="ml-panel error svelte-1xs394q"><p class="error-text svelte-1xs394q"> </p></div>'),lr=n("<option> </option>"),nr=n('<span class="anomaly-reasons svelte-1xs394q"> </span>'),vr=n('<div class="anomaly-banner svelte-1xs394q"><span class="anomaly-icon svelte-1xs394q">‚ö†Ô∏è</span> <div class="anomaly-content svelte-1xs394q"><span class="anomaly-label svelte-1xs394q">Anomaly Detected</span> <!></div></div>'),or=n('<span class="activity-badge svelte-1xs394q"> </span>'),dr=n('<div class="progress-section svelte-1xs394q"><div class="progress-header svelte-1xs394q"><span class="progress-label svelte-1xs394q">Fermentation Progress</span> <!></div> <div class="fermentation-progress-bar svelte-1xs394q"><div class="fermentation-fill svelte-1xs394q"></div></div> <div class="progress-labels svelte-1xs394q"><span class="og-label svelte-1xs394q"> </span> <span class="progress-percent svelte-1xs394q"> </span> <span class="fg-label svelte-1xs394q"> </span></div></div>'),cr=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Predicted FG:</span> <span class="value svelte-1xs394q"> </span></div>'),ur=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Attenuation:</span> <span class="value attenuation svelte-1xs394q"> </span></div>'),_r=n('<span class="complete-now svelte-1xs394q">Ready now!</span>'),pr=n('<span class="days svelte-1xs394q"> </span>'),gr=n(" <!>",1),mr=n('<div class="metric completion-metric svelte-1xs394q"><span class="label svelte-1xs394q">Est. Completion:</span> <span class="value svelte-1xs394q"><!></span></div>'),fr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model:</span> <span class="model-value model-type svelte-1xs394q"> </span></div>'),hr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),br=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),yr=n('<div><div class="panel-header svelte-1xs394q"><h3 class="panel-title svelte-1xs394q">Fermentation Intelligence</h3> <div class="header-controls svelte-1xs394q"><select class="model-select svelte-1xs394q" title="Select prediction model"></select> <button type="button" class="reload-btn svelte-1xs394q" title="Recalculate predictions from database history"> </button></div></div> <!> <!> <div class="metrics svelte-1xs394q"><!> <!> <!> <div class="model-info svelte-1xs394q"><!> <!> <!></div></div></div>'),xr=n('<div class="ml-panel disabled svelte-1xs394q"><div class="disabled-header svelte-1xs394q"><p class="unavailable-text svelte-1xs394q">ML predictions unavailable</p> <button type="button" class="reload-btn svelte-1xs394q" title="Reload predictions from database"> </button></div> <p class="unavailable-hint svelte-1xs394q"><!></p></div>');function kr(ke,l){Ot(l,!0);let m=Vt(l,"measuredOg",3,null),k=Vt(l,"currentSg",3,null),z=Vt(l,"liveReading",3,null),x=pe(na({available:!1})),T=pe(!0),r=pe(!1),P=pe(null),C=pe("auto");const de=[{value:"auto",label:"Auto (Best Fit)"},{value:"exponential",label:"Exponential"},{value:"gompertz",label:"Gompertz (S-Curve)"},{value:"logistic",label:"Logistic"}];async function be(){d(T,!0),d(P,null);try{d(x,await ps(l.batchId,e(C)),!0)}catch(b){d(P,b instanceof Error?b.message:"Failed to load predictions",!0),console.error("Failed to load ML predictions:",b)}finally{d(T,!1)}}async function fe(){d(r,!0),d(P,null);try{const b=await _s(l.batchId);console.log("Reloaded predictions:",b.message),await be()}catch(b){d(P,b instanceof Error?b.message:"Failed to reload predictions",!0),console.error("Failed to reload predictions:",b)}finally{d(r,!1)}}function I(){be()}Aa(fe);function J(b){return b?new Date(b).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}):"N/A"}function ae(b){if(!b)return null;const D=new Date(b),ce=new Date,Q=D.getTime()-ce.getTime();return Math.ceil(Q/(1e3*60*60*24))}let ie=A(()=>{const b=m()??e(x).predicted_og,D=e(x).predicted_fg,ce=k()??z()?.sg;if(!b||!D||!ce||b<=D)return null;const Q=b-D,u=(b-ce)/Q*100;return Math.min(100,Math.max(0,u))}),w=A(()=>{const b=m()??e(x).predicted_og,D=k()??z()?.sg;if(!b||!D||b<=1)return null;const ce=(b-D)/(b-1)*100;return Math.min(100,Math.max(0,ce))}),E=A(()=>{const b=z()?.sg_rate;if(b==null)return null;const D=Math.abs(b);return D>.002?{label:"Very Active",color:"var(--activity-very-active)",emoji:"üî•"}:D>5e-4?{label:"Active",color:"var(--activity-active)",emoji:"‚ú®"}:D>1e-4?{label:"Slowing",color:"var(--activity-slowing)",emoji:"üê¢"}:{label:"Complete",color:"var(--activity-complete)",emoji:"‚úì"}}),Y=A(()=>z()?.is_anomaly??!1),K=A(()=>z()?.anomaly_reasons??[]);var M=we(),S=W(M);{var le=b=>{var D=rr();i(b,D)},ee=b=>{var D=we(),ce=W(D);{var Q=u=>{var f=ir(),N=a(f),ue=a(N);t(N),t(f),p(()=>c(ue,`‚ö†Ô∏è ${e(P)??""}`)),i(u,f)},o=u=>{var f=we(),N=W(f);{var ue=_=>{var h=yr();let j;var R=a(h),L=s(a(R),2),X=a(L);X.__change=I,Wt(X,21,()=>de,va,(q,B)=>{var G=lr(),je=a(G,!0);t(G);var De={};p(()=>{c(je,e(B).label),De!==(De=e(B).value)&&(G.value=(G.__value=e(B).value)??"")}),i(q,G)}),t(X);var U=s(X,2);U.__click=fe;var ye=a(U,!0);t(U),t(L),t(R);var ne=s(R,2);{var re=q=>{var B=vr(),G=s(a(B),2),je=s(a(G),2);{var De=Ye=>{var Ve=nr(),Ae=a(Ve,!0);t(Ve),p(We=>c(Ae,We),[()=>e(K).join(", ")]),i(Ye,Ve)};v(je,Ye=>{e(K).length>0&&Ye(De)})}t(G),t(B),i(q,B)};v(ne,q=>{e(Y)&&q(re)})}var ge=s(ne,2);{var xe=q=>{var B=dr(),G=a(B),je=s(a(G),2);{var De=ut=>{var jt=or(),sa=a(jt);t(jt),p(()=>{rt(jt,`color: ${e(E).color??""}`),c(sa,`${e(E).emoji??""} ${e(E).label??""}`)}),i(ut,jt)};v(je,ut=>{e(E)&&ut(De)})}t(G);var Ye=s(G,2),Ve=a(Ye);t(Ye);var Ae=s(Ye,2),We=a(Ae),it=a(We);t(We);var ct=s(We,2),Nt=a(ct);t(ct);var et=s(ct,2),tt=a(et);t(et),t(Ae),t(B),p((ut,jt,sa)=>{rt(Ve,`width: ${e(ie)??""}%`),c(it,`OG: ${ut??""}`),c(Nt,`${jt??""}%`),c(tt,`FG: ${sa??""}`)},[()=>ta(m()??e(x).predicted_og??0),()=>e(ie).toFixed(0),()=>ta(e(x).predicted_fg??0)]),i(q,B)};v(ge,q=>{e(ie)!==null&&q(xe)})}var Be=s(ge,2),Fe=a(Be);{var qe=q=>{var B=cr(),G=s(a(B),2),je=a(G,!0);t(G),t(B),p(De=>c(je,De),[()=>ta(e(x).predicted_fg)]),i(q,B)};v(Fe,q=>{e(x).predicted_fg&&q(qe)})}var Ce=s(Fe,2);{var Ne=q=>{var B=ur(),G=s(a(B),2),je=a(G);t(G),t(B),p(De=>c(je,`${De??""}%`),[()=>e(w).toFixed(1)]),i(q,B)};v(Ce,q=>{e(w)!==null&&q(Ne)})}var g=s(Ce,2);{var Z=q=>{const B=A(()=>ae(e(x).estimated_completion));var G=mr(),je=s(a(G),2),De=a(je);{var Ye=Ae=>{var We=_r();i(Ae,We)},Ve=Ae=>{var We=gr(),it=W(We),ct=s(it);{var Nt=et=>{var tt=pr(),ut=a(tt);t(tt),p(()=>c(ut,`(${e(B)??""} ${e(B)===1?"day":"days"})`)),i(et,tt)};v(ct,et=>{e(B)!==null&&et(Nt)})}p(et=>c(it,`${et??""} `),[()=>J(e(x).estimated_completion)]),i(Ae,We)};v(De,Ae=>{e(B)!==null&&e(B)<=0?Ae(Ye):Ae(Ve,!1)})}t(je),t(G),i(q,G)};v(g,q=>{e(x).estimated_completion&&q(Z)})}var se=s(g,2),O=a(se);{var te=q=>{var B=fr(),G=s(a(B),2),je=a(G,!0);t(G),t(B),p(()=>c(je,e(x).model_type)),i(q,B)};v(O,q=>{e(x).model_type&&q(te)})}var ve=s(O,2);{var Le=q=>{var B=hr(),G=s(a(B),2),je=a(G);t(G),t(B),p(De=>c(je,`${De??""}%`),[()=>(e(x).r_squared*100).toFixed(0)]),i(q,B)};v(ve,q=>{e(x).r_squared!==void 0&&q(Le)})}var Ue=s(ve,2);{var Ge=q=>{var B=br(),G=s(a(B),2),je=a(G,!0);t(G),t(B),p(()=>c(je,e(x).num_readings)),i(q,B)};v(Ue,q=>{e(x).num_readings&&q(Ge)})}t(se),t(Be),t(h),p(()=>{j=Ee(h,1,"ml-panel svelte-1xs394q",null,j,{"has-anomaly":e(Y)}),X.disabled=e(T)||e(r),U.disabled=e(r)||e(T),c(ye,e(r)?"Reloading...":"‚Üª")}),ls(X,()=>e(C),q=>d(C,q)),i(_,h)},y=_=>{var h=xr(),j=a(h),R=s(a(j),2);R.__click=fe;var L=a(R,!0);t(R),t(j);var X=s(j,2),U=a(X);{var ye=re=>{var ge=It("Waiting for fermentation to progress (need visible SG drop)");i(re,ge)},ne=re=>{var ge=we(),xe=W(ge);{var Be=qe=>{var Ce=It("Need more fermentation curve data for reliable prediction");i(qe,Ce)},Fe=qe=>{var Ce=we(),Ne=W(Ce);{var g=se=>{var O=It("Need at least 10 readings to make predictions");i(se,O)},Z=se=>{var O=It("Predictions will appear once fermentation is underway");i(se,O)};v(Ne,se=>{e(x).reason==="insufficient_data"?se(g):se(Z,!1)},!0)}i(qe,Ce)};v(xe,qe=>{e(x).reason==="insufficient_curve_data"?qe(Be):qe(Fe,!1)},!0)}i(re,ge)};v(U,re=>{e(x).reason==="insufficient_fermentation_progress"?re(ye):re(ne,!1)})}t(X),t(h),p(()=>{R.disabled=e(r)||e(T),c(L,e(r)?"Reloading...":"‚Üª Reload")}),i(_,h)};v(N,_=>{e(x).available?_(ue):_(y,!1)},!0)}i(u,f)};v(ce,u=>{e(P)?u(Q):u(o,!1)},!0)}i(b,D)};v(S,b=>{e(T)?b(le):b(ee,!1)})}i(ke,M),Et()}Jt(["change","click"]);var jr=n('<div class="loading svelte-1hws0u6">Loading alerts...</div>'),wr=n('<div class="error-banner svelte-1hws0u6"><span> </span> <button type="button" class="dismiss-error svelte-1hws0u6">√ó</button></div>'),zr=n('<button type="button" class="dismiss-all-btn svelte-1hws0u6"> </button>'),Cr=n('<span class="spinner svelte-1hws0u6"></span>'),qr=Yt('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1hws0u6"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg>'),Sr=n('<div class="alert-item svelte-1hws0u6"><div class="alert-icon svelte-1hws0u6"> </div> <div class="alert-content svelte-1hws0u6"><div class="alert-header svelte-1hws0u6"><span class="alert-type svelte-1hws0u6"> </span> <span class="severity-badge svelte-1hws0u6"> </span></div> <p class="alert-message svelte-1hws0u6"> </p> <div class="alert-meta svelte-1hws0u6"><span class="alert-time svelte-1hws0u6"> </span> <span class="alert-separator svelte-1hws0u6">¬∑</span> <span class="alert-time svelte-1hws0u6"> </span></div></div> <button type="button" class="dismiss-btn svelte-1hws0u6" title="Dismiss alert"><!></button></div>'),Mr=n('<!> <div class="alerts-header svelte-1hws0u6"><span class="alert-count svelte-1hws0u6"> </span> <!></div> <div class="alerts-list svelte-1hws0u6"></div>',1);function Br(ke,l){Ot(l,!0);let m=pe(na([])),k=pe(!0),z=pe(null),x=pe(null),T=pe(!1);ha(()=>{r()});async function r(){try{d(k,!0),d(z,null),d(m,await gs(l.batchId,!1),!0)}catch(w){d(z,w instanceof Error?w.message:"Failed to load alerts",!0)}finally{d(k,!1)}}async function P(w){try{d(x,w,!0),await ms(l.batchId,w),d(m,e(m).filter(E=>E.id!==w),!0)}catch(E){d(z,E instanceof Error?E.message:"Failed to dismiss alert",!0)}finally{d(x,null)}}async function C(){try{d(T,!0),await fs(l.batchId),d(m,[],!0)}catch(w){d(z,w instanceof Error?w.message:"Failed to dismiss alerts",!0)}finally{d(T,!1)}}function de(w){switch(w){case"critical":return"var(--negative)";case"warning":return"var(--warning)";case"info":return"var(--accent)";default:return"var(--text-muted)"}}function be(w){switch(w){case"stall":return"‚è∏";case"temperature_high":return"üî•";case"temperature_low":return"‚ùÑ";case"anomaly":return"‚ö†";default:return"‚ö†"}}function fe(w){const E=new Date(w),K=new Date().getTime()-E.getTime(),M=Math.floor(K/6e4),S=Math.floor(M/60),le=Math.floor(S/24);return le>0?`${le}d ago`:S>0?`${S}h ago`:M>0?`${M}m ago`:"just now"}var I=we(),J=W(I);{var ae=w=>{aa(w,{title:"Alerts",icon:"üîî",children:(E,Y)=>{var K=jr();i(E,K)},$$slots:{default:!0}})},ie=w=>{var E=we(),Y=W(E);{var K=S=>{},M=S=>{aa(S,{title:"Active Alerts",icon:"üîî",highlight:!0,children:(le,ee)=>{var b=Mr(),D=W(b);{var ce=y=>{var _=wr(),h=a(_),j=a(h,!0);t(h);var R=s(h,2);R.__click=()=>d(z,null),t(_),p(()=>c(j,e(z))),i(y,_)};v(D,y=>{e(z)&&y(ce)})}var Q=s(D,2),o=a(Q),u=a(o);t(o);var f=s(o,2);{var N=y=>{var _=zr();_.__click=C;var h=a(_,!0);t(_),p(()=>{_.disabled=e(T),c(h,e(T)?"Dismissing...":"Dismiss All")}),i(y,_)};v(f,y=>{e(m).length>1&&y(N)})}t(Q);var ue=s(Q,2);Wt(ue,21,()=>e(m),y=>y.id,(y,_)=>{var h=Sr(),j=a(h),R=a(j,!0);t(j);var L=s(j,2),X=a(L),U=a(X),ye=a(U,!0);t(U);var ne=s(U,2),re=a(ne,!0);t(ne),t(X);var ge=s(X,2),xe=a(ge,!0);t(ge);var Be=s(ge,2),Fe=a(Be),qe=a(Fe);t(Fe);var Ce=s(Fe,4),Ne=a(Ce);t(Ce),t(Be),t(L);var g=s(L,2);g.__click=()=>P(e(_).id);var Z=a(g);{var se=te=>{var ve=Cr();i(te,ve)},O=te=>{var ve=qr();i(te,ve)};v(Z,te=>{e(x)===e(_).id?te(se):te(O,!1)})}t(g),t(h),p((te,ve,Le,Ue,Ge,q,B,G)=>{rt(h,`--severity-color: ${te??""}`),c(R,ve),c(ye,Le),rt(ne,`background: ${Ue??""}`),c(re,e(_).severity),c(xe,e(_).message),Mt(Fe,"title",`First detected: ${Ge??""}`),c(qe,`First: ${q??""}`),Mt(Ce,"title",`Last seen: ${B??""}`),c(Ne,`Last: ${G??""}`),g.disabled=e(x)===e(_).id},[()=>de(e(_).severity),()=>be(e(_).alert_type),()=>e(_).alert_type.replace("_"," "),()=>de(e(_).severity),()=>new Date(e(_).first_detected_at).toLocaleString(),()=>fe(e(_).first_detected_at),()=>new Date(e(_).last_seen_at).toLocaleString(),()=>fe(e(_).last_seen_at)]),i(y,h)}),t(ue),p(()=>c(u,`${e(m).length??""} active`)),i(le,b)},$$slots:{default:!0}})};v(Y,S=>{e(m).length===0?S(K):S(M,!1)},!0)}i(w,E)};v(J,w=>{e(k)?w(ae):w(ie,!1)})}i(ke,I),Et()}Jt(["click"]);var Fr=n("<span> </span>"),Rr=n('<div class="timer-idle svelte-ukh80y"><div class="timer-option svelte-ukh80y"><label class="option-label svelte-ukh80y">Mash Duration</label> <div class="duration-input svelte-ukh80y"><button type="button" class="duration-btn svelte-ukh80y">‚àí</button> <span class="duration-value svelte-ukh80y"> </span> <button type="button" class="duration-btn svelte-ukh80y">+</button> <span class="duration-unit svelte-ukh80y">min</span></div></div> <div class="timer-option svelte-ukh80y"><label class="option-label svelte-ukh80y">Boil Duration</label> <div class="duration-display svelte-ukh80y"><span class="duration-value svelte-ukh80y"> </span> <span class="duration-unit svelte-ukh80y">min</span></div></div> <div class="timer-actions svelte-ukh80y"><button type="button" class="start-btn mash svelte-ukh80y"><svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path></svg> Start Mash</button> <button type="button" class="start-btn boil svelte-ukh80y">Skip to Boil</button></div></div>'),Tr=n('<div class="timer-complete svelte-ukh80y"><div class="complete-icon svelte-ukh80y">‚úì</div> <p class="complete-text svelte-ukh80y">Boil complete! Time to chill the wort.</p> <button type="button" class="reset-btn svelte-ukh80y">Reset Timer</button></div>'),Dr=Yt('<svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path></svg> Resume',1),Ar=Yt('<svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6"></path></svg> Pause',1),Pr=n('<span class="hop-check svelte-ukh80y">‚úì</span>'),Ir=n('<div><span class="hop-time svelte-ukh80y"> </span> <span class="hop-name svelte-ukh80y"> </span> <span class="hop-amount svelte-ukh80y"> </span> <!></div>'),Or=n('<div class="hop-schedule svelte-ukh80y"><h4 class="schedule-title svelte-ukh80y">Hop Additions</h4> <div class="hop-list svelte-ukh80y"></div></div>'),Er=n('<button type="button" class="next-phase-btn svelte-ukh80y">Mash Done ‚Üí Start Boil</button>'),Nr=n('<div class="timer-active svelte-ukh80y"><div class="timer-display svelte-ukh80y"><span class="time-value svelte-ukh80y"> </span> <span class="time-label svelte-ukh80y">remaining</span></div> <div class="progress-bar svelte-ukh80y"><div></div></div> <div class="timer-controls svelte-ukh80y"><button type="button" class="control-btn svelte-ukh80y" title="Subtract 1 minute">‚àí1m</button> <button type="button"><!></button> <button type="button" class="control-btn svelte-ukh80y" title="Add 1 minute">+1m</button></div> <!> <div class="phase-actions svelte-ukh80y"><!> <button type="button" class="reset-btn svelte-ukh80y">Reset</button></div></div>'),Lr=n('<div class="timer-card svelte-ukh80y"><div class="timer-header svelte-ukh80y"><h3 class="timer-title svelte-ukh80y">Brew Day Timer</h3> <!></div> <!></div>');function Gr(ke,l){Ot(l,!0);let m=pe("idle"),k=pe(0),z=null,x=pe(!1),T=pe(na(new Set)),r=pe(60),P=A(()=>l.recipe.boil_time_minutes||60),C=A(()=>l.recipe.hops?l.recipe.hops.filter(o=>o.timing?.use==="add_to_boil"||!o.timing?.use).map(o=>({name:o.name,amount:o.amount_grams,time:o.timing?.duration?.value||0,unit:o.timing?.duration?.unit||"min"})).sort((o,u)=>u.time-o.time):[]),de=A(()=>{const o=Math.floor(e(k)/60),u=e(k)%60;return`${o.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`}),be=A(()=>e(m)==="mash"?(e(r)*60-e(k))/(e(r)*60)*100:e(m)==="boil"?(e(P)*60-e(k))/(e(P)*60)*100:0),fe=A(()=>{switch(e(m)){case"mash":return"Mash";case"boil":return"Boil";case"complete":return"Complete!";default:return"Ready"}});function I(){d(m,"mash"),d(k,e(r)*60),d(T,new Set,!0),ae()}function J(){d(m,"boil"),d(k,e(P)*60),d(T,new Set,!0),ae()}function ae(){z&&clearInterval(z),d(x,!1),z=setInterval(()=>{if(!e(x)&&e(k)>0){if($a(k,-1),e(m)==="boil"){const o=Math.floor(e(k)/60);for(const u of e(C)){const f=u.time;o===f&&!e(T).has(f)&&(e(T).add(f),K(),M(`Add ${u.name}`,`${u.amount}g at ${f} minutes`))}}e(k)===0&&(clearInterval(z),z=null,K(),e(m)==="mash"?M("Mash Complete","Time to sparge and start the boil!"):e(m)==="boil"&&(d(m,"complete"),M("Boil Complete","Time to chill the wort!"),l.onComplete?.()))}},1e3)}function ie(){d(x,!e(x))}function w(){z&&(clearInterval(z),z=null),d(m,"idle"),d(k,0),d(x,!1),d(T,new Set,!0)}function E(){d(k,e(k)+60)}function Y(){e(k)>=60&&d(k,e(k)-60)}function K(){try{const o=new(window.AudioContext||window.webkitAudioContext),u=o.createOscillator(),f=o.createGain();u.connect(f),f.connect(o.destination),u.frequency.value=880,u.type="sine",f.gain.value=.3,u.start(),setTimeout(()=>f.gain.value=0,150),setTimeout(()=>f.gain.value=.3,250),setTimeout(()=>f.gain.value=0,400),setTimeout(()=>f.gain.value=.3,500),setTimeout(()=>f.gain.value=0,650),setTimeout(()=>{u.stop(),o.close()},700)}catch(o){console.warn("Audio notification not available:",o)}}function M(o,u){"Notification"in window&&Notification.permission==="granted"&&new Notification(o,{body:u,icon:"/favicon.png"})}ha(()=>("Notification"in window&&Notification.permission==="default"&&Notification.requestPermission(),()=>{z&&clearInterval(z)}));var S=Lr(),le=a(S),ee=s(a(le),2);{var b=o=>{var u=Fr();let f;var N=a(u,!0);t(u),p(()=>{f=Ee(u,1,"phase-badge svelte-ukh80y",null,f,{mash:e(m)==="mash",boil:e(m)==="boil"}),c(N,e(fe))}),i(o,u)};v(ee,o=>{e(m)!=="idle"&&e(m)!=="complete"&&o(b)})}t(le);var D=s(le,2);{var ce=o=>{var u=Rr(),f=a(u),N=s(a(f),2),ue=a(N);ue.__click=()=>d(r,Math.max(1,e(r)-5),!0);var y=s(ue,2),_=a(y,!0);t(y);var h=s(y,2);h.__click=()=>d(r,e(r)+5),ze(2),t(N),t(f);var j=s(f,2),R=s(a(j),2),L=a(R),X=a(L,!0);t(L),ze(2),t(R),t(j);var U=s(j,2),ye=a(U);ye.__click=I;var ne=s(ye,2);ne.__click=J,t(U),t(u),p(()=>{c(_,e(r)),c(X,e(P))}),i(o,u)},Q=o=>{var u=we(),f=W(u);{var N=y=>{var _=Tr(),h=s(a(_),4);h.__click=w,t(_),i(y,_)},ue=y=>{var _=Nr(),h=a(_),j=a(h),R=a(j,!0);t(j),ze(2),t(h);var L=s(h,2),X=a(L);let U;t(L);var ye=s(L,2),ne=a(ye);ne.__click=Y;var re=s(ne,2);let ge;re.__click=ie;var xe=a(re);{var Be=te=>{var ve=Dr();ze(),i(te,ve)},Fe=te=>{var ve=Ar();ze(),i(te,ve)};v(xe,te=>{e(x)?te(Be):te(Fe,!1)})}t(re);var qe=s(re,2);qe.__click=E,t(ye);var Ce=s(ye,2);{var Ne=te=>{var ve=Or(),Le=s(a(ve),2);Wt(Le,21,()=>e(C),va,(Ue,Ge)=>{const q=A(()=>Math.floor(e(k)/60)),B=A(()=>e(Ge).time<=e(q)&&!e(T).has(e(Ge).time)),G=A(()=>e(T).has(e(Ge).time)||e(Ge).time>e(q));var je=Ir();let De;var Ye=a(je),Ve=a(Ye);t(Ye);var Ae=s(Ye,2),We=a(Ae,!0);t(Ae);var it=s(Ae,2),ct=a(it);t(it);var Nt=s(it,2);{var et=tt=>{var ut=Pr();i(tt,ut)};v(Nt,tt=>{e(G)&&tt(et)})}t(je),p(()=>{De=Ee(je,1,"hop-item svelte-ukh80y",null,De,{next:e(B),done:e(G)}),c(Ve,`${e(Ge).time??""}m`),c(We,e(Ge).name),c(ct,`${e(Ge).amount??""}g`)}),i(Ue,je)}),t(Le),t(ve),i(te,ve)};v(Ce,te=>{e(m)==="boil"&&e(C).length>0&&te(Ne)})}var g=s(Ce,2),Z=a(g);{var se=te=>{var ve=Er();ve.__click=J,i(te,ve)};v(Z,te=>{e(m)==="mash"&&te(se)})}var O=s(Z,2);O.__click=w,t(g),t(_),p(()=>{c(R,e(de)),U=Ee(X,1,"progress-fill svelte-ukh80y",null,U,{mash:e(m)==="mash",boil:e(m)==="boil"}),rt(X,`width: ${e(be)??""}%`),ge=Ee(re,1,"control-btn pause svelte-ukh80y",null,ge,{paused:e(x)})}),i(y,_)};v(f,y=>{e(m)==="complete"?y(N):y(ue,!1)},!0)}i(o,u)};v(D,o=>{e(m)==="idle"?o(ce):o(Q,!1)})}t(S),i(ke,S),Et()}Jt(["click"]);var Hr=n('<button type="button" class="remove-btn svelte-ue9vqt" title="Remove item">√ó</button>'),Ur=n('<label><input type="checkbox" class="svelte-ue9vqt"/> <span class="item-text svelte-ue9vqt"> </span> <!></label>'),Vr=n('<div class="category-group svelte-ue9vqt"><h4 class="category-title svelte-ue9vqt"> </h4> <div class="items-list svelte-ue9vqt"></div></div>'),Wr=n('<div class="add-form svelte-ue9vqt"><input type="text" class="add-input svelte-ue9vqt" placeholder="Add custom item..."/> <button type="button" class="add-btn svelte-ue9vqt">Add</button> <button type="button" class="cancel-btn svelte-ue9vqt">Cancel</button></div>'),Jr=n('<button type="button" class="show-add-btn svelte-ue9vqt"><svg class="btn-icon svelte-ue9vqt" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path></svg> Add custom item</button>'),Yr=n('<div class="checklist-card svelte-ue9vqt"><div class="checklist-header svelte-ue9vqt"><div class="header-left svelte-ue9vqt"><h3 class="checklist-title svelte-ue9vqt">Brew Day Checklist</h3> <span class="progress-badge svelte-ue9vqt"> </span></div> <button type="button" class="reset-btn svelte-ue9vqt" title="Reset all items"><svg class="btn-icon svelte-ue9vqt" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg></button></div> <div class="progress-bar svelte-ue9vqt"><div class="progress-fill svelte-ue9vqt"></div></div> <div class="checklist-groups svelte-ue9vqt"></div> <div class="add-section svelte-ue9vqt"><!></div></div>');function Kr(ke,l){Ot(l,!0);let m=pe(na([])),k=pe(""),z=pe(!1),x=A(()=>`brewday-checklist-${l.batchId}`);function T(){const o=[];return o.push({id:"prep-sanitize",text:"Sanitize all equipment",checked:!1,category:"prep"}),o.push({id:"prep-water",text:`Heat strike water (${l.recipe.batch_size_liters?Math.round(l.recipe.batch_size_liters*1.3):"--"}L)`,checked:!1,category:"prep"}),l.recipe.fermentables&&l.recipe.fermentables.forEach((u,f)=>{const N=u.amount_kg?`${(u.amount_kg*1e3).toFixed(0)}g`:"";o.push({id:`ferm-${f}`,text:`Mill grain: ${u.name} ${N}`,checked:!1,category:"prep"})}),o.push({id:"mash-dough-in",text:"Dough in - add grain to strike water",checked:!1,category:"mash"}),o.push({id:"mash-temp",text:"Check mash temperature",checked:!1,category:"mash"}),o.push({id:"mash-rest",text:"Mash rest complete",checked:!1,category:"mash"}),o.push({id:"mash-sparge",text:"Sparge and collect wort",checked:!1,category:"mash"}),o.push({id:"boil-preboil",text:"Record pre-boil gravity",checked:!1,category:"boil"}),o.push({id:"boil-start",text:"Bring to boil",checked:!1,category:"boil"}),l.recipe.hops&&l.recipe.hops.filter(f=>f.timing?.use==="add_to_boil"||!f.timing?.use).sort((f,N)=>(N.timing?.duration?.value||0)-(f.timing?.duration?.value||0)).forEach((f,N)=>{const ue=f.timing?.duration?.value||0,y=f.amount_grams?`${f.amount_grams}g`:"";o.push({id:`hop-${N}`,text:`Add ${f.name} ${y} @ ${ue}min`,checked:!1,category:"boil"})}),o.push({id:"postboil-flame-off",text:"Flame off / end boil",checked:!1,category:"post-boil"}),o.push({id:"postboil-chill",text:"Chill wort to pitch temp",checked:!1,category:"post-boil"}),o.push({id:"postboil-og",text:"Record original gravity (OG)",checked:!1,category:"post-boil"}),o.push({id:"postboil-transfer",text:"Transfer to fermenter",checked:!1,category:"post-boil"}),o.push({id:"postboil-yeast",text:"Pitch yeast",checked:!1,category:"post-boil"}),o.push({id:"postboil-airlock",text:"Seal fermenter and add airlock",checked:!1,category:"post-boil"}),o}function r(){try{const o=localStorage.getItem(e(x));if(o){const u=JSON.parse(o),f=T(),N=new Map(u.map(y=>[y.id,y]));for(const y of f){const _=N.get(y.id);_&&(y.checked=_.checked)}const ue=u.filter(y=>y.category==="custom");d(m,[...f,...ue],!0)}else d(m,T(),!0)}catch{d(m,T(),!0)}}function P(){try{localStorage.setItem(e(x),JSON.stringify(e(m)))}catch(o){console.warn("Failed to save checklist:",o)}}function C(o){d(m,e(m).map(u=>u.id===o?{...u,checked:!u.checked}:u),!0),P()}function de(){if(!e(k).trim())return;const o={id:`custom-${Date.now()}`,text:e(k).trim(),checked:!1,category:"custom"};d(m,[...e(m),o],!0),d(k,""),d(z,!1),P()}function be(o){d(m,e(m).filter(u=>u.id!==o),!0),P()}function fe(){confirm("Reset all checklist items to unchecked?")&&(d(m,e(m).map(o=>({...o,checked:!1})),!0),P())}let I=A(()=>{if(e(m).length===0)return 0;const o=e(m).filter(u=>u.checked).length;return Math.round(o/e(m).length*100)}),J=A(()=>{const o={prep:[],mash:[],boil:[],"post-boil":[],custom:[]};for(const u of e(m))o[u.category].push(u);return o});const ae={prep:"Preparation",mash:"Mash",boil:"Boil","post-boil":"Post-Boil",custom:"Custom"};ha(()=>{r()});var ie=Yr(),w=a(ie),E=a(w),Y=s(a(E),2),K=a(Y);t(Y),t(E);var M=s(E,2);M.__click=fe,t(w);var S=s(w,2),le=a(S);t(S);var ee=s(S,2);Wt(ee,21,()=>Object.entries(e(J)),va,(o,u)=>{var f=A(()=>es(e(u),2));let N=()=>e(f)[0],ue=()=>e(f)[1];var y=we(),_=W(y);{var h=j=>{var R=Vr(),L=a(R),X=a(L,!0);t(L);var U=s(L,2);Wt(U,21,ue,ye=>ye.id,(ye,ne)=>{var re=Ur();let ge;var xe=a(re);Fa(xe),xe.__change=()=>C(e(ne).id);var Be=s(xe,2),Fe=a(Be,!0);t(Be);var qe=s(Be,2);{var Ce=Ne=>{var g=Hr();g.__click=()=>be(e(ne).id),i(Ne,g)};v(qe,Ne=>{e(ne).category==="custom"&&Ne(Ce)})}t(re),p(()=>{ge=Ee(re,1,"checklist-item svelte-ue9vqt",null,ge,{checked:e(ne).checked}),is(xe,e(ne).checked),c(Fe,e(ne).text)}),i(ye,re)}),t(U),t(R),p(()=>c(X,ae[N()])),i(j,R)};v(_,j=>{ue().length>0&&j(h)})}i(o,y)}),t(ee);var b=s(ee,2),D=a(b);{var ce=o=>{var u=Wr(),f=a(u);Fa(f),f.__keydown=y=>y.key==="Enter"&&de();var N=s(f,2);N.__click=de;var ue=s(N,2);ue.__click=()=>{d(z,!1),d(k,"")},t(u),js(f,()=>e(k),y=>d(k,y)),i(o,u)},Q=o=>{var u=Jr();u.__click=()=>d(z,!0),i(o,u)};v(D,o=>{e(z)?o(ce):o(Q,!1)})}t(b),t(ie),p(()=>{c(K,`${e(I)??""}%`),rt(le,`width: ${e(I)??""}%`)}),i(ke,ie),Et()}Jt(["click","change","keydown"]);var Qr=n('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),Xr=n('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),Zr=n('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),$r=n('<span class="recipe-type svelte-g5au2j"> </span>'),ei=n('<a class="recipe-link svelte-g5au2j"> <!></a>'),ti=n('<div class="batch-timing svelte-g5au2j"> </div>'),ai=n('<div class="batch-timing svelte-g5au2j"> </div>'),si=n('<option class="svelte-g5au2j"> </option>'),ri=Yt('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" class="svelte-g5au2j"></path><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Resume',1),ii=Yt('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Pause',1),li=n('<button type="button"><!></button>'),ni=n('<span class="chilling-icon svelte-g5au2j">üç∫</span> <h3 class="chilling-title svelte-g5au2j">Ready to Pitch!</h3>',1),vi=n('<span class="chilling-icon svelte-g5au2j">‚ùÑÔ∏è</span> <h3 class="chilling-title svelte-g5au2j">Chilling to Pitch Temperature</h3>',1),oi=n('<div class="progress-section svelte-g5au2j"><div class="progress-bar svelte-g5au2j"><div class="progress-fill svelte-g5au2j"></div></div> <span class="progress-text svelte-g5au2j"> </span></div>'),di=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è No cooler configured - set a cooler entity to enable automated chilling</span>'),ci=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è Temperature control disabled in settings</span>'),ui=n('<span class="status-ready svelte-g5au2j">Wort has reached pitch temperature - ready to add yeast!</span>'),_i=n('<span class="status-active svelte-g5au2j">Cooler will run automatically when temp exceeds target + hysteresis</span>'),pi=n('<div><div class="chilling-header svelte-g5au2j"><!></div> <div class="chilling-content svelte-g5au2j"><div class="temp-display svelte-g5au2j"><div class="temp-current svelte-g5au2j"><span class="temp-label svelte-g5au2j">Current</span> <span class="temp-value svelte-g5au2j"> </span></div> <div class="temp-arrow svelte-g5au2j">‚Üí</div> <div class="temp-target svelte-g5au2j"><span class="temp-label svelte-g5au2j">Target</span> <span class="temp-value svelte-g5au2j"> </span></div></div> <!> <div class="chilling-status svelte-g5au2j"><!></div></div></div>'),gi=n(`<div class="paused-banner svelte-g5au2j"><div class="paused-header svelte-g5au2j"><svg class="paused-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> <h3 class="paused-title svelte-g5au2j">Readings Paused</h3></div> <p class="paused-text svelte-g5au2j">Hydrometer readings are not being stored. Live readings still display but won't be saved to the fermentation history.</p> <button type="button" class="resume-btn svelte-g5au2j"> </button></div>`),mi=n('<span class="btn-spinner svelte-g5au2j"></span> Starting...',1),fi=Yt('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" class="svelte-g5au2j"></path><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Start Brew Day',1),hi=n(`<div class="planning-phase svelte-g5au2j"><div class="phase-action-card svelte-g5au2j"><div class="phase-icon svelte-g5au2j">üìã</div> <h2 class="phase-title svelte-g5au2j">Ready to Brew?</h2> <p class="phase-description svelte-g5au2j">Review your recipe below, then start brew day when you're ready to begin.</p> <button type="button" class="start-brewday-btn svelte-g5au2j"><!></button></div> <!></div>`),bi=n('<span class="btn-spinner svelte-g5au2j"></span> Starting...',1),yi=Yt('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" class="svelte-g5au2j"></path></svg> Yeast Pitched - Start Fermentation',1),xi=n(`<div class="brewing-phase svelte-g5au2j"><div class="phase-action-card brewing svelte-g5au2j"><div class="phase-icon svelte-g5au2j">üç∫</div> <h2 class="phase-title svelte-g5au2j">Brew Day in Progress</h2> <p class="phase-description svelte-g5au2j">Track your brew day activities. When you've pitched the yeast and fermentation begins, transition to the fermentation phase.</p> <button type="button" class="start-fermentation-btn svelte-g5au2j"><!></button></div> <div class="brewday-tools-grid svelte-g5au2j"><!> <!></div> <!> <!></div>`),ki=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot brewing svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Brew Day</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),ji=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot fermenting svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Fermentation Started</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),wi=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot conditioning svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Conditioning Started</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),zi=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot completed svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Completed</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Ci=n('<div class="completed-phase svelte-g5au2j"><div class="batch-summary-card svelte-g5au2j"><h2 class="summary-title svelte-g5au2j">Batch Complete</h2> <div class="summary-stats svelte-g5au2j"><div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Original Gravity</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Final Gravity</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">ABV</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Attenuation</span> <span class="stat-value svelte-g5au2j"><!></span></div></div></div> <div class="timeline-card svelte-g5au2j"><h3 class="timeline-title svelte-g5au2j">Batch Timeline</h3> <div class="timeline svelte-g5au2j"><!> <!> <!> <!></div></div> <!></div>'),qi=n('<span class="status-badge heater svelte-g5au2j">üî• Heating</span>'),Si=n('<span class="status-badge cooler svelte-g5au2j">‚ùÑÔ∏è Cooling</span>'),Mi=n('<span class="status-badge idle svelte-g5au2j"> </span>'),Bi=n('<div class="device-status heater svelte-g5au2j"><div>üî•</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Heater</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Fi=n('<div class="device-status cooler svelte-g5au2j"><div>‚ùÑÔ∏è</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Cooler</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Ri=n('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">‚ö°</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),Ti=n('<button type="button" class="override-btn heat-on svelte-g5au2j">Force Heat ON</button> <button type="button" class="override-btn heat-off svelte-g5au2j">Force Heat OFF</button>',1),Di=n('<button type="button" class="override-btn cool-on svelte-g5au2j">Force Cool ON</button> <button type="button" class="override-btn cool-off svelte-g5au2j">Force Cool OFF</button>',1),Ai=n('<div class="control-details svelte-g5au2j"><div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns-grid svelte-g5au2j"><!> <!> <button type="button" class="override-btn auto-mode svelte-g5au2j">Auto Mode</button></div></div>',1),Pi=n('<div class="device-status-grid svelte-g5au2j"><!> <!></div> <!>',1),Ii=n('<div><button type="button" class="collapsible-header svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="collapse-indicator svelte-g5au2j"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" class="svelte-g5au2j"></path></svg></div></button> <!></div>'),Oi=n('<span class="svelte-g5au2j"> </span>'),Ei=n('<span class="svelte-g5au2j"> </span>'),Ni=n('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><!> <!> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),Li=n('<div class="chart-section svelte-g5au2j"><!></div>'),Gi=n('<div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!> <!></div></div> <!>',1),Hi=n('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <!> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j" aria-label="Delete batch"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <!> <!> <!>',1),Ui=n('<div class="modal-overlay svelte-g5au2j" role="presentation"><div class="modal svelte-g5au2j" role="dialog" aria-modal="true" aria-labelledby="delete-modal-title" tabindex="-1"><h2 id="delete-modal-title" class="modal-title svelte-g5au2j">Delete Batch?</h2> <p class="modal-text svelte-g5au2j"> </p> <div class="modal-actions svelte-g5au2j"><button type="button" class="modal-btn cancel svelte-g5au2j">Cancel</button> <button type="button" class="modal-btn delete svelte-g5au2j"> </button></div></div></div>'),Vi=n('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div> <!>',1);function pl(ke,l){Ot(l,!0);const m=()=>ds(cs,"$page",k),[k,z]=os();let x=null,T=null,r=pe(null),P=pe(null),C=pe(null),de=na([]),be=pe(!0),fe=pe(null),I=pe(!1),J=pe(!1),ae=pe(!1),ie=pe(!1),w=pe(!1),E=pe(!1),Y=pe(!1),K=A(()=>parseInt(m().params.id??"0"));const M=["planning","brewing","fermenting","conditioning","completed","archived"];let S=A(()=>e(r)?ma[e(r).status]:ma.planning),le=A(Ia),ee=A(()=>da.config.ha_enabled&&da.config.temp_control_enabled&&(e(r)?.heater_entity_id||e(r)?.cooler_entity_id)),b=A(()=>e(r)?.status==="planning"&&e(r)?.temp_target!=null),D=A(()=>!e(b)||!e(Q)?.temp||!e(r)?.temp_target?!1:e(Q).temp<=e(r).temp_target),ce=A(()=>{if(!e(b)||!e(Q)?.temp||!e(r)?.temp_target)return null;const g=e(r).temp_target+30,Z=e(Q).temp,se=e(r).temp_target;if(Z<=se)return 100;if(Z>=g)return 0;const O=(g-Z)/(g-se)*100;return Math.min(100,Math.max(0,O))}),Q=A(()=>{if(!e(r)?.device_id)return null;const g=Ra.tilts.get(e(r).device_id);if(g)return g;const Z=e(r).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!Z?.[1])return null;const se=Z[1].toUpperCase();for(const O of Ra.tilts.values())if(O.color&&O.color.toUpperCase()===se)return O;return null});async function o(){d(be,!0),d(fe,null);try{if(d(r,await hs(e(K)),!0),e(r).status==="fermenting"||e(r).status==="conditioning")try{d(P,await pa(e(K)),!0)}catch{}if(e(r).heater_entity_id||e(r).cooler_entity_id)try{d(C,await oa(e(K)),!0)}catch{}}catch(g){d(fe,g instanceof Error?g.message:"Failed to load batch",!0)}finally{d(be,!1)}}async function u(g){if(!(!e(r)||e(J))&&!(g==="conditioning"&&e(r).status==="fermenting"&&!confirm(`üí° Entering Conditioning Phase

Reminder: Adjust target temperature if cold crashing.
Temperature control will continue during conditioning.

Continue?`))){d(J,!0);try{d(r,await la(e(r).id,{status:g}),!0),(g==="fermenting"||g==="conditioning")&&d(P,await pa(e(r).id),!0)}catch(Z){console.error("Failed to update status:",Z)}finally{d(J,!1)}}}async function f(){if(!(!e(r)||e(J))){d(J,!0);try{d(r,await la(e(r).id,{status:"brewing"}),!0)}catch(g){console.error("Failed to start brew day:",g)}finally{d(J,!1)}}}async function N(){if(!(!e(r)||e(J))){d(J,!0);try{d(r,await la(e(r).id,{status:"fermenting"}),!0),d(P,await pa(e(r).id),!0)}catch(g){console.error("Failed to start fermentation:",g)}finally{d(J,!1)}}}async function ue(g){if(e(r)&&(d(r,await la(e(r).id,g),!0),d(I,!1),e(r).heater_entity_id||e(r).cooler_entity_id))try{d(C,await oa(e(r).id),!0)}catch{}}async function y(){if(e(r)){d(w,!0);try{await bs(e(r).id),us("/batches")}catch(g){d(fe,g instanceof Error?g.message:"Failed to delete batch",!0),d(w,!1),d(ie,!1)}}}async function _(){if(!(!e(r)||e(Y))){d(Y,!0);try{d(r,await la(e(r).id,{readings_paused:!e(r).readings_paused}),!0)}catch(g){console.error("Failed to toggle pause:",g)}finally{d(Y,!1)}}}async function h(g,Z){if(!(!e(r)||e(ae))){d(ae,!0);try{await ga(e(r).id,Z,60,g),d(C,await oa(e(r).id),!0)}catch(se){console.error("Failed to set override:",se)}finally{d(ae,!1)}}}async function j(){if(!(!e(r)||e(ae))){d(ae,!0);try{e(r).heater_entity_id&&await ga(e(r).id,null,60,"heater"),e(r).cooler_entity_id&&await ga(e(r).id,null,60,"cooler"),d(C,await oa(e(r).id),!0)}catch(g){console.error("Failed to clear overrides:",g)}finally{d(ae,!1)}}}function R(){if(x?.readyState===WebSocket.OPEN)return;const Z=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;x=new WebSocket(Z),x.onmessage=async se=>{try{const O=JSON.parse(se.data);O.type==="control_event"&&O.batch_id===e(K)&&e(C)&&(O.action==="heat_on"?d(C,{...e(C),heater_state:"on"},!0):O.action==="heat_off"?d(C,{...e(C),heater_state:"off"},!0):O.action==="cool_on"?d(C,{...e(C),cooler_state:"on"},!0):O.action==="cool_off"&&d(C,{...e(C),cooler_state:"off"},!0))}catch{}},x.onclose=()=>{x=null,T=setTimeout(R,3e3)},x.onerror=()=>{x?.close()}}function L(){T&&(clearTimeout(T),T=null),x?.close(),x=null}function X(g){return g==null?"--":ta(g)}function U(g){return g==null?"--":Pa(g)}function ye(g){return g?new Date(g).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"--"}function ne(g){if(!g)return"--";const Z=new Date(g),O=(new Date().getTime()-Z.getTime())/(1e3*60*60);if(O<1)return`${Math.round(O*60)}m`;if(O<24)return`${O.toFixed(1)}h`;const te=O/24;return te<7?`${te.toFixed(1)}d`:`${Math.round(te)}d`}function re(g){return g?new Date(g).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"}):"--"}Aa(()=>{o(),R()}),ts(()=>{L()});var ge=Vi();rs("g5au2j",g=>{as(()=>{ss.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var xe=W(ge),Be=s(a(xe),2);{var Fe=g=>{var Z=Qr();i(g,Z)},qe=g=>{var Z=we(),se=W(Z);{var O=ve=>{var Le=Xr(),Ue=s(a(Le),2),Ge=a(Ue,!0);t(Ue);var q=s(Ue,2);q.__click=o,t(Le),p(()=>c(Ge,e(fe))),i(ve,Le)},te=ve=>{var Le=we(),Ue=W(Le);{var Ge=B=>{var G=Zr();i(B,G)},q=B=>{var G=we(),je=W(G);{var De=Ve=>{ys(Ve,{get batch(){return e(r)},onSubmit:ue,onCancel:()=>d(I,!1)})},Ye=Ve=>{var Ae=Hi(),We=W(Ae),it=a(We),ct=a(it),Nt=a(ct);t(ct);var et=s(ct,2),tt=a(et),ut=a(tt,!0);t(tt);var jt=s(tt,2);{var sa=oe=>{var V=ei(),me=a(V),Re=s(me);{var Pe=Te=>{var Se=$r(),Ie=a(Se);t(Se),p(()=>c(Ie,`(${e(r).recipe.type??""})`)),i(Te,Se)};v(Re,Te=>{e(r).recipe.type&&Te(Pe)})}t(V),p(()=>{Mt(V,"href",`/recipes/${e(r).recipe.id??""}`),c(me,`${e(r).recipe.name??""} `)}),i(oe,V)};v(jt,oe=>{e(r).recipe&&oe(sa)})}var Ea=s(jt,2);{var Na=oe=>{var V=ti(),me=a(V);t(V),p((Re,Pe)=>c(me,`Started ${Re??""} ¬∑ ${Pe??""} ago`),[()=>ye(e(r).start_time),()=>ne(e(r).start_time)]),i(oe,V)},La=oe=>{var V=we(),me=W(V);{var Re=Pe=>{var Te=ai(),Se=a(Te);t(Te),p(Ie=>c(Se,`Brewed ${Ie??""}`),[()=>ye(e(r).brew_date)]),i(Pe,Te)};v(me,Pe=>{e(r).brew_date&&Pe(Re)},!0)}i(oe,V)};v(Ea,oe=>{e(r).start_time?oe(Na):oe(La,!1)})}t(et),t(it);var ba=s(it,2),ca=a(ba),wt=a(ca);wt.__change=oe=>u(oe.currentTarget.value),Wt(wt,21,()=>M,va,(oe,V)=>{var me=si(),Re=a(me,!0);t(me);var Pe={};p(()=>{c(Re,ma[e(V)].label),Pe!==(Pe=e(V))&&(me.value=(me.__value=e(V))??"")}),i(oe,me)}),t(wt);var ya;ns(wt),t(ca);var xa=s(ca,2);{var Ga=oe=>{var V=li();let me;V.__click=_;var Re=a(V);{var Pe=Se=>{var Ie=ri();ze(),i(Se,Ie)},Te=Se=>{var Ie=ii();ze(),i(Se,Ie)};v(Re,Se=>{e(r).readings_paused?Se(Pe):Se(Te,!1)})}t(V),p(()=>{me=Ee(V,1,"pause-btn svelte-g5au2j",null,me,{paused:e(r).readings_paused}),V.disabled=e(Y),Mt(V,"title",e(r).readings_paused?"Resume storing readings":"Pause storing readings")}),i(oe,V)};v(xa,oe=>{(e(r).status==="fermenting"||e(r).status==="conditioning")&&oe(Ga)})}var ka=s(xa,2);ka.__click=()=>d(I,!0);var Ha=s(ka,2);Ha.__click=()=>d(ie,!0),t(ba),t(We);var ja=s(We,2);{var Ua=oe=>{var V=pi();let me;var Re=a(V),Pe=a(Re);{var Te=F=>{var Me=ni();ze(2),i(F,Me)},Se=F=>{var Me=vi();ze(2),i(F,Me)};v(Pe,F=>{e(D)?F(Te):F(Se,!1)})}t(Re);var Ie=s(Re,2),lt=a(Ie),Oe=a(lt),Ke=s(a(Oe),2),bt=a(Ke,!0);t(Ke),t(Oe);var Ze=s(Oe,4),nt=s(a(Ze),2),yt=a(nt,!0);t(nt),t(Ze),t(lt);var zt=s(lt,2);{var Lt=F=>{var Me=oi(),xt=a(Me),Ft=a(xt);t(xt);var Rt=s(xt,2),ot=a(Rt);t(Rt),t(Me),p(kt=>{rt(Ft,`width: ${e(ce)??""}%`),c(ot,`${kt??""}% to target`)},[()=>Math.round(e(ce))]),i(F,Me)};v(zt,F=>{e(ce)!=null&&!e(D)&&F(Lt)})}var vt=s(zt,2),Ct=a(vt);{var Bt=F=>{var Me=di();i(F,Me)},qt=F=>{var Me=we(),xt=W(Me);{var Ft=ot=>{var kt=ci();i(ot,kt)},Rt=ot=>{var kt=we(),Gt=W(kt);{var _e=Qe=>{var at=ui();i(Qe,at)},Je=Qe=>{var at=_i();i(Qe,at)};v(Gt,Qe=>{e(D)?Qe(_e):Qe(Je,!1)},!0)}i(ot,kt)};v(xt,ot=>{!da.config.ha_enabled||!da.config.temp_control_enabled?ot(Ft):ot(Rt,!1)},!0)}i(F,Me)};v(Ct,F=>{e(r).cooler_entity_id?F(qt,!1):F(Bt)})}t(vt),t(Ie),t(V),p((F,Me)=>{me=Ee(V,1,"chilling-banner svelte-g5au2j",null,me,{ready:e(D)}),c(bt,F),c(yt,Me)},[()=>e(Q)?.temp!=null?U(e(Q).temp):"--",()=>e(r).temp_target!=null?U(e(r).temp_target):"--"]),i(oe,V)};v(ja,oe=>{e(b)&&oe(Ua)})}var wa=s(ja,2);{var Va=oe=>{var V=gi(),me=s(a(V),4);me.__click=_;var Re=a(me,!0);t(me),t(V),p(()=>{me.disabled=e(Y),c(Re,e(Y)?"Resuming...":"Resume Readings")}),i(oe,V)};v(wa,oe=>{e(r).readings_paused&&(e(r).status==="fermenting"||e(r).status==="conditioning")&&oe(Va)})}var Wa=s(wa,2);{var Ja=oe=>{var V=hi(),me=a(V),Re=s(a(me),6);Re.__click=f;var Pe=a(Re);{var Te=Oe=>{var Ke=mi();ze(),i(Oe,Ke)},Se=Oe=>{var Ke=fi();ze(),i(Oe,Ke)};v(Pe,Oe=>{e(J)?Oe(Te):Oe(Se,!1)})}t(Re),t(me);var Ie=s(me,2);{var lt=Oe=>{fa(Oe,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(Ie,Oe=>{e(r).recipe&&Oe(lt)})}t(V),p(()=>Re.disabled=e(J)),i(oe,V)},Ya=oe=>{var V=we(),me=W(V);{var Re=Te=>{var Se=xi(),Ie=a(Se),lt=s(a(Ie),6);lt.__click=N;var Oe=a(lt);{var Ke=F=>{var Me=bi();ze(),i(F,Me)},bt=F=>{var Me=yi();ze(),i(F,Me)};v(Oe,F=>{e(J)?F(Ke):F(bt,!1)})}t(lt),t(Ie);var Ze=s(Ie,2),nt=a(Ze);{var yt=F=>{Gr(F,{get recipe(){return e(r).recipe}})};v(nt,F=>{e(r).recipe&&F(yt)})}var zt=s(nt,2);{var Lt=F=>{Kr(F,{get recipe(){return e(r).recipe},get batchId(){return e(r).id}})};v(zt,F=>{e(r).recipe&&F(Lt)})}t(Ze);var vt=s(Ze,2);{var Ct=F=>{Ta(F,{get batch(){return e(r)},get liveReading(){return e(Q)},onEdit:()=>d(I,!0)})};v(vt,F=>{e(r).device_id&&F(Ct)})}var Bt=s(vt,2);{var qt=F=>{fa(F,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(Bt,F=>{e(r).recipe&&F(qt)})}t(Se),p(()=>lt.disabled=e(J)),i(Te,Se)},Pe=Te=>{var Se=we(),Ie=W(Se);{var lt=Ke=>{var bt=Ci(),Ze=a(bt),nt=s(a(Ze),2),yt=a(nt),zt=s(a(yt),2),Lt=a(zt,!0);t(zt),t(yt);var vt=s(yt,2),Ct=s(a(vt),2),Bt=a(Ct,!0);t(Ct),t(vt);var qt=s(vt,2),F=s(a(qt),2),Me=a(F);t(F),t(qt);var xt=s(qt,2),Ft=s(a(xt),2),Rt=a(Ft);{var ot=$=>{var H=It();p(he=>c(H,`${he??""}%`),[()=>((e(r).measured_og-e(r).measured_fg)/(e(r).measured_og-1)*100).toFixed(0)]),i($,H)},kt=$=>{var H=It("--");i($,H)};v(Rt,$=>{e(r).measured_og&&e(r).measured_fg?$(ot):$(kt,!1)})}t(Ft),t(xt),t(nt),t(Ze);var Gt=s(Ze,2),_e=s(a(Gt),2),Je=a(_e);{var Qe=$=>{var H=ki(),he=s(a(H),2),He=s(a(he),2),dt=a(He,!0);t(He),t(he),t(H),p(_t=>c(dt,_t),[()=>re(e(r).brewing_started_at||e(r).brew_date)]),i($,H)};v(Je,$=>{(e(r).brew_date||e(r).brewing_started_at)&&$(Qe)})}var at=s(Je,2);{var Tt=$=>{var H=ji(),he=s(a(H),2),He=s(a(he),2),dt=a(He,!0);t(He),t(he),t(H),p(_t=>c(dt,_t),[()=>re(e(r).fermenting_started_at||e(r).start_time)]),i($,H)};v(at,$=>{(e(r).start_time||e(r).fermenting_started_at)&&$(Tt)})}var St=s(at,2);{var Kt=$=>{var H=wi(),he=s(a(H),2),He=s(a(he),2),dt=a(He,!0);t(He),t(he),t(H),p(_t=>c(dt,_t),[()=>re(e(r).conditioning_started_at)]),i($,H)};v(St,$=>{e(r).conditioning_started_at&&$(Kt)})}var Qt=s(St,2);{var ra=$=>{var H=zi(),he=s(a(H),2),He=s(a(he),2),dt=a(He,!0);t(He),t(he),t(H),p(_t=>c(dt,_t),[()=>re(e(r).completed_at||e(r).end_time)]),i($,H)};v(Qt,$=>{(e(r).end_time||e(r).completed_at)&&$(ra)})}t(_e),t(Gt);var Xt=s(Gt,2);{var ia=$=>{Da($,{get notes(){return e(r).notes}})};v(Xt,$=>{e(r).notes&&$(ia)})}t(bt),p(($,H,he)=>{c(Lt,$),c(Bt,H),c(Me,`${he??""}%`)},[()=>X(e(r).measured_og),()=>X(e(r).measured_fg),()=>e(r).measured_abv?.toFixed(1)??"--"]),i(Ke,bt)},Oe=Ke=>{var bt=Gi(),Ze=W(bt),nt=a(Ze),yt=a(nt);{let _e=A(()=>e(Q)?.sg??e(P)?.measured?.current_sg);Os(yt,{get batch(){return e(r)},get currentSg(){return e(_e)},get progress(){return e(P)},get liveReading(){return e(Q)}})}var zt=s(yt,2);{var Lt=_e=>{fa(_e,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(zt,_e=>{e(r).recipe&&_e(Lt)})}t(nt);var vt=s(nt,2),Ct=a(vt);Ta(Ct,{get batch(){return e(r)},get liveReading(){return e(Q)},onEdit:()=>d(I,!0)});var Bt=s(Ct,2);{var qt=_e=>{Br(_e,{get batchId(){return e(r).id}})};v(Bt,_e=>{(e(r).status==="fermenting"||e(r).status==="conditioning")&&_e(qt)})}var F=s(Bt,2);{let _e=A(()=>e(Q)?.sg);kr(F,{get batchId(){return e(r).id},get measuredOg(){return e(r).measured_og},get currentSg(){return e(_e)},get liveReading(){return e(Q)}})}var Me=s(F,2);{var xt=_e=>{var Je=Ii();let Qe;var at=a(Je);at.__click=()=>d(E,!e(E));var Tt=s(a(at),2),St=a(Tt);{var Kt=H=>{var he=qi();i(H,he)},Qt=H=>{var he=we(),He=W(he);{var dt=Dt=>{var Zt=Si();i(Dt,Zt)},_t=Dt=>{var Zt=we(),ua=W(Zt);{var _a=Xe=>{var $e=Mi(),pt=a($e);t($e),p(gt=>c(pt,`üéØ ${gt??""}${e(le)??""}`),[()=>U(e(C).target_temp)]),i(Xe,$e)};v(ua,Xe=>{e(E)&&e(C)&&Xe(_a)},!0)}i(Dt,Zt)};v(He,Dt=>{e(C)?.cooler_state==="on"?Dt(dt):Dt(_t,!1)},!0)}i(H,he)};v(St,H=>{e(C)?.heater_state==="on"?H(Kt):H(Qt,!1)})}var ra=s(St,2);let Xt;t(Tt),t(at);var ia=s(at,2);{var $=H=>{var he=Pi(),He=W(he),dt=a(He);{var _t=Xe=>{var $e=Bi(),pt=a($e);let gt;var At=s(pt,2),mt=s(a(At),2);let Pt;var $t=a(mt,!0);t(mt);var Ht=s(mt,2),ea=a(Ht,!0);t(Ht),t(At),t($e),p(()=>{gt=Ee(pt,1,"device-icon-wrap svelte-g5au2j",null,gt,{active:e(C)?.heater_state==="on"}),Pt=Ee(mt,1,"device-state svelte-g5au2j",null,Pt,{on:e(C)?.heater_state==="on"}),c($t,e(C)?.heater_state==="on"?"ON":"OFF"),c(ea,e(r).heater_entity_id)}),i(Xe,$e)};v(dt,Xe=>{e(r).heater_entity_id&&Xe(_t)})}var Dt=s(dt,2);{var Zt=Xe=>{var $e=Fi(),pt=a($e);let gt;var At=s(pt,2),mt=s(a(At),2);let Pt;var $t=a(mt,!0);t(mt);var Ht=s(mt,2),ea=a(Ht,!0);t(Ht),t(At),t($e),p(()=>{gt=Ee(pt,1,"device-icon-wrap svelte-g5au2j",null,gt,{active:e(C)?.cooler_state==="on"}),Pt=Ee(mt,1,"device-state svelte-g5au2j",null,Pt,{on:e(C)?.cooler_state==="on"}),c($t,e(C)?.cooler_state==="on"?"ON":"OFF"),c(ea,e(r).cooler_entity_id)}),i(Xe,$e)};v(Dt,Xe=>{e(r).cooler_entity_id&&Xe(Zt)})}t(He);var ua=s(He,2);{var _a=Xe=>{var $e=Ai(),pt=W($e),gt=a(pt),At=s(a(gt),2),mt=a(At);t(At),t(gt);var Pt=s(gt,2),$t=s(a(Pt),2),Ht=a($t);t($t),t(Pt),t(pt);var ea=s(pt,2);{var Ka=st=>{var ft=Ri(),ht=s(a(ft),2),Ut=a(ht);t(ht);var Ba=s(ht,2);Ba.__click=()=>j(),t(ft),p(Za=>{c(Ut,`Override active: ${Za??""}`),Ba.disabled=e(ae)},[()=>e(C).override_state?.toUpperCase()]),i(st,ft)};v(ea,st=>{e(C).override_active&&st(Ka)})}var za=s(ea,2),Ca=s(a(za),2),qa=a(Ca);{var Qa=st=>{var ft=Ti(),ht=W(ft);ht.__click=()=>h("heater","on");var Ut=s(ht,2);Ut.__click=()=>h("heater","off"),p(()=>{ht.disabled=e(ae),Ut.disabled=e(ae)}),i(st,ft)};v(qa,st=>{e(r).heater_entity_id&&st(Qa)})}var Sa=s(qa,2);{var Xa=st=>{var ft=Di(),ht=W(ft);ht.__click=()=>h("cooler","on");var Ut=s(ht,2);Ut.__click=()=>h("cooler","off"),p(()=>{ht.disabled=e(ae),Ut.disabled=e(ae)}),i(st,ft)};v(Sa,st=>{e(r).cooler_entity_id&&st(Xa)})}var Ma=s(Sa,2);Ma.__click=()=>j(),t(Ca),t(za),p((st,ft)=>{c(mt,`${st??""}${e(le)??""}`),c(Ht,`¬±${ft??""}${e(le)??""}`),Ma.disabled=e(ae)},[()=>U(e(C).target_temp),()=>e(C).hysteresis?.toFixed(1)||"--"]),i(Xe,$e)};v(ua,Xe=>{e(C)&&Xe(_a)})}i(H,he)};v(ia,H=>{e(E)||H($)})}t(Je),p(()=>{Qe=Ee(Je,1,"info-card temp-control-card svelte-g5au2j",null,Qe,{"heater-on":e(C)?.heater_state==="on","cooler-on":e(C)?.cooler_state==="on",collapsed:e(E)}),Xt=Ee(ra,0,"chevron svelte-g5au2j",null,Xt,{rotated:!e(E)})}),i(_e,Je)},Ft=_e=>{var Je=we(),Qe=W(Je);{var at=Tt=>{var St=Ni(),Kt=s(a(St),2),Qt=a(Kt);{var ra=$=>{var H=Oi(),he=a(H);t(H),p(()=>c(he,`Heater: ${e(r).heater_entity_id??""}`)),i($,H)};v(Qt,$=>{e(r).heater_entity_id&&$(ra)})}var Xt=s(Qt,2);{var ia=$=>{var H=Ei(),he=a(H);t(H),p(()=>c(he,`Cooler: ${e(r).cooler_entity_id??""}`)),i($,H)};v(Xt,$=>{e(r).cooler_entity_id&&$(ia)})}ze(2),t(Kt),t(St),i(Tt,St)};v(Qe,Tt=>{(e(r).heater_entity_id||e(r).cooler_entity_id)&&e(r).status!=="fermenting"&&Tt(at)},!0)}i(_e,Je)};v(Me,_e=>{e(ee)&&(e(r).status==="fermenting"||e(r).status==="conditioning")?_e(xt):_e(Ft,!1)})}var Rt=s(Me,2);{var ot=_e=>{Da(_e,{get notes(){return e(r).notes}})};v(Rt,_e=>{e(r).notes&&_e(ot)})}t(vt),t(Ze);var kt=s(Ze,2);{var Gt=_e=>{var Je=Li(),Qe=a(Je);ks(Qe,{get batchId(){return e(r).id},get deviceColor(){return e(r).device_id},get originalGravity(){return e(r).measured_og},get controlEvents(){return de}}),t(Je),i(_e,Je)};v(kt,_e=>{e(r).device_id&&_e(Gt)})}i(Ke,bt)};v(Ie,Ke=>{e(r).status==="completed"?Ke(lt):Ke(Oe,!1)},!0)}i(Te,Se)};v(me,Te=>{e(r).status==="brewing"?Te(Re):Te(Pe,!1)},!0)}i(oe,V)};v(Wa,oe=>{e(r).status==="planning"?oe(Ja):oe(Ya,!1)})}p(()=>{c(Nt,`#${(e(r).batch_number||"?")??""}`),c(ut,e(r).name||e(r).recipe?.name||"Unnamed Batch"),wt.disabled=e(J),rt(wt,`color: ${e(S).color??""}; background: ${e(S).bg??""};`),ya!==(ya=e(r).status)&&(wt.value=(wt.__value=e(r).status)??"",vs(wt,e(r).status))}),i(Ve,Ae)};v(je,Ve=>{e(I)?Ve(De):Ve(Ye,!1)},!0)}i(B,G)};v(Ue,B=>{e(r)?B(q,!1):B(Ge)},!0)}i(ve,Le)};v(se,ve=>{e(fe)?ve(O):ve(te,!1)},!0)}i(g,Z)};v(Be,g=>{e(be)?g(Fe):g(qe,!1)})}t(xe);var Ce=s(xe,2);{var Ne=g=>{var Z=Ui();Z.__click=()=>d(ie,!1),Z.__keydown=q=>q.key==="Escape"&&d(ie,!1);var se=a(Z);se.__click=q=>q.stopPropagation(),se.__keydown=q=>q.stopPropagation();var O=s(a(se),2),te=a(O);t(O);var ve=s(O,2),Le=a(ve);Le.__click=()=>d(ie,!1);var Ue=s(Le,2);Ue.__click=y;var Ge=a(Ue,!0);t(Ue),t(ve),t(se),t(Z),p(()=>{c(te,`Are you sure you want to delete "${(e(r)?.name||"this batch")??""}"? This cannot be undone.`),Le.disabled=e(w),Ue.disabled=e(w),c(Ge,e(w)?"Deleting...":"Delete Batch")}),i(g,Z)};v(Ce,g=>{e(ie)&&g(Ne)})}i(ke,ge),Et(),z()}Jt(["click","change","keydown"]);export{pl as component,_l as universal};
