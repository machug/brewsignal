import{d as Zt,f as n,s as d,a as l,c as He,t as Yt,h as da,e as Mt}from"../chunks/orbuQWWI.js";import{d as a,e as s,r as t,t as u,a as Ht,f as oe,h as e,u as L,n as xe,g as Wt,s as U,p as Ze,o as Wa,c as o,az as Ma,b9 as as,i as Da,aJ as ss,aC as rs,ax as ls}from"../chunks/pAodAtlG.js";import{e as Dt,i as Kt}from"../chunks/0whDC7Rl.js";import{i as v}from"../chunks/ucc1DXe2.js";import{h as is}from"../chunks/DJBMpqSf.js";import{s as Qt,r as Ct,a as Ia}from"../chunks/CYuZshLQ.js";import{s as Ee}from"../chunks/Cpbxxhlc.js";import{s as At}from"../chunks/C-5oeV0L.js";import{b as Ta,i as ns,s as vs}from"../chunks/RboyDiSx.js";import{s as os,a as ds}from"../chunks/BkeTWnxc.js";import{p as cs}from"../chunks/DI6ZqqrE.js";import{g as us}from"../chunks/-HrUrg8M.js";import{a8 as _s,a9 as ps,aa as fs,ab as gs,ac as hs,Q as oa,ad as ms,ae as bs,af as ys,X as xs,S as Ca,ag as ja,a3 as ks,ah as Ba}from"../chunks/DsM_eXzM.js";import{b as Bt,d as Sa,g as Aa,c as qa}from"../chunks/C54DtTUy.js";import{t as Ua}from"../chunks/DWpXqN03.js";import{B as ws}from"../chunks/CKiN9Vr8.js";import{s as js}from"../chunks/GbV1md6Y.js";import{p as sa}from"../chunks/C44MPb_E.js";import{F as qs}from"../chunks/CfPvXJRK.js";import{b as yt}from"../chunks/Dh5hCwq1.js";import{s as Fa}from"../chunks/BkabqQ1A.js";const Ss=!1,mn=Object.freeze(Object.defineProperty({__proto__:null,prerender:Ss},Symbol.toStringTag,{value:"Module"}));function Ms(Pe){return Pe>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:Pe>=-60?{bars:3,color:"var(--positive)",label:"Good"}:Pe>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function Xa(Pe){const i=Math.floor((Date.now()-new Date(Pe).getTime())/1e3);if(i<10)return"just now";if(i<60)return`${i}s ago`;const g=Math.floor(i/60);if(g<60)return`${g}m ago`;const S=Math.floor(g/60);return S<24?`${S}h ago`:`${Math.floor(S/24)}d ago`}var Cs=n('<div class="accent-bar svelte-1oyrwd9"></div>'),Bs=n('<span class="card-icon svelte-1oyrwd9"> </span>'),Fs=n('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),zs=n('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function xa(Pe,i){let g=sa(i,"highlight",3,!1),S=sa(i,"compact",3,!1),E=sa(i,"collapsible",3,!1),B=sa(i,"expanded",3,!1);var K=zs();let r;var P=a(K);{var q=N=>{var V=Cs();l(N,V)};v(P,N=>{g()&&N(q)})}var Q=s(P,2),de=a(Q),je=a(de);{var M=N=>{var V=Bs(),te=a(V,!0);t(V),u(()=>d(te,i.icon)),l(N,V)};v(je,N=>{i.icon&&N(M)})}var X=s(je,2),J=a(X,!0);t(X),t(de);var le=s(de,2);{var R=N=>{var V=Fs();V.__click=function(..._e){i.onToggle?.apply(this,_e)};var te=a(V);let ee;t(V),u(()=>{Qt(V,"aria-label",B()?"Collapse":"Expand"),ee=Ee(te,0,"expand-icon svelte-1oyrwd9",null,ee,{"rotate-180":B()})}),l(N,V)};v(le,N=>{E()&&i.onToggle&&N(R)})}t(Q);var Z=s(Q,2);let $;var re=a(Z);js(re,()=>i.children),t(Z),t(K),u(()=>{r=Ee(K,1,"batch-card svelte-1oyrwd9",null,r,{highlight:g(),compact:S()}),d(J,i.title),$=Ee(Z,1,"card-content svelte-1oyrwd9",null,$,{collapsed:E()&&!B()})}),l(Pe,K)}Zt(["click"]);var Ts=n('<span class="updated-text svelte-t80j9z"> </span>'),Ds=n('<div class="hero-divider svelte-t80j9z"></div> <div class="hero-metric temperature svelte-t80j9z"><span class="hero-value svelte-t80j9z"> <span class="hero-unit svelte-t80j9z"> </span></span> <span class="hero-label svelte-t80j9z">Temperature</span></div>',1),As=n('<div class="remaining-text svelte-t80j9z"> </div>'),Ps=n('<div class="progress-section svelte-t80j9z"><div class="progress-labels svelte-t80j9z"><div class="progress-endpoint start svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">OG</span></div> <div class="progress-current svelte-t80j9z"><span class="current-percent svelte-t80j9z"> </span></div> <div class="progress-endpoint end svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">Target FG</span></div></div> <div class="progress-track svelte-t80j9z"><div class="progress-fill svelte-t80j9z"></div> <div><div class="marker-dot svelte-t80j9z"></div> <div class="marker-value svelte-t80j9z"> </div></div></div> <!></div>'),Rs=n('<div class="metrics-row svelte-t80j9z"><div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">ABV</span></div> <div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">Attenuation</span></div></div>'),Ns=n('<div class="status-row svelte-t80j9z"><div class="live-indicator svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> <span class="status-text svelte-t80j9z">LIVE</span></div> <!></div> <div class="hero-section svelte-t80j9z"><div class="hero-metric gravity svelte-t80j9z"><span class="hero-value svelte-t80j9z"> </span> <span class="hero-label svelte-t80j9z">Gravity</span></div> <!></div> <!> <!>',1),Os=n('<div class="completed-grid svelte-t80j9z"><div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Original Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Final Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">ABV</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Attenuation</span></div></div>'),Ls=n('<div class="empty-state svelte-t80j9z"><div class="empty-icon svelte-t80j9z">‚óé</div> <p class="empty-text svelte-t80j9z">Set Original Gravity to track fermentation</p></div>');function Es(Pe,i){Ht(i,!0);let g=L(()=>i.currentSg??i.progress?.measured?.current_sg),S=L(()=>i.liveReading?.temp??i.progress?.temperature?.current),E=L(()=>i.liveReading?.last_seen),B=L(()=>e(E)?Xa(e(E)):null),K=L(Aa),r=L(()=>{if(!i.batch.measured_og||!e(g))return null;const M=Math.max(0,(i.batch.measured_og-e(g))*131.25),X=i.batch.measured_og-1,J=X!==0?Math.max(0,Math.min(100,(i.batch.measured_og-e(g))/X*100)):0;return{abv:M,attenuation:J}}),P=L(()=>{const M=i.batch.measured_og,X=i.batch.recipe?.fg;if(!M||!X||!e(g))return null;const J=M-X,le=M-e(g);return J<=0?null:Math.max(0,Math.min(100,le/J*100))}),q=L(()=>i.batch.status==="fermenting"||i.batch.status==="conditioning");function Q(M){return M==null?"--":Bt(M)}function de(M){return M==null?"--":`${M.toFixed(1)}%`}function je(M){return M==null?"--":Sa(M)}xa(Pe,{title:"Fermentation",children:(M,X)=>{var J=He(),le=oe(J);{var R=$=>{var re=Ns(),N=oe(re),V=s(a(N),2);{var te=p=>{var c=Ts(),f=a(c);t(c),u(()=>d(f,`Updated ${e(B)??""}`)),l(p,c)};v(V,p=>{e(B)&&p(te)})}t(N);var ee=s(N,2),_e=a(ee),qe=a(_e),Me=a(qe,!0);t(qe),xe(2),t(_e);var se=s(_e,2);{var w=p=>{var c=Ds(),f=s(oe(c),2),k=a(f),y=a(k,!0),F=s(y),H=a(F,!0);t(F),t(k),xe(2),t(f),u(O=>{d(y,O),d(H,e(K))},[()=>je(e(S))]),l(p,c)};v(se,p=>{e(S)!=null&&p(w)})}t(ee);var m=s(ee,2);{var x=p=>{var c=Ps(),f=a(c),k=a(f),y=a(k),F=a(y,!0);t(y),xe(2),t(k);var H=s(k,2),O=a(H),ce=a(O);t(O),t(H);var ae=s(H,2),pe=a(ae),ie=a(pe,!0);t(pe),xe(2),t(ae),t(f);var ke=s(f,2),Se=a(ke),Be=s(Se,2);let Ge;var Fe=s(a(Be),2),fe=a(Fe,!0);t(Fe),t(Be),t(ke);var _=s(ke,2);{var j=T=>{var D=As(),W=a(D);t(D),u(Y=>d(W,`${Y??""} points to go`),[()=>i.progress.progress.sg_remaining.toFixed(3)]),l(T,D)};v(_,T=>{i.progress?.progress?.sg_remaining!=null&&i.progress.progress.sg_remaining>0&&T(j)})}t(c),u((T,D,W,Y)=>{d(F,T),d(ce,`${D??""}%`),d(ie,W),At(Se,`width: ${e(P)??""}%`),Ge=Ee(Be,1,"progress-marker svelte-t80j9z",null,Ge,{"at-start":e(P)<3}),At(Be,`left: ${e(P)??""}%`),d(fe,Y)},[()=>Q(i.batch.measured_og),()=>e(P).toFixed(0),()=>Q(i.batch.recipe.fg),()=>Q(e(g))]),l(p,c)};v(m,p=>{e(P)!==null&&i.batch.measured_og&&i.batch.recipe?.fg&&p(x)})}var b=s(m,2);{var h=p=>{var c=Rs(),f=a(c),k=a(f),y=a(k,!0);t(k),xe(2),t(f);var F=s(f,2),H=a(F),O=a(H,!0);t(H),xe(2),t(F),t(c),u((ce,ae)=>{d(y,ce),d(O,ae)},[()=>de(e(r).abv),()=>de(e(r).attenuation)]),l(p,c)};v(b,p=>{e(r)&&p(h)})}u(p=>d(Me,p),[()=>Q(e(g))]),l($,re)},Z=$=>{var re=He(),N=oe(re);{var V=ee=>{const _e=L(()=>i.batch.measured_fg??i.progress?.measured?.fg??i.progress?.measured?.current_sg),qe=L(()=>i.batch.measured_abv??i.progress?.measured?.abv),Me=L(()=>i.batch.measured_attenuation??i.progress?.measured?.attenuation);var se=Os(),w=a(se),m=a(w),x=a(m,!0);t(m),xe(2),t(w);var b=s(w,2),h=a(b),p=a(h,!0);t(h),xe(2),t(b);var c=s(b,2),f=a(c),k=a(f,!0);t(f),xe(2),t(c);var y=s(c,2),F=a(y),H=a(F,!0);t(F),xe(2),t(y),t(se),u((O,ce,ae,pe)=>{d(x,O),d(p,ce),d(k,ae),d(H,pe)},[()=>Q(i.batch.measured_og),()=>Q(e(_e)),()=>e(qe)!=null?de(e(qe)):"--",()=>e(Me)!=null?de(e(Me)):"--"]),l(ee,se)},te=ee=>{var _e=Ls();l(ee,_e)};v(N,ee=>{i.batch.measured_og?ee(V):ee(te,!1)},!0)}l($,re)};v(le,$=>{e(g)&&e(q)?$(R):$(Z,!1)})}l(M,J)},$$slots:{default:!0}}),Wt()}var Gs=n('<span class="device-last-seen svelte-1kdxwtz"> </span>'),Is=n('<div class="signal-bar svelte-1kdxwtz"></div>'),Us=n('<div class="metric-item svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="metric-text svelte-1kdxwtz"> </span></div>'),Vs=n('<div class="metric-item battery svelte-1kdxwtz"><svg class="battery-icon svelte-1kdxwtz" viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="2" y="7" width="18" height="10" rx="2"></rect><rect x="4" y="9" height="6" stroke="none" rx="1"></rect><path d="M20 10v4h2v-4z" stroke="none"></path></svg> <span class="metric-text svelte-1kdxwtz"><!></span></div>'),Hs=n('<div class="device-metrics svelte-1kdxwtz"><!> <!></div>'),Ws=n('<div class="device-row svelte-1kdxwtz"><div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!></div> <!>',1),Xs=n('<div class="device-row svelte-1kdxwtz"><div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <span class="device-last-seen svelte-1kdxwtz">No data</span></div>'),Js=n('<div class="device-info svelte-1kdxwtz"><!></div>'),Ys=n('<button type="button" class="link-btn svelte-1kdxwtz">Link device</button>'),Ks=n('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function Va(Pe,i){Ht(i,!0);let g=L(()=>i.liveReading?.device_type==="tilt"),S=L(()=>e(g)&&i.liveReading?.rssi?Ms(i.liveReading.rssi):null),E=L(()=>i.liveReading?.last_seen?Xa(i.liveReading.last_seen):null),B=L(()=>i.liveReading?.battery_percent!=null||i.liveReading?.battery_voltage!=null),K=L(()=>i.liveReading?.battery_percent),r=L(()=>i.liveReading?.battery_voltage),P=L(()=>e(K)?e(K)>50?"var(--positive)":e(K)>20?"var(--warning)":"var(--negative)":"var(--text-muted)"),q=L(()=>{if(!i.liveReading)return i.batch.device_id||"Unknown";const Q=i.liveReading.device_type;return Q==="tilt"?`${i.liveReading.color} Tilt`:Q==="gravitymon"?`GravityMon (${i.liveReading.id})`:Q==="ispindel"?`iSpindel (${i.liveReading.id})`:Q==="floaty"?`Floaty (${i.liveReading.id})`:i.liveReading.color||i.liveReading.id});xa(Pe,{title:"Tracking Device",compact:!0,children:(Q,de)=>{var je=He(),M=oe(je);{var X=le=>{var R=Js(),Z=a(R);{var $=N=>{var V=Ws(),te=oe(V),ee=a(te),_e=s(a(ee));t(ee);var qe=s(ee,2);{var Me=m=>{var x=Gs(),b=a(x,!0);t(x),u(()=>d(b,e(E))),l(m,x)};v(qe,m=>{e(E)&&m(Me)})}t(te);var se=s(te,2);{var w=m=>{var x=Hs(),b=a(x);{var h=f=>{var k=Us(),y=a(k);Dt(y,20,()=>Array(4),Kt,(O,ce,ae)=>{var pe=Is();u(()=>At(pe,`height: ${4+ae*2}px; background: ${(ae<e(S).bars?e(S).color:"var(--bg-hover)")??""}; opacity: ${ae<e(S).bars?1:.4};`)),l(O,pe)}),t(y);var F=s(y,2),H=a(F);t(F),t(k),u(()=>{At(F,`color: ${e(S).color??""}`),d(H,`${i.liveReading.rssi??""}dBm`)}),l(f,k)};v(b,f=>{e(S)&&f(h)})}var p=s(b,2);{var c=f=>{var k=Vs(),y=a(k),F=s(a(y)),H=s(F);t(y);var O=s(y,2),ce=a(O);{var ae=ie=>{var ke=Yt();u(Se=>d(ke,`${Se??""}%`),[()=>e(K).toFixed(0)]),l(ie,ke)},pe=ie=>{var ke=He(),Se=oe(ke);{var Be=Ge=>{var Fe=Yt();u(fe=>d(Fe,`${fe??""}V`),[()=>e(r).toFixed(2)]),l(Ge,Fe)};v(Se,Ge=>{e(r)!=null&&Ge(Be)},!0)}l(ie,ke)};v(ce,ie=>{e(K)!=null?ie(ae):ie(pe,!1)})}t(O),t(k),u(()=>{Qt(y,"stroke",e(P)),Qt(F,"width",(e(K)??50)*.14),Qt(F,"fill",e(P)),Qt(H,"fill",e(P)),At(O,`color: ${e(P)??""}`)}),l(f,k)};v(p,f=>{e(B)&&f(c)})}t(x),l(m,x)};v(se,m=>{(e(S)||e(B))&&m(w)})}u(()=>d(_e,` ${e(q)??""}`)),l(N,V)},re=N=>{var V=Xs(),te=a(V),ee=s(a(te));t(te),xe(2),t(V),u(()=>d(ee,` ${i.batch.device_id??""}`)),l(N,V)};v(Z,N=>{i.liveReading?N($):N(re,!1)})}t(R),l(le,R)},J=le=>{var R=Ks(),Z=s(a(R),2);{var $=re=>{var N=Ys();N.__click=function(...V){i.onEdit?.apply(this,V)},l(re,N)};v(Z,re=>{i.onEdit&&re($)})}t(R),l(le,R)};v(M,le=>{i.batch.device_id?le(X):le(J,!1)})}l(Q,je)},$$slots:{default:!0}}),Wt()}Zt(["click"]);const Qs=131.25;var Zs=n('<span class="yeast-producer svelte-19u9n31"> </span>'),$s=n('<span class="yeast-temp svelte-19u9n31"> </span>'),er=n('<div class="yeast-row recipe svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Recipe</span> <span class="yeast-value muted svelte-19u9n31"> </span></div>'),tr=n('<div class="yeast-row actual svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span> <!> <!></div> <!>',1),ar=n('<div class="yeast-row svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span></div>'),sr=n('<div class="yeast-section svelte-19u9n31"><!></div>'),rr=n('<div class="targets-row svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div></div> <!>',1);function za(Pe,i){Ht(i,!0);function g(E){return E==null?"--":Bt(E)}let S=L(()=>i.recipe.abv!=null?i.recipe.abv:i.recipe.og&&i.recipe.fg?(i.recipe.og-i.recipe.fg)*Qs:null);xa(Pe,{title:"Recipe Targets",compact:!0,children:(E,B)=>{var K=rr(),r=oe(K),P=a(r),q=s(a(P),2),Q=a(q,!0);t(q),t(P);var de=s(P,2),je=s(a(de),2),M=a(je,!0);t(je),t(de);var X=s(de,2),J=s(a(X),2),le=a(J,!0);t(J),t(X),t(r);var R=s(r,2);{var Z=$=>{var re=sr(),N=a(re);{var V=ee=>{var _e=tr(),qe=oe(_e),Me=s(a(qe),2),se=a(Me,!0);t(Me);var w=s(Me,2);{var m=c=>{var f=Zs(),k=a(f);t(f),u(()=>d(k,`(${i.yeastStrain.producer??""})`)),l(c,f)};v(w,c=>{i.yeastStrain.producer&&c(m)})}var x=s(w,2);{var b=c=>{var f=$s(),k=a(f);t(f),u((y,F)=>d(k,`${y??""}-${F??""}¬∞C`),[()=>i.yeastStrain.temp_low.toFixed(0),()=>i.yeastStrain.temp_high.toFixed(0)]),l(c,f)};v(x,c=>{i.yeastStrain.temp_low&&i.yeastStrain.temp_high&&c(b)})}t(qe);var h=s(qe,2);{var p=c=>{var f=er(),k=s(a(f),2),y=a(k,!0);t(k),t(f),u(()=>d(y,i.recipe.yeast_name)),l(c,f)};v(h,c=>{i.recipe.yeast_name&&c(p)})}u(()=>d(se,i.yeastStrain.name)),l(ee,_e)},te=ee=>{var _e=He(),qe=oe(_e);{var Me=se=>{var w=ar(),m=s(a(w),2),x=a(m,!0);t(m),t(w),u(()=>d(x,i.recipe.yeast_name)),l(se,w)};v(qe,se=>{i.recipe.yeast_name&&se(Me)},!0)}l(ee,_e)};v(N,ee=>{i.yeastStrain?ee(V):ee(te,!1)})}t(re),l($,re)};v(R,$=>{(i.yeastStrain||i.recipe.yeast_name)&&$(Z)})}u(($,re,N)=>{d(Q,$),d(M,re),d(le,N)},[()=>g(i.recipe.og),()=>g(i.recipe.fg),()=>e(S)!=null?`${e(S).toFixed(1)}%`:"--"]),l(E,K)},$$slots:{default:!0}}),Wt()}var lr=n('<p class="notes-content svelte-hkv31i"> </p>');function Ha(Pe,i){xa(Pe,{title:"Notes",children:(g,S)=>{var E=lr(),B=a(E,!0);t(E),u(()=>d(B,i.notes)),l(g,E)},$$slots:{default:!0}})}var ir=n('<div class="ml-panel loading svelte-1xs394q"><p> </p></div>'),nr=n('<div class="ml-panel error svelte-1xs394q"><p class="error-text svelte-1xs394q"> </p></div>'),vr=n("<option> </option>"),or=n('<div class="header-controls svelte-1xs394q"><select class="model-select svelte-1xs394q" title="Select prediction model"></select> <button type="button" class="reload-btn svelte-1xs394q" title="Recalculate predictions from database history"> </button></div>'),dr=n('<span class="accuracy-icon svelte-1xs394q">‚úì</span> <span class="accuracy-title svelte-1xs394q">Excellent Prediction</span>',1),cr=n('<span class="accuracy-icon svelte-1xs394q">‚âà</span> <span class="accuracy-title svelte-1xs394q">Close Prediction</span>',1),ur=n('<span class="accuracy-icon svelte-1xs394q">‚ñ≥</span> <span class="accuracy-title svelte-1xs394q">Prediction Variance</span>',1),_r=n('<div><div class="accuracy-header svelte-1xs394q"><!></div> <p class="accuracy-detail svelte-1xs394q"> <span class="accuracy-diff svelte-1xs394q"> </span></p></div>'),pr=n('<span class="comparison-predicted svelte-1xs394q"> </span>'),fr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model:</span> <span class="model-value model-type svelte-1xs394q"> </span></div>'),gr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),hr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),mr=n('<div class="summary-section svelte-1xs394q"><!> <div class="comparison-grid svelte-1xs394q"><div class="comparison-item svelte-1xs394q"><span class="comparison-label svelte-1xs394q">Final Gravity</span> <div class="comparison-values svelte-1xs394q"><span class="comparison-actual svelte-1xs394q"> </span> <!></div></div></div> <div class="model-info summary-model svelte-1xs394q"><!> <!> <!></div></div>'),br=n('<span class="anomaly-reasons svelte-1xs394q"> </span>'),yr=n('<div class="anomaly-banner svelte-1xs394q"><span class="anomaly-icon svelte-1xs394q">‚ö†Ô∏è</span> <div class="anomaly-content svelte-1xs394q"><span class="anomaly-label svelte-1xs394q">Anomaly Detected</span> <!></div></div>'),xr=n('<span class="activity-badge svelte-1xs394q"> </span>'),kr=n('<div class="progress-section svelte-1xs394q"><div class="progress-header svelte-1xs394q"><span class="progress-label svelte-1xs394q">Fermentation Progress</span> <!></div> <div class="fermentation-progress-bar svelte-1xs394q"><div class="fermentation-fill svelte-1xs394q"></div></div> <div class="progress-labels svelte-1xs394q"><span class="og-label svelte-1xs394q"> </span> <span class="progress-percent svelte-1xs394q"> </span> <span class="fg-label svelte-1xs394q"> </span></div></div>'),wr=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Predicted FG:</span> <span class="value svelte-1xs394q"> </span></div>'),jr=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Attenuation:</span> <span class="value attenuation svelte-1xs394q"> </span></div>'),qr=n('<span class="complete-now svelte-1xs394q">Ready now!</span>'),Sr=n('<span class="days svelte-1xs394q"> </span>'),Mr=n(" <!>",1),Cr=n('<div class="metric completion-metric svelte-1xs394q"><span class="label svelte-1xs394q">Est. Completion:</span> <span class="value svelte-1xs394q"><!></span></div>'),Br=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model:</span> <span class="model-value model-type svelte-1xs394q"> </span></div>'),Fr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),zr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),Tr=n('<!> <!> <div class="metrics svelte-1xs394q"><!> <!> <!> <div class="model-info svelte-1xs394q"><!> <!> <!></div></div>',1),Dr=n('<div><div class="panel-header svelte-1xs394q"><h3 class="panel-title svelte-1xs394q"> </h3> <!></div> <!></div>'),Ar=n('<div class="ml-panel disabled svelte-1xs394q"><div class="disabled-header svelte-1xs394q"><p class="unavailable-text svelte-1xs394q"> </p> <button type="button" class="reload-btn svelte-1xs394q" title="Reload predictions from database"> </button></div> <p class="unavailable-hint svelte-1xs394q"><!></p></div>');function Pr(Pe,i){Ht(i,!0);let g=sa(i,"batchStatus",3,"fermenting"),S=sa(i,"measuredOg",3,null),E=sa(i,"measuredFg",3,null),B=sa(i,"currentSg",3,null),K=sa(i,"liveReading",3,null),r=U(Ze({available:!1})),P=U(!0),q=U(!1),Q=U(null),de=U("auto");const je=[{value:"auto",label:"Auto (Best Fit)"},{value:"exponential",label:"Exponential"},{value:"gompertz",label:"Gompertz (S-Curve)"},{value:"logistic",label:"Logistic"}];let M=L(()=>g()==="completed"||g()==="archived"),X=L(()=>E()??B()),J=L(()=>{if(!e(M)||!e(r).predicted_fg||!e(X))return null;const m=Math.abs(e(r).predicted_fg-e(X)),x=Math.round(m*1e3);return{diff:m,points:x,isAccurate:x<=2,isClose:x<=5}});async function le(){o(P,!0),o(Q,null);try{o(r,await ps(i.batchId,e(de)),!0)}catch(m){o(Q,m instanceof Error?m.message:"Failed to load predictions",!0),console.error("Failed to load ML predictions:",m)}finally{o(P,!1)}}async function R(){o(q,!0),o(Q,null);try{const m=await _s(i.batchId);console.log("Reloaded predictions:",m.message),await le()}catch(m){o(Q,m instanceof Error?m.message:"Failed to reload predictions",!0),console.error("Failed to reload predictions:",m)}finally{o(q,!1)}}function Z(){le()}Wa(R);function $(m){return m?new Date(m).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}):"N/A"}function re(m){if(!m)return null;const x=new Date(m),b=new Date,h=x.getTime()-b.getTime();return Math.ceil(h/(1e3*60*60*24))}let N=L(()=>{const m=S()??e(r).predicted_og,x=e(r).predicted_fg,b=B()??K()?.sg;if(!m||!x||!b||m<=x)return null;const h=m-x,c=(m-b)/h*100;return Math.min(100,Math.max(0,c))}),V=L(()=>{const m=S()??e(r).predicted_og,x=B()??K()?.sg;if(!m||!x||m<=1)return null;const b=(m-x)/(m-1)*100;return Math.min(100,Math.max(0,b))}),te=L(()=>{const m=K()?.sg_rate;if(m==null)return null;const x=Math.abs(m);return x>.002?{label:"Very Active",color:"var(--activity-very-active)",emoji:"üî•"}:x>5e-4?{label:"Active",color:"var(--activity-active)",emoji:"‚ú®"}:x>1e-4?{label:"Slowing",color:"var(--activity-slowing)",emoji:"üê¢"}:{label:"Complete",color:"var(--activity-complete)",emoji:"‚úì"}}),ee=L(()=>K()?.is_anomaly??!1),_e=L(()=>K()?.anomaly_reasons??[]);var qe=He(),Me=oe(qe);{var se=m=>{var x=ir(),b=a(x),h=a(b);t(b),t(x),u(()=>d(h,`Loading ${e(M)?"summary":"predictions"}...`)),l(m,x)},w=m=>{var x=He(),b=oe(x);{var h=c=>{var f=nr(),k=a(f),y=a(k);t(k),t(f),u(()=>d(y,`‚ö†Ô∏è ${e(Q)??""}`)),l(c,f)},p=c=>{var f=He(),k=oe(f);{var y=H=>{var O=Dr();let ce;var ae=a(O),pe=a(ae),ie=a(pe,!0);t(pe);var ke=s(pe,2);{var Se=fe=>{var _=or(),j=a(_);j.__change=Z,Dt(j,21,()=>je,Kt,(W,Y)=>{var ne=vr(),ge=a(ne,!0);t(ne);var be={};u(()=>{d(ge,e(Y).label),be!==(be=e(Y).value)&&(ne.value=(ne.__value=e(Y).value)??"")}),l(W,ne)}),t(j);var T=s(j,2);T.__click=R;var D=a(T,!0);t(T),t(_),u(()=>{j.disabled=e(P)||e(q),T.disabled=e(q)||e(P),d(D,e(q)?"Reloading...":"‚Üª")}),Ta(j,()=>e(de),W=>o(de,W)),l(fe,_)};v(ke,fe=>{e(M)||fe(Se)})}t(ae);var Be=s(ae,2);{var Ge=fe=>{var _=mr(),j=a(_);{var T=G=>{var ve=_r();let A;var I=a(ve),me=a(I);{var ze=$e=>{var et=dr();xe(2),l($e,et)},Xe=$e=>{var et=He(),ot=oe(et);{var De=we=>{var Je=cr();xe(2),l(we,Je)},pt=we=>{var Je=ur();xe(2),l(we,Je)};v(ot,we=>{e(J).isClose?we(De):we(pt,!1)},!0)}l($e,et)};v(me,$e=>{e(J).isAccurate?$e(ze):$e(Xe,!1)})}t(I);var Ie=s(I,2),Ue=a(Ie),Re=s(Ue),Qe=a(Re);t(Re),t(Ie),t(ve),u(($e,et)=>{A=Ee(ve,1,"accuracy-banner svelte-1xs394q",null,A,{accurate:e(J).isAccurate,close:e(J).isClose&&!e(J).isAccurate}),d(Ue,`Model predicted ${$e??""}, actual was ${et??""} `),d(Qe,`(${e(J).points??""} points ${e(r).predicted_fg&&e(r).predicted_fg>e(X)?"high":"low"})`)},[()=>Bt(e(r).predicted_fg??0),()=>Bt(e(X))]),l(G,ve)};v(j,G=>{e(J)&&e(X)&&G(T)})}var D=s(j,2),W=a(D),Y=s(a(W),2),ne=a(Y),ge=a(ne,!0);t(ne);var be=s(ne,2);{var ye=G=>{var ve=pr(),A=a(ve);t(ve),u(I=>d(A,`ML: ${I??""}`),[()=>Bt(e(r).predicted_fg)]),l(G,ve)};v(be,G=>{e(r).predicted_fg&&G(ye)})}t(Y),t(W),t(D);var We=s(D,2),bt=a(We);{var _t=G=>{var ve=fr(),A=s(a(ve),2),I=a(A,!0);t(A),t(ve),u(()=>d(I,e(r).model_type)),l(G,ve)};v(bt,G=>{e(r).model_type&&G(_t)})}var Pt=s(bt,2);{var C=G=>{var ve=gr(),A=s(a(ve),2),I=a(A);t(A),t(ve),u(me=>d(I,`${me??""}%`),[()=>(e(r).r_squared*100).toFixed(0)]),l(G,ve)};v(Pt,G=>{e(r).r_squared!==void 0&&G(C)})}var z=s(Pt,2);{var he=G=>{var ve=hr(),A=s(a(ve),2),I=a(A,!0);t(A),t(ve),u(()=>d(I,e(r).num_readings)),l(G,ve)};v(z,G=>{e(r).num_readings&&G(he)})}t(We),t(_),u(G=>d(ge,G),[()=>Bt(e(X)??0)]),l(fe,_)},Fe=fe=>{var _=Tr(),j=oe(_);{var T=A=>{var I=yr(),me=s(a(I),2),ze=s(a(me),2);{var Xe=Ie=>{var Ue=br(),Re=a(Ue,!0);t(Ue),u(Qe=>d(Re,Qe),[()=>e(_e).join(", ")]),l(Ie,Ue)};v(ze,Ie=>{e(_e).length>0&&Ie(Xe)})}t(me),t(I),l(A,I)};v(j,A=>{e(ee)&&A(T)})}var D=s(j,2);{var W=A=>{var I=kr(),me=a(I),ze=s(a(me),2);{var Xe=we=>{var Je=xr(),Rt=a(Je);t(Je),u(()=>{At(Je,`color: ${e(te).color??""}`),d(Rt,`${e(te).emoji??""} ${e(te).label??""}`)}),l(we,Je)};v(ze,we=>{e(te)&&we(Xe)})}t(me);var Ie=s(me,2),Ue=a(Ie);t(Ie);var Re=s(Ie,2),Qe=a(Re),$e=a(Qe);t(Qe);var et=s(Qe,2),ot=a(et);t(et);var De=s(et,2),pt=a(De);t(De),t(Re),t(I),u((we,Je,Rt)=>{At(Ue,`width: ${e(N)??""}%`),d($e,`OG: ${we??""}`),d(ot,`${Je??""}%`),d(pt,`FG: ${Rt??""}`)},[()=>Bt(S()??e(r).predicted_og??0),()=>e(N).toFixed(0),()=>Bt(e(r).predicted_fg??0)]),l(A,I)};v(D,A=>{e(N)!==null&&A(W)})}var Y=s(D,2),ne=a(Y);{var ge=A=>{var I=wr(),me=s(a(I),2),ze=a(me,!0);t(me),t(I),u(Xe=>d(ze,Xe),[()=>Bt(e(r).predicted_fg)]),l(A,I)};v(ne,A=>{e(r).predicted_fg&&A(ge)})}var be=s(ne,2);{var ye=A=>{var I=jr(),me=s(a(I),2),ze=a(me);t(me),t(I),u(Xe=>d(ze,`${Xe??""}%`),[()=>e(V).toFixed(1)]),l(A,I)};v(be,A=>{e(V)!==null&&A(ye)})}var We=s(be,2);{var bt=A=>{const I=L(()=>re(e(r).estimated_completion));var me=Cr(),ze=s(a(me),2),Xe=a(ze);{var Ie=Re=>{var Qe=qr();l(Re,Qe)},Ue=Re=>{var Qe=Mr(),$e=oe(Qe),et=s($e);{var ot=De=>{var pt=Sr(),we=a(pt);t(pt),u(()=>d(we,`(${e(I)??""} ${e(I)===1?"day":"days"})`)),l(De,pt)};v(et,De=>{e(I)!==null&&De(ot)})}u(De=>d($e,`${De??""} `),[()=>$(e(r).estimated_completion)]),l(Re,Qe)};v(Xe,Re=>{e(I)!==null&&e(I)<=0?Re(Ie):Re(Ue,!1)})}t(ze),t(me),l(A,me)};v(We,A=>{e(r).estimated_completion&&A(bt)})}var _t=s(We,2),Pt=a(_t);{var C=A=>{var I=Br(),me=s(a(I),2),ze=a(me,!0);t(me),t(I),u(()=>d(ze,e(r).model_type)),l(A,I)};v(Pt,A=>{e(r).model_type&&A(C)})}var z=s(Pt,2);{var he=A=>{var I=Fr(),me=s(a(I),2),ze=a(me);t(me),t(I),u(Xe=>d(ze,`${Xe??""}%`),[()=>(e(r).r_squared*100).toFixed(0)]),l(A,I)};v(z,A=>{e(r).r_squared!==void 0&&A(he)})}var G=s(z,2);{var ve=A=>{var I=zr(),me=s(a(I),2),ze=a(me,!0);t(me),t(I),u(()=>d(ze,e(r).num_readings)),l(A,I)};v(G,A=>{e(r).num_readings&&A(ve)})}t(_t),t(Y),l(fe,_)};v(Be,fe=>{e(M)?fe(Ge):fe(Fe,!1)})}t(O),u(()=>{ce=Ee(O,1,"ml-panel svelte-1xs394q",null,ce,{"has-anomaly":e(ee),completed:e(M)}),d(ie,e(M)?"Fermentation Summary":"Fermentation Intelligence")}),l(H,O)},F=H=>{var O=Ar(),ce=a(O),ae=a(ce),pe=a(ae,!0);t(ae);var ie=s(ae,2);ie.__click=R;var ke=a(ie,!0);t(ie),t(ce);var Se=s(ce,2),Be=a(Se);{var Ge=fe=>{var _=Yt("Waiting for fermentation to progress (need visible SG drop)");l(fe,_)},Fe=fe=>{var _=He(),j=oe(_);{var T=W=>{var Y=Yt("Need more fermentation curve data for reliable prediction");l(W,Y)},D=W=>{var Y=He(),ne=oe(Y);{var ge=ye=>{var We=Yt("Need at least 10 readings to make predictions");l(ye,We)},be=ye=>{var We=Yt();u(()=>d(We,e(M)?"No fermentation data recorded":"Predictions will appear once fermentation is underway")),l(ye,We)};v(ne,ye=>{e(r).reason==="insufficient_data"?ye(ge):ye(be,!1)},!0)}l(W,Y)};v(j,W=>{e(r).reason==="insufficient_curve_data"?W(T):W(D,!1)},!0)}l(fe,_)};v(Be,fe=>{e(r).reason==="insufficient_fermentation_progress"?fe(Ge):fe(Fe,!1)})}t(Se),t(O),u(()=>{d(pe,e(M)?"Fermentation summary unavailable":"ML predictions unavailable"),ie.disabled=e(q)||e(P),d(ke,e(q)?"Reloading...":"‚Üª Reload")}),l(H,O)};v(k,H=>{e(r).available?H(y):H(F,!1)},!0)}l(c,f)};v(b,c=>{e(Q)?c(h):c(p,!1)},!0)}l(m,x)};v(Me,m=>{e(P)?m(se):m(w,!1)})}l(Pe,qe),Wt()}Zt(["change","click"]);var Rr=n('<div class="loading svelte-1hws0u6">Loading alerts...</div>'),Nr=n('<div class="error-banner svelte-1hws0u6"><span> </span> <button type="button" class="dismiss-error svelte-1hws0u6">√ó</button></div>'),Or=n('<button type="button" class="dismiss-all-btn svelte-1hws0u6"> </button>'),Lr=n('<span class="spinner svelte-1hws0u6"></span>'),Er=da('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1hws0u6"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg>'),Gr=n('<div class="alert-item svelte-1hws0u6"><div class="alert-icon svelte-1hws0u6"> </div> <div class="alert-content svelte-1hws0u6"><div class="alert-header svelte-1hws0u6"><span class="alert-type svelte-1hws0u6"> </span> <span class="severity-badge svelte-1hws0u6"> </span></div> <p class="alert-message svelte-1hws0u6"> </p> <div class="alert-meta svelte-1hws0u6"><span class="alert-time svelte-1hws0u6"> </span> <span class="alert-separator svelte-1hws0u6">¬∑</span> <span class="alert-time svelte-1hws0u6"> </span></div></div> <button type="button" class="dismiss-btn svelte-1hws0u6" title="Dismiss alert"><!></button></div>'),Ir=n('<!> <div class="alerts-header svelte-1hws0u6"><span class="alert-count svelte-1hws0u6"> </span> <!></div> <div class="alerts-list svelte-1hws0u6"></div>',1);function Ur(Pe,i){Ht(i,!0);let g=U(Ze([])),S=U(!0),E=U(null),B=U(null),K=U(!1);Ma(()=>{r()});async function r(){try{o(S,!0),o(E,null),o(g,await fs(i.batchId,!1),!0)}catch(R){o(E,R instanceof Error?R.message:"Failed to load alerts",!0)}finally{o(S,!1)}}async function P(R){try{o(B,R,!0),await gs(i.batchId,R),o(g,e(g).filter(Z=>Z.id!==R),!0)}catch(Z){o(E,Z instanceof Error?Z.message:"Failed to dismiss alert",!0)}finally{o(B,null)}}async function q(){try{o(K,!0),await hs(i.batchId),o(g,[],!0)}catch(R){o(E,R instanceof Error?R.message:"Failed to dismiss alerts",!0)}finally{o(K,!1)}}function Q(R){switch(R){case"critical":return"var(--negative)";case"warning":return"var(--warning)";case"info":return"var(--accent)";default:return"var(--text-muted)"}}function de(R){switch(R){case"stall":return"‚è∏";case"temperature_high":return"üî•";case"temperature_low":return"‚ùÑ";case"anomaly":return"‚ö†";default:return"‚ö†"}}function je(R){const Z=new Date(R),re=new Date().getTime()-Z.getTime(),N=Math.floor(re/6e4),V=Math.floor(N/60),te=Math.floor(V/24);return te>0?`${te}d ago`:V>0?`${V}h ago`:N>0?`${N}m ago`:"just now"}var M=He(),X=oe(M);{var J=R=>{xa(R,{title:"Alerts",icon:"üîî",children:(Z,$)=>{var re=Rr();l(Z,re)},$$slots:{default:!0}})},le=R=>{var Z=He(),$=oe(Z);{var re=V=>{},N=V=>{xa(V,{title:"Active Alerts",icon:"üîî",highlight:!0,children:(te,ee)=>{var _e=Ir(),qe=oe(_e);{var Me=p=>{var c=Nr(),f=a(c),k=a(f,!0);t(f);var y=s(f,2);y.__click=()=>o(E,null),t(c),u(()=>d(k,e(E))),l(p,c)};v(qe,p=>{e(E)&&p(Me)})}var se=s(qe,2),w=a(se),m=a(w);t(w);var x=s(w,2);{var b=p=>{var c=Or();c.__click=q;var f=a(c,!0);t(c),u(()=>{c.disabled=e(K),d(f,e(K)?"Dismissing...":"Dismiss All")}),l(p,c)};v(x,p=>{e(g).length>1&&p(b)})}t(se);var h=s(se,2);Dt(h,21,()=>e(g),p=>p.id,(p,c)=>{var f=Gr(),k=a(f),y=a(k,!0);t(k);var F=s(k,2),H=a(F),O=a(H),ce=a(O,!0);t(O);var ae=s(O,2),pe=a(ae,!0);t(ae),t(H);var ie=s(H,2),ke=a(ie,!0);t(ie);var Se=s(ie,2),Be=a(Se),Ge=a(Be);t(Be);var Fe=s(Be,4),fe=a(Fe);t(Fe),t(Se),t(F);var _=s(F,2);_.__click=()=>P(e(c).id);var j=a(_);{var T=W=>{var Y=Lr();l(W,Y)},D=W=>{var Y=Er();l(W,Y)};v(j,W=>{e(B)===e(c).id?W(T):W(D,!1)})}t(_),t(f),u((W,Y,ne,ge,be,ye,We,bt)=>{At(f,`--severity-color: ${W??""}`),d(y,Y),d(ce,ne),At(ae,`background: ${ge??""}`),d(pe,e(c).severity),d(ke,e(c).message),Qt(Be,"title",`First detected: ${be??""}`),d(Ge,`First: ${ye??""}`),Qt(Fe,"title",`Last seen: ${We??""}`),d(fe,`Last: ${bt??""}`),_.disabled=e(B)===e(c).id},[()=>Q(e(c).severity),()=>de(e(c).alert_type),()=>e(c).alert_type.replace("_"," "),()=>Q(e(c).severity),()=>new Date(e(c).first_detected_at).toLocaleString(),()=>je(e(c).first_detected_at),()=>new Date(e(c).last_seen_at).toLocaleString(),()=>je(e(c).last_seen_at)]),l(p,f)}),t(h),u(()=>d(m,`${e(g).length??""} active`)),l(te,_e)},$$slots:{default:!0}})};v($,V=>{e(g).length===0?V(re):V(N,!1)},!0)}l(R,Z)};v(X,R=>{e(S)?R(J):R(le,!1)})}l(Pe,M),Wt()}Zt(["click"]);var Vr=n('<span class="saving-indicator svelte-ukh80y">Syncing...</span>'),Hr=n("<span> </span>"),Wr=n('<div class="timer-idle svelte-ukh80y"><div class="timer-option svelte-ukh80y"><label class="option-label svelte-ukh80y">Mash Duration</label> <div class="duration-input svelte-ukh80y"><button type="button" class="duration-btn svelte-ukh80y">‚àí</button> <span class="duration-value svelte-ukh80y"> </span> <button type="button" class="duration-btn svelte-ukh80y">+</button> <span class="duration-unit svelte-ukh80y">min</span></div></div> <div class="timer-option svelte-ukh80y"><label class="option-label svelte-ukh80y">Boil Duration</label> <div class="duration-display svelte-ukh80y"><span class="duration-value svelte-ukh80y"> </span> <span class="duration-unit svelte-ukh80y">min</span></div></div> <div class="timer-actions svelte-ukh80y"><button type="button" class="start-btn mash svelte-ukh80y"><svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path></svg> Start Mash</button> <button type="button" class="start-btn boil svelte-ukh80y">Skip to Boil</button></div></div>'),Xr=n('<div class="timer-complete svelte-ukh80y"><div class="complete-icon svelte-ukh80y">‚úì</div> <p class="complete-text svelte-ukh80y">Boil complete! Time to chill the wort.</p> <button type="button" class="reset-btn svelte-ukh80y">Reset Timer</button></div>'),Jr=da('<svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path></svg> Resume',1),Yr=da('<svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6"></path></svg> Pause',1),Kr=n('<span class="hop-check svelte-ukh80y">‚úì</span>'),Qr=n('<div><span class="hop-time svelte-ukh80y"> </span> <span class="hop-name svelte-ukh80y"> </span> <span class="hop-amount svelte-ukh80y"> </span> <!></div>'),Zr=n('<div class="hop-schedule svelte-ukh80y"><h4 class="schedule-title svelte-ukh80y">Hop Additions</h4> <div class="hop-list svelte-ukh80y"></div></div>'),$r=n('<button type="button" class="next-phase-btn svelte-ukh80y">Mash Done ‚Üí Start Boil</button>'),el=n('<div class="timer-active svelte-ukh80y"><div class="timer-display svelte-ukh80y"><span class="time-value svelte-ukh80y"> </span> <span class="time-label svelte-ukh80y">remaining</span></div> <div class="progress-bar svelte-ukh80y"><div></div></div> <div class="timer-controls svelte-ukh80y"><button type="button" class="control-btn svelte-ukh80y" title="Subtract 1 minute">‚àí1m</button> <button type="button"><!></button> <button type="button" class="control-btn svelte-ukh80y" title="Add 1 minute">+1m</button></div> <!> <div class="phase-actions svelte-ukh80y"><!> <button type="button" class="reset-btn svelte-ukh80y">Reset</button></div></div>'),tl=n('<div class="timer-card svelte-ukh80y"><div class="timer-header svelte-ukh80y"><h3 class="timer-title svelte-ukh80y">Brew Day Timer</h3> <!></div> <!></div>');function al(Pe,i){Ht(i,!0);let g=U(Ze(i.batch.timer_phase||"idle")),S=U(0),E=null,B=U(i.batch.timer_paused_at!=null),K=U(!1),r=U(Ze(new Set)),P=U(60),q=L(()=>i.recipe.boil_time_minutes||60),Q=L(()=>i.recipe.hops?i.recipe.hops.filter(h=>h.timing?.use==="add_to_boil"||!h.timing?.use).map(h=>({name:h.name,amount:h.amount_grams,time:h.timing?.duration?.value||0,unit:h.timing?.duration?.unit||"min"})).sort((h,p)=>p.time-h.time):[]),de=L(()=>{const h=Math.floor(e(S)/60),p=e(S)%60;return`${h.toString().padStart(2,"0")}:${p.toString().padStart(2,"0")}`}),je=L(()=>e(g)==="mash"?(e(P)*60-e(S))/(e(P)*60)*100:e(g)==="boil"?(e(q)*60-e(S))/(e(q)*60)*100:0),M=L(()=>{switch(e(g)){case"mash":return"Mash";case"boil":return"Boil";case"complete":return"Complete!";default:return"Ready"}});function X(){if(!i.batch.timer_started_at||!i.batch.timer_duration_seconds)return 0;const h=new Date(i.batch.timer_started_at).getTime(),p=i.batch.timer_duration_seconds*1e3,c=Date.now();if(i.batch.timer_paused_at){const k=new Date(i.batch.timer_paused_at).getTime()-h;return Math.max(0,Math.floor((p-k)/1e3))}else{const f=c-h;return Math.max(0,Math.floor((p-f)/1e3))}}async function J(h,p,c=!1){o(K,!0);try{const f={timer_phase:h,timer_duration_seconds:p};h==="idle"||h==="complete"?(f.timer_started_at=null,f.timer_paused_at=null):c?f.timer_paused_at=new Date().toISOString():(f.timer_started_at=new Date().toISOString(),f.timer_paused_at=null),await oa(i.batch.id,f)}catch(f){console.error("Failed to save timer state:",f)}finally{o(K,!1)}}async function le(){o(g,"mash"),o(S,e(P)*60),o(r,new Set,!0),o(B,!1),await J("mash",e(P)*60),Z()}async function R(){o(g,"boil"),o(S,e(q)*60),o(r,new Set,!0),o(B,!1),await J("boil",e(q)*60),Z()}function Z(){E&&clearInterval(E),E=setInterval(()=>{if(!e(B)&&e(S)>0){if(as(S,-1),e(g)==="boil"){const h=Math.floor(e(S)/60);for(const p of e(Q)){const c=p.time;h===c&&!e(r).has(c)&&(e(r).add(c),te(),ee(`Add ${p.name}`,`${p.amount}g at ${c} minutes`))}}e(S)===0&&(clearInterval(E),E=null,te(),e(g)==="mash"?ee("Mash Complete","Time to sparge and start the boil!"):e(g)==="boil"&&(o(g,"complete"),J("complete",0),ee("Boil Complete","Time to chill the wort!"),i.onComplete?.()))}},1e3)}async function $(){o(B,!e(B)),e(B)?await J(e(g),e(S),!0):await J(e(g),e(S),!1)}async function re(){E&&(clearInterval(E),E=null),o(g,"idle"),o(S,0),o(B,!1),o(r,new Set,!0),await J("idle",0)}function N(){o(S,e(S)+60)}function V(){e(S)>=60&&o(S,e(S)-60)}function te(){try{const h=new(window.AudioContext||window.webkitAudioContext),p=h.createOscillator(),c=h.createGain();p.connect(c),c.connect(h.destination),p.frequency.value=880,p.type="sine",c.gain.value=.3,p.start(),setTimeout(()=>c.gain.value=0,150),setTimeout(()=>c.gain.value=.3,250),setTimeout(()=>c.gain.value=0,400),setTimeout(()=>c.gain.value=.3,500),setTimeout(()=>c.gain.value=0,650),setTimeout(()=>{p.stop(),h.close()},700)}catch(h){console.warn("Audio notification not available:",h)}}function ee(h,p){"Notification"in window&&Notification.permission==="granted"&&new Notification(h,{body:p,icon:"/favicon.png"})}Ma(()=>("Notification"in window&&Notification.permission==="default"&&Notification.requestPermission(),i.batch.timer_phase&&i.batch.timer_phase!=="idle"&&i.batch.timer_phase!=="complete"&&(o(g,i.batch.timer_phase,!0),o(S,X(),!0),o(B,i.batch.timer_paused_at!=null),!e(B)&&e(S)>0&&Z()),()=>{E&&clearInterval(E)}));var _e=tl(),qe=a(_e),Me=s(a(qe),2);{var se=h=>{var p=Vr();l(h,p)},w=h=>{var p=He(),c=oe(p);{var f=k=>{var y=Hr();let F;var H=a(y,!0);t(y),u(()=>{F=Ee(y,1,"phase-badge svelte-ukh80y",null,F,{mash:e(g)==="mash",boil:e(g)==="boil"}),d(H,e(M))}),l(k,y)};v(c,k=>{e(g)!=="idle"&&e(g)!=="complete"&&k(f)},!0)}l(h,p)};v(Me,h=>{e(K)?h(se):h(w,!1)})}t(qe);var m=s(qe,2);{var x=h=>{var p=Wr(),c=a(p),f=s(a(c),2),k=a(f);k.__click=()=>o(P,Math.max(1,e(P)-5),!0);var y=s(k,2),F=a(y,!0);t(y);var H=s(y,2);H.__click=()=>o(P,e(P)+5),xe(2),t(f),t(c);var O=s(c,2),ce=s(a(O),2),ae=a(ce),pe=a(ae,!0);t(ae),xe(2),t(ce),t(O);var ie=s(O,2),ke=a(ie);ke.__click=le;var Se=s(ke,2);Se.__click=R,t(ie),t(p),u(()=>{d(F,e(P)),d(pe,e(q))}),l(h,p)},b=h=>{var p=He(),c=oe(p);{var f=y=>{var F=Xr(),H=s(a(F),4);H.__click=re,t(F),l(y,F)},k=y=>{var F=el(),H=a(F),O=a(H),ce=a(O,!0);t(O),xe(2),t(H);var ae=s(H,2),pe=a(ae);let ie;t(ae);var ke=s(ae,2),Se=a(ke);Se.__click=V;var Be=s(Se,2);let Ge;Be.__click=$;var Fe=a(Be);{var fe=be=>{var ye=Jr();xe(),l(be,ye)},_=be=>{var ye=Yr();xe(),l(be,ye)};v(Fe,be=>{e(B)?be(fe):be(_,!1)})}t(Be);var j=s(Be,2);j.__click=N,t(ke);var T=s(ke,2);{var D=be=>{var ye=Zr(),We=s(a(ye),2);Dt(We,21,()=>e(Q),Kt,(bt,_t)=>{const Pt=L(()=>Math.floor(e(S)/60)),C=L(()=>e(_t).time<=e(Pt)&&!e(r).has(e(_t).time)),z=L(()=>e(r).has(e(_t).time)||e(_t).time>e(Pt));var he=Qr();let G;var ve=a(he),A=a(ve);t(ve);var I=s(ve,2),me=a(I,!0);t(I);var ze=s(I,2),Xe=a(ze);t(ze);var Ie=s(ze,2);{var Ue=Re=>{var Qe=Kr();l(Re,Qe)};v(Ie,Re=>{e(z)&&Re(Ue)})}t(he),u(()=>{G=Ee(he,1,"hop-item svelte-ukh80y",null,G,{next:e(C),done:e(z)}),d(A,`${e(_t).time??""}m`),d(me,e(_t).name),d(Xe,`${e(_t).amount??""}g`)}),l(bt,he)}),t(We),t(ye),l(be,ye)};v(T,be=>{e(g)==="boil"&&e(Q).length>0&&be(D)})}var W=s(T,2),Y=a(W);{var ne=be=>{var ye=$r();ye.__click=R,l(be,ye)};v(Y,be=>{e(g)==="mash"&&be(ne)})}var ge=s(Y,2);ge.__click=re,t(W),t(F),u(()=>{d(ce,e(de)),ie=Ee(pe,1,"progress-fill svelte-ukh80y",null,ie,{mash:e(g)==="mash",boil:e(g)==="boil"}),At(pe,`width: ${e(je)??""}%`),Ge=Ee(Be,1,"control-btn pause svelte-ukh80y",null,Ge,{paused:e(B)})}),l(y,F)};v(c,y=>{e(g)==="complete"?y(f):y(k,!1)},!0)}l(h,p)};v(m,h=>{e(g)==="idle"?h(x):h(b,!1)})}t(_e),l(Pe,_e),Wt()}Zt(["click"]);var sl=n('<label class="next-item svelte-ue9vqt"><input type="checkbox" class="svelte-ue9vqt"/> <span class="item-text svelte-ue9vqt"> </span></label>'),rl=n('<div class="next-items svelte-ue9vqt"></div>'),ll=n('<label><input type="checkbox" class="svelte-ue9vqt"/> <span class="item-text svelte-ue9vqt"> </span></label>'),il=n('<div class="all-items svelte-ue9vqt"></div>'),nl=n('<div class="checklist-compact svelte-ue9vqt"><button type="button" class="checklist-header svelte-ue9vqt"><div class="header-left svelte-ue9vqt"><span><!></span> <span class="title svelte-ue9vqt">Checklist</span> <span class="progress-text svelte-ue9vqt"> </span></div> <div class="header-right svelte-ue9vqt"><div class="mini-progress svelte-ue9vqt"><div class="mini-fill svelte-ue9vqt"></div></div> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></div></button> <!> <!></div>');function vl(Pe,i){Ht(i,!0);let g=U(Ze([])),S=U(!1),E=L(()=>`brewday-checklist-${i.batchId}`);function B(){const b=[];return b.push({id:"prep-sanitize",text:"Sanitize equipment",checked:!1,category:"prep"}),b.push({id:"prep-water",text:"Heat strike water",checked:!1,category:"prep"}),i.recipe.fermentables&&i.recipe.fermentables.forEach((h,p)=>{b.push({id:`ferm-${p}`,text:`Mill: ${h.name}`,checked:!1,category:"prep"})}),b.push({id:"mash-dough-in",text:"Dough in",checked:!1,category:"mash"}),b.push({id:"mash-temp",text:"Check mash temp",checked:!1,category:"mash"}),b.push({id:"mash-sparge",text:"Sparge",checked:!1,category:"mash"}),b.push({id:"boil-preboil",text:"Record pre-boil gravity",checked:!1,category:"boil"}),b.push({id:"boil-start",text:"Bring to boil",checked:!1,category:"boil"}),i.recipe.hops&&i.recipe.hops.filter(p=>p.timing?.use==="add_to_boil"||!p.timing?.use).sort((p,c)=>(c.timing?.duration?.value||0)-(p.timing?.duration?.value||0)).forEach((p,c)=>{const f=p.timing?.duration?.value||0;b.push({id:`hop-${c}`,text:`${p.name} @ ${f}min`,checked:!1,category:"boil"})}),b.push({id:"postboil-chill",text:"Chill wort",checked:!1,category:"post-boil"}),b.push({id:"postboil-og",text:"Record OG",checked:!1,category:"post-boil"}),b.push({id:"postboil-transfer",text:"Transfer to fermenter",checked:!1,category:"post-boil"}),b.push({id:"postboil-yeast",text:"Pitch yeast",checked:!1,category:"post-boil"}),b}function K(){try{const b=localStorage.getItem(e(E));if(b){const h=JSON.parse(b),p=B(),c=new Map(h.map(k=>[k.id,k]));for(const k of p){const y=c.get(k.id);y&&(k.checked=y.checked)}const f=h.filter(k=>k.category==="custom");o(g,[...p,...f],!0)}else o(g,B(),!0)}catch{o(g,B(),!0)}}function r(){try{localStorage.setItem(e(E),JSON.stringify(e(g)))}catch(b){console.warn("Failed to save checklist:",b)}}function P(b){o(g,e(g).map(h=>h.id===b?{...h,checked:!h.checked}:h),!0),r()}let q=L(()=>e(g).filter(b=>b.checked).length),Q=L(()=>e(g).length),de=L(()=>e(Q)>0?Math.round(e(q)/e(Q)*100):0),je=L(()=>e(g).filter(b=>!b.checked).slice(0,3));Ma(()=>{K()});var M=nl(),X=a(M);X.__click=()=>o(S,!e(S));var J=a(X),le=a(J);let R;var Z=a(le);{var $=b=>{var h=Yt("‚úì");l(b,h)},re=b=>{var h=Yt("‚òê");l(b,h)};v(Z,b=>{e(de)===100?b($):b(re,!1)})}t(le);var N=s(le,4),V=a(N);t(N),t(J);var te=s(J,2),ee=a(te),_e=a(ee);t(ee);var qe=s(ee,2);let Me;t(te),t(X);var se=s(X,2);{var w=b=>{var h=rl();Dt(h,21,()=>e(je),p=>p.id,(p,c)=>{var f=sl();f.__click=H=>H.stopPropagation();var k=a(f);Ct(k),k.__change=()=>P(e(c).id);var y=s(k,2),F=a(y,!0);t(y),t(f),u(()=>{Ia(k,e(c).checked),d(F,e(c).text)}),l(p,f)}),t(h),l(b,h)};v(se,b=>{!e(S)&&e(je).length>0&&b(w)})}var m=s(se,2);{var x=b=>{var h=il();Dt(h,21,()=>e(g),p=>p.id,(p,c)=>{var f=ll();let k;var y=a(f);Ct(y),y.__change=()=>P(e(c).id);var F=s(y,2),H=a(F,!0);t(F),t(f),u(()=>{k=Ee(f,1,"item-row svelte-ue9vqt",null,k,{checked:e(c).checked}),Ia(y,e(c).checked),d(H,e(c).text)}),l(p,f)}),t(h),l(b,h)};v(m,b=>{e(S)&&b(x)})}t(M),u(()=>{R=Ee(le,1,"check-icon svelte-ue9vqt",null,R,{done:e(de)===100}),d(V,`${e(q)??""}/${e(Q)??""}`),At(_e,`width: ${e(de)??""}%`),Me=Ee(qe,0,"chevron svelte-ue9vqt",null,Me,{expanded:e(S)})}),l(Pe,M),Wt()}Zt(["click","change"]);var ol=n('<span class="save-indicator svelte-1hyfh06"> </span>'),dl=n('<span class="summary-value svelte-1hyfh06"> </span>'),cl=n('<span class="summary-value svelte-1hyfh06"> </span>'),ul=n('<span class="target svelte-1hyfh06"> </span>'),_l=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Mash Temperature</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06"> </span></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Mash pH</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.01" min="4" max="7" class="field-input svelte-1hyfh06" placeholder="--"/></div> <span class="target svelte-1hyfh06">Target: 5.2-5.6</span></div></div> <div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Strike Water Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div></div></div></div>'),pl=n('<span class="summary-value svelte-1hyfh06"> </span>'),fl=n('<span class="summary-value svelte-1hyfh06"> </span>'),gl=n('<span class="target svelte-1hyfh06"> </span>'),hl=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Pre-Boil Gravity</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.001" min="1.000" max="1.200" class="field-input svelte-1hyfh06" placeholder="1.0XX"/></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Pre-Boil Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div></div></div></div>'),ml=n('<span class="summary-value og svelte-1hyfh06"> </span>'),bl=n('<span class="summary-value svelte-1hyfh06"> </span>'),yl=n('<span class="target svelte-1hyfh06"> </span>'),xl=n('<span class="target svelte-1hyfh06"> </span>'),kl=n('<span class="target svelte-1hyfh06"> </span>'),wl=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Original Gravity (OG)</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.001" min="1.000" max="1.200" class="field-input og-input svelte-1hyfh06" placeholder="1.0XX"/></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Post-Boil Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div> <!></div></div> <div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Brewhouse Efficiency</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" min="0" max="100" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">%</span></div> <!></div></div></div>'),jl=n('<span class="has-notes svelte-1hyfh06">Has notes</span>'),ql=n('<div class="section-content svelte-1hyfh06"><textarea class="notes-input svelte-1hyfh06" placeholder="Record any deviations, substitutions, or observations..." rows="4"></textarea></div>'),Sl=n('<div class="saving-indicator svelte-1hyfh06"><span class="spinner svelte-1hyfh06"></span> Saving...</div>'),Ml=n('<div class="observations-card svelte-1hyfh06"><div class="card-header svelte-1hyfh06"><h3 class="card-title svelte-1hyfh06">Brew Day Log</h3> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Mash</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Pre-Boil</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Post-Boil / OG</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Brew Day Notes</span> <!> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <!></div>');function Cl(Pe,i){Ht(i,!0);let g=U(Ze(i.batch.actual_mash_temp??null)),S=U(Ze(i.batch.actual_mash_ph??null)),E=U(Ze(i.batch.strike_water_volume??null)),B=U(Ze(i.batch.pre_boil_gravity??null)),K=U(Ze(i.batch.pre_boil_volume??null)),r=U(Ze(i.batch.post_boil_volume??null)),P=U(Ze(i.batch.measured_og??null)),q=U(Ze(i.batch.actual_efficiency??null)),Q=U(Ze(i.batch.brew_day_notes??"")),de=U(!1),je=U(null),M=U("mash"),X=L(Aa),J=L(()=>i.recipe.mash_temp),le=L(()=>i.recipe.og),R=L(()=>i.recipe.pre_boil_og),Z=L(()=>i.recipe.batch_size_liters),$=L(()=>i.recipe.efficiency_percent);function re(){if(!e(P)||!e(le)||!e($))return null;const C=(e(P)-1)*1e3,z=(e(le)-1)*1e3;return z===0?null:C/z*e($)}Ma(()=>{if(e(P)&&!e(q)){const C=re();C&&o(q,Math.round(C*10)/10)}});async function N(){if(!e(de)){o(de,!0);try{const C={actual_mash_temp:e(g)??void 0,actual_mash_ph:e(S)??void 0,strike_water_volume:e(E)??void 0,pre_boil_gravity:e(B)??void 0,pre_boil_volume:e(K)??void 0,post_boil_volume:e(r)??void 0,measured_og:e(P)??void 0,actual_efficiency:e(q)??void 0,brew_day_notes:e(Q)||void 0},z=await oa(i.batch.id,C);o(je,new Date,!0),i.onUpdate?.(z)}catch(C){console.error("Failed to save observations:",C)}finally{o(de,!1)}}}function V(C){o(M,e(M)===C?null:C,!0)}var te=Ml(),ee=a(te),_e=s(a(ee),2);{var qe=C=>{var z=ol(),he=a(z);t(z),u(G=>d(he,`Saved ${G??""}`),[()=>e(je).toLocaleTimeString()]),l(C,z)};v(_e,C=>{e(je)&&C(qe)})}t(ee);var Me=s(ee,2);let se;var w=a(Me);w.__click=()=>V("mash");var m=s(a(w),2),x=a(m);{var b=C=>{var z=dl(),he=a(z);t(z),u(G=>d(he,`${G??""}${e(X)??""}`),[()=>Sa(e(g))]),l(C,z)};v(x,C=>{e(g)&&C(b)})}var h=s(x,2);{var p=C=>{var z=cl(),he=a(z);t(z),u(G=>d(he,`pH ${G??""}`),[()=>e(S).toFixed(2)]),l(C,z)};v(h,C=>{e(S)&&C(p)})}t(m),xe(2),t(w);var c=s(w,2);{var f=C=>{var z=_l(),he=a(z),G=a(he),ve=s(a(G),2),A=a(ve);Ct(A);var I=s(A,2),me=a(I,!0);t(I),t(ve);var ze=s(ve,2);{var Xe=De=>{var pt=ul(),we=a(pt);t(pt),u(Je=>d(we,`Target: ${Je??""}${e(X)??""}`),[()=>Sa(e(J))]),l(De,pt)};v(ze,De=>{e(J)&&De(Xe)})}t(G);var Ie=s(G,2),Ue=s(a(Ie),2),Re=a(Ue);Ct(Re),t(Ue),xe(2),t(Ie),t(he);var Qe=s(he,2),$e=a(Qe),et=s(a($e),2),ot=a(et);Ct(ot),xe(2),t(et),t($e),t(Qe),t(z),u(()=>d(me,e(X))),Mt("blur",A,N),yt(A,()=>e(g),De=>o(g,De)),Mt("blur",Re,N),yt(Re,()=>e(S),De=>o(S,De)),Mt("blur",ot,N),yt(ot,()=>e(E),De=>o(E,De)),l(C,z)};v(c,C=>{e(M)==="mash"&&C(f)})}t(Me);var k=s(Me,2);let y;var F=a(k);F.__click=()=>V("preboil");var H=s(a(F),2),O=a(H);{var ce=C=>{var z=pl(),he=a(z,!0);t(z),u(G=>d(he,G),[()=>Bt(e(B))]),l(C,z)};v(O,C=>{e(B)&&C(ce)})}var ae=s(O,2);{var pe=C=>{var z=fl(),he=a(z);t(z),u(G=>d(he,`${G??""}L`),[()=>e(K).toFixed(1)]),l(C,z)};v(ae,C=>{e(K)&&C(pe)})}t(H),xe(2),t(F);var ie=s(F,2);{var ke=C=>{var z=hl(),he=a(z),G=a(he),ve=s(a(G),2),A=a(ve);Ct(A),t(ve);var I=s(ve,2);{var me=Ue=>{var Re=gl(),Qe=a(Re);t(Re),u($e=>d(Qe,`Target: ${$e??""}`),[()=>Bt(e(R))]),l(Ue,Re)};v(I,Ue=>{e(R)&&Ue(me)})}t(G);var ze=s(G,2),Xe=s(a(ze),2),Ie=a(Xe);Ct(Ie),xe(2),t(Xe),t(ze),t(he),t(z),Mt("blur",A,N),yt(A,()=>e(B),Ue=>o(B,Ue)),Mt("blur",Ie,N),yt(Ie,()=>e(K),Ue=>o(K,Ue)),l(C,z)};v(ie,C=>{e(M)==="preboil"&&C(ke)})}t(k);var Se=s(k,2);let Be;var Ge=a(Se);Ge.__click=()=>V("postboil");var Fe=s(a(Ge),2),fe=a(Fe);{var _=C=>{var z=ml(),he=a(z,!0);t(z),u(G=>d(he,G),[()=>Bt(e(P))]),l(C,z)};v(fe,C=>{e(P)&&C(_)})}var j=s(fe,2);{var T=C=>{var z=bl(),he=a(z);t(z),u(G=>d(he,`${G??""}% eff`),[()=>e(q).toFixed(0)]),l(C,z)};v(j,C=>{e(q)&&C(T)})}t(Fe),xe(2),t(Ge);var D=s(Ge,2);{var W=C=>{var z=wl(),he=a(z),G=a(he),ve=s(a(G),2),A=a(ve);Ct(A),t(ve);var I=s(ve,2);{var me=we=>{var Je=yl(),Rt=a(Je);t(Je),u(ca=>d(Rt,`Target: ${ca??""}`),[()=>Bt(e(le))]),l(we,Je)};v(I,we=>{e(le)&&we(me)})}t(G);var ze=s(G,2),Xe=s(a(ze),2),Ie=a(Xe);Ct(Ie),xe(2),t(Xe);var Ue=s(Xe,2);{var Re=we=>{var Je=xl(),Rt=a(Je);t(Je),u(ca=>d(Rt,`Target: ${ca??""}L`),[()=>e(Z).toFixed(1)]),l(we,Je)};v(Ue,we=>{e(Z)&&we(Re)})}t(ze),t(he);var Qe=s(he,2),$e=a(Qe),et=s(a($e),2),ot=a(et);Ct(ot),xe(2),t(et);var De=s(et,2);{var pt=we=>{var Je=kl(),Rt=a(Je);t(Je),u(ca=>d(Rt,`Target: ${ca??""}%`),[()=>e($).toFixed(0)]),l(we,Je)};v(De,we=>{e($)&&we(pt)})}t($e),t(Qe),t(z),Mt("blur",A,N),yt(A,()=>e(P),we=>o(P,we)),Mt("blur",Ie,N),yt(Ie,()=>e(r),we=>o(r,we)),Mt("blur",ot,N),yt(ot,()=>e(q),we=>o(q,we)),l(C,z)};v(D,C=>{e(M)==="postboil"&&C(W)})}t(Se);var Y=s(Se,2);let ne;var ge=a(Y);ge.__click=()=>V("notes");var be=s(a(ge),2);{var ye=C=>{var z=jl();l(C,z)};v(be,C=>{e(Q)&&C(ye)})}xe(2),t(ge);var We=s(ge,2);{var bt=C=>{var z=ql(),he=a(z);Da(he),t(z),Mt("blur",he,N),yt(he,()=>e(Q),G=>o(Q,G)),l(C,z)};v(We,C=>{e(M)==="notes"&&C(bt)})}t(Y);var _t=s(Y,2);{var Pt=C=>{var z=Sl();l(C,z)};v(_t,C=>{e(de)&&C(Pt)})}t(te),u(()=>{se=Ee(Me,1,"section svelte-1hyfh06",null,se,{expanded:e(M)==="mash"}),y=Ee(k,1,"section svelte-1hyfh06",null,y,{expanded:e(M)==="preboil"}),Be=Ee(Se,1,"section svelte-1hyfh06",null,Be,{expanded:e(M)==="postboil"}),ne=Ee(Y,1,"section svelte-1hyfh06",null,ne,{expanded:e(M)==="notes"})}),l(Pe,te),Wt()}Zt(["click"]);var Bl=n('<span class="packaged-badge svelte-1yofiqc">Packaged</span>'),Fl=n('<span class="save-indicator svelte-1yofiqc">Saved</span>'),zl=n("<option> </option>"),Tl=n("<option> </option>"),Dl=n('<div class="field-row priming-row svelte-1yofiqc"><div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Priming Sugar Type</label> <input type="text" class="field-input svelte-1yofiqc" placeholder="e.g., table sugar, corn sugar"/></div> <div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Amount</label> <div class="input-with-unit svelte-1yofiqc"><input type="number" step="1" class="field-input svelte-1yofiqc" placeholder="--"/> <span class="unit svelte-1yofiqc">g</span></div></div></div>'),Al=n('<div class="card-content svelte-1yofiqc"><div class="field-row svelte-1yofiqc"><div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Packaged On</label> <input type="date" class="field-input svelte-1yofiqc"/></div> <div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Package Type</label> <select class="field-input svelte-1yofiqc"><option>Select...</option><!></select></div></div> <div class="field-row svelte-1yofiqc"><div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Volume Packaged</label> <div class="input-with-unit svelte-1yofiqc"><input type="number" step="0.1" class="field-input svelte-1yofiqc" placeholder="--"/> <span class="unit svelte-1yofiqc">L</span></div></div> <div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Carbonation Method</label> <select class="field-input svelte-1yofiqc"><option>Select...</option><!></select></div></div> <!> <div class="field full-width svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Packaging Notes</label> <textarea class="notes-input svelte-1yofiqc" placeholder="Any observations about packaging day..." rows="3"></textarea></div></div>'),Pl=n('<div class="saving-indicator svelte-1yofiqc"><span class="spinner svelte-1yofiqc"></span> Saving...</div>'),Rl=n('<div class="packaging-card svelte-1yofiqc"><button type="button" class="card-header svelte-1yofiqc"><div class="header-content svelte-1yofiqc"><h3 class="card-title svelte-1yofiqc">Packaging</h3> <!></div> <div class="header-right svelte-1yofiqc"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div></button> <!> <!></div>');function Nl(Pe,i){Ht(i,!0);let g=U(Ze(i.batch.packaged_at?i.batch.packaged_at.split("T")[0]:"")),S=U(Ze(i.batch.packaging_type??"")),E=U(Ze(i.batch.packaging_volume??null)),B=U(Ze(i.batch.carbonation_method??"")),K=U(Ze(i.batch.priming_sugar_type??"")),r=U(Ze(i.batch.priming_sugar_amount??null)),P=U(Ze(i.batch.packaging_notes??"")),q=U(!1),Q=U(null),de=U(!i.batch.packaged_at),je=L(()=>e(B)==="bottle_conditioned"||e(B)==="keg_conditioned");async function M(){if(!e(q)){o(q,!0);try{const x={packaged_at:e(g)?new Date(e(g)).toISOString():void 0,packaging_type:e(S)||void 0,packaging_volume:e(E)??void 0,carbonation_method:e(B)||void 0,priming_sugar_type:e(je)&&e(K)||void 0,priming_sugar_amount:e(je)?e(r)??void 0:void 0,packaging_notes:e(P)||void 0},b=await oa(i.batch.id,x);o(Q,new Date,!0),i.onUpdate?.(b)}catch(x){console.error("Failed to save packaging info:",x)}finally{o(q,!1)}}}function X(){o(de,!e(de))}const J=[{value:"keg",label:"Keg"},{value:"bottles",label:"Bottles"},{value:"cans",label:"Cans"}],le=[{value:"forced",label:"Force Carbonated"},{value:"bottle_conditioned",label:"Bottle Conditioned"},{value:"keg_conditioned",label:"Keg Conditioned"},{value:"natural",label:"Naturally Carbonated"}];var R=Rl(),Z=a(R);Z.__click=X;var $=a(Z),re=s(a($),2);{var N=x=>{var b=Bl();l(x,b)};v(re,x=>{i.batch.packaged_at&&x(N)})}t($);var V=s($,2),te=a(V);{var ee=x=>{var b=Fl();l(x,b)};v(te,x=>{e(Q)&&x(ee)})}var _e=s(te,2);let qe;t(V),t(Z);var Me=s(Z,2);{var se=x=>{var b=Al(),h=a(b),p=a(h),c=s(a(p),2);Ct(c),t(p);var f=s(p,2),k=s(a(f),2);k.__change=M;var y=a(k);y.value=y.__value="";var F=s(y);Dt(F,17,()=>J,Kt,(_,j)=>{var T=zl(),D=a(T,!0);t(T);var W={};u(()=>{d(D,e(j).label),W!==(W=e(j).value)&&(T.value=(T.__value=e(j).value)??"")}),l(_,T)}),t(k),t(f),t(h);var H=s(h,2),O=a(H),ce=s(a(O),2),ae=a(ce);Ct(ae),xe(2),t(ce),t(O);var pe=s(O,2),ie=s(a(pe),2);ie.__change=M;var ke=a(ie);ke.value=ke.__value="";var Se=s(ke);Dt(Se,17,()=>le,Kt,(_,j)=>{var T=Tl(),D=a(T,!0);t(T);var W={};u(()=>{d(D,e(j).label),W!==(W=e(j).value)&&(T.value=(T.__value=e(j).value)??"")}),l(_,T)}),t(ie),t(pe),t(H);var Be=s(H,2);{var Ge=_=>{var j=Dl(),T=a(j),D=s(a(T),2);Ct(D),t(T);var W=s(T,2),Y=s(a(W),2),ne=a(Y);Ct(ne),xe(2),t(Y),t(W),t(j),Mt("blur",D,M),yt(D,()=>e(K),ge=>o(K,ge)),Mt("blur",ne,M),yt(ne,()=>e(r),ge=>o(r,ge)),l(_,j)};v(Be,_=>{e(je)&&_(Ge)})}var Fe=s(Be,2),fe=s(a(Fe),2);Da(fe),t(Fe),t(b),Mt("blur",c,M),yt(c,()=>e(g),_=>o(g,_)),Ta(k,()=>e(S),_=>o(S,_)),Mt("blur",ae,M),yt(ae,()=>e(E),_=>o(E,_)),Ta(ie,()=>e(B),_=>o(B,_)),Mt("blur",fe,M),yt(fe,()=>e(P),_=>o(P,_)),l(x,b)};v(Me,x=>{e(de)&&x(se)})}var w=s(Me,2);{var m=x=>{var b=Pl();l(x,b)};v(w,x=>{e(q)&&x(m)})}t(R),u(()=>qe=Ee(_e,0,"chevron svelte-1yofiqc",null,qe,{expanded:e(de)})),l(Pe,R),Wt()}Zt(["click","change"]);var Ol=n('<span class="note-count svelte-11n209s"> </span>'),Ll=n('<span class="avg-score svelte-11n209s"> </span>'),El=n('<button type="button" class="add-note-btn svelte-11n209s"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> Add Tasting Note</button>'),Gl=n('<button type="button"> </button>'),Il=n('<div class="score-category svelte-11n209s"><div class="category-header svelte-11n209s"><span class="category-label svelte-11n209s"> </span> <div class="score-selector svelte-11n209s"></div></div> <textarea class="category-notes svelte-11n209s" rows="2"></textarea></div>'),Ul=n('<div class="note-form svelte-11n209s"><div class="form-header svelte-11n209s"><h4 class="svelte-11n209s"> </h4> <button type="button" class="close-btn svelte-11n209s"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <!> <div class="form-actions svelte-11n209s"><button type="button" class="cancel-btn svelte-11n209s">Cancel</button> <button type="button" class="save-btn svelte-11n209s"> </button></div></div>'),Vl=n('<div><span class="score-label svelte-11n209s"> </span> <span class="score-value svelte-11n209s"> </span></div>'),Hl=n('<p class="note-text svelte-11n209s"> </p>'),Wl=n('<div><div class="note-header svelte-11n209s"><span class="note-date svelte-11n209s"> </span> <div class="note-actions svelte-11n209s"><button type="button" class="action-btn svelte-11n209s" title="Edit"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button> <button type="button" class="action-btn delete svelte-11n209s" title="Delete"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div> <div class="note-scores svelte-11n209s"></div> <!></div>'),Xl=n('<div class="notes-list svelte-11n209s"></div>'),Jl=n('<p class="empty-message svelte-11n209s">No tasting notes yet. Add your first one to track how this batch develops over time.</p>'),Yl=n('<div class="card-content svelte-11n209s"><!> <!> <!></div>'),Kl=n('<div class="tasting-card svelte-11n209s"><button type="button" class="card-header svelte-11n209s"><div class="header-content svelte-11n209s"><h3 class="card-title svelte-11n209s">Tasting Notes</h3> <!></div> <div class="header-right svelte-11n209s"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div></button> <!></div>');function Ql(Pe,i){Ht(i,!0);let g=U(Ze(i.batch.tasting_notes??[])),S=U(!0),E=U(!1),B=U(null),K=U(!1),r=U(Ze({appearance_score:void 0,appearance_notes:"",aroma_score:void 0,aroma_notes:"",flavor_score:void 0,flavor_notes:"",mouthfeel_score:void 0,mouthfeel_notes:"",overall_score:void 0,overall_notes:""})),P=L(()=>()=>{if(e(g).length===0)return null;const w=e(g).filter(m=>m.overall_score!=null).map(m=>m.overall_score);return w.length===0?null:(w.reduce((m,x)=>m+x,0)/w.length).toFixed(1)});function q(){o(S,!e(S))}function Q(){o(r,{appearance_score:void 0,appearance_notes:"",aroma_score:void 0,aroma_notes:"",flavor_score:void 0,flavor_notes:"",mouthfeel_score:void 0,mouthfeel_notes:"",overall_score:void 0,overall_notes:""},!0),o(B,null),o(E,!1)}function de(){Q(),o(E,!0)}function je(w){o(r,{appearance_score:w.appearance_score??void 0,appearance_notes:w.appearance_notes??"",aroma_score:w.aroma_score??void 0,aroma_notes:w.aroma_notes??"",flavor_score:w.flavor_score??void 0,flavor_notes:w.flavor_notes??"",mouthfeel_score:w.mouthfeel_score??void 0,mouthfeel_notes:w.mouthfeel_notes??"",overall_score:w.overall_score??void 0,overall_notes:w.overall_notes??""},!0),o(B,w.id,!0),o(E,!0)}async function M(){if(!e(K)){o(K,!0);try{if(e(B)){const w=await ms(i.batch.id,e(B),e(r));o(g,e(g).map(m=>m.id===e(B)?w:m),!0)}else{const w=await bs(i.batch.id,e(r));o(g,[w,...e(g)],!0)}Q(),i.onUpdate?.({...i.batch,tasting_notes:e(g)})}catch(w){console.error("Failed to save tasting note:",w)}finally{o(K,!1)}}}async function X(w){if(confirm("Delete this tasting note?"))try{await ys(i.batch.id,w),o(g,e(g).filter(m=>m.id!==w),!0),i.onUpdate?.({...i.batch,tasting_notes:e(g)})}catch(m){console.error("Failed to delete tasting note:",m)}}function J(w){return new Date(w).toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric"})}function le(w){return w==null?"-":"‚òÖ".repeat(w)+"‚òÜ".repeat(5-w)}var R=Kl(),Z=a(R);Z.__click=q;var $=a(Z),re=s(a($),2);{var N=w=>{var m=Ol(),x=a(m,!0);t(m),u(()=>d(x,e(g).length)),l(w,m)};v(re,w=>{e(g).length>0&&w(N)})}t($);var V=s($,2),te=a(V);{var ee=w=>{var m=Ll(),x=a(m);t(m),u(b=>d(x,`Avg: ${b??""}/5`),[()=>e(P)()]),l(w,m)};v(te,w=>{e(P)()&&w(ee)})}var _e=s(te,2);let qe;t(V),t(Z);var Me=s(Z,2);{var se=w=>{var m=Yl(),x=a(m);{var b=y=>{var F=El();F.__click=de,l(y,F)};v(x,y=>{e(E)||y(b)})}var h=s(x,2);{var p=y=>{var F=Ul(),H=a(F),O=a(H),ce=a(O);t(O);var ae=s(O,2);ae.__click=Q,t(H);var pe=s(H,2);Dt(pe,16,()=>[{key:"appearance",label:"Appearance"},{key:"aroma",label:"Aroma"},{key:"flavor",label:"Flavor"},{key:"mouthfeel",label:"Mouthfeel"},{key:"overall",label:"Overall"}],Kt,(Ge,Fe)=>{var fe=Il(),_=a(fe),j=a(_),T=a(j,!0);t(j);var D=s(j,2);Dt(D,20,()=>[1,2,3,4,5],Kt,(Y,ne)=>{var ge=Gl();let be;ge.__click=()=>{const We=`${Fe.key}_score`;e(r)[We]=ne};var ye=a(ge,!0);t(ge),u(()=>{be=Ee(ge,1,"score-btn svelte-11n209s",null,be,{selected:e(r)[`${Fe.key}_score`]===ne}),d(ye,ne)}),l(Y,ge)}),t(D),t(_);var W=s(_,2);Da(W),t(fe),u(Y=>{d(T,Fe.label),Qt(W,"placeholder",`Notes on ${Y??""}...`)},[()=>Fe.label.toLowerCase()]),yt(W,()=>e(r)[`${Fe.key}_notes`],Y=>e(r)[`${Fe.key}_notes`]=Y),l(Ge,fe)});var ie=s(pe,2),ke=a(ie);ke.__click=Q;var Se=s(ke,2);Se.__click=M;var Be=a(Se,!0);t(Se),t(ie),t(F),u(()=>{d(ce,`${e(B)?"Edit":"New"} Tasting Note`),Se.disabled=e(K),d(Be,e(K)?"Saving...":e(B)?"Update":"Save")}),l(y,F)};v(h,y=>{e(E)&&y(p)})}var c=s(h,2);{var f=y=>{var F=Xl();Dt(F,21,()=>e(g),Kt,(H,O)=>{var ce=Wl();let ae;var pe=a(ce),ie=a(pe),ke=a(ie,!0);t(ie);var Se=s(ie,2),Be=a(Se);Be.__click=()=>je(e(O));var Ge=s(Be,2);Ge.__click=()=>X(e(O).id),t(Se),t(pe);var Fe=s(pe,2);Dt(Fe,20,()=>[{key:"appearance",label:"App"},{key:"aroma",label:"Aroma"},{key:"flavor",label:"Flav"},{key:"mouthfeel",label:"Mouth"},{key:"overall",label:"Overall"}],Kt,(j,T)=>{var D=Vl();let W;var Y=a(D),ne=a(Y,!0);t(Y);var ge=s(Y,2),be=a(ge,!0);t(ge),t(D),u(ye=>{W=Ee(D,1,"score-item svelte-11n209s",null,W,{overall:T.key==="overall"}),d(ne,T.label),d(be,ye)},[()=>le(e(O)[`${T.key}_score`])]),l(j,D)}),t(Fe);var fe=s(Fe,2);{var _=j=>{var T=Hl(),D=a(T,!0);t(T),u(()=>d(D,e(O).overall_notes)),l(j,T)};v(fe,j=>{e(O).overall_notes&&j(_)})}t(ce),u(j=>{ae=Ee(ce,1,"note-item svelte-11n209s",null,ae,{editing:e(B)===e(O).id}),d(ke,j)},[()=>J(e(O).tasted_at)]),l(H,ce)}),t(F),l(y,F)},k=y=>{var F=He(),H=oe(F);{var O=ce=>{var ae=Jl();l(ce,ae)};v(H,ce=>{e(E)||ce(O)},!0)}l(y,F)};v(c,y=>{e(g).length>0?y(f):y(k,!1)})}t(m),l(w,m)};v(Me,w=>{e(S)&&w(se)})}t(R),u(()=>qe=Ee(_e,0,"chevron svelte-11n209s",null,qe,{expanded:e(S)})),l(Pe,R),Wt()}Zt(["click"]);var Zl=n('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),$l=n('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),ei=n('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),ti=n('<span class="recipe-type svelte-g5au2j"> </span>'),ai=n('<a class="recipe-link svelte-g5au2j"> <!></a>'),si=n('<div class="batch-timing svelte-g5au2j"> </div>'),ri=n('<div class="batch-timing svelte-g5au2j"> </div>'),li=n('<option class="svelte-g5au2j"> </option>'),ii=da('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" class="svelte-g5au2j"></path><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Resume',1),ni=da('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Pause',1),vi=n('<button type="button"><!></button>'),oi=n(`<div class="paused-banner svelte-g5au2j"><div class="paused-header svelte-g5au2j"><svg class="paused-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> <h3 class="paused-title svelte-g5au2j">Readings Paused</h3></div> <p class="paused-text svelte-g5au2j">Hydrometer readings are not being stored. Live readings still display but won't be saved to the fermentation history.</p> <button type="button" class="resume-btn svelte-g5au2j"> </button></div>`),di=n('<span class="btn-spinner svelte-g5au2j"></span> Starting...',1),ci=da('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" class="svelte-g5au2j"></path><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Start Brew Day',1),ui=n(`<div class="planning-phase svelte-g5au2j"><div class="phase-action-card svelte-g5au2j"><div class="phase-icon svelte-g5au2j">üìã</div> <h2 class="phase-title svelte-g5au2j">Ready to Brew?</h2> <p class="phase-description svelte-g5au2j">Review your recipe below, then start brew day when you're ready to begin.</p> <button type="button" class="start-brewday-btn svelte-g5au2j"><!></button></div> <!></div>`),_i=n('<div class="chilling-progress svelte-g5au2j"><div class="progress-bar svelte-g5au2j"><div class="progress-fill svelte-g5au2j"></div></div> <span class="progress-text svelte-g5au2j"> </span></div>'),pi=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è No cooler configured - set in Edit to enable automated chilling</span>'),fi=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è Temperature control disabled in settings</span>'),gi=n('<span class="status-active svelte-g5au2j">Cooler running automatically</span>'),hi=n(`<div class="phase-action-card chilling svelte-g5au2j"><div class="phase-icon svelte-g5au2j">‚ùÑÔ∏è</div> <h2 class="phase-title svelte-g5au2j">Chilling to Pitch Temperature</h2> <p class="phase-description svelte-g5au2j">Wort is being cooled to pitch temperature. The cooler will run automatically.
							Once target is reached, you can pitch the yeast.</p> <div class="chilling-temp-display svelte-g5au2j"><div class="temp-current svelte-g5au2j"><span class="temp-label svelte-g5au2j">Current</span> <span class="temp-value svelte-g5au2j"> </span></div> <div class="temp-arrow svelte-g5au2j">‚Üí</div> <div class="temp-target svelte-g5au2j"><span class="temp-label svelte-g5au2j">Target</span> <span class="temp-value svelte-g5au2j"> </span></div></div> <!> <div class="chilling-status svelte-g5au2j"><!></div></div>`),mi=n('<span class="btn-spinner svelte-g5au2j"></span> Starting...',1),bi=da('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" class="svelte-g5au2j"></path></svg> Yeast Pitched - Start Fermentation',1),yi=n('<div class="phase-action-card ready-to-pitch svelte-g5au2j"><div class="phase-icon svelte-g5au2j">üç∫</div> <h2 class="phase-title svelte-g5au2j">Ready to Pitch!</h2> <p class="phase-description svelte-g5au2j"> </p> <button type="button" class="start-fermentation-btn svelte-g5au2j"><!></button></div>'),xi=n('<span class="btn-spinner svelte-g5au2j"></span> Starting...',1),ki=da('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" class="svelte-g5au2j"></path></svg> Yeast Pitched - Start Fermentation',1),wi=n(`<div class="phase-action-card brewing svelte-g5au2j"><div class="phase-icon svelte-g5au2j">üç∫</div> <h2 class="phase-title svelte-g5au2j">Brew Day in Progress</h2> <p class="phase-description svelte-g5au2j">Track your brew day activities. When you've pitched the yeast and fermentation begins, transition to the fermentation phase.</p> <button type="button" class="start-fermentation-btn svelte-g5au2j"><!></button></div>`),ji=n('<div class="brewing-phase svelte-g5au2j"><!> <div class="brewday-tools-grid svelte-g5au2j"><!> <!></div> <!> <!> <!></div>'),qi=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot brewing svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Brew Day</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Si=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot fermenting svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Fermentation Started</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Mi=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot conditioning svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Conditioning Started</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Ci=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot completed svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Completed</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Bi=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot packaged svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j"> </span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Fi=n('<div class="completed-phase svelte-g5au2j"><div class="batch-summary-card svelte-g5au2j"><h2 class="summary-title svelte-g5au2j">Batch Complete</h2> <div class="summary-stats svelte-g5au2j"><div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Original Gravity</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Final Gravity</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">ABV</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Attenuation</span> <span class="stat-value svelte-g5au2j"><!></span></div></div></div> <div class="timeline-card svelte-g5au2j"><h3 class="timeline-title svelte-g5au2j">Batch Timeline</h3> <div class="timeline svelte-g5au2j"><!> <!> <!> <!> <!></div></div> <!> <!> <!></div>'),zi=n('<span class="status-badge heater svelte-g5au2j">üî• Heating</span>'),Ti=n('<span class="status-badge cooler svelte-g5au2j">‚ùÑÔ∏è Cooling</span>'),Di=n('<span class="status-badge idle svelte-g5au2j"> </span>'),Ai=n('<div class="device-status heater svelte-g5au2j"><div>üî•</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Heater</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Pi=n('<div class="device-status cooler svelte-g5au2j"><div>‚ùÑÔ∏è</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Cooler</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Ri=n('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">‚ö°</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),Ni=n('<button type="button" class="override-btn heat-on svelte-g5au2j">Force Heat ON</button> <button type="button" class="override-btn heat-off svelte-g5au2j">Force Heat OFF</button>',1),Oi=n('<button type="button" class="override-btn cool-on svelte-g5au2j">Force Cool ON</button> <button type="button" class="override-btn cool-off svelte-g5au2j">Force Cool OFF</button>',1),Li=n('<div class="control-details svelte-g5au2j"><div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns-grid svelte-g5au2j"><!> <!> <button type="button" class="override-btn auto-mode svelte-g5au2j">Auto Mode</button></div></div>',1),Ei=n('<div class="device-status-grid svelte-g5au2j"><!> <!></div> <!>',1),Gi=n('<div><button type="button" class="collapsible-header svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="collapse-indicator svelte-g5au2j"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" class="svelte-g5au2j"></path></svg></div></button> <!></div>'),Ii=n('<span class="svelte-g5au2j"> </span>'),Ui=n('<span class="svelte-g5au2j"> </span>'),Vi=n('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><!> <!> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),Hi=n('<div class="chart-section svelte-g5au2j"><!></div>'),Wi=n('<div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!> <!></div></div> <!>',1),Xi=n('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <!> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j" aria-label="Delete batch"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <!> <!>',1),Ji=n('<div class="modal-overlay svelte-g5au2j" role="presentation"><div class="modal svelte-g5au2j" role="dialog" aria-modal="true" aria-labelledby="delete-modal-title" tabindex="-1"><h2 id="delete-modal-title" class="modal-title svelte-g5au2j">Delete Batch?</h2> <p class="modal-text svelte-g5au2j"> </p> <div class="modal-actions svelte-g5au2j"><button type="button" class="modal-btn cancel svelte-g5au2j">Cancel</button> <button type="button" class="modal-btn delete svelte-g5au2j"> </button></div></div></div>'),Yi=n('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div> <!>',1);function bn(Pe,i){Ht(i,!0);const g=()=>ds(cs,"$page",S),[S,E]=os();let B=null,K=null,r=U(null),P=U(null),q=U(null),Q=Ze([]),de=U(!0),je=U(null),M=U(!1),X=U(!1),J=U(!1),le=U(!1),R=U(!1),Z=U(!1),$=U(!1),re=L(()=>parseInt(g().params.id??"0"));const N=["planning","brewing","fermenting","conditioning","completed","archived"];let V=L(()=>e(r)?Fa[e(r).status]:Fa.planning),te=L(Aa),ee=L(()=>qa.config.ha_enabled&&qa.config.temp_control_enabled&&(e(r)?.heater_entity_id||e(r)?.cooler_entity_id)),_e=L(()=>(e(r)?.status==="planning"||e(r)?.status==="brewing")&&e(r)?.temp_target!=null),qe=L(()=>!e(_e)||!e(se)?.temp||!e(r)?.temp_target?!1:e(se).temp<=e(r).temp_target),Me=L(()=>{if(!e(_e)||!e(se)?.temp||!e(r)?.temp_target)return null;const _=e(r).temp_target+30,j=e(se).temp,T=e(r).temp_target;if(j<=T)return 100;if(j>=_)return 0;const D=(_-j)/(_-T)*100;return Math.min(100,Math.max(0,D))}),se=L(()=>{if(!e(r)?.device_id)return null;const _=Ua.tilts.get(e(r).device_id);if(_)return _;const j=e(r).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!j?.[1])return null;const T=j[1].toUpperCase();for(const D of Ua.tilts.values())if(D.color&&D.color.toUpperCase()===T)return D;return null});async function w(){o(de,!0),o(je,null);try{if(o(r,await xs(e(re)),!0),e(r).status==="fermenting"||e(r).status==="conditioning"||e(r).status==="completed")try{o(P,await Ca(e(re)),!0)}catch{}if(e(r).heater_entity_id||e(r).cooler_entity_id)try{o(q,await ja(e(re)),!0)}catch{}}catch(_){o(je,_ instanceof Error?_.message:"Failed to load batch",!0)}finally{o(de,!1)}}async function m(_){if(!(!e(r)||e(X))&&!(_==="conditioning"&&e(r).status==="fermenting"&&!confirm(`üí° Entering Conditioning Phase

Reminder: Adjust target temperature if cold crashing.
Temperature control will continue during conditioning.

Continue?`))){o(X,!0);try{o(r,await oa(e(r).id,{status:_}),!0),(_==="fermenting"||_==="conditioning")&&o(P,await Ca(e(r).id),!0)}catch(j){console.error("Failed to update status:",j)}finally{o(X,!1)}}}async function x(){if(!(!e(r)||e(X))){o(X,!0);try{o(r,await oa(e(r).id,{status:"brewing"}),!0)}catch(_){console.error("Failed to start brew day:",_)}finally{o(X,!1)}}}async function b(){if(!(!e(r)||e(X))){o(X,!0);try{o(r,await oa(e(r).id,{status:"fermenting"}),!0),o(P,await Ca(e(r).id),!0)}catch(_){console.error("Failed to start fermentation:",_)}finally{o(X,!1)}}}async function h(_){if(e(r)&&(o(r,await oa(e(r).id,_),!0),o(M,!1),e(r).heater_entity_id||e(r).cooler_entity_id))try{o(q,await ja(e(r).id),!0)}catch{}}async function p(){if(e(r)){o(R,!0);try{await ks(e(r).id),us("/batches")}catch(_){o(je,_ instanceof Error?_.message:"Failed to delete batch",!0),o(R,!1),o(le,!1)}}}async function c(){if(!(!e(r)||e($))){o($,!0);try{o(r,await oa(e(r).id,{readings_paused:!e(r).readings_paused}),!0)}catch(_){console.error("Failed to toggle pause:",_)}finally{o($,!1)}}}async function f(_,j){if(!(!e(r)||e(J))){o(J,!0);try{await Ba(e(r).id,j,60,_),o(q,await ja(e(r).id),!0)}catch(T){console.error("Failed to set override:",T)}finally{o(J,!1)}}}async function k(){if(!(!e(r)||e(J))){o(J,!0);try{e(r).heater_entity_id&&await Ba(e(r).id,null,60,"heater"),e(r).cooler_entity_id&&await Ba(e(r).id,null,60,"cooler"),o(q,await ja(e(r).id),!0)}catch(_){console.error("Failed to clear overrides:",_)}finally{o(J,!1)}}}function y(){if(B?.readyState===WebSocket.OPEN)return;const j=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;B=new WebSocket(j),B.onmessage=async T=>{try{const D=JSON.parse(T.data);D.type==="control_event"&&D.batch_id===e(re)&&e(q)&&(D.action==="heat_on"?o(q,{...e(q),heater_state:"on"},!0):D.action==="heat_off"?o(q,{...e(q),heater_state:"off"},!0):D.action==="cool_on"?o(q,{...e(q),cooler_state:"on"},!0):D.action==="cool_off"&&o(q,{...e(q),cooler_state:"off"},!0))}catch{}},B.onclose=()=>{B=null,K=setTimeout(y,3e3)},B.onerror=()=>{B?.close()}}function F(){K&&(clearTimeout(K),K=null),B?.close(),B=null}function H(_){return _==null?"--":Bt(_)}function O(_){return _==null?"--":Sa(_)}function ce(_){return _?new Date(_).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"--"}function ae(_){if(!_)return"--";const j=new Date(_),D=(new Date().getTime()-j.getTime())/(1e3*60*60);if(D<1)return`${Math.round(D*60)}m`;if(D<24)return`${D.toFixed(1)}h`;const W=D/24;return W<7?`${W.toFixed(1)}d`:`${Math.round(W)}d`}function pe(_){return _?new Date(_).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"}):"--"}Wa(()=>{w(),y()}),ss(()=>{F()});var ie=Yi();is("g5au2j",_=>{rs(()=>{ls.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var ke=oe(ie),Se=s(a(ke),2);{var Be=_=>{var j=Zl();l(_,j)},Ge=_=>{var j=He(),T=oe(j);{var D=Y=>{var ne=$l(),ge=s(a(ne),2),be=a(ge,!0);t(ge);var ye=s(ge,2);ye.__click=w,t(ne),u(()=>d(be,e(je))),l(Y,ne)},W=Y=>{var ne=He(),ge=oe(ne);{var be=We=>{var bt=ei();l(We,bt)},ye=We=>{var bt=He(),_t=oe(bt);{var Pt=z=>{ws(z,{get batch(){return e(r)},onSubmit:h,onCancel:()=>o(M,!1)})},C=z=>{var he=Xi(),G=oe(he),ve=a(G),A=a(ve),I=a(A);t(A);var me=s(A,2),ze=a(me),Xe=a(ze,!0);t(ze);var Ie=s(ze,2);{var Ue=Le=>{var Te=ai(),Ye=a(Te),nt=s(Ye);{var ft=vt=>{var at=ti(),xt=a(at);t(at),u(()=>d(xt,`(${e(r).recipe.type??""})`)),l(vt,at)};v(nt,vt=>{e(r).recipe.type&&vt(ft)})}t(Te),u(()=>{Qt(Te,"href",`/recipes/${e(r).recipe.id??""}`),d(Ye,`${e(r).recipe.name??""} `)}),l(Le,Te)};v(Ie,Le=>{e(r).recipe&&Le(Ue)})}var Re=s(Ie,2);{var Qe=Le=>{var Te=si(),Ye=a(Te);t(Te),u((nt,ft)=>d(Ye,`Started ${nt??""} ¬∑ ${ft??""} ago`),[()=>ce(e(r).start_time),()=>ae(e(r).start_time)]),l(Le,Te)},$e=Le=>{var Te=He(),Ye=oe(Te);{var nt=ft=>{var vt=ri(),at=a(vt);t(vt),u(xt=>d(at,`Brewed ${xt??""}`),[()=>ce(e(r).brew_date)]),l(ft,vt)};v(Ye,ft=>{e(r).brew_date&&ft(nt)},!0)}l(Le,Te)};v(Re,Le=>{e(r).start_time?Le(Qe):Le($e,!1)})}t(me),t(ve);var et=s(ve,2),ot=a(et),De=a(ot);De.__change=Le=>m(Le.currentTarget.value),Dt(De,21,()=>N,Kt,(Le,Te)=>{var Ye=li(),nt=a(Ye,!0);t(Ye);var ft={};u(()=>{d(nt,Fa[e(Te)].label),ft!==(ft=e(Te))&&(Ye.value=(Ye.__value=e(Te))??"")}),l(Le,Ye)}),t(De);var pt;ns(De),t(ot);var we=s(ot,2);{var Je=Le=>{var Te=vi();let Ye;Te.__click=c;var nt=a(Te);{var ft=at=>{var xt=ii();xe(),l(at,xt)},vt=at=>{var xt=ni();xe(),l(at,xt)};v(nt,at=>{e(r).readings_paused?at(ft):at(vt,!1)})}t(Te),u(()=>{Ye=Ee(Te,1,"pause-btn svelte-g5au2j",null,Ye,{paused:e(r).readings_paused}),Te.disabled=e($),Qt(Te,"title",e(r).readings_paused?"Resume storing readings":"Pause storing readings")}),l(Le,Te)};v(we,Le=>{(e(r).status==="fermenting"||e(r).status==="conditioning")&&Le(Je)})}var Rt=s(we,2);Rt.__click=()=>o(M,!0);var ca=s(Rt,2);ca.__click=()=>o(le,!0),t(et),t(G);var Pa=s(G,2);{var Ja=Le=>{var Te=oi(),Ye=s(a(Te),4);Ye.__click=c;var nt=a(Ye,!0);t(Ye),t(Te),u(()=>{Ye.disabled=e($),d(nt,e($)?"Resuming...":"Resume Readings")}),l(Le,Te)};v(Pa,Le=>{e(r).readings_paused&&(e(r).status==="fermenting"||e(r).status==="conditioning")&&Le(Ja)})}var Ya=s(Pa,2);{var Ka=Le=>{var Te=ui(),Ye=a(Te),nt=s(a(Ye),6);nt.__click=x;var ft=a(nt);{var vt=kt=>{var wt=di();xe(),l(kt,wt)},at=kt=>{var wt=ci();xe(),l(kt,wt)};v(ft,kt=>{e(X)?kt(vt):kt(at,!1)})}t(nt),t(Ye);var xt=s(Ye,2);{var ka=kt=>{za(kt,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(xt,kt=>{e(r).recipe&&kt(ka)})}t(Te),u(()=>nt.disabled=e(X)),l(Le,Te)},Qa=Le=>{var Te=He(),Ye=oe(Te);{var nt=vt=>{var at=ji(),xt=a(at);{var ka=Ae=>{var Ft=hi(),Xt=s(a(Ft),6),Jt=a(Xt),ia=s(a(Jt),2),Nt=a(ia,!0);t(ia),t(Jt);var jt=s(Jt,4),dt=s(a(jt),2),Ce=a(dt,!0);t(dt),t(jt),t(Xt);var Ke=s(Xt,2);{var qt=lt=>{var ht=_i(),Lt=a(ht),aa=a(Lt);t(Lt);var ct=s(Lt,2),Ne=a(ct);t(ct),t(ht),u(it=>{At(aa,`width: ${e(Me)??""}%`),d(Ne,`${it??""}% to pitch temp`)},[()=>Math.round(e(Me))]),l(lt,ht)};v(Ke,lt=>{e(Me)!=null&&lt(qt)})}var st=s(Ke,2),gt=a(st);{var rt=lt=>{var ht=pi();l(lt,ht)},Ot=lt=>{var ht=He(),Lt=oe(ht);{var aa=Ne=>{var it=fi();l(Ne,it)},ct=Ne=>{var it=gi();l(Ne,it)};v(Lt,Ne=>{!qa.config.ha_enabled||!qa.config.temp_control_enabled?Ne(aa):Ne(ct,!1)},!0)}l(lt,ht)};v(gt,lt=>{e(r).cooler_entity_id?lt(Ot,!1):lt(rt)})}t(st),t(Ft),u((lt,ht)=>{d(Nt,lt),d(Ce,ht)},[()=>e(se)?.temp!=null?O(e(se).temp):"--",()=>e(r).temp_target!=null?O(e(r).temp_target):"--"]),l(Ae,Ft)},kt=Ae=>{var Ft=He(),Xt=oe(Ft);{var Jt=Nt=>{var jt=yi(),dt=s(a(jt),4),Ce=a(dt);t(dt);var Ke=s(dt,2);Ke.__click=b;var qt=a(Ke);{var st=rt=>{var Ot=mi();xe(),l(rt,Ot)},gt=rt=>{var Ot=bi();xe(),l(rt,Ot)};v(qt,rt=>{e(X)?rt(st):rt(gt,!1)})}t(Ke),t(jt),u(rt=>{d(Ce,`Wort has reached pitch temperature (${rt??""}${e(te)??""}).
							Pitch the yeast and start fermentation.`),Ke.disabled=e(X)},[()=>O(e(r).temp_target)]),l(Nt,jt)},ia=Nt=>{var jt=wi(),dt=s(a(jt),6);dt.__click=b;var Ce=a(dt);{var Ke=st=>{var gt=xi();xe(),l(st,gt)},qt=st=>{var gt=ki();xe(),l(st,gt)};v(Ce,st=>{e(X)?st(Ke):st(qt,!1)})}t(dt),t(jt),u(()=>dt.disabled=e(X)),l(Nt,jt)};v(Xt,Nt=>{e(_e)&&e(qe)?Nt(Jt):Nt(ia,!1)},!0)}l(Ae,Ft)};v(xt,Ae=>{e(_e)&&!e(qe)?Ae(ka):Ae(kt,!1)})}var wt=s(xt,2),$t=a(wt);{var ea=Ae=>{al(Ae,{get batch(){return e(r)},get recipe(){return e(r).recipe}})};v($t,Ae=>{e(r).recipe&&Ae(ea)})}var ra=s($t,2);{var la=Ae=>{vl(Ae,{get recipe(){return e(r).recipe},get batchId(){return e(r).id}})};v(ra,Ae=>{e(r).recipe&&Ae(la)})}t(wt);var ua=s(wt,2);{var wa=Ae=>{Cl(Ae,{get batch(){return e(r)},get recipe(){return e(r).recipe},onUpdate:Ft=>o(r,Ft,!0)})};v(ua,Ae=>{e(r).recipe&&Ae(wa)})}var ta=s(ua,2);{var _a=Ae=>{Va(Ae,{get batch(){return e(r)},get liveReading(){return e(se)},onEdit:()=>o(M,!0)})};v(ta,Ae=>{e(r).device_id&&Ae(_a)})}var ma=s(ta,2);{var pa=Ae=>{za(Ae,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(ma,Ae=>{e(r).recipe&&Ae(pa)})}t(at),l(vt,at)},ft=vt=>{var at=He(),xt=oe(at);{var ka=wt=>{var $t=Fi(),ea=a($t),ra=s(a(ea),2),la=a(ra),ua=s(a(la),2),wa=a(ua,!0);t(ua),t(la);var ta=s(la,2),_a=s(a(ta),2),ma=a(_a,!0);t(_a),t(ta);var pa=s(ta,2),Ae=s(a(pa),2),Ft=a(Ae);t(Ae),t(pa);var Xt=s(pa,2),Jt=s(a(Xt),2),ia=a(Jt);{var Nt=ue=>{var Oe=Yt();u(Ve=>d(Oe,`${Ve??""}%`),[()=>((e(r).measured_og-e(r).measured_fg)/(e(r).measured_og-1)*100).toFixed(0)]),l(ue,Oe)},jt=ue=>{var Oe=Yt("--");l(ue,Oe)};v(ia,ue=>{e(r).measured_og&&e(r).measured_fg?ue(Nt):ue(jt,!1)})}t(Jt),t(Xt),t(ra),t(ea);var dt=s(ea,2),Ce=s(a(dt),2),Ke=a(Ce);{var qt=ue=>{var Oe=qi(),Ve=s(a(Oe),2),tt=s(a(Ve),2),zt=a(tt,!0);t(tt),t(Ve),t(Oe),u(St=>d(zt,St),[()=>pe(e(r).brewing_started_at||e(r).brew_date)]),l(ue,Oe)};v(Ke,ue=>{(e(r).brew_date||e(r).brewing_started_at)&&ue(qt)})}var st=s(Ke,2);{var gt=ue=>{var Oe=Si(),Ve=s(a(Oe),2),tt=s(a(Ve),2),zt=a(tt,!0);t(tt),t(Ve),t(Oe),u(St=>d(zt,St),[()=>pe(e(r).fermenting_started_at||e(r).start_time)]),l(ue,Oe)};v(st,ue=>{(e(r).start_time||e(r).fermenting_started_at)&&ue(gt)})}var rt=s(st,2);{var Ot=ue=>{var Oe=Mi(),Ve=s(a(Oe),2),tt=s(a(Ve),2),zt=a(tt,!0);t(tt),t(Ve),t(Oe),u(St=>d(zt,St),[()=>pe(e(r).conditioning_started_at)]),l(ue,Oe)};v(rt,ue=>{e(r).conditioning_started_at&&ue(Ot)})}var lt=s(rt,2);{var ht=ue=>{var Oe=Ci(),Ve=s(a(Oe),2),tt=s(a(Ve),2),zt=a(tt,!0);t(tt),t(Ve),t(Oe),u(St=>d(zt,St),[()=>pe(e(r).completed_at||e(r).end_time)]),l(ue,Oe)};v(lt,ue=>{(e(r).end_time||e(r).completed_at)&&ue(ht)})}var Lt=s(lt,2);{var aa=ue=>{var Oe=Bi(),Ve=s(a(Oe),2),tt=a(Ve),zt=a(tt);t(tt);var St=s(tt,2),ut=a(St,!0);t(St),t(Ve),t(Oe),u(mt=>{d(zt,`Packaged (${(e(r).packaging_type||"kegged")??""})`),d(ut,mt)},[()=>pe(e(r).packaged_at)]),l(ue,Oe)};v(Lt,ue=>{e(r).packaged_at&&ue(aa)})}t(Ce),t(dt);var ct=s(dt,2);Nl(ct,{get batch(){return e(r)},onUpdate:ue=>o(r,ue,!0)});var Ne=s(ct,2);Ql(Ne,{get batch(){return e(r)},onUpdate:ue=>o(r,ue,!0)});var it=s(Ne,2);{var fa=ue=>{Ha(ue,{get notes(){return e(r).notes}})};v(it,ue=>{e(r).notes&&ue(fa)})}t($t),u((ue,Oe,Ve)=>{d(wa,ue),d(ma,Oe),d(Ft,`${Ve??""}%`)},[()=>H(e(r).measured_og),()=>H(e(r).measured_fg),()=>e(r).measured_abv?.toFixed(1)??"--"]),l(wt,$t)},kt=wt=>{var $t=Wi(),ea=oe($t),ra=a(ea),la=a(ra);{let Ce=L(()=>e(se)?.sg??e(P)?.measured?.current_sg);Es(la,{get batch(){return e(r)},get currentSg(){return e(Ce)},get progress(){return e(P)},get liveReading(){return e(se)}})}var ua=s(la,2);{var wa=Ce=>{za(Ce,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(ua,Ce=>{e(r).recipe&&Ce(wa)})}t(ra);var ta=s(ra,2),_a=a(ta);Va(_a,{get batch(){return e(r)},get liveReading(){return e(se)},onEdit:()=>o(M,!0)});var ma=s(_a,2);{var pa=Ce=>{Ur(Ce,{get batchId(){return e(r).id}})};v(ma,Ce=>{(e(r).status==="fermenting"||e(r).status==="conditioning")&&Ce(pa)})}var Ae=s(ma,2);{let Ce=L(()=>e(r).measured_fg??e(P)?.measured?.fg),Ke=L(()=>e(se)?.sg??e(P)?.measured?.current_sg);Pr(Ae,{get batchId(){return e(r).id},get batchStatus(){return e(r).status},get measuredOg(){return e(r).measured_og},get measuredFg(){return e(Ce)},get currentSg(){return e(Ke)},get liveReading(){return e(se)}})}var Ft=s(Ae,2);{var Xt=Ce=>{var Ke=Gi();let qt;var st=a(Ke);st.__click=()=>o(Z,!e(Z));var gt=s(a(st),2),rt=a(gt);{var Ot=Ne=>{var it=zi();l(Ne,it)},lt=Ne=>{var it=He(),fa=oe(it);{var ue=Ve=>{var tt=Ti();l(Ve,tt)},Oe=Ve=>{var tt=He(),zt=oe(tt);{var St=ut=>{var mt=Di(),Et=a(mt);t(mt),u(Gt=>d(Et,`üéØ ${Gt??""}${e(te)??""}`),[()=>O(e(q).target_temp)]),l(ut,mt)};v(zt,ut=>{e(Z)&&e(q)&&ut(St)},!0)}l(Ve,tt)};v(fa,Ve=>{e(q)?.cooler_state==="on"?Ve(ue):Ve(Oe,!1)},!0)}l(Ne,it)};v(rt,Ne=>{e(q)?.heater_state==="on"?Ne(Ot):Ne(lt,!1)})}var ht=s(rt,2);let Lt;t(gt),t(st);var aa=s(st,2);{var ct=Ne=>{var it=Ei(),fa=oe(it),ue=a(fa);{var Oe=ut=>{var mt=Ai(),Et=a(mt);let Gt;var na=s(Et,2),It=s(a(na),2);let va;var ba=a(It,!0);t(It);var ga=s(It,2),ya=a(ga,!0);t(ga),t(na),t(mt),u(()=>{Gt=Ee(Et,1,"device-icon-wrap svelte-g5au2j",null,Gt,{active:e(q)?.heater_state==="on"}),va=Ee(It,1,"device-state svelte-g5au2j",null,va,{on:e(q)?.heater_state==="on"}),d(ba,e(q)?.heater_state==="on"?"ON":"OFF"),d(ya,e(r).heater_entity_id)}),l(ut,mt)};v(ue,ut=>{e(r).heater_entity_id&&ut(Oe)})}var Ve=s(ue,2);{var tt=ut=>{var mt=Pi(),Et=a(mt);let Gt;var na=s(Et,2),It=s(a(na),2);let va;var ba=a(It,!0);t(It);var ga=s(It,2),ya=a(ga,!0);t(ga),t(na),t(mt),u(()=>{Gt=Ee(Et,1,"device-icon-wrap svelte-g5au2j",null,Gt,{active:e(q)?.cooler_state==="on"}),va=Ee(It,1,"device-state svelte-g5au2j",null,va,{on:e(q)?.cooler_state==="on"}),d(ba,e(q)?.cooler_state==="on"?"ON":"OFF"),d(ya,e(r).cooler_entity_id)}),l(ut,mt)};v(Ve,ut=>{e(r).cooler_entity_id&&ut(tt)})}t(fa);var zt=s(fa,2);{var St=ut=>{var mt=Li(),Et=oe(mt),Gt=a(Et),na=s(a(Gt),2),It=a(na);t(na),t(Gt);var va=s(Gt,2),ba=s(a(va),2),ga=a(ba);t(ba),t(va),t(Et);var ya=s(Et,2);{var Za=Tt=>{var Ut=Ri(),Vt=s(a(Ut),2),ha=a(Vt);t(Vt);var Ga=s(Vt,2);Ga.__click=()=>k(),t(Ut),u(ts=>{d(ha,`Override active: ${ts??""}`),Ga.disabled=e(J)},[()=>e(q).override_state?.toUpperCase()]),l(Tt,Ut)};v(ya,Tt=>{e(q).override_active&&Tt(Za)})}var Ra=s(ya,2),Na=s(a(Ra),2),Oa=a(Na);{var $a=Tt=>{var Ut=Ni(),Vt=oe(Ut);Vt.__click=()=>f("heater","on");var ha=s(Vt,2);ha.__click=()=>f("heater","off"),u(()=>{Vt.disabled=e(J),ha.disabled=e(J)}),l(Tt,Ut)};v(Oa,Tt=>{e(r).heater_entity_id&&Tt($a)})}var La=s(Oa,2);{var es=Tt=>{var Ut=Oi(),Vt=oe(Ut);Vt.__click=()=>f("cooler","on");var ha=s(Vt,2);ha.__click=()=>f("cooler","off"),u(()=>{Vt.disabled=e(J),ha.disabled=e(J)}),l(Tt,Ut)};v(La,Tt=>{e(r).cooler_entity_id&&Tt(es)})}var Ea=s(La,2);Ea.__click=()=>k(),t(Na),t(Ra),u((Tt,Ut)=>{d(It,`${Tt??""}${e(te)??""}`),d(ga,`¬±${Ut??""}${e(te)??""}`),Ea.disabled=e(J)},[()=>O(e(q).target_temp),()=>e(q).hysteresis?.toFixed(1)||"--"]),l(ut,mt)};v(zt,ut=>{e(q)&&ut(St)})}l(Ne,it)};v(aa,Ne=>{e(Z)||Ne(ct)})}t(Ke),u(()=>{qt=Ee(Ke,1,"info-card temp-control-card svelte-g5au2j",null,qt,{"heater-on":e(q)?.heater_state==="on","cooler-on":e(q)?.cooler_state==="on",collapsed:e(Z)}),Lt=Ee(ht,0,"chevron svelte-g5au2j",null,Lt,{rotated:!e(Z)})}),l(Ce,Ke)},Jt=Ce=>{var Ke=He(),qt=oe(Ke);{var st=gt=>{var rt=Vi(),Ot=s(a(rt),2),lt=a(Ot);{var ht=ct=>{var Ne=Ii(),it=a(Ne);t(Ne),u(()=>d(it,`Heater: ${e(r).heater_entity_id??""}`)),l(ct,Ne)};v(lt,ct=>{e(r).heater_entity_id&&ct(ht)})}var Lt=s(lt,2);{var aa=ct=>{var Ne=Ui(),it=a(Ne);t(Ne),u(()=>d(it,`Cooler: ${e(r).cooler_entity_id??""}`)),l(ct,Ne)};v(Lt,ct=>{e(r).cooler_entity_id&&ct(aa)})}xe(2),t(Ot),t(rt),l(gt,rt)};v(qt,gt=>{(e(r).heater_entity_id||e(r).cooler_entity_id)&&e(r).status!=="fermenting"&&gt(st)},!0)}l(Ce,Ke)};v(Ft,Ce=>{e(ee)&&(e(r).status==="fermenting"||e(r).status==="conditioning")?Ce(Xt):Ce(Jt,!1)})}var ia=s(Ft,2);{var Nt=Ce=>{Ha(Ce,{get notes(){return e(r).notes}})};v(ia,Ce=>{e(r).notes&&Ce(Nt)})}t(ta),t(ea);var jt=s(ea,2);{var dt=Ce=>{var Ke=Hi(),qt=a(Ke);qs(qt,{get batchId(){return e(r).id},get deviceColor(){return e(r).device_id},get originalGravity(){return e(r).measured_og},get controlEvents(){return Q}}),t(Ke),l(Ce,Ke)};v(jt,Ce=>{e(r).device_id&&Ce(dt)})}l(wt,$t)};v(xt,wt=>{e(r).status==="completed"?wt(ka):wt(kt,!1)},!0)}l(vt,at)};v(Ye,vt=>{e(r).status==="brewing"?vt(nt):vt(ft,!1)},!0)}l(Le,Te)};v(Ya,Le=>{e(r).status==="planning"?Le(Ka):Le(Qa,!1)})}u(()=>{d(I,`#${(e(r).batch_number||"?")??""}`),d(Xe,e(r).name||e(r).recipe?.name||"Unnamed Batch"),De.disabled=e(X),At(De,`color: ${e(V).color??""}; background: ${e(V).bg??""};`),pt!==(pt=e(r).status)&&(De.value=(De.__value=e(r).status)??"",vs(De,e(r).status))}),l(z,he)};v(_t,z=>{e(M)?z(Pt):z(C,!1)},!0)}l(We,bt)};v(ge,We=>{e(r)?We(ye,!1):We(be)},!0)}l(Y,ne)};v(T,Y=>{e(je)?Y(D):Y(W,!1)},!0)}l(_,j)};v(Se,_=>{e(de)?_(Be):_(Ge,!1)})}t(ke);var Fe=s(ke,2);{var fe=_=>{var j=Ji();j.__click=()=>o(le,!1),j.__keydown=ye=>ye.key==="Escape"&&o(le,!1);var T=a(j);T.__click=ye=>ye.stopPropagation(),T.__keydown=ye=>ye.stopPropagation();var D=s(a(T),2),W=a(D);t(D);var Y=s(D,2),ne=a(Y);ne.__click=()=>o(le,!1);var ge=s(ne,2);ge.__click=p;var be=a(ge,!0);t(ge),t(Y),t(T),t(j),u(()=>{d(W,`Are you sure you want to delete "${(e(r)?.name||"this batch")??""}"? This cannot be undone.`),ne.disabled=e(R),ge.disabled=e(R),d(be,e(R)?"Deleting...":"Delete Batch")}),l(_,j)};v(Fe,_=>{e(le)&&_(fe)})}l(Pe,ie),Wt(),E()}Zt(["click","change","keydown"]);export{bn as component,mn as universal};
