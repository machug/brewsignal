import{d as zt,f as i,s as o,a as n,c as be,t as It}from"../chunks/NSBYmcxh.js";import{al as a,ak as s,an as t,ar as u,ah as yt,at as A,c as e,ai as S,as as Fe,aj as jt,aq as qe,p as Kt,ao as Qt,s as g,aO as ma,ay as ha,am as ba}from"../chunks/DkBf6qYn.js";import{e as Xt,i as Zt}from"../chunks/J4k8iyZ5.js";import{i as v}from"../chunks/S0lmOLxe.js";import{h as xa}from"../chunks/Cdr2eubP.js";import{s as ft}from"../chunks/BSVWW4up.js";import{s as Ae}from"../chunks/DiswNjmD.js";import{s as Ze}from"../chunks/mQ7Axk59.js";import{i as ya,s as ja}from"../chunks/BwTw8k3J.js";import{s as wa,a as ka}from"../chunks/IQazAl2k.js";import{p as za}from"../chunks/x9Jly6ZP.js";import{g as qa}from"../chunks/BqjaVNxO.js";import{E as Fa,F as Ra,x as Ca,n as Wt,G as wt,q as Sa,C as Yt,H as Ct}from"../chunks/BfEIqWbI.js";import{d as xt,e as $t,g as ea,c as kt}from"../chunks/BhVEqTpw.js";import{t as Jt}from"../chunks/D-ds_LpT.js";import{B as Ba}from"../chunks/DqBX-qip.js";import{s as Ma}from"../chunks/DcdoetHA.js";import{p as ut}from"../chunks/8pk9z1gL.js";const Ta=!1,Sr=Object.freeze(Object.defineProperty({__proto__:null,prerender:Ta},Symbol.toStringTag,{value:"Module"}));function Da(de){return de>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:de>=-60?{bars:3,color:"var(--positive)",label:"Good"}:de>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function ta(de){const l=Math.floor((Date.now()-new Date(de).getTime())/1e3);if(l<10)return"just now";if(l<60)return`${l}s ago`;const E=Math.floor(l/60);if(E<60)return`${E}m ago`;const W=Math.floor(E/60);return W<24?`${W}h ago`:`${Math.floor(W/24)}d ago`}var Oa=i('<div class="accent-bar svelte-1oyrwd9"></div>'),Pa=i('<span class="card-icon svelte-1oyrwd9"> </span>'),Aa=i('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),Ea=i('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function qt(de,l){let E=ut(l,"highlight",3,!1),W=ut(l,"compact",3,!1),L=ut(l,"collapsible",3,!1),h=ut(l,"expanded",3,!1);var U=Ea();let r;var O=a(U);{var p=w=>{var d=Oa();n(w,d)};v(O,w=>{E()&&w(p)})}var H=s(O,2),te=a(H),ge=a(te);{var F=w=>{var d=Pa(),y=a(d,!0);t(d),u(()=>o(y,l.icon)),n(w,d)};v(ge,w=>{l.icon&&w(F)})}var T=s(ge,2),V=a(T,!0);t(T),t(te);var X=s(te,2);{var Z=w=>{var d=Aa();d.__click=function(...D){l.onToggle?.apply(this,D)};var y=a(d);let b;t(d),u(()=>{ft(d,"aria-label",h()?"Collapse":"Expand"),b=Ae(y,0,"expand-icon svelte-1oyrwd9",null,b,{"rotate-180":h()})}),n(w,d)};v(X,w=>{L()&&l.onToggle&&w(Z)})}t(H);var ce=s(H,2);let I;var $=a(ce);Ma($,()=>l.children),t(ce),t(U),u(()=>{r=Ae(U,1,"batch-card svelte-1oyrwd9",null,r,{highlight:E(),compact:W()}),o(V,l.title),I=Ae(ce,1,"card-content svelte-1oyrwd9",null,I,{collapsed:L()&&!h()})}),n(de,U)}zt(["click"]);var Ga=i('<span class="updated-text svelte-t80j9z"> </span>'),La=i('<div class="hero-divider svelte-t80j9z"></div> <div class="hero-metric temperature svelte-t80j9z"><span class="hero-value svelte-t80j9z"> <span class="hero-unit svelte-t80j9z"> </span></span> <span class="hero-label svelte-t80j9z">Temperature</span></div>',1),Ua=i('<div class="remaining-text svelte-t80j9z"> </div>'),Na=i('<div class="progress-section svelte-t80j9z"><div class="progress-labels svelte-t80j9z"><div class="progress-endpoint start svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">OG</span></div> <div class="progress-current svelte-t80j9z"><span class="current-percent svelte-t80j9z"> </span></div> <div class="progress-endpoint end svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">Target FG</span></div></div> <div class="progress-track svelte-t80j9z"><div class="progress-fill svelte-t80j9z"></div> <div><div class="marker-dot svelte-t80j9z"></div> <div class="marker-value svelte-t80j9z"> </div></div></div> <!></div>'),Ha=i('<div class="metrics-row svelte-t80j9z"><div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">ABV</span></div> <div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">Attenuation</span></div></div>'),Va=i('<div class="status-row svelte-t80j9z"><div class="live-indicator svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> <span class="status-text svelte-t80j9z">LIVE</span></div> <!></div> <div class="hero-section svelte-t80j9z"><div class="hero-metric gravity svelte-t80j9z"><span class="hero-value svelte-t80j9z"> </span> <span class="hero-label svelte-t80j9z">Gravity</span></div> <!></div> <!> <!>',1),Ia=i('<div class="completed-grid svelte-t80j9z"><div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Original Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Final Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">ABV</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Attenuation</span></div></div>'),Wa=i('<div class="empty-state svelte-t80j9z"><div class="empty-icon svelte-t80j9z">‚óé</div> <p class="empty-text svelte-t80j9z">Set Original Gravity to track fermentation</p></div>');function Ya(de,l){yt(l,!0);let E=S(()=>l.currentSg??l.progress?.measured?.current_sg),W=S(()=>l.liveReading?.temp??l.progress?.temperature?.current),L=S(()=>l.liveReading?.last_seen),h=S(()=>e(L)?ta(e(L)):null),U=S(ea),r=S(()=>{if(!l.batch.measured_og||!e(E))return null;const F=Math.max(0,(l.batch.measured_og-e(E))*131.25),T=l.batch.measured_og-1,V=T!==0?Math.max(0,Math.min(100,(l.batch.measured_og-e(E))/T*100)):0;return{abv:F,attenuation:V}}),O=S(()=>{const F=l.batch.measured_og,T=l.batch.recipe?.fg;if(!F||!T||!e(E))return null;const V=F-T,X=F-e(E);return V<=0?null:Math.max(0,Math.min(100,X/V*100))}),p=S(()=>l.batch.status==="fermenting"||l.batch.status==="conditioning");function H(F){return F==null?"--":xt(F)}function te(F){return F==null?"--":`${F.toFixed(1)}%`}function ge(F){return F==null?"--":$t(F)}qt(de,{title:"Fermentation",children:(F,T)=>{var V=be(),X=A(V);{var Z=I=>{var $=Va(),w=A($),d=s(a(w),2);{var y=B=>{var f=Ga(),_=a(f);t(f),u(()=>o(_,`Updated ${e(h)??""}`)),n(B,f)};v(d,B=>{e(h)&&B(y)})}t(w);var b=s(w,2),D=a(b),ae=a(D),R=a(ae,!0);t(ae),Fe(2),t(D);var se=s(D,2);{var re=B=>{var f=La(),_=s(A(f),2),M=a(_),N=a(M,!0),K=s(N),le=a(K,!0);t(K),t(M),Fe(2),t(_),u(pe=>{o(N,pe),o(le,e(U))},[()=>ge(e(W))]),n(B,f)};v(se,B=>{e(W)!=null&&B(re)})}t(b);var Y=s(b,2);{var ue=B=>{var f=Na(),_=a(f),M=a(_),N=a(M),K=a(N,!0);t(N),Fe(2),t(M);var le=s(M,2),pe=a(le),Ee=a(pe);t(pe),t(le);var je=s(le,2),Ge=a(je),Be=a(Ge,!0);t(Ge),Fe(2),t(je),t(_);var c=s(_,2),k=a(c),Q=s(k,2);let z;var xe=s(a(Q),2),we=a(xe,!0);t(xe),t(Q),t(c);var Re=s(c,2);{var Ce=x=>{var m=Ua(),C=a(m);t(m),u(ee=>o(C,`${ee??""} points to go`),[()=>l.progress.progress.sg_remaining.toFixed(3)]),n(x,m)};v(Re,x=>{l.progress?.progress?.sg_remaining!=null&&l.progress.progress.sg_remaining>0&&x(Ce)})}t(f),u((x,m,C,ee)=>{o(K,x),o(Ee,`${m??""}%`),o(Be,C),Ze(k,`width: ${e(O)??""}%`),z=Ae(Q,1,"progress-marker svelte-t80j9z",null,z,{"at-start":e(O)<3}),Ze(Q,`left: ${e(O)??""}%`),o(we,ee)},[()=>H(l.batch.measured_og),()=>e(O).toFixed(0),()=>H(l.batch.recipe.fg),()=>H(e(E))]),n(B,f)};v(Y,B=>{e(O)!==null&&l.batch.measured_og&&l.batch.recipe?.fg&&B(ue)})}var J=s(Y,2);{var ie=B=>{var f=Ha(),_=a(f),M=a(_),N=a(M,!0);t(M),Fe(2),t(_);var K=s(_,2),le=a(K),pe=a(le,!0);t(le),Fe(2),t(K),t(f),u((Ee,je)=>{o(N,Ee),o(pe,je)},[()=>te(e(r).abv),()=>te(e(r).attenuation)]),n(B,f)};v(J,B=>{e(r)&&B(ie)})}u(B=>o(R,B),[()=>H(e(E))]),n(I,$)},ce=I=>{var $=be(),w=A($);{var d=b=>{var D=Ia(),ae=a(D),R=a(ae),se=a(R,!0);t(R),Fe(2),t(ae);var re=s(ae,2),Y=a(re),ue=a(Y,!0);t(Y),Fe(2),t(re);var J=s(re,2),ie=a(J),B=a(ie,!0);t(ie),Fe(2),t(J);var f=s(J,2),_=a(f),M=a(_,!0);t(_),Fe(2),t(f),t(D),u((N,K,le,pe)=>{o(se,N),o(ue,K),o(B,le),o(M,pe)},[()=>H(l.batch.measured_og),()=>H(l.batch.measured_fg),()=>l.batch.measured_abv!=null?te(l.batch.measured_abv):"--",()=>l.batch.measured_attenuation!=null?te(l.batch.measured_attenuation):"--"]),n(b,D)},y=b=>{var D=Wa();n(b,D)};v(w,b=>{l.batch.measured_og?b(d):b(y,!1)},!0)}n(I,$)};v(X,I=>{e(E)&&e(p)?I(Z):I(ce,!1)})}n(F,V)},$$slots:{default:!0}}),jt()}var Ja=i('<span class="device-last-seen svelte-1kdxwtz"> </span>'),Ka=i('<div class="signal-bar svelte-1kdxwtz"></div>'),Qa=i('<div class="metric-item svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="metric-text svelte-1kdxwtz"> </span></div>'),Xa=i('<div class="metric-item battery svelte-1kdxwtz"><svg class="battery-icon svelte-1kdxwtz" viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="2" y="7" width="18" height="10" rx="2"></rect><rect x="4" y="9" height="6" stroke="none" rx="1"></rect><path d="M20 10v4h2v-4z" stroke="none"></path></svg> <span class="metric-text svelte-1kdxwtz"><!></span></div>'),Za=i('<div class="device-metrics svelte-1kdxwtz"><!> <!></div>'),$a=i('<div class="device-row svelte-1kdxwtz"><div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!></div> <!>',1),es=i('<div class="device-row svelte-1kdxwtz"><div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <span class="device-last-seen svelte-1kdxwtz">No data</span></div>'),ts=i('<div class="device-info svelte-1kdxwtz"><!></div>'),as=i('<button type="button" class="link-btn svelte-1kdxwtz">Link device</button>'),ss=i('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function rs(de,l){yt(l,!0);let E=S(()=>l.liveReading?.device_type==="tilt"),W=S(()=>e(E)&&l.liveReading?.rssi?Da(l.liveReading.rssi):null),L=S(()=>l.liveReading?.last_seen?ta(l.liveReading.last_seen):null),h=S(()=>l.liveReading?.battery_percent!=null||l.liveReading?.battery_voltage!=null),U=S(()=>l.liveReading?.battery_percent),r=S(()=>l.liveReading?.battery_voltage),O=S(()=>e(U)?e(U)>50?"var(--positive)":e(U)>20?"#f59e0b":"var(--negative)":"var(--text-muted)"),p=S(()=>{if(!l.liveReading)return l.batch.device_id||"Unknown";const H=l.liveReading.device_type;return H==="tilt"?`${l.liveReading.color} Tilt`:H==="gravitymon"?`GravityMon (${l.liveReading.id})`:H==="ispindel"?`iSpindel (${l.liveReading.id})`:H==="floaty"?`Floaty (${l.liveReading.id})`:l.liveReading.color||l.liveReading.id});qt(de,{title:"Tracking Device",compact:!0,children:(H,te)=>{var ge=be(),F=A(ge);{var T=X=>{var Z=ts(),ce=a(Z);{var I=w=>{var d=$a(),y=A(d),b=a(y),D=s(a(b));t(b);var ae=s(b,2);{var R=Y=>{var ue=Ja(),J=a(ue,!0);t(ue),u(()=>o(J,e(L))),n(Y,ue)};v(ae,Y=>{e(L)&&Y(R)})}t(y);var se=s(y,2);{var re=Y=>{var ue=Za(),J=a(ue);{var ie=_=>{var M=Qa(),N=a(M);Xt(N,20,()=>Array(4),Zt,(pe,Ee,je)=>{var Ge=Ka();u(()=>Ze(Ge,`height: ${4+je*2}px; background: ${(je<e(W).bars?e(W).color:"var(--bg-hover)")??""}; opacity: ${je<e(W).bars?1:.4};`)),n(pe,Ge)}),t(N);var K=s(N,2),le=a(K);t(K),t(M),u(()=>{Ze(K,`color: ${e(W).color??""}`),o(le,`${l.liveReading.rssi??""}dBm`)}),n(_,M)};v(J,_=>{e(W)&&_(ie)})}var B=s(J,2);{var f=_=>{var M=Xa(),N=a(M),K=s(a(N)),le=s(K);t(N);var pe=s(N,2),Ee=a(pe);{var je=Be=>{var c=It();u(k=>o(c,`${k??""}%`),[()=>e(U).toFixed(0)]),n(Be,c)},Ge=Be=>{var c=be(),k=A(c);{var Q=z=>{var xe=It();u(we=>o(xe,`${we??""}V`),[()=>e(r).toFixed(2)]),n(z,xe)};v(k,z=>{e(r)!=null&&z(Q)},!0)}n(Be,c)};v(Ee,Be=>{e(U)!=null?Be(je):Be(Ge,!1)})}t(pe),t(M),u(()=>{ft(N,"stroke",e(O)),ft(K,"width",(e(U)??50)*.14),ft(K,"fill",e(O)),ft(le,"fill",e(O)),Ze(pe,`color: ${e(O)??""}`)}),n(_,M)};v(B,_=>{e(h)&&_(f)})}t(ue),n(Y,ue)};v(se,Y=>{(e(W)||e(h))&&Y(re)})}u(()=>o(D,` ${e(p)??""}`)),n(w,d)},$=w=>{var d=es(),y=a(d),b=s(a(y));t(y),Fe(2),t(d),u(()=>o(b,` ${l.batch.device_id??""}`)),n(w,d)};v(ce,w=>{l.liveReading?w(I):w($,!1)})}t(Z),n(X,Z)},V=X=>{var Z=ss(),ce=s(a(Z),2);{var I=$=>{var w=as();w.__click=function(...d){l.onEdit?.apply(this,d)},n($,w)};v(ce,$=>{l.onEdit&&$(I)})}t(Z),n(X,Z)};v(F,X=>{l.batch.device_id?X(T):X(V,!1)})}n(H,ge)},$$slots:{default:!0}}),jt()}zt(["click"]);const ls=131.25;var ns=i('<span class="yeast-producer svelte-19u9n31"> </span>'),is=i('<span class="yeast-temp svelte-19u9n31"> </span>'),vs=i('<div class="yeast-row recipe svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Recipe</span> <span class="yeast-value muted svelte-19u9n31"> </span></div>'),os=i('<div class="yeast-row actual svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span> <!> <!></div> <!>',1),ds=i('<div class="yeast-row svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span></div>'),cs=i('<div class="yeast-section svelte-19u9n31"><!></div>'),us=i('<div class="targets-row svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div></div> <!>',1);function _s(de,l){yt(l,!0);function E(L){return L==null?"--":xt(L)}let W=S(()=>l.recipe.abv!=null?l.recipe.abv:l.recipe.og&&l.recipe.fg?(l.recipe.og-l.recipe.fg)*ls:null);qt(de,{title:"Recipe Targets",compact:!0,children:(L,h)=>{var U=us(),r=A(U),O=a(r),p=s(a(O),2),H=a(p,!0);t(p),t(O);var te=s(O,2),ge=s(a(te),2),F=a(ge,!0);t(ge),t(te);var T=s(te,2),V=s(a(T),2),X=a(V,!0);t(V),t(T),t(r);var Z=s(r,2);{var ce=I=>{var $=cs(),w=a($);{var d=b=>{var D=os(),ae=A(D),R=s(a(ae),2),se=a(R,!0);t(R);var re=s(R,2);{var Y=f=>{var _=ns(),M=a(_);t(_),u(()=>o(M,`(${l.yeastStrain.producer??""})`)),n(f,_)};v(re,f=>{l.yeastStrain.producer&&f(Y)})}var ue=s(re,2);{var J=f=>{var _=is(),M=a(_);t(_),u((N,K)=>o(M,`${N??""}-${K??""}¬∞C`),[()=>l.yeastStrain.temp_low.toFixed(0),()=>l.yeastStrain.temp_high.toFixed(0)]),n(f,_)};v(ue,f=>{l.yeastStrain.temp_low&&l.yeastStrain.temp_high&&f(J)})}t(ae);var ie=s(ae,2);{var B=f=>{var _=vs(),M=s(a(_),2),N=a(M,!0);t(M),t(_),u(()=>o(N,l.recipe.yeast_name)),n(f,_)};v(ie,f=>{l.recipe.yeast_name&&f(B)})}u(()=>o(se,l.yeastStrain.name)),n(b,D)},y=b=>{var D=be(),ae=A(D);{var R=se=>{var re=ds(),Y=s(a(re),2),ue=a(Y,!0);t(Y),t(re),u(()=>o(ue,l.recipe.yeast_name)),n(se,re)};v(ae,se=>{l.recipe.yeast_name&&se(R)},!0)}n(b,D)};v(w,b=>{l.yeastStrain?b(d):b(y,!1)})}t($),n(I,$)};v(Z,I=>{(l.yeastStrain||l.recipe.yeast_name)&&I(ce)})}u((I,$,w)=>{o(H,I),o(F,$),o(X,w)},[()=>E(l.recipe.og),()=>E(l.recipe.fg),()=>e(W)!=null?`${e(W).toFixed(1)}%`:"--"]),n(L,U)},$$slots:{default:!0}}),jt()}var gs=i('<p class="notes-content svelte-hkv31i"> </p>');function ps(de,l){qt(de,{title:"Notes",children:(E,W)=>{var L=gs(),h=a(L,!0);t(L),u(()=>o(h,l.notes)),n(E,L)},$$slots:{default:!0}})}var fs=i('<div class="ml-panel loading svelte-1xs394q"><p>Loading predictions...</p></div>'),ms=i('<div class="ml-panel error svelte-1xs394q"><p class="error-text svelte-1xs394q"> </p></div>'),hs=i('<span class="anomaly-reasons svelte-1xs394q"> </span>'),bs=i('<div class="anomaly-banner svelte-1xs394q"><span class="anomaly-icon svelte-1xs394q">‚ö†Ô∏è</span> <div class="anomaly-content svelte-1xs394q"><span class="anomaly-label svelte-1xs394q">Anomaly Detected</span> <!></div></div>'),xs=i('<span class="activity-badge svelte-1xs394q"> </span>'),ys=i('<div class="progress-section svelte-1xs394q"><div class="progress-header svelte-1xs394q"><span class="progress-label svelte-1xs394q">Fermentation Progress</span> <!></div> <div class="fermentation-progress-bar svelte-1xs394q"><div class="fermentation-fill svelte-1xs394q"></div></div> <div class="progress-labels svelte-1xs394q"><span class="og-label svelte-1xs394q"> </span> <span class="progress-percent svelte-1xs394q"> </span> <span class="fg-label svelte-1xs394q"> </span></div></div>'),js=i('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Predicted FG:</span> <span class="value svelte-1xs394q"> </span></div>'),ws=i('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Attenuation:</span> <span class="value attenuation svelte-1xs394q"> </span></div>'),ks=i('<span class="complete-now svelte-1xs394q">Ready now!</span>'),zs=i('<span class="days svelte-1xs394q"> </span>'),qs=i(" <!>",1),Fs=i('<div class="metric completion-metric svelte-1xs394q"><span class="label svelte-1xs394q">Est. Completion:</span> <span class="value svelte-1xs394q"><!></span></div>'),Rs=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),Cs=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Data points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),Ss=i('<div><div class="panel-header svelte-1xs394q"><h3 class="panel-title svelte-1xs394q">Fermentation Intelligence</h3> <button type="button" class="reload-btn svelte-1xs394q" title="Recalculate predictions from database history"> </button></div> <!> <!> <div class="metrics svelte-1xs394q"><!> <!> <!> <div class="model-info svelte-1xs394q"><!> <!></div></div></div>'),Bs=i('<div class="ml-panel disabled svelte-1xs394q"><div class="disabled-header svelte-1xs394q"><p class="unavailable-text svelte-1xs394q">ML predictions unavailable</p> <button type="button" class="reload-btn svelte-1xs394q" title="Reload predictions from database"> </button></div> <p class="unavailable-hint svelte-1xs394q">Predictions require at least 10 readings over 2+ hours</p></div>');function Ms(de,l){yt(l,!0);let E=ut(l,"measuredOg",3,null),W=ut(l,"currentSg",3,null),L=ut(l,"liveReading",3,null),h=qe(Kt({available:!1})),U=qe(!0),r=qe(!1),O=qe(null);async function p(){g(U,!0),g(O,null);try{g(h,await Fa(l.batchId),!0)}catch(d){g(O,d instanceof Error?d.message:"Failed to load predictions",!0),console.error("Failed to load ML predictions:",d)}finally{g(U,!1)}}async function H(){g(r,!0),g(O,null);try{const d=await Ra(l.batchId);console.log("Reloaded predictions:",d.message),await p()}catch(d){g(O,d instanceof Error?d.message:"Failed to reload predictions",!0),console.error("Failed to reload predictions:",d)}finally{g(r,!1)}}Qt(p);function te(d){return d?new Date(d).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}):"N/A"}function ge(d){if(!d)return null;const y=new Date(d),b=new Date,D=y.getTime()-b.getTime();return Math.ceil(D/(1e3*60*60*24))}let F=S(()=>{const d=E()??e(h).predicted_og,y=e(h).predicted_fg,b=W()??L()?.sg;if(!d||!y||!b||d<=y)return null;const D=d-y,R=(d-b)/D*100;return Math.min(100,Math.max(0,R))}),T=S(()=>{const d=E()??e(h).predicted_og,y=W()??L()?.sg;if(!d||!y||d<=1)return null;const b=(d-y)/(d-1)*100;return Math.min(100,Math.max(0,b))}),V=S(()=>{const d=L()?.sg_rate;if(d==null)return null;const y=Math.abs(d);return y>.002?{label:"Very Active",color:"#22c55e",emoji:"üî•"}:y>5e-4?{label:"Active",color:"#84cc16",emoji:"‚ú®"}:y>1e-4?{label:"Slowing",color:"#eab308",emoji:"üê¢"}:{label:"Complete",color:"#6b7280",emoji:"‚úì"}}),X=S(()=>L()?.is_anomaly??!1),Z=S(()=>L()?.anomaly_reasons??[]);var ce=be(),I=A(ce);{var $=d=>{var y=fs();n(d,y)},w=d=>{var y=be(),b=A(y);{var D=R=>{var se=ms(),re=a(se),Y=a(re);t(re),t(se),u(()=>o(Y,`‚ö†Ô∏è ${e(O)??""}`)),n(R,se)},ae=R=>{var se=be(),re=A(se);{var Y=J=>{var ie=Ss();let B;var f=a(ie),_=s(a(f),2);_.__click=H;var M=a(_,!0);t(_),t(f);var N=s(f,2);{var K=x=>{var m=bs(),C=s(a(m),2),ee=s(a(C),2);{var Me=Le=>{var Je=hs(),fe=a(Je,!0);t(Je),u(Te=>o(fe,Te),[()=>e(Z).join(", ")]),n(Le,Je)};v(ee,Le=>{e(Z).length>0&&Le(Me)})}t(C),t(m),n(x,m)};v(N,x=>{e(X)&&x(K)})}var le=s(N,2);{var pe=x=>{var m=ys(),C=a(m),ee=s(a(C),2);{var Me=Ue=>{var tt=xs(),_t=a(tt);t(tt),u(()=>{Ze(tt,`color: ${e(V).color??""}`),o(_t,`${e(V).emoji??""} ${e(V).label??""}`)}),n(Ue,tt)};v(ee,Ue=>{e(V)&&Ue(Me)})}t(C);var Le=s(C,2),Je=a(Le);t(Le);var fe=s(Le,2),Te=a(fe),$e=a(Te);t(Te);var Ke=s(Te,2),it=a(Ke);t(Ke);var Ye=s(Ke,2),et=a(Ye);t(Ye),t(fe),t(m),u((Ue,tt,_t)=>{Ze(Je,`width: ${e(F)??""}%`),o($e,`OG: ${Ue??""}`),o(it,`${tt??""}%`),o(et,`FG: ${_t??""}`)},[()=>xt(E()??e(h).predicted_og??0),()=>e(F).toFixed(0),()=>xt(e(h).predicted_fg??0)]),n(x,m)};v(le,x=>{e(F)!==null&&x(pe)})}var Ee=s(le,2),je=a(Ee);{var Ge=x=>{var m=js(),C=s(a(m),2),ee=a(C,!0);t(C),t(m),u(Me=>o(ee,Me),[()=>xt(e(h).predicted_fg)]),n(x,m)};v(je,x=>{e(h).predicted_fg&&x(Ge)})}var Be=s(je,2);{var c=x=>{var m=ws(),C=s(a(m),2),ee=a(C);t(C),t(m),u(Me=>o(ee,`${Me??""}%`),[()=>e(T).toFixed(1)]),n(x,m)};v(Be,x=>{e(T)!==null&&x(c)})}var k=s(Be,2);{var Q=x=>{const m=S(()=>ge(e(h).estimated_completion));var C=Fs(),ee=s(a(C),2),Me=a(ee);{var Le=fe=>{var Te=ks();n(fe,Te)},Je=fe=>{var Te=qs(),$e=A(Te),Ke=s($e);{var it=Ye=>{var et=zs(),Ue=a(et);t(et),u(()=>o(Ue,`(${e(m)??""} ${e(m)===1?"day":"days"})`)),n(Ye,et)};v(Ke,Ye=>{e(m)!==null&&Ye(it)})}u(Ye=>o($e,`${Ye??""} `),[()=>te(e(h).estimated_completion)]),n(fe,Te)};v(Me,fe=>{e(m)!==null&&e(m)<=0?fe(Le):fe(Je,!1)})}t(ee),t(C),n(x,C)};v(k,x=>{e(h).estimated_completion&&x(Q)})}var z=s(k,2),xe=a(z);{var we=x=>{var m=Rs(),C=s(a(m),2),ee=a(C);t(C),t(m),u(Me=>o(ee,`${Me??""}%`),[()=>(e(h).r_squared*100).toFixed(0)]),n(x,m)};v(xe,x=>{e(h).r_squared!==void 0&&x(we)})}var Re=s(xe,2);{var Ce=x=>{var m=Cs(),C=s(a(m),2),ee=a(C,!0);t(C),t(m),u(()=>o(ee,e(h).num_readings)),n(x,m)};v(Re,x=>{e(h).num_readings&&x(Ce)})}t(z),t(Ee),t(ie),u(()=>{B=Ae(ie,1,"ml-panel svelte-1xs394q",null,B,{"has-anomaly":e(X)}),_.disabled=e(r)||e(U),o(M,e(r)?"Reloading...":"‚Üª Reload")}),n(J,ie)},ue=J=>{var ie=Bs(),B=a(ie),f=s(a(B),2);f.__click=H;var _=a(f,!0);t(f),t(B),Fe(2),t(ie),u(()=>{f.disabled=e(r)||e(U),o(_,e(r)?"Reloading...":"‚Üª Reload")}),n(J,ie)};v(re,J=>{e(h).available?J(Y):J(ue,!1)},!0)}n(R,se)};v(b,R=>{e(O)?R(D):R(ae,!1)},!0)}n(d,y)};v(I,d=>{e(U)?d($):d(w,!1)})}n(de,ce),jt()}zt(["click"]);var Ts=i('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),Ds=i('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),Os=i('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),Ps=i('<span class="recipe-type svelte-g5au2j"> </span>'),As=i('<a class="recipe-link svelte-g5au2j"> <!></a>'),Es=i('<div class="batch-timing svelte-g5au2j"> </div>'),Gs=i('<div class="batch-timing svelte-g5au2j"> </div>'),Ls=i('<option class="svelte-g5au2j"> </option>'),Us=i('<span class="chilling-icon svelte-g5au2j">üç∫</span> <h3 class="chilling-title svelte-g5au2j">Ready to Pitch!</h3>',1),Ns=i('<span class="chilling-icon svelte-g5au2j">‚ùÑÔ∏è</span> <h3 class="chilling-title svelte-g5au2j">Chilling to Pitch Temperature</h3>',1),Hs=i('<div class="progress-section svelte-g5au2j"><div class="progress-bar svelte-g5au2j"><div class="progress-fill svelte-g5au2j"></div></div> <span class="progress-text svelte-g5au2j"> </span></div>'),Vs=i('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è No cooler configured - set a cooler entity to enable automated chilling</span>'),Is=i('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è Temperature control disabled in settings</span>'),Ws=i('<span class="status-ready svelte-g5au2j">Wort has reached pitch temperature - ready to add yeast!</span>'),Ys=i('<span class="status-active svelte-g5au2j">Cooler will run automatically when temp exceeds target + hysteresis</span>'),Js=i('<div><div class="chilling-header svelte-g5au2j"><!></div> <div class="chilling-content svelte-g5au2j"><div class="temp-display svelte-g5au2j"><div class="temp-current svelte-g5au2j"><span class="temp-label svelte-g5au2j">Current</span> <span class="temp-value svelte-g5au2j"> </span></div> <div class="temp-arrow svelte-g5au2j">‚Üí</div> <div class="temp-target svelte-g5au2j"><span class="temp-label svelte-g5au2j">Target</span> <span class="temp-value svelte-g5au2j"> </span></div></div> <!> <div class="chilling-status svelte-g5au2j"><!></div></div></div>'),Ks=i('<span class="status-badge heater svelte-g5au2j">üî• Heating</span>'),Qs=i('<span class="status-badge cooler svelte-g5au2j">‚ùÑÔ∏è Cooling</span>'),Xs=i('<span class="status-badge idle svelte-g5au2j"> </span>'),Zs=i('<div class="device-status heater svelte-g5au2j"><div>üî•</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Heater</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),$s=i('<div class="device-status cooler svelte-g5au2j"><div>‚ùÑÔ∏è</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Cooler</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),er=i('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">‚ö°</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),tr=i('<button type="button" class="override-btn heat-on svelte-g5au2j">Force Heat ON</button> <button type="button" class="override-btn heat-off svelte-g5au2j">Force Heat OFF</button>',1),ar=i('<button type="button" class="override-btn cool-on svelte-g5au2j">Force Cool ON</button> <button type="button" class="override-btn cool-off svelte-g5au2j">Force Cool OFF</button>',1),sr=i('<div class="control-details svelte-g5au2j"><div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns-grid svelte-g5au2j"><!> <!> <button type="button" class="override-btn auto-mode svelte-g5au2j">Auto Mode</button></div></div>',1),rr=i('<div class="device-status-grid svelte-g5au2j"><!> <!></div> <!>',1),lr=i('<div><button type="button" class="collapsible-header svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="collapse-indicator svelte-g5au2j"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" class="svelte-g5au2j"></path></svg></div></button> <!></div>'),nr=i('<span class="svelte-g5au2j"> </span>'),ir=i('<span class="svelte-g5au2j"> </span>'),vr=i('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><!> <!> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),or=i('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j" aria-label="Delete batch"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <!> <div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!></div></div>',1),dr=i('<div class="modal-overlay svelte-g5au2j"><div class="modal svelte-g5au2j"><h2 class="modal-title svelte-g5au2j">Delete Batch?</h2> <p class="modal-text svelte-g5au2j"> </p> <div class="modal-actions svelte-g5au2j"><button type="button" class="modal-btn cancel svelte-g5au2j">Cancel</button> <button type="button" class="modal-btn delete svelte-g5au2j"> </button></div></div></div>'),cr=i('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div> <!>',1);function Br(de,l){yt(l,!0);const E=()=>ka(za,"$page",W),[W,L]=wa();let h=null,U=null,r=qe(null),O=qe(null),p=qe(null);Kt([]);let H=qe(!0),te=qe(null),ge=qe(!1),F=qe(!1),T=qe(!1),V=qe(!1),X=qe(!1),Z=qe(!1),ce=S(()=>parseInt(E().params.id??"0"));const I={planning:{label:"Planning",color:"var(--text-secondary)",bg:"var(--bg-elevated)"},fermenting:{label:"Fermenting",color:"#f59e0b",bg:"rgba(245, 158, 11, 0.12)"},conditioning:{label:"Conditioning",color:"#8b5cf6",bg:"rgba(139, 92, 246, 0.12)"},completed:{label:"Completed",color:"var(--positive)",bg:"rgba(34, 197, 94, 0.12)"},archived:{label:"Archived",color:"var(--text-muted)",bg:"var(--bg-elevated)"}},$=["planning","fermenting","conditioning","completed","archived"];let w=S(()=>e(r)?I[e(r).status]:I.planning),d=S(ea),y=S(()=>kt.config.ha_enabled&&kt.config.temp_control_enabled&&(e(r)?.heater_entity_id||e(r)?.cooler_entity_id)),b=S(()=>e(r)?.status==="planning"&&e(r)?.temp_target!=null),D=S(()=>!e(b)||!e(R)?.temp||!e(r)?.temp_target?!1:e(R).temp<=e(r).temp_target),ae=S(()=>{if(!e(b)||!e(R)?.temp||!e(r)?.temp_target)return null;const c=e(r).temp_target+30,k=e(R).temp,Q=e(r).temp_target;if(k<=Q)return 100;if(k>=c)return 0;const z=(c-k)/(c-Q)*100;return Math.min(100,Math.max(0,z))}),R=S(()=>{if(!e(r)?.device_id)return null;const c=Jt.tilts.get(e(r).device_id);if(c)return c;const k=e(r).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!k?.[1])return null;const Q=k[1].toUpperCase();for(const z of Jt.tilts.values())if(z.color&&z.color.toUpperCase()===Q)return z;return null});async function se(){g(H,!0),g(te,null);try{if(g(r,await Ca(e(ce)),!0),e(r).status==="fermenting"||e(r).status==="conditioning")try{g(O,await Wt(e(ce)),!0)}catch{}if(e(r).heater_entity_id||e(r).cooler_entity_id)try{g(p,await wt(e(ce)),!0)}catch{}}catch(c){g(te,c instanceof Error?c.message:"Failed to load batch",!0)}finally{g(H,!1)}}async function re(c){if(!(!e(r)||e(F))&&!(c==="conditioning"&&e(r).status==="fermenting"&&!confirm(`üí° Entering Conditioning Phase

Reminder: Adjust target temperature if cold crashing.
Temperature control will continue during conditioning.

Continue?`))){g(F,!0);try{g(r,await Yt(e(r).id,{status:c}),!0),(c==="fermenting"||c==="conditioning")&&g(O,await Wt(e(r).id),!0)}catch(k){console.error("Failed to update status:",k)}finally{g(F,!1)}}}async function Y(c){if(e(r)&&(g(r,await Yt(e(r).id,c),!0),g(ge,!1),e(r).heater_entity_id||e(r).cooler_entity_id))try{g(p,await wt(e(r).id),!0)}catch{}}async function ue(){if(e(r)){g(X,!0);try{await Sa(e(r).id),qa("/batches")}catch(c){g(te,c instanceof Error?c.message:"Failed to delete batch",!0),g(X,!1),g(V,!1)}}}async function J(c,k){if(!(!e(r)||e(T))){g(T,!0);try{await Ct(e(r).id,k,60,c),g(p,await wt(e(r).id),!0)}catch(Q){console.error("Failed to set override:",Q)}finally{g(T,!1)}}}async function ie(){if(!(!e(r)||e(T))){g(T,!0);try{e(r).heater_entity_id&&await Ct(e(r).id,null,60,"heater"),e(r).cooler_entity_id&&await Ct(e(r).id,null,60,"cooler"),g(p,await wt(e(r).id),!0)}catch(c){console.error("Failed to clear overrides:",c)}finally{g(T,!1)}}}function B(){if(h?.readyState===WebSocket.OPEN)return;const k=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;h=new WebSocket(k),h.onmessage=async Q=>{try{const z=JSON.parse(Q.data);z.type==="control_event"&&z.batch_id===e(ce)&&e(p)&&(z.action==="heat_on"?g(p,{...e(p),heater_state:"on"},!0):z.action==="heat_off"?g(p,{...e(p),heater_state:"off"},!0):z.action==="cool_on"?g(p,{...e(p),cooler_state:"on"},!0):z.action==="cool_off"&&g(p,{...e(p),cooler_state:"off"},!0))}catch{}},h.onclose=()=>{h=null,U=setTimeout(B,3e3)},h.onerror=()=>{h?.close()}}function f(){U&&(clearTimeout(U),U=null),h?.close(),h=null}function _(c){return c==null?"--":$t(c)}function M(c){return c?new Date(c).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"--"}function N(c){if(!c)return"--";const k=new Date(c),z=(new Date().getTime()-k.getTime())/(1e3*60*60);if(z<1)return`${Math.round(z*60)}m`;if(z<24)return`${z.toFixed(1)}h`;const xe=z/24;return xe<7?`${xe.toFixed(1)}d`:`${Math.round(xe)}d`}Qt(()=>{se(),B()}),ma(()=>{f()});var K=cr();xa("g5au2j",c=>{ha(()=>{ba.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var le=A(K),pe=s(a(le),2);{var Ee=c=>{var k=Ts();n(c,k)},je=c=>{var k=be(),Q=A(k);{var z=we=>{var Re=Ds(),Ce=s(a(Re),2),x=a(Ce,!0);t(Ce);var m=s(Ce,2);m.__click=se,t(Re),u(()=>o(x,e(te))),n(we,Re)},xe=we=>{var Re=be(),Ce=A(Re);{var x=C=>{var ee=Os();n(C,ee)},m=C=>{var ee=be(),Me=A(ee);{var Le=fe=>{Ba(fe,{get batch(){return e(r)},onSubmit:Y,onCancel:()=>g(ge,!1)})},Je=fe=>{var Te=or(),$e=A(Te),Ke=a($e),it=a(Ke),Ye=a(it);t(it);var et=s(it,2),Ue=a(et),tt=a(Ue,!0);t(Ue);var _t=s(Ue,2);{var aa=j=>{var G=As(),ve=a(G),me=s(ve);{var _e=ye=>{var Pe=Ps(),Ne=a(Pe);t(Pe),u(()=>o(Ne,`(${e(r).recipe.type??""})`)),n(ye,Pe)};v(me,ye=>{e(r).recipe.type&&ye(_e)})}t(G),u(()=>{ft(G,"href",`/recipes/${e(r).recipe.id??""}`),o(ve,`${e(r).recipe.name??""} `)}),n(j,G)};v(_t,j=>{e(r).recipe&&j(aa)})}var sa=s(_t,2);{var ra=j=>{var G=Es(),ve=a(G);t(G),u((me,_e)=>o(ve,`Started ${me??""} ¬∑ ${_e??""} ago`),[()=>M(e(r).start_time),()=>N(e(r).start_time)]),n(j,G)},la=j=>{var G=be(),ve=A(G);{var me=_e=>{var ye=Gs(),Pe=a(ye);t(ye),u(Ne=>o(Pe,`Brewed ${Ne??""}`),[()=>M(e(r).brew_date)]),n(_e,ye)};v(ve,_e=>{e(r).brew_date&&_e(me)},!0)}n(j,G)};v(sa,j=>{e(r).start_time?j(ra):j(la,!1)})}t(et),t(Ke);var St=s(Ke,2),Ft=a(St),Qe=a(Ft);Qe.__change=j=>re(j.currentTarget.value),Xt(Qe,21,()=>$,Zt,(j,G)=>{var ve=Ls(),me=a(ve,!0);t(ve);var _e={};u(()=>{o(me,I[e(G)].label),_e!==(_e=e(G))&&(ve.value=(ve.__value=e(G))??"")}),n(j,ve)}),t(Qe);var Bt;ya(Qe),t(Ft);var Mt=s(Ft,2);Mt.__click=()=>g(ge,!0);var na=s(Mt,2);na.__click=()=>g(V,!0),t(St),t($e);var Tt=s($e,2);{var ia=j=>{var G=Js();let ve;var me=a(G),_e=a(me);{var ye=q=>{var P=Us();Fe(2),n(q,P)},Pe=q=>{var P=Ns();Fe(2),n(q,P)};v(_e,q=>{e(D)?q(ye):q(Pe,!1)})}t(me);var Ne=s(me,2),vt=a(Ne),at=a(vt),gt=s(a(at),2),He=a(gt,!0);t(gt),t(at);var ne=s(at,4),Se=s(a(ne),2),ot=a(Se,!0);t(Se),t(ne),t(vt);var dt=s(vt,2);{var mt=q=>{var P=Hs(),he=a(P),ke=a(he);t(he);var De=s(he,2),oe=a(De);t(De),t(P),u(ze=>{Ze(ke,`width: ${e(ae)??""}%`),o(oe,`${ze??""}% to target`)},[()=>Math.round(e(ae))]),n(q,P)};v(dt,q=>{e(ae)!=null&&!e(D)&&q(mt)})}var Ve=s(dt,2),st=a(Ve);{var ht=q=>{var P=Vs();n(q,P)},bt=q=>{var P=be(),he=A(P);{var ke=oe=>{var ze=Is();n(oe,ze)},De=oe=>{var ze=be(),rt=A(ze);{var Xe=nt=>{var pt=Ws();n(nt,pt)},lt=nt=>{var pt=Ys();n(nt,pt)};v(rt,nt=>{e(D)?nt(Xe):nt(lt,!1)},!0)}n(oe,ze)};v(he,oe=>{!kt.config.ha_enabled||!kt.config.temp_control_enabled?oe(ke):oe(De,!1)},!0)}n(q,P)};v(st,q=>{e(r).cooler_entity_id?q(bt,!1):q(ht)})}t(Ve),t(Ne),t(G),u((q,P)=>{ve=Ae(G,1,"chilling-banner svelte-g5au2j",null,ve,{ready:e(D)}),o(He,q),o(ot,P)},[()=>e(R)?.temp!=null?_(e(R).temp):"--",()=>e(r).temp_target!=null?_(e(r).temp_target):"--"]),n(j,G)};v(Tt,j=>{e(b)&&j(ia)})}var Dt=s(Tt,2),Rt=a(Dt),Ot=a(Rt);{let j=S(()=>e(R)?.sg??e(O)?.measured?.current_sg);Ya(Ot,{get batch(){return e(r)},get currentSg(){return e(j)},get progress(){return e(O)},get liveReading(){return e(R)}})}var va=s(Ot,2);{var oa=j=>{_s(j,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(va,j=>{e(r).recipe&&j(oa)})}t(Rt);var Pt=s(Rt,2),At=a(Pt);rs(At,{get batch(){return e(r)},get liveReading(){return e(R)},onEdit:()=>g(ge,!0)});var Et=s(At,2);{let j=S(()=>e(R)?.sg);Ms(Et,{get batchId(){return e(r).id},get measuredOg(){return e(r).measured_og},get currentSg(){return e(j)},get liveReading(){return e(R)}})}var Gt=s(Et,2);{var da=j=>{var G=lr();let ve;var me=a(G);me.__click=()=>g(Z,!e(Z));var _e=s(a(me),2),ye=a(_e);{var Pe=ne=>{var Se=Ks();n(ne,Se)},Ne=ne=>{var Se=be(),ot=A(Se);{var dt=Ve=>{var st=Qs();n(Ve,st)},mt=Ve=>{var st=be(),ht=A(st);{var bt=q=>{var P=Xs(),he=a(P);t(P),u(ke=>o(he,`üéØ ${ke??""}${e(d)??""}`),[()=>_(e(p).target_temp)]),n(q,P)};v(ht,q=>{e(Z)&&e(p)&&q(bt)},!0)}n(Ve,st)};v(ot,Ve=>{e(p)?.cooler_state==="on"?Ve(dt):Ve(mt,!1)},!0)}n(ne,Se)};v(ye,ne=>{e(p)?.heater_state==="on"?ne(Pe):ne(Ne,!1)})}var vt=s(ye,2);let at;t(_e),t(me);var gt=s(me,2);{var He=ne=>{var Se=rr(),ot=A(Se),dt=a(ot);{var mt=q=>{var P=Zs(),he=a(P);let ke;var De=s(he,2),oe=s(a(De),2);let ze;var rt=a(oe,!0);t(oe);var Xe=s(oe,2),lt=a(Xe,!0);t(Xe),t(De),t(P),u(()=>{ke=Ae(he,1,"device-icon-wrap svelte-g5au2j",null,ke,{active:e(p)?.heater_state==="on"}),ze=Ae(oe,1,"device-state svelte-g5au2j",null,ze,{on:e(p)?.heater_state==="on"}),o(rt,e(p)?.heater_state==="on"?"ON":"OFF"),o(lt,e(r).heater_entity_id)}),n(q,P)};v(dt,q=>{e(r).heater_entity_id&&q(mt)})}var Ve=s(dt,2);{var st=q=>{var P=$s(),he=a(P);let ke;var De=s(he,2),oe=s(a(De),2);let ze;var rt=a(oe,!0);t(oe);var Xe=s(oe,2),lt=a(Xe,!0);t(Xe),t(De),t(P),u(()=>{ke=Ae(he,1,"device-icon-wrap svelte-g5au2j",null,ke,{active:e(p)?.cooler_state==="on"}),ze=Ae(oe,1,"device-state svelte-g5au2j",null,ze,{on:e(p)?.cooler_state==="on"}),o(rt,e(p)?.cooler_state==="on"?"ON":"OFF"),o(lt,e(r).cooler_entity_id)}),n(q,P)};v(Ve,q=>{e(r).cooler_entity_id&&q(st)})}t(ot);var ht=s(ot,2);{var bt=q=>{var P=sr(),he=A(P),ke=a(he),De=s(a(ke),2),oe=a(De);t(De),t(ke);var ze=s(ke,2),rt=s(a(ze),2),Xe=a(rt);t(rt),t(ze),t(he);var lt=s(he,2);{var nt=Oe=>{var Ie=er(),We=s(a(Ie),2),ct=a(We);t(We);var Vt=s(We,2);Vt.__click=()=>ie(),t(Ie),u(fa=>{o(ct,`Override active: ${fa??""}`),Vt.disabled=e(T)},[()=>e(p).override_state?.toUpperCase()]),n(Oe,Ie)};v(lt,Oe=>{e(p).override_active&&Oe(nt)})}var pt=s(lt,2),Lt=s(a(pt),2),Ut=a(Lt);{var ga=Oe=>{var Ie=tr(),We=A(Ie);We.__click=()=>J("heater","on");var ct=s(We,2);ct.__click=()=>J("heater","off"),u(()=>{We.disabled=e(T),ct.disabled=e(T)}),n(Oe,Ie)};v(Ut,Oe=>{e(r).heater_entity_id&&Oe(ga)})}var Nt=s(Ut,2);{var pa=Oe=>{var Ie=ar(),We=A(Ie);We.__click=()=>J("cooler","on");var ct=s(We,2);ct.__click=()=>J("cooler","off"),u(()=>{We.disabled=e(T),ct.disabled=e(T)}),n(Oe,Ie)};v(Nt,Oe=>{e(r).cooler_entity_id&&Oe(pa)})}var Ht=s(Nt,2);Ht.__click=()=>ie(),t(Lt),t(pt),u((Oe,Ie)=>{o(oe,`${Oe??""}${e(d)??""}`),o(Xe,`¬±${Ie??""}${e(d)??""}`),Ht.disabled=e(T)},[()=>_(e(p).target_temp),()=>e(p).hysteresis?.toFixed(1)||"--"]),n(q,P)};v(ht,q=>{e(p)&&q(bt)})}n(ne,Se)};v(gt,ne=>{e(Z)||ne(He)})}t(G),u(()=>{ve=Ae(G,1,"info-card temp-control-card svelte-g5au2j",null,ve,{"heater-on":e(p)?.heater_state==="on","cooler-on":e(p)?.cooler_state==="on",collapsed:e(Z)}),at=Ae(vt,0,"chevron svelte-g5au2j",null,at,{rotated:!e(Z)})}),n(j,G)},ca=j=>{var G=be(),ve=A(G);{var me=_e=>{var ye=vr(),Pe=s(a(ye),2),Ne=a(Pe);{var vt=He=>{var ne=nr(),Se=a(ne);t(ne),u(()=>o(Se,`Heater: ${e(r).heater_entity_id??""}`)),n(He,ne)};v(Ne,He=>{e(r).heater_entity_id&&He(vt)})}var at=s(Ne,2);{var gt=He=>{var ne=ir(),Se=a(ne);t(ne),u(()=>o(Se,`Cooler: ${e(r).cooler_entity_id??""}`)),n(He,ne)};v(at,He=>{e(r).cooler_entity_id&&He(gt)})}Fe(2),t(Pe),t(ye),n(_e,ye)};v(ve,_e=>{(e(r).heater_entity_id||e(r).cooler_entity_id)&&e(r).status!=="fermenting"&&_e(me)},!0)}n(j,G)};v(Gt,j=>{e(y)&&(e(r).status==="fermenting"||e(r).status==="conditioning")?j(da):j(ca,!1)})}var ua=s(Gt,2);{var _a=j=>{ps(j,{get notes(){return e(r).notes}})};v(ua,j=>{e(r).notes&&j(_a)})}t(Pt),t(Dt),u(()=>{o(Ye,`#${(e(r).batch_number||"?")??""}`),o(tt,e(r).name||e(r).recipe?.name||"Unnamed Batch"),Qe.disabled=e(F),Ze(Qe,`color: ${e(w).color??""}; background: ${e(w).bg??""};`),Bt!==(Bt=e(r).status)&&(Qe.value=(Qe.__value=e(r).status)??"",ja(Qe,e(r).status))}),n(fe,Te)};v(Me,fe=>{e(ge)?fe(Le):fe(Je,!1)},!0)}n(C,ee)};v(Ce,C=>{e(r)?C(m,!1):C(x)},!0)}n(we,Re)};v(Q,we=>{e(te)?we(z):we(xe,!1)},!0)}n(c,k)};v(pe,c=>{e(H)?c(Ee):c(je,!1)})}t(le);var Ge=s(le,2);{var Be=c=>{var k=dr();k.__click=()=>g(V,!1);var Q=a(k);Q.__click=m=>m.stopPropagation();var z=s(a(Q),2),xe=a(z);t(z);var we=s(z,2),Re=a(we);Re.__click=()=>g(V,!1);var Ce=s(Re,2);Ce.__click=ue;var x=a(Ce,!0);t(Ce),t(we),t(Q),t(k),u(()=>{o(xe,`Are you sure you want to delete "${(e(r)?.name||"this batch")??""}"? This cannot be undone.`),Re.disabled=e(X),Ce.disabled=e(X),o(x,e(X)?"Deleting...":"Delete Batch")}),n(c,k)};v(Ge,c=>{e(V)&&c(Be)})}n(de,K),jt(),L()}zt(["click","change"]);export{Br as component,Sr as universal};
