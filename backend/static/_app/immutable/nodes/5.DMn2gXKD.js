import{d as Yt,f as n,s as u,a as l,c as He,t as na,h as ga,e as xt}from"../chunks/orbuQWWI.js";import{d as a,e as s,r as t,t as p,a as Ut,f as ce,h as e,u as H,n as be,g as Vt,s as U,p as Ze,o as Wa,c,az as Sa,b9 as ss,ay as rs,i as Aa,aJ as ls,aC as is,ax as ns}from"../chunks/pAodAtlG.js";import{e as Bt,i as Ht}from"../chunks/0whDC7Rl.js";import{i as o}from"../chunks/ucc1DXe2.js";import{h as vs}from"../chunks/DJBMpqSf.js";import{s as Kt,r as kt,a as os}from"../chunks/CYuZshLQ.js";import{s as Ee}from"../chunks/Cpbxxhlc.js";import{s as Ft}from"../chunks/C-5oeV0L.js";import{b as Ta,i as ds,s as cs}from"../chunks/RboyDiSx.js";import{s as us,a as _s}from"../chunks/BkeTWnxc.js";import{p as ps}from"../chunks/CytSTFOc.js";import{g as fs}from"../chunks/tN1UbnY3.js";import{a8 as gs,a9 as hs,aa as ms,ab as bs,ac as ys,Q as fa,ad as xs,ae as ks,af as ws,X as js,S as Ca,ag as ja,a3 as qs,ah as Ba}from"../chunks/DsM_eXzM.js";import{b as wt,d as Ma,g as Da,c as qa}from"../chunks/C54DtTUy.js";import{t as Ha}from"../chunks/DWpXqN03.js";import{B as Ms}from"../chunks/Dzjp8j6H.js";import{s as Ss}from"../chunks/GbV1md6Y.js";import{p as aa}from"../chunks/C44MPb_E.js";import{F as Cs}from"../chunks/CfPvXJRK.js";import{b as ft}from"../chunks/Dh5hCwq1.js";import{s as Fa}from"../chunks/BkabqQ1A.js";const Bs=!1,yn=Object.freeze(Object.defineProperty({__proto__:null,prerender:Bs},Symbol.toStringTag,{value:"Module"}));function Fs(De){return De>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:De>=-60?{bars:3,color:"var(--positive)",label:"Good"}:De>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function Xa(De){const i=Math.floor((Date.now()-new Date(De).getTime())/1e3);if(i<10)return"just now";if(i<60)return`${i}s ago`;const g=Math.floor(i/60);if(g<60)return`${g}m ago`;const j=Math.floor(g/60);return j<24?`${j}h ago`:`${Math.floor(j/24)}d ago`}var zs=n('<div class="accent-bar svelte-1oyrwd9"></div>'),Ts=n('<span class="card-icon svelte-1oyrwd9"> </span>'),As=n('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),Ds=n('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function xa(De,i){let g=aa(i,"highlight",3,!1),j=aa(i,"compact",3,!1),N=aa(i,"collapsible",3,!1),A=aa(i,"expanded",3,!1);var E=Ds();let r;var I=a(E);{var k=D=>{var L=zs();l(D,L)};o(I,D=>{g()&&D(k)})}var Z=s(I,2),ge=a(Z),Se=a(ge);{var w=D=>{var L=Ts(),te=a(L,!0);t(L),p(()=>u(te,i.icon)),l(D,L)};o(Se,D=>{i.icon&&D(w)})}var X=s(Se,2),$=a(X,!0);t(X),t(ge);var ue=s(ge,2);{var z=D=>{var L=As();L.__click=function(...ye){i.onToggle?.apply(this,ye)};var te=a(L);let ae;t(L),p(()=>{Kt(L,"aria-label",A()?"Collapse":"Expand"),ae=Ee(te,0,"expand-icon svelte-1oyrwd9",null,ae,{"rotate-180":A()})}),l(D,L)};o(ue,D=>{N()&&i.onToggle&&D(z)})}t(Z);var J=s(Z,2);let Y;var ie=a(J);Ss(ie,()=>i.children),t(J),t(E),p(()=>{r=Ee(E,1,"batch-card svelte-1oyrwd9",null,r,{highlight:g(),compact:j()}),u($,i.title),Y=Ee(J,1,"card-content svelte-1oyrwd9",null,Y,{collapsed:N()&&!A()})}),l(De,E)}Yt(["click"]);var Rs=n('<span class="updated-text svelte-t80j9z"> </span>'),Ps=n('<div class="hero-divider svelte-t80j9z"></div> <div class="hero-metric temperature svelte-t80j9z"><span class="hero-value svelte-t80j9z"> <span class="hero-unit svelte-t80j9z"> </span></span> <span class="hero-label svelte-t80j9z">Temperature</span></div>',1),Ns=n('<div class="remaining-text svelte-t80j9z"> </div>'),Os=n('<div class="progress-section svelte-t80j9z"><div class="progress-labels svelte-t80j9z"><div class="progress-endpoint start svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">OG</span></div> <div class="progress-current svelte-t80j9z"><span class="current-percent svelte-t80j9z"> </span></div> <div class="progress-endpoint end svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">Target FG</span></div></div> <div class="progress-track svelte-t80j9z"><div class="progress-fill svelte-t80j9z"></div> <div><div class="marker-dot svelte-t80j9z"></div> <div class="marker-value svelte-t80j9z"> </div></div></div> <!></div>'),Ls=n('<div class="metrics-row svelte-t80j9z"><div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">ABV</span></div> <div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">Attenuation</span></div></div>'),Es=n('<div class="status-row svelte-t80j9z"><div class="live-indicator svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> <span class="status-text svelte-t80j9z">LIVE</span></div> <!></div> <div class="hero-section svelte-t80j9z"><div class="hero-metric gravity svelte-t80j9z"><span class="hero-value svelte-t80j9z"> </span> <span class="hero-label svelte-t80j9z">Gravity</span></div> <!></div> <!> <!>',1),Is=n('<div class="completed-grid svelte-t80j9z"><div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Original Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Final Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">ABV</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Attenuation</span></div></div>'),Gs=n('<div class="empty-state svelte-t80j9z"><div class="empty-icon svelte-t80j9z">‚óé</div> <p class="empty-text svelte-t80j9z">Set Original Gravity to track fermentation</p></div>');function Hs(De,i){Ut(i,!0);let g=H(()=>i.currentSg??i.progress?.measured?.current_sg),j=H(()=>i.liveReading?.temp??i.progress?.temperature?.current),N=H(()=>i.liveReading?.last_seen),A=H(()=>e(N)?Xa(e(N)):null),E=H(Da),r=H(()=>{if(!i.batch.measured_og||!e(g))return null;const w=Math.max(0,(i.batch.measured_og-e(g))*131.25),X=i.batch.measured_og-1,$=X!==0?Math.max(0,Math.min(100,(i.batch.measured_og-e(g))/X*100)):0;return{abv:w,attenuation:$}}),I=H(()=>{const w=i.batch.measured_og,X=i.batch.recipe?.fg;if(!w||!X||!e(g))return null;const $=w-X,ue=w-e(g);return $<=0?null:Math.max(0,Math.min(100,ue/$*100))}),k=H(()=>i.batch.status==="fermenting"||i.batch.status==="conditioning");function Z(w){return w==null?"--":wt(w)}function ge(w){return w==null?"--":`${w.toFixed(1)}%`}function Se(w){return w==null?"--":Ma(w)}xa(De,{title:"Fermentation",children:(w,X)=>{var $=He(),ue=ce($);{var z=Y=>{var ie=Es(),D=ce(ie),L=s(a(D),2);{var te=m=>{var h=Rs(),b=a(h);t(h),p(()=>u(b,`Updated ${e(A)??""}`)),l(m,h)};o(L,m=>{e(A)&&m(te)})}t(D);var ae=s(D,2),ye=a(ae),Me=a(ye),Ce=a(Me,!0);t(Me),be(2),t(ye);var ne=s(ye,2);{var v=m=>{var h=Ps(),b=s(ce(h),2),R=a(b),B=a(R,!0),G=s(B),Q=a(G,!0);t(G),t(R),be(2),t(b),p(O=>{u(B,O),u(Q,e(E))},[()=>Se(e(j))]),l(m,h)};o(ne,m=>{e(j)!=null&&m(v)})}t(ae);var d=s(ae,2);{var _=m=>{var h=Os(),b=a(h),R=a(b),B=a(R),G=a(B,!0);t(B),be(2),t(R);var Q=s(R,2),O=a(Q),ee=a(O);t(O),t(Q);var K=s(Q,2),se=a(K),oe=a(se,!0);t(se),be(2),t(K),t(b);var xe=s(b,2),ke=a(xe),ze=s(ke,2);let Oe;var we=s(a(ze),2),le=a(we,!0);t(we),t(ze),t(xe);var f=s(xe,2);{var y=F=>{var S=Ns(),q=a(S);t(S),p(P=>u(q,`${P??""} points to go`),[()=>i.progress.progress.sg_remaining.toFixed(3)]),l(F,S)};o(f,F=>{i.progress?.progress?.sg_remaining!=null&&i.progress.progress.sg_remaining>0&&F(y)})}t(h),p((F,S,q,P)=>{u(G,F),u(ee,`${S??""}%`),u(oe,q),Ft(ke,`width: ${e(I)??""}%`),Oe=Ee(ze,1,"progress-marker svelte-t80j9z",null,Oe,{"at-start":e(I)<3}),Ft(ze,`left: ${e(I)??""}%`),u(le,P)},[()=>Z(i.batch.measured_og),()=>e(I).toFixed(0),()=>Z(i.batch.recipe.fg),()=>Z(e(g))]),l(m,h)};o(d,m=>{e(I)!==null&&i.batch.measured_og&&i.batch.recipe?.fg&&m(_)})}var M=s(d,2);{var re=m=>{var h=Ls(),b=a(h),R=a(b),B=a(R,!0);t(R),be(2),t(b);var G=s(b,2),Q=a(G),O=a(Q,!0);t(Q),be(2),t(G),t(h),p((ee,K)=>{u(B,ee),u(O,K)},[()=>ge(e(r).abv),()=>ge(e(r).attenuation)]),l(m,h)};o(M,m=>{e(r)&&m(re)})}p(m=>u(Ce,m),[()=>Z(e(g))]),l(Y,ie)},J=Y=>{var ie=He(),D=ce(ie);{var L=ae=>{const ye=H(()=>i.batch.measured_fg??i.progress?.measured?.fg??i.progress?.measured?.current_sg),Me=H(()=>i.batch.measured_abv??i.progress?.measured?.abv),Ce=H(()=>i.batch.measured_attenuation??i.progress?.measured?.attenuation);var ne=Is(),v=a(ne),d=a(v),_=a(d,!0);t(d),be(2),t(v);var M=s(v,2),re=a(M),m=a(re,!0);t(re),be(2),t(M);var h=s(M,2),b=a(h),R=a(b,!0);t(b),be(2),t(h);var B=s(h,2),G=a(B),Q=a(G,!0);t(G),be(2),t(B),t(ne),p((O,ee,K,se)=>{u(_,O),u(m,ee),u(R,K),u(Q,se)},[()=>Z(i.batch.measured_og),()=>Z(e(ye)),()=>e(Me)!=null?ge(e(Me)):"--",()=>e(Ce)!=null?ge(e(Ce)):"--"]),l(ae,ne)},te=ae=>{var ye=Gs();l(ae,ye)};o(D,ae=>{i.batch.measured_og?ae(L):ae(te,!1)},!0)}l(Y,ie)};o(ue,Y=>{e(g)&&e(k)?Y(z):Y(J,!1)})}l(w,$)},$$slots:{default:!0}}),Vt()}var Us=n('<span class="device-last-seen svelte-1kdxwtz"> </span>'),Vs=n('<div class="signal-bar svelte-1kdxwtz"></div>'),Ws=n('<div class="metric-item svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="metric-text svelte-1kdxwtz"> </span></div>'),Xs=n('<div class="metric-item battery svelte-1kdxwtz"><svg class="battery-icon svelte-1kdxwtz" viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="2" y="7" width="18" height="10" rx="2"></rect><rect x="4" y="9" height="6" stroke="none" rx="1"></rect><path d="M20 10v4h2v-4z" stroke="none"></path></svg> <span class="metric-text svelte-1kdxwtz"><!></span></div>'),Js=n('<div class="device-metrics svelte-1kdxwtz"><!> <!></div>'),Ks=n('<div class="device-row svelte-1kdxwtz"><div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!></div> <!>',1),Ys=n('<div class="device-row svelte-1kdxwtz"><div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <span class="device-last-seen svelte-1kdxwtz">No data</span></div>'),Qs=n('<div class="device-info svelte-1kdxwtz"><!></div>'),Zs=n('<button type="button" class="link-btn svelte-1kdxwtz">Link device</button>'),$s=n('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function Ua(De,i){Ut(i,!0);let g=H(()=>i.liveReading?.device_type==="tilt"),j=H(()=>e(g)&&i.liveReading?.rssi?Fs(i.liveReading.rssi):null),N=H(()=>i.liveReading?.last_seen?Xa(i.liveReading.last_seen):null),A=H(()=>i.liveReading?.battery_percent!=null||i.liveReading?.battery_voltage!=null),E=H(()=>i.liveReading?.battery_percent),r=H(()=>i.liveReading?.battery_voltage),I=H(()=>e(E)?e(E)>50?"var(--positive)":e(E)>20?"var(--warning)":"var(--negative)":"var(--text-muted)"),k=H(()=>{if(!i.liveReading)return i.batch.device_id||"Unknown";const Z=i.liveReading.device_type;return Z==="tilt"?`${i.liveReading.color} Tilt`:Z==="gravitymon"?`GravityMon (${i.liveReading.id})`:Z==="ispindel"?`iSpindel (${i.liveReading.id})`:Z==="floaty"?`Floaty (${i.liveReading.id})`:i.liveReading.color||i.liveReading.id});xa(De,{title:"Tracking Device",compact:!0,children:(Z,ge)=>{var Se=He(),w=ce(Se);{var X=ue=>{var z=Qs(),J=a(z);{var Y=D=>{var L=Ks(),te=ce(L),ae=a(te),ye=s(a(ae));t(ae);var Me=s(ae,2);{var Ce=d=>{var _=Us(),M=a(_,!0);t(_),p(()=>u(M,e(N))),l(d,_)};o(Me,d=>{e(N)&&d(Ce)})}t(te);var ne=s(te,2);{var v=d=>{var _=Js(),M=a(_);{var re=b=>{var R=Ws(),B=a(R);Bt(B,20,()=>Array(4),Ht,(O,ee,K)=>{var se=Vs();p(()=>Ft(se,`height: ${4+K*2}px; background: ${(K<e(j).bars?e(j).color:"var(--bg-hover)")??""}; opacity: ${K<e(j).bars?1:.4};`)),l(O,se)}),t(B);var G=s(B,2),Q=a(G);t(G),t(R),p(()=>{Ft(G,`color: ${e(j).color??""}`),u(Q,`${i.liveReading.rssi??""}dBm`)}),l(b,R)};o(M,b=>{e(j)&&b(re)})}var m=s(M,2);{var h=b=>{var R=Xs(),B=a(R),G=s(a(B)),Q=s(G);t(B);var O=s(B,2),ee=a(O);{var K=oe=>{var xe=na();p(ke=>u(xe,`${ke??""}%`),[()=>e(E).toFixed(0)]),l(oe,xe)},se=oe=>{var xe=He(),ke=ce(xe);{var ze=Oe=>{var we=na();p(le=>u(we,`${le??""}V`),[()=>e(r).toFixed(2)]),l(Oe,we)};o(ke,Oe=>{e(r)!=null&&Oe(ze)},!0)}l(oe,xe)};o(ee,oe=>{e(E)!=null?oe(K):oe(se,!1)})}t(O),t(R),p(()=>{Kt(B,"stroke",e(I)),Kt(G,"width",(e(E)??50)*.14),Kt(G,"fill",e(I)),Kt(Q,"fill",e(I)),Ft(O,`color: ${e(I)??""}`)}),l(b,R)};o(m,b=>{e(A)&&b(h)})}t(_),l(d,_)};o(ne,d=>{(e(j)||e(A))&&d(v)})}p(()=>u(ye,` ${e(k)??""}`)),l(D,L)},ie=D=>{var L=Ys(),te=a(L),ae=s(a(te));t(te),be(2),t(L),p(()=>u(ae,` ${i.batch.device_id??""}`)),l(D,L)};o(J,D=>{i.liveReading?D(Y):D(ie,!1)})}t(z),l(ue,z)},$=ue=>{var z=$s(),J=s(a(z),2);{var Y=ie=>{var D=Zs();D.__click=function(...L){i.onEdit?.apply(this,L)},l(ie,D)};o(J,ie=>{i.onEdit&&ie(Y)})}t(z),l(ue,z)};o(w,ue=>{i.batch.device_id?ue(X):ue($,!1)})}l(Z,Se)},$$slots:{default:!0}}),Vt()}Yt(["click"]);const er=131.25;var tr=n('<span class="yeast-producer svelte-19u9n31"> </span>'),ar=n('<span class="yeast-temp svelte-19u9n31"> </span>'),sr=n('<div class="yeast-row recipe svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Recipe</span> <span class="yeast-value muted svelte-19u9n31"> </span></div>'),rr=n('<div class="yeast-row actual svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span> <!> <!></div> <!>',1),lr=n('<div class="yeast-row svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span></div>'),ir=n('<div class="yeast-section svelte-19u9n31"><!></div>'),nr=n('<div class="targets-row svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div></div> <!>',1);function za(De,i){Ut(i,!0);function g(N){return N==null?"--":wt(N)}let j=H(()=>i.recipe.abv!=null?i.recipe.abv:i.recipe.og&&i.recipe.fg?(i.recipe.og-i.recipe.fg)*er:null);xa(De,{title:"Recipe Targets",compact:!0,children:(N,A)=>{var E=nr(),r=ce(E),I=a(r),k=s(a(I),2),Z=a(k,!0);t(k),t(I);var ge=s(I,2),Se=s(a(ge),2),w=a(Se,!0);t(Se),t(ge);var X=s(ge,2),$=s(a(X),2),ue=a($,!0);t($),t(X),t(r);var z=s(r,2);{var J=Y=>{var ie=ir(),D=a(ie);{var L=ae=>{var ye=rr(),Me=ce(ye),Ce=s(a(Me),2),ne=a(Ce,!0);t(Ce);var v=s(Ce,2);{var d=h=>{var b=tr(),R=a(b);t(b),p(()=>u(R,`(${i.yeastStrain.producer??""})`)),l(h,b)};o(v,h=>{i.yeastStrain.producer&&h(d)})}var _=s(v,2);{var M=h=>{var b=ar(),R=a(b);t(b),p((B,G)=>u(R,`${B??""}-${G??""}¬∞C`),[()=>i.yeastStrain.temp_low.toFixed(0),()=>i.yeastStrain.temp_high.toFixed(0)]),l(h,b)};o(_,h=>{i.yeastStrain.temp_low&&i.yeastStrain.temp_high&&h(M)})}t(Me);var re=s(Me,2);{var m=h=>{var b=sr(),R=s(a(b),2),B=a(R,!0);t(R),t(b),p(()=>u(B,i.recipe.yeast_name)),l(h,b)};o(re,h=>{i.recipe.yeast_name&&h(m)})}p(()=>u(ne,i.yeastStrain.name)),l(ae,ye)},te=ae=>{var ye=He(),Me=ce(ye);{var Ce=ne=>{var v=lr(),d=s(a(v),2),_=a(d,!0);t(d),t(v),p(()=>u(_,i.recipe.yeast_name)),l(ne,v)};o(Me,ne=>{i.recipe.yeast_name&&ne(Ce)},!0)}l(ae,ye)};o(D,ae=>{i.yeastStrain?ae(L):ae(te,!1)})}t(ie),l(Y,ie)};o(z,Y=>{(i.yeastStrain||i.recipe.yeast_name)&&Y(J)})}p((Y,ie,D)=>{u(Z,Y),u(w,ie),u(ue,D)},[()=>g(i.recipe.og),()=>g(i.recipe.fg),()=>e(j)!=null?`${e(j).toFixed(1)}%`:"--"]),l(N,E)},$$slots:{default:!0}}),Vt()}var vr=n('<p class="notes-content svelte-hkv31i"> </p>');function Va(De,i){xa(De,{title:"Notes",children:(g,j)=>{var N=vr(),A=a(N,!0);t(N),p(()=>u(A,i.notes)),l(g,N)},$$slots:{default:!0}})}var or=n('<div class="ml-panel loading svelte-1xs394q"><p> </p></div>'),dr=n('<div class="ml-panel error svelte-1xs394q"><p class="error-text svelte-1xs394q"> </p></div>'),cr=n("<option> </option>"),ur=n('<div class="header-controls svelte-1xs394q"><select class="model-select svelte-1xs394q" title="Select prediction model"></select> <button type="button" class="reload-btn svelte-1xs394q" title="Recalculate predictions from database history"> </button></div>'),_r=n('<span class="accuracy-icon svelte-1xs394q">‚úì</span> <span class="accuracy-title svelte-1xs394q">Excellent Prediction</span>',1),pr=n('<span class="accuracy-icon svelte-1xs394q">‚âà</span> <span class="accuracy-title svelte-1xs394q">Close Prediction</span>',1),fr=n('<span class="accuracy-icon svelte-1xs394q">‚ñ≥</span> <span class="accuracy-title svelte-1xs394q">Prediction Variance</span>',1),gr=n('<div><div class="accuracy-header svelte-1xs394q"><!></div> <p class="accuracy-detail svelte-1xs394q"> <span class="accuracy-diff svelte-1xs394q"> </span></p></div>'),hr=n('<span class="comparison-predicted svelte-1xs394q"> </span>'),mr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model:</span> <span class="model-value model-type svelte-1xs394q"> </span></div>'),br=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),yr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),xr=n('<div class="summary-section svelte-1xs394q"><!> <div class="comparison-grid svelte-1xs394q"><div class="comparison-item svelte-1xs394q"><span class="comparison-label svelte-1xs394q">Final Gravity</span> <div class="comparison-values svelte-1xs394q"><span class="comparison-actual svelte-1xs394q"> </span> <!></div></div></div> <div class="model-info summary-model svelte-1xs394q"><!> <!> <!></div></div>'),kr=n('<span class="anomaly-reasons svelte-1xs394q"> </span>'),wr=n('<div class="anomaly-banner svelte-1xs394q"><span class="anomaly-icon svelte-1xs394q">‚ö†Ô∏è</span> <div class="anomaly-content svelte-1xs394q"><span class="anomaly-label svelte-1xs394q">Anomaly Detected</span> <!></div></div>'),jr=n('<span class="activity-badge svelte-1xs394q"> </span>'),qr=n('<div class="progress-section svelte-1xs394q"><div class="progress-header svelte-1xs394q"><span class="progress-label svelte-1xs394q">Fermentation Progress</span> <!></div> <div class="fermentation-progress-bar svelte-1xs394q"><div class="fermentation-fill svelte-1xs394q"></div></div> <div class="progress-labels svelte-1xs394q"><span class="og-label svelte-1xs394q"> </span> <span class="progress-percent svelte-1xs394q"> </span> <span class="fg-label svelte-1xs394q"> </span></div></div>'),Mr=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Predicted FG:</span> <span class="value svelte-1xs394q"> </span></div>'),Sr=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Attenuation:</span> <span class="value attenuation svelte-1xs394q"> </span></div>'),Cr=n('<span class="complete-now svelte-1xs394q">Ready now!</span>'),Br=n('<span class="days svelte-1xs394q"> </span>'),Fr=n(" <!>",1),zr=n('<div class="metric completion-metric svelte-1xs394q"><span class="label svelte-1xs394q">Est. Completion:</span> <span class="value svelte-1xs394q"><!></span></div>'),Tr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model:</span> <span class="model-value model-type svelte-1xs394q"> </span></div>'),Ar=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),Dr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),Rr=n('<!> <!> <div class="metrics svelte-1xs394q"><!> <!> <!> <div class="model-info svelte-1xs394q"><!> <!> <!></div></div>',1),Pr=n('<div><div class="panel-header svelte-1xs394q"><h3 class="panel-title svelte-1xs394q"> </h3> <!></div> <!></div>'),Nr=n('<div class="ml-panel disabled svelte-1xs394q"><div class="disabled-header svelte-1xs394q"><p class="unavailable-text svelte-1xs394q"> </p> <button type="button" class="reload-btn svelte-1xs394q" title="Reload predictions from database"> </button></div> <p class="unavailable-hint svelte-1xs394q"><!></p></div>');function Or(De,i){Ut(i,!0);let g=aa(i,"batchStatus",3,"fermenting"),j=aa(i,"measuredOg",3,null),N=aa(i,"measuredFg",3,null),A=aa(i,"currentSg",3,null),E=aa(i,"liveReading",3,null),r=U(Ze({available:!1})),I=U(!0),k=U(!1),Z=U(null),ge=U("auto");const Se=[{value:"auto",label:"Auto (Best Fit)"},{value:"exponential",label:"Exponential"},{value:"gompertz",label:"Gompertz (S-Curve)"},{value:"logistic",label:"Logistic"}];let w=H(()=>g()==="completed"||g()==="archived"),X=H(()=>N()??A()),$=H(()=>{if(!e(w)||!e(r).predicted_fg||!e(X))return null;const d=Math.abs(e(r).predicted_fg-e(X)),_=Math.round(d*1e3);return{diff:d,points:_,isAccurate:_<=2,isClose:_<=5}});async function ue(){c(I,!0),c(Z,null);try{c(r,await hs(i.batchId,e(ge)),!0)}catch(d){c(Z,d instanceof Error?d.message:"Failed to load predictions",!0),console.error("Failed to load ML predictions:",d)}finally{c(I,!1)}}async function z(){c(k,!0),c(Z,null);try{const d=await gs(i.batchId);console.log("Reloaded predictions:",d.message),await ue()}catch(d){c(Z,d instanceof Error?d.message:"Failed to reload predictions",!0),console.error("Failed to reload predictions:",d)}finally{c(k,!1)}}function J(){ue()}Wa(z);function Y(d){return d?new Date(d).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}):"N/A"}function ie(d){if(!d)return null;const _=new Date(d),M=new Date,re=_.getTime()-M.getTime();return Math.ceil(re/(1e3*60*60*24))}let D=H(()=>{const d=j()??e(r).predicted_og,_=e(r).predicted_fg,M=A()??E()?.sg;if(!d||!_||!M||d<=_)return null;const re=d-_,h=(d-M)/re*100;return Math.min(100,Math.max(0,h))}),L=H(()=>{const d=j()??e(r).predicted_og,_=A()??E()?.sg;if(!d||!_||d<=1)return null;const M=(d-_)/(d-1)*100;return Math.min(100,Math.max(0,M))}),te=H(()=>{const d=E()?.sg_rate;if(d==null)return null;const _=Math.abs(d);return _>.002?{label:"Very Active",color:"var(--activity-very-active)",emoji:"üî•"}:_>5e-4?{label:"Active",color:"var(--activity-active)",emoji:"‚ú®"}:_>1e-4?{label:"Slowing",color:"var(--activity-slowing)",emoji:"üê¢"}:{label:"Complete",color:"var(--activity-complete)",emoji:"‚úì"}}),ae=H(()=>E()?.is_anomaly??!1),ye=H(()=>E()?.anomaly_reasons??[]);var Me=He(),Ce=ce(Me);{var ne=d=>{var _=or(),M=a(_),re=a(M);t(M),t(_),p(()=>u(re,`Loading ${e(w)?"summary":"predictions"}...`)),l(d,_)},v=d=>{var _=He(),M=ce(_);{var re=h=>{var b=dr(),R=a(b),B=a(R);t(R),t(b),p(()=>u(B,`‚ö†Ô∏è ${e(Z)??""}`)),l(h,b)},m=h=>{var b=He(),R=ce(b);{var B=Q=>{var O=Pr();let ee;var K=a(O),se=a(K),oe=a(se,!0);t(se);var xe=s(se,2);{var ke=le=>{var f=ur(),y=a(f);y.__change=J,Bt(y,21,()=>Se,Ht,(q,P)=>{var ve=cr(),pe=a(ve,!0);t(ve);var Te={};p(()=>{u(pe,e(P).label),Te!==(Te=e(P).value)&&(ve.value=(ve.__value=e(P).value)??"")}),l(q,ve)}),t(y);var F=s(y,2);F.__click=z;var S=a(F,!0);t(F),t(f),p(()=>{y.disabled=e(I)||e(k),F.disabled=e(k)||e(I),u(S,e(k)?"Reloading...":"‚Üª")}),Ta(y,()=>e(ge),q=>c(ge,q)),l(le,f)};o(xe,le=>{e(w)||le(ke)})}t(K);var ze=s(K,2);{var Oe=le=>{var f=xr(),y=a(f);{var F=V=>{var de=gr();let T;var W=a(de),fe=a(W);{var Be=Ye=>{var et=_r();be(2),l(Ye,et)},Ue=Ye=>{var et=He(),dt=ce(et);{var Ae=je=>{var Xe=pr();be(2),l(je,Xe)},_t=je=>{var Xe=fr();be(2),l(je,Xe)};o(dt,je=>{e($).isClose?je(Ae):je(_t,!1)},!0)}l(Ye,et)};o(fe,Ye=>{e($).isAccurate?Ye(Be):Ye(Ue,!1)})}t(W);var Ve=s(W,2),Ke=a(Ve),We=s(Ke),$e=a(We);t(We),t(Ve),t(de),p((Ye,et)=>{T=Ee(de,1,"accuracy-banner svelte-1xs394q",null,T,{accurate:e($).isAccurate,close:e($).isClose&&!e($).isAccurate}),u(Ke,`Model predicted ${Ye??""}, actual was ${et??""} `),u($e,`(${e($).points??""} points ${e(r).predicted_fg&&e(r).predicted_fg>e(X)?"high":"low"})`)},[()=>wt(e(r).predicted_fg??0),()=>wt(e(X))]),l(V,de)};o(y,V=>{e($)&&e(X)&&V(F)})}var S=s(y,2),q=a(S),P=s(a(q),2),ve=a(P),pe=a(ve,!0);t(ve);var Te=s(ve,2);{var Re=V=>{var de=hr(),T=a(de);t(de),p(W=>u(T,`ML: ${W??""}`),[()=>wt(e(r).predicted_fg)]),l(V,de)};o(Te,V=>{e(r).predicted_fg&&V(Re)})}t(P),t(q),t(S);var Je=s(S,2),ut=a(Je);{var jt=V=>{var de=mr(),T=s(a(de),2),W=a(T,!0);t(T),t(de),p(()=>u(W,e(r).model_type)),l(V,de)};o(ut,V=>{e(r).model_type&&V(jt)})}var zt=s(ut,2);{var x=V=>{var de=br(),T=s(a(de),2),W=a(T);t(T),t(de),p(fe=>u(W,`${fe??""}%`),[()=>(e(r).r_squared*100).toFixed(0)]),l(V,de)};o(zt,V=>{e(r).r_squared!==void 0&&V(x)})}var C=s(zt,2);{var he=V=>{var de=yr(),T=s(a(de),2),W=a(T,!0);t(T),t(de),p(()=>u(W,e(r).num_readings)),l(V,de)};o(C,V=>{e(r).num_readings&&V(he)})}t(Je),t(f),p(V=>u(pe,V),[()=>wt(e(X)??0)]),l(le,f)},we=le=>{var f=Rr(),y=ce(f);{var F=T=>{var W=wr(),fe=s(a(W),2),Be=s(a(fe),2);{var Ue=Ve=>{var Ke=kr(),We=a(Ke,!0);t(Ke),p($e=>u(We,$e),[()=>e(ye).join(", ")]),l(Ve,Ke)};o(Be,Ve=>{e(ye).length>0&&Ve(Ue)})}t(fe),t(W),l(T,W)};o(y,T=>{e(ae)&&T(F)})}var S=s(y,2);{var q=T=>{var W=qr(),fe=a(W),Be=s(a(fe),2);{var Ue=je=>{var Xe=jr(),Tt=a(Xe);t(Xe),p(()=>{Ft(Xe,`color: ${e(te).color??""}`),u(Tt,`${e(te).emoji??""} ${e(te).label??""}`)}),l(je,Xe)};o(Be,je=>{e(te)&&je(Ue)})}t(fe);var Ve=s(fe,2),Ke=a(Ve);t(Ve);var We=s(Ve,2),$e=a(We),Ye=a($e);t($e);var et=s($e,2),dt=a(et);t(et);var Ae=s(et,2),_t=a(Ae);t(Ae),t(We),t(W),p((je,Xe,Tt)=>{Ft(Ke,`width: ${e(D)??""}%`),u(Ye,`OG: ${je??""}`),u(dt,`${Xe??""}%`),u(_t,`FG: ${Tt??""}`)},[()=>wt(j()??e(r).predicted_og??0),()=>e(D).toFixed(0),()=>wt(e(r).predicted_fg??0)]),l(T,W)};o(S,T=>{e(D)!==null&&T(q)})}var P=s(S,2),ve=a(P);{var pe=T=>{var W=Mr(),fe=s(a(W),2),Be=a(fe,!0);t(fe),t(W),p(Ue=>u(Be,Ue),[()=>wt(e(r).predicted_fg)]),l(T,W)};o(ve,T=>{e(r).predicted_fg&&T(pe)})}var Te=s(ve,2);{var Re=T=>{var W=Sr(),fe=s(a(W),2),Be=a(fe);t(fe),t(W),p(Ue=>u(Be,`${Ue??""}%`),[()=>e(L).toFixed(1)]),l(T,W)};o(Te,T=>{e(L)!==null&&T(Re)})}var Je=s(Te,2);{var ut=T=>{const W=H(()=>ie(e(r).estimated_completion));var fe=zr(),Be=s(a(fe),2),Ue=a(Be);{var Ve=We=>{var $e=Cr();l(We,$e)},Ke=We=>{var $e=Fr(),Ye=ce($e),et=s(Ye);{var dt=Ae=>{var _t=Br(),je=a(_t);t(_t),p(()=>u(je,`(${e(W)??""} ${e(W)===1?"day":"days"})`)),l(Ae,_t)};o(et,Ae=>{e(W)!==null&&Ae(dt)})}p(Ae=>u(Ye,`${Ae??""} `),[()=>Y(e(r).estimated_completion)]),l(We,$e)};o(Ue,We=>{e(W)!==null&&e(W)<=0?We(Ve):We(Ke,!1)})}t(Be),t(fe),l(T,fe)};o(Je,T=>{e(r).estimated_completion&&T(ut)})}var jt=s(Je,2),zt=a(jt);{var x=T=>{var W=Tr(),fe=s(a(W),2),Be=a(fe,!0);t(fe),t(W),p(()=>u(Be,e(r).model_type)),l(T,W)};o(zt,T=>{e(r).model_type&&T(x)})}var C=s(zt,2);{var he=T=>{var W=Ar(),fe=s(a(W),2),Be=a(fe);t(fe),t(W),p(Ue=>u(Be,`${Ue??""}%`),[()=>(e(r).r_squared*100).toFixed(0)]),l(T,W)};o(C,T=>{e(r).r_squared!==void 0&&T(he)})}var V=s(C,2);{var de=T=>{var W=Dr(),fe=s(a(W),2),Be=a(fe,!0);t(fe),t(W),p(()=>u(Be,e(r).num_readings)),l(T,W)};o(V,T=>{e(r).num_readings&&T(de)})}t(jt),t(P),l(le,f)};o(ze,le=>{e(w)?le(Oe):le(we,!1)})}t(O),p(()=>{ee=Ee(O,1,"ml-panel svelte-1xs394q",null,ee,{"has-anomaly":e(ae),completed:e(w)}),u(oe,e(w)?"Fermentation Summary":"Fermentation Intelligence")}),l(Q,O)},G=Q=>{var O=Nr(),ee=a(O),K=a(ee),se=a(K,!0);t(K);var oe=s(K,2);oe.__click=z;var xe=a(oe,!0);t(oe),t(ee);var ke=s(ee,2),ze=a(ke);{var Oe=le=>{var f=na("Waiting for fermentation to progress (need visible SG drop)");l(le,f)},we=le=>{var f=He(),y=ce(f);{var F=q=>{var P=na("Need more fermentation curve data for reliable prediction");l(q,P)},S=q=>{var P=He(),ve=ce(P);{var pe=Re=>{var Je=na("Need at least 10 readings to make predictions");l(Re,Je)},Te=Re=>{var Je=na();p(()=>u(Je,e(w)?"No fermentation data recorded":"Predictions will appear once fermentation is underway")),l(Re,Je)};o(ve,Re=>{e(r).reason==="insufficient_data"?Re(pe):Re(Te,!1)},!0)}l(q,P)};o(y,q=>{e(r).reason==="insufficient_curve_data"?q(F):q(S,!1)},!0)}l(le,f)};o(ze,le=>{e(r).reason==="insufficient_fermentation_progress"?le(Oe):le(we,!1)})}t(ke),t(O),p(()=>{u(se,e(w)?"Fermentation summary unavailable":"ML predictions unavailable"),oe.disabled=e(k)||e(I),u(xe,e(k)?"Reloading...":"‚Üª Reload")}),l(Q,O)};o(R,Q=>{e(r).available?Q(B):Q(G,!1)},!0)}l(h,b)};o(M,h=>{e(Z)?h(re):h(m,!1)},!0)}l(d,_)};o(Ce,d=>{e(I)?d(ne):d(v,!1)})}l(De,Me),Vt()}Yt(["change","click"]);var Lr=n('<div class="loading svelte-1hws0u6">Loading alerts...</div>'),Er=n('<div class="error-banner svelte-1hws0u6"><span> </span> <button type="button" class="dismiss-error svelte-1hws0u6">√ó</button></div>'),Ir=n('<button type="button" class="dismiss-all-btn svelte-1hws0u6"> </button>'),Gr=n('<span class="spinner svelte-1hws0u6"></span>'),Hr=ga('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1hws0u6"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg>'),Ur=n('<div class="alert-item svelte-1hws0u6"><div class="alert-icon svelte-1hws0u6"> </div> <div class="alert-content svelte-1hws0u6"><div class="alert-header svelte-1hws0u6"><span class="alert-type svelte-1hws0u6"> </span> <span class="severity-badge svelte-1hws0u6"> </span></div> <p class="alert-message svelte-1hws0u6"> </p> <div class="alert-meta svelte-1hws0u6"><span class="alert-time svelte-1hws0u6"> </span> <span class="alert-separator svelte-1hws0u6">¬∑</span> <span class="alert-time svelte-1hws0u6"> </span></div></div> <button type="button" class="dismiss-btn svelte-1hws0u6" title="Dismiss alert"><!></button></div>'),Vr=n('<!> <div class="alerts-header svelte-1hws0u6"><span class="alert-count svelte-1hws0u6"> </span> <!></div> <div class="alerts-list svelte-1hws0u6"></div>',1);function Wr(De,i){Ut(i,!0);let g=U(Ze([])),j=U(!0),N=U(null),A=U(null),E=U(!1);Sa(()=>{r()});async function r(){try{c(j,!0),c(N,null),c(g,await ms(i.batchId,!1),!0)}catch(z){c(N,z instanceof Error?z.message:"Failed to load alerts",!0)}finally{c(j,!1)}}async function I(z){try{c(A,z,!0),await bs(i.batchId,z),c(g,e(g).filter(J=>J.id!==z),!0)}catch(J){c(N,J instanceof Error?J.message:"Failed to dismiss alert",!0)}finally{c(A,null)}}async function k(){try{c(E,!0),await ys(i.batchId),c(g,[],!0)}catch(z){c(N,z instanceof Error?z.message:"Failed to dismiss alerts",!0)}finally{c(E,!1)}}function Z(z){switch(z){case"critical":return"var(--negative)";case"warning":return"var(--warning)";case"info":return"var(--accent)";default:return"var(--text-muted)"}}function ge(z){switch(z){case"stall":return"‚è∏";case"temperature_high":return"üî•";case"temperature_low":return"‚ùÑ";case"anomaly":return"‚ö†";default:return"‚ö†"}}function Se(z){const J=new Date(z),ie=new Date().getTime()-J.getTime(),D=Math.floor(ie/6e4),L=Math.floor(D/60),te=Math.floor(L/24);return te>0?`${te}d ago`:L>0?`${L}h ago`:D>0?`${D}m ago`:"just now"}var w=He(),X=ce(w);{var $=z=>{xa(z,{title:"Alerts",icon:"üîî",children:(J,Y)=>{var ie=Lr();l(J,ie)},$$slots:{default:!0}})},ue=z=>{var J=He(),Y=ce(J);{var ie=L=>{},D=L=>{xa(L,{title:"Active Alerts",icon:"üîî",highlight:!0,children:(te,ae)=>{var ye=Vr(),Me=ce(ye);{var Ce=m=>{var h=Er(),b=a(h),R=a(b,!0);t(b);var B=s(b,2);B.__click=()=>c(N,null),t(h),p(()=>u(R,e(N))),l(m,h)};o(Me,m=>{e(N)&&m(Ce)})}var ne=s(Me,2),v=a(ne),d=a(v);t(v);var _=s(v,2);{var M=m=>{var h=Ir();h.__click=k;var b=a(h,!0);t(h),p(()=>{h.disabled=e(E),u(b,e(E)?"Dismissing...":"Dismiss All")}),l(m,h)};o(_,m=>{e(g).length>1&&m(M)})}t(ne);var re=s(ne,2);Bt(re,21,()=>e(g),m=>m.id,(m,h)=>{var b=Ur(),R=a(b),B=a(R,!0);t(R);var G=s(R,2),Q=a(G),O=a(Q),ee=a(O,!0);t(O);var K=s(O,2),se=a(K,!0);t(K),t(Q);var oe=s(Q,2),xe=a(oe,!0);t(oe);var ke=s(oe,2),ze=a(ke),Oe=a(ze);t(ze);var we=s(ze,4),le=a(we);t(we),t(ke),t(G);var f=s(G,2);f.__click=()=>I(e(h).id);var y=a(f);{var F=q=>{var P=Gr();l(q,P)},S=q=>{var P=Hr();l(q,P)};o(y,q=>{e(A)===e(h).id?q(F):q(S,!1)})}t(f),t(b),p((q,P,ve,pe,Te,Re,Je,ut)=>{Ft(b,`--severity-color: ${q??""}`),u(B,P),u(ee,ve),Ft(K,`background: ${pe??""}`),u(se,e(h).severity),u(xe,e(h).message),Kt(ze,"title",`First detected: ${Te??""}`),u(Oe,`First: ${Re??""}`),Kt(we,"title",`Last seen: ${Je??""}`),u(le,`Last: ${ut??""}`),f.disabled=e(A)===e(h).id},[()=>Z(e(h).severity),()=>ge(e(h).alert_type),()=>e(h).alert_type.replace("_"," "),()=>Z(e(h).severity),()=>new Date(e(h).first_detected_at).toLocaleString(),()=>Se(e(h).first_detected_at),()=>new Date(e(h).last_seen_at).toLocaleString(),()=>Se(e(h).last_seen_at)]),l(m,b)}),t(re),p(()=>u(d,`${e(g).length??""} active`)),l(te,ye)},$$slots:{default:!0}})};o(Y,L=>{e(g).length===0?L(ie):L(D,!1)},!0)}l(z,J)};o(X,z=>{e(j)?z($):z(ue,!1)})}l(De,w),Vt()}Yt(["click"]);var Xr=n("<span> </span>"),Jr=n('<div class="timer-idle svelte-ukh80y"><div class="timer-option svelte-ukh80y"><label class="option-label svelte-ukh80y">Mash Duration</label> <div class="duration-input svelte-ukh80y"><button type="button" class="duration-btn svelte-ukh80y">‚àí</button> <span class="duration-value svelte-ukh80y"> </span> <button type="button" class="duration-btn svelte-ukh80y">+</button> <span class="duration-unit svelte-ukh80y">min</span></div></div> <div class="timer-option svelte-ukh80y"><label class="option-label svelte-ukh80y">Boil Duration</label> <div class="duration-display svelte-ukh80y"><span class="duration-value svelte-ukh80y"> </span> <span class="duration-unit svelte-ukh80y">min</span></div></div> <div class="timer-actions svelte-ukh80y"><button type="button" class="start-btn mash svelte-ukh80y"><svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path></svg> Start Mash</button> <button type="button" class="start-btn boil svelte-ukh80y">Skip to Boil</button></div></div>'),Kr=n('<div class="timer-complete svelte-ukh80y"><div class="complete-icon svelte-ukh80y">‚úì</div> <p class="complete-text svelte-ukh80y">Boil complete! Time to chill the wort.</p> <button type="button" class="reset-btn svelte-ukh80y">Reset Timer</button></div>'),Yr=ga('<svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path></svg> Resume',1),Qr=ga('<svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6"></path></svg> Pause',1),Zr=n('<span class="hop-check svelte-ukh80y">‚úì</span>'),$r=n('<div><span class="hop-time svelte-ukh80y"> </span> <span class="hop-name svelte-ukh80y"> </span> <span class="hop-amount svelte-ukh80y"> </span> <!></div>'),el=n('<div class="hop-schedule svelte-ukh80y"><h4 class="schedule-title svelte-ukh80y">Hop Additions</h4> <div class="hop-list svelte-ukh80y"></div></div>'),tl=n('<button type="button" class="next-phase-btn svelte-ukh80y">Mash Done ‚Üí Start Boil</button>'),al=n('<div class="timer-active svelte-ukh80y"><div class="timer-display svelte-ukh80y"><span class="time-value svelte-ukh80y"> </span> <span class="time-label svelte-ukh80y">remaining</span></div> <div class="progress-bar svelte-ukh80y"><div></div></div> <div class="timer-controls svelte-ukh80y"><button type="button" class="control-btn svelte-ukh80y" title="Subtract 1 minute">‚àí1m</button> <button type="button"><!></button> <button type="button" class="control-btn svelte-ukh80y" title="Add 1 minute">+1m</button></div> <!> <div class="phase-actions svelte-ukh80y"><!> <button type="button" class="reset-btn svelte-ukh80y">Reset</button></div></div>'),sl=n('<div class="timer-card svelte-ukh80y"><div class="timer-header svelte-ukh80y"><h3 class="timer-title svelte-ukh80y">Brew Day Timer</h3> <!></div> <!></div>');function rl(De,i){Ut(i,!0);let g=U("idle"),j=U(0),N=null,A=U(!1),E=U(Ze(new Set)),r=U(60),I=H(()=>i.recipe.boil_time_minutes||60),k=H(()=>i.recipe.hops?i.recipe.hops.filter(v=>v.timing?.use==="add_to_boil"||!v.timing?.use).map(v=>({name:v.name,amount:v.amount_grams,time:v.timing?.duration?.value||0,unit:v.timing?.duration?.unit||"min"})).sort((v,d)=>d.time-v.time):[]),Z=H(()=>{const v=Math.floor(e(j)/60),d=e(j)%60;return`${v.toString().padStart(2,"0")}:${d.toString().padStart(2,"0")}`}),ge=H(()=>e(g)==="mash"?(e(r)*60-e(j))/(e(r)*60)*100:e(g)==="boil"?(e(I)*60-e(j))/(e(I)*60)*100:0),Se=H(()=>{switch(e(g)){case"mash":return"Mash";case"boil":return"Boil";case"complete":return"Complete!";default:return"Ready"}});function w(){c(g,"mash"),c(j,e(r)*60),c(E,new Set,!0),$()}function X(){c(g,"boil"),c(j,e(I)*60),c(E,new Set,!0),$()}function $(){N&&clearInterval(N),c(A,!1),N=setInterval(()=>{if(!e(A)&&e(j)>0){if(ss(j,-1),e(g)==="boil"){const v=Math.floor(e(j)/60);for(const d of e(k)){const _=d.time;v===_&&!e(E).has(_)&&(e(E).add(_),ie(),D(`Add ${d.name}`,`${d.amount}g at ${_} minutes`))}}e(j)===0&&(clearInterval(N),N=null,ie(),e(g)==="mash"?D("Mash Complete","Time to sparge and start the boil!"):e(g)==="boil"&&(c(g,"complete"),D("Boil Complete","Time to chill the wort!"),i.onComplete?.()))}},1e3)}function ue(){c(A,!e(A))}function z(){N&&(clearInterval(N),N=null),c(g,"idle"),c(j,0),c(A,!1),c(E,new Set,!0)}function J(){c(j,e(j)+60)}function Y(){e(j)>=60&&c(j,e(j)-60)}function ie(){try{const v=new(window.AudioContext||window.webkitAudioContext),d=v.createOscillator(),_=v.createGain();d.connect(_),_.connect(v.destination),d.frequency.value=880,d.type="sine",_.gain.value=.3,d.start(),setTimeout(()=>_.gain.value=0,150),setTimeout(()=>_.gain.value=.3,250),setTimeout(()=>_.gain.value=0,400),setTimeout(()=>_.gain.value=.3,500),setTimeout(()=>_.gain.value=0,650),setTimeout(()=>{d.stop(),v.close()},700)}catch(v){console.warn("Audio notification not available:",v)}}function D(v,d){"Notification"in window&&Notification.permission==="granted"&&new Notification(v,{body:d,icon:"/favicon.png"})}Sa(()=>("Notification"in window&&Notification.permission==="default"&&Notification.requestPermission(),()=>{N&&clearInterval(N)}));var L=sl(),te=a(L),ae=s(a(te),2);{var ye=v=>{var d=Xr();let _;var M=a(d,!0);t(d),p(()=>{_=Ee(d,1,"phase-badge svelte-ukh80y",null,_,{mash:e(g)==="mash",boil:e(g)==="boil"}),u(M,e(Se))}),l(v,d)};o(ae,v=>{e(g)!=="idle"&&e(g)!=="complete"&&v(ye)})}t(te);var Me=s(te,2);{var Ce=v=>{var d=Jr(),_=a(d),M=s(a(_),2),re=a(M);re.__click=()=>c(r,Math.max(1,e(r)-5),!0);var m=s(re,2),h=a(m,!0);t(m);var b=s(m,2);b.__click=()=>c(r,e(r)+5),be(2),t(M),t(_);var R=s(_,2),B=s(a(R),2),G=a(B),Q=a(G,!0);t(G),be(2),t(B),t(R);var O=s(R,2),ee=a(O);ee.__click=w;var K=s(ee,2);K.__click=X,t(O),t(d),p(()=>{u(h,e(r)),u(Q,e(I))}),l(v,d)},ne=v=>{var d=He(),_=ce(d);{var M=m=>{var h=Kr(),b=s(a(h),4);b.__click=z,t(h),l(m,h)},re=m=>{var h=al(),b=a(h),R=a(b),B=a(R,!0);t(R),be(2),t(b);var G=s(b,2),Q=a(G);let O;t(G);var ee=s(G,2),K=a(ee);K.__click=Y;var se=s(K,2);let oe;se.__click=ue;var xe=a(se);{var ke=q=>{var P=Yr();be(),l(q,P)},ze=q=>{var P=Qr();be(),l(q,P)};o(xe,q=>{e(A)?q(ke):q(ze,!1)})}t(se);var Oe=s(se,2);Oe.__click=J,t(ee);var we=s(ee,2);{var le=q=>{var P=el(),ve=s(a(P),2);Bt(ve,21,()=>e(k),Ht,(pe,Te)=>{const Re=H(()=>Math.floor(e(j)/60)),Je=H(()=>e(Te).time<=e(Re)&&!e(E).has(e(Te).time)),ut=H(()=>e(E).has(e(Te).time)||e(Te).time>e(Re));var jt=$r();let zt;var x=a(jt),C=a(x);t(x);var he=s(x,2),V=a(he,!0);t(he);var de=s(he,2),T=a(de);t(de);var W=s(de,2);{var fe=Be=>{var Ue=Zr();l(Be,Ue)};o(W,Be=>{e(ut)&&Be(fe)})}t(jt),p(()=>{zt=Ee(jt,1,"hop-item svelte-ukh80y",null,zt,{next:e(Je),done:e(ut)}),u(C,`${e(Te).time??""}m`),u(V,e(Te).name),u(T,`${e(Te).amount??""}g`)}),l(pe,jt)}),t(ve),t(P),l(q,P)};o(we,q=>{e(g)==="boil"&&e(k).length>0&&q(le)})}var f=s(we,2),y=a(f);{var F=q=>{var P=tl();P.__click=X,l(q,P)};o(y,q=>{e(g)==="mash"&&q(F)})}var S=s(y,2);S.__click=z,t(f),t(h),p(()=>{u(B,e(Z)),O=Ee(Q,1,"progress-fill svelte-ukh80y",null,O,{mash:e(g)==="mash",boil:e(g)==="boil"}),Ft(Q,`width: ${e(ge)??""}%`),oe=Ee(se,1,"control-btn pause svelte-ukh80y",null,oe,{paused:e(A)})}),l(m,h)};o(_,m=>{e(g)==="complete"?m(M):m(re,!1)},!0)}l(v,d)};o(Me,v=>{e(g)==="idle"?v(Ce):v(ne,!1)})}t(L),l(De,L),Vt()}Yt(["click"]);var ll=n('<button type="button" class="remove-btn svelte-ue9vqt" title="Remove item">√ó</button>'),il=n('<label><input type="checkbox" class="svelte-ue9vqt"/> <span class="item-text svelte-ue9vqt"> </span> <!></label>'),nl=n('<div class="category-group svelte-ue9vqt"><h4 class="category-title svelte-ue9vqt"> </h4> <div class="items-list svelte-ue9vqt"></div></div>'),vl=n('<div class="add-form svelte-ue9vqt"><input type="text" class="add-input svelte-ue9vqt" placeholder="Add custom item..."/> <button type="button" class="add-btn svelte-ue9vqt">Add</button> <button type="button" class="cancel-btn svelte-ue9vqt">Cancel</button></div>'),ol=n('<button type="button" class="show-add-btn svelte-ue9vqt"><svg class="btn-icon svelte-ue9vqt" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path></svg> Add custom item</button>'),dl=n('<div class="checklist-card svelte-ue9vqt"><div class="checklist-header svelte-ue9vqt"><div class="header-left svelte-ue9vqt"><h3 class="checklist-title svelte-ue9vqt">Brew Day Checklist</h3> <span class="progress-badge svelte-ue9vqt"> </span></div> <button type="button" class="reset-btn svelte-ue9vqt" title="Reset all items"><svg class="btn-icon svelte-ue9vqt" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg></button></div> <div class="progress-bar svelte-ue9vqt"><div class="progress-fill svelte-ue9vqt"></div></div> <div class="checklist-groups svelte-ue9vqt"></div> <div class="add-section svelte-ue9vqt"><!></div></div>');function cl(De,i){Ut(i,!0);let g=U(Ze([])),j=U(""),N=U(!1),A=H(()=>`brewday-checklist-${i.batchId}`);function E(){const v=[];return v.push({id:"prep-sanitize",text:"Sanitize all equipment",checked:!1,category:"prep"}),v.push({id:"prep-water",text:`Heat strike water (${i.recipe.batch_size_liters?Math.round(i.recipe.batch_size_liters*1.3):"--"}L)`,checked:!1,category:"prep"}),i.recipe.fermentables&&i.recipe.fermentables.forEach((d,_)=>{const M=d.amount_kg?`${(d.amount_kg*1e3).toFixed(0)}g`:"";v.push({id:`ferm-${_}`,text:`Mill grain: ${d.name} ${M}`,checked:!1,category:"prep"})}),v.push({id:"mash-dough-in",text:"Dough in - add grain to strike water",checked:!1,category:"mash"}),v.push({id:"mash-temp",text:"Check mash temperature",checked:!1,category:"mash"}),v.push({id:"mash-rest",text:"Mash rest complete",checked:!1,category:"mash"}),v.push({id:"mash-sparge",text:"Sparge and collect wort",checked:!1,category:"mash"}),v.push({id:"boil-preboil",text:"Record pre-boil gravity",checked:!1,category:"boil"}),v.push({id:"boil-start",text:"Bring to boil",checked:!1,category:"boil"}),i.recipe.hops&&i.recipe.hops.filter(_=>_.timing?.use==="add_to_boil"||!_.timing?.use).sort((_,M)=>(M.timing?.duration?.value||0)-(_.timing?.duration?.value||0)).forEach((_,M)=>{const re=_.timing?.duration?.value||0,m=_.amount_grams?`${_.amount_grams}g`:"";v.push({id:`hop-${M}`,text:`Add ${_.name} ${m} @ ${re}min`,checked:!1,category:"boil"})}),v.push({id:"postboil-flame-off",text:"Flame off / end boil",checked:!1,category:"post-boil"}),v.push({id:"postboil-chill",text:"Chill wort to pitch temp",checked:!1,category:"post-boil"}),v.push({id:"postboil-og",text:"Record original gravity (OG)",checked:!1,category:"post-boil"}),v.push({id:"postboil-transfer",text:"Transfer to fermenter",checked:!1,category:"post-boil"}),v.push({id:"postboil-yeast",text:"Pitch yeast",checked:!1,category:"post-boil"}),v.push({id:"postboil-airlock",text:"Seal fermenter and add airlock",checked:!1,category:"post-boil"}),v}function r(){try{const v=localStorage.getItem(e(A));if(v){const d=JSON.parse(v),_=E(),M=new Map(d.map(m=>[m.id,m]));for(const m of _){const h=M.get(m.id);h&&(m.checked=h.checked)}const re=d.filter(m=>m.category==="custom");c(g,[..._,...re],!0)}else c(g,E(),!0)}catch{c(g,E(),!0)}}function I(){try{localStorage.setItem(e(A),JSON.stringify(e(g)))}catch(v){console.warn("Failed to save checklist:",v)}}function k(v){c(g,e(g).map(d=>d.id===v?{...d,checked:!d.checked}:d),!0),I()}function Z(){if(!e(j).trim())return;const v={id:`custom-${Date.now()}`,text:e(j).trim(),checked:!1,category:"custom"};c(g,[...e(g),v],!0),c(j,""),c(N,!1),I()}function ge(v){c(g,e(g).filter(d=>d.id!==v),!0),I()}function Se(){confirm("Reset all checklist items to unchecked?")&&(c(g,e(g).map(v=>({...v,checked:!1})),!0),I())}let w=H(()=>{if(e(g).length===0)return 0;const v=e(g).filter(d=>d.checked).length;return Math.round(v/e(g).length*100)}),X=H(()=>{const v={prep:[],mash:[],boil:[],"post-boil":[],custom:[]};for(const d of e(g))v[d.category].push(d);return v});const $={prep:"Preparation",mash:"Mash",boil:"Boil","post-boil":"Post-Boil",custom:"Custom"};Sa(()=>{r()});var ue=dl(),z=a(ue),J=a(z),Y=s(a(J),2),ie=a(Y);t(Y),t(J);var D=s(J,2);D.__click=Se,t(z);var L=s(z,2),te=a(L);t(L);var ae=s(L,2);Bt(ae,21,()=>Object.entries(e(X)),Ht,(v,d)=>{var _=H(()=>rs(e(d),2));let M=()=>e(_)[0],re=()=>e(_)[1];var m=He(),h=ce(m);{var b=R=>{var B=nl(),G=a(B),Q=a(G,!0);t(G);var O=s(G,2);Bt(O,21,re,ee=>ee.id,(ee,K)=>{var se=il();let oe;var xe=a(se);kt(xe),xe.__change=()=>k(e(K).id);var ke=s(xe,2),ze=a(ke,!0);t(ke);var Oe=s(ke,2);{var we=le=>{var f=ll();f.__click=()=>ge(e(K).id),l(le,f)};o(Oe,le=>{e(K).category==="custom"&&le(we)})}t(se),p(()=>{oe=Ee(se,1,"checklist-item svelte-ue9vqt",null,oe,{checked:e(K).checked}),os(xe,e(K).checked),u(ze,e(K).text)}),l(ee,se)}),t(O),t(B),p(()=>u(Q,$[M()])),l(R,B)};o(h,R=>{re().length>0&&R(b)})}l(v,m)}),t(ae);var ye=s(ae,2),Me=a(ye);{var Ce=v=>{var d=vl(),_=a(d);kt(_),_.__keydown=m=>m.key==="Enter"&&Z();var M=s(_,2);M.__click=Z;var re=s(M,2);re.__click=()=>{c(N,!1),c(j,"")},t(d),ft(_,()=>e(j),m=>c(j,m)),l(v,d)},ne=v=>{var d=ol();d.__click=()=>c(N,!0),l(v,d)};o(Me,v=>{e(N)?v(Ce):v(ne,!1)})}t(ye),t(ue),p(()=>{u(ie,`${e(w)??""}%`),Ft(te,`width: ${e(w)??""}%`)}),l(De,ue),Vt()}Yt(["click","change","keydown"]);var ul=n('<span class="save-indicator svelte-1hyfh06"> </span>'),_l=n('<span class="summary-value svelte-1hyfh06"> </span>'),pl=n('<span class="summary-value svelte-1hyfh06"> </span>'),fl=n('<span class="target svelte-1hyfh06"> </span>'),gl=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Mash Temperature</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06"> </span></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Mash pH</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.01" min="4" max="7" class="field-input svelte-1hyfh06" placeholder="--"/></div> <span class="target svelte-1hyfh06">Target: 5.2-5.6</span></div></div> <div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Strike Water Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div></div></div></div>'),hl=n('<span class="summary-value svelte-1hyfh06"> </span>'),ml=n('<span class="summary-value svelte-1hyfh06"> </span>'),bl=n('<span class="target svelte-1hyfh06"> </span>'),yl=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Pre-Boil Gravity</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.001" min="1.000" max="1.200" class="field-input svelte-1hyfh06" placeholder="1.0XX"/></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Pre-Boil Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div></div></div></div>'),xl=n('<span class="summary-value og svelte-1hyfh06"> </span>'),kl=n('<span class="summary-value svelte-1hyfh06"> </span>'),wl=n('<span class="target svelte-1hyfh06"> </span>'),jl=n('<span class="target svelte-1hyfh06"> </span>'),ql=n('<span class="target svelte-1hyfh06"> </span>'),Ml=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Original Gravity (OG)</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.001" min="1.000" max="1.200" class="field-input og-input svelte-1hyfh06" placeholder="1.0XX"/></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Post-Boil Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div> <!></div></div> <div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Brewhouse Efficiency</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" min="0" max="100" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">%</span></div> <!></div></div></div>'),Sl=n('<span class="has-notes svelte-1hyfh06">Has notes</span>'),Cl=n('<div class="section-content svelte-1hyfh06"><textarea class="notes-input svelte-1hyfh06" placeholder="Record any deviations, substitutions, or observations..." rows="4"></textarea></div>'),Bl=n('<div class="saving-indicator svelte-1hyfh06"><span class="spinner svelte-1hyfh06"></span> Saving...</div>'),Fl=n('<div class="observations-card svelte-1hyfh06"><div class="card-header svelte-1hyfh06"><h3 class="card-title svelte-1hyfh06">Brew Day Log</h3> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Mash</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Pre-Boil</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Post-Boil / OG</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Brew Day Notes</span> <!> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <!></div>');function zl(De,i){Ut(i,!0);let g=U(Ze(i.batch.actual_mash_temp??null)),j=U(Ze(i.batch.actual_mash_ph??null)),N=U(Ze(i.batch.strike_water_volume??null)),A=U(Ze(i.batch.pre_boil_gravity??null)),E=U(Ze(i.batch.pre_boil_volume??null)),r=U(Ze(i.batch.post_boil_volume??null)),I=U(Ze(i.batch.measured_og??null)),k=U(Ze(i.batch.actual_efficiency??null)),Z=U(Ze(i.batch.brew_day_notes??"")),ge=U(!1),Se=U(null),w=U("mash"),X=H(Da),$=H(()=>i.recipe.mash_temp),ue=H(()=>i.recipe.og),z=H(()=>i.recipe.pre_boil_og),J=H(()=>i.recipe.batch_size_liters),Y=H(()=>i.recipe.efficiency);function ie(){if(!e(I)||!e(ue)||!e(Y))return null;const x=(e(I)-1)*1e3,C=(e(ue)-1)*1e3;return C===0?null:x/C*e(Y)}Sa(()=>{if(e(I)&&!e(k)){const x=ie();x&&c(k,Math.round(x*10)/10)}});async function D(){if(!e(ge)){c(ge,!0);try{const x={actual_mash_temp:e(g)??void 0,actual_mash_ph:e(j)??void 0,strike_water_volume:e(N)??void 0,pre_boil_gravity:e(A)??void 0,pre_boil_volume:e(E)??void 0,post_boil_volume:e(r)??void 0,measured_og:e(I)??void 0,actual_efficiency:e(k)??void 0,brew_day_notes:e(Z)||void 0},C=await fa(i.batch.id,x);c(Se,new Date,!0),i.onUpdate?.(C)}catch(x){console.error("Failed to save observations:",x)}finally{c(ge,!1)}}}function L(x){c(w,e(w)===x?null:x,!0)}var te=Fl(),ae=a(te),ye=s(a(ae),2);{var Me=x=>{var C=ul(),he=a(C);t(C),p(V=>u(he,`Saved ${V??""}`),[()=>e(Se).toLocaleTimeString()]),l(x,C)};o(ye,x=>{e(Se)&&x(Me)})}t(ae);var Ce=s(ae,2);let ne;var v=a(Ce);v.__click=()=>L("mash");var d=s(a(v),2),_=a(d);{var M=x=>{var C=_l(),he=a(C);t(C),p(V=>u(he,`${V??""}${e(X)??""}`),[()=>Ma(e(g))]),l(x,C)};o(_,x=>{e(g)&&x(M)})}var re=s(_,2);{var m=x=>{var C=pl(),he=a(C);t(C),p(V=>u(he,`pH ${V??""}`),[()=>e(j).toFixed(2)]),l(x,C)};o(re,x=>{e(j)&&x(m)})}t(d),be(2),t(v);var h=s(v,2);{var b=x=>{var C=gl(),he=a(C),V=a(he),de=s(a(V),2),T=a(de);kt(T);var W=s(T,2),fe=a(W,!0);t(W),t(de);var Be=s(de,2);{var Ue=Ae=>{var _t=fl(),je=a(_t);t(_t),p(Xe=>u(je,`Target: ${Xe??""}${e(X)??""}`),[()=>Ma(e($))]),l(Ae,_t)};o(Be,Ae=>{e($)&&Ae(Ue)})}t(V);var Ve=s(V,2),Ke=s(a(Ve),2),We=a(Ke);kt(We),t(Ke),be(2),t(Ve),t(he);var $e=s(he,2),Ye=a($e),et=s(a(Ye),2),dt=a(et);kt(dt),be(2),t(et),t(Ye),t($e),t(C),p(()=>u(fe,e(X))),xt("blur",T,D),ft(T,()=>e(g),Ae=>c(g,Ae)),xt("blur",We,D),ft(We,()=>e(j),Ae=>c(j,Ae)),xt("blur",dt,D),ft(dt,()=>e(N),Ae=>c(N,Ae)),l(x,C)};o(h,x=>{e(w)==="mash"&&x(b)})}t(Ce);var R=s(Ce,2);let B;var G=a(R);G.__click=()=>L("preboil");var Q=s(a(G),2),O=a(Q);{var ee=x=>{var C=hl(),he=a(C,!0);t(C),p(V=>u(he,V),[()=>wt(e(A))]),l(x,C)};o(O,x=>{e(A)&&x(ee)})}var K=s(O,2);{var se=x=>{var C=ml(),he=a(C);t(C),p(V=>u(he,`${V??""}L`),[()=>e(E).toFixed(1)]),l(x,C)};o(K,x=>{e(E)&&x(se)})}t(Q),be(2),t(G);var oe=s(G,2);{var xe=x=>{var C=yl(),he=a(C),V=a(he),de=s(a(V),2),T=a(de);kt(T),t(de);var W=s(de,2);{var fe=Ke=>{var We=bl(),$e=a(We);t(We),p(Ye=>u($e,`Target: ${Ye??""}`),[()=>wt(e(z))]),l(Ke,We)};o(W,Ke=>{e(z)&&Ke(fe)})}t(V);var Be=s(V,2),Ue=s(a(Be),2),Ve=a(Ue);kt(Ve),be(2),t(Ue),t(Be),t(he),t(C),xt("blur",T,D),ft(T,()=>e(A),Ke=>c(A,Ke)),xt("blur",Ve,D),ft(Ve,()=>e(E),Ke=>c(E,Ke)),l(x,C)};o(oe,x=>{e(w)==="preboil"&&x(xe)})}t(R);var ke=s(R,2);let ze;var Oe=a(ke);Oe.__click=()=>L("postboil");var we=s(a(Oe),2),le=a(we);{var f=x=>{var C=xl(),he=a(C,!0);t(C),p(V=>u(he,V),[()=>wt(e(I))]),l(x,C)};o(le,x=>{e(I)&&x(f)})}var y=s(le,2);{var F=x=>{var C=kl(),he=a(C);t(C),p(V=>u(he,`${V??""}% eff`),[()=>e(k).toFixed(0)]),l(x,C)};o(y,x=>{e(k)&&x(F)})}t(we),be(2),t(Oe);var S=s(Oe,2);{var q=x=>{var C=Ml(),he=a(C),V=a(he),de=s(a(V),2),T=a(de);kt(T),t(de);var W=s(de,2);{var fe=je=>{var Xe=wl(),Tt=a(Xe);t(Xe),p(va=>u(Tt,`Target: ${va??""}`),[()=>wt(e(ue))]),l(je,Xe)};o(W,je=>{e(ue)&&je(fe)})}t(V);var Be=s(V,2),Ue=s(a(Be),2),Ve=a(Ue);kt(Ve),be(2),t(Ue);var Ke=s(Ue,2);{var We=je=>{var Xe=jl(),Tt=a(Xe);t(Xe),p(va=>u(Tt,`Target: ${va??""}L`),[()=>e(J).toFixed(1)]),l(je,Xe)};o(Ke,je=>{e(J)&&je(We)})}t(Be),t(he);var $e=s(he,2),Ye=a($e),et=s(a(Ye),2),dt=a(et);kt(dt),be(2),t(et);var Ae=s(et,2);{var _t=je=>{var Xe=ql(),Tt=a(Xe);t(Xe),p(va=>u(Tt,`Target: ${va??""}%`),[()=>e(Y).toFixed(0)]),l(je,Xe)};o(Ae,je=>{e(Y)&&je(_t)})}t(Ye),t($e),t(C),xt("blur",T,D),ft(T,()=>e(I),je=>c(I,je)),xt("blur",Ve,D),ft(Ve,()=>e(r),je=>c(r,je)),xt("blur",dt,D),ft(dt,()=>e(k),je=>c(k,je)),l(x,C)};o(S,x=>{e(w)==="postboil"&&x(q)})}t(ke);var P=s(ke,2);let ve;var pe=a(P);pe.__click=()=>L("notes");var Te=s(a(pe),2);{var Re=x=>{var C=Sl();l(x,C)};o(Te,x=>{e(Z)&&x(Re)})}be(2),t(pe);var Je=s(pe,2);{var ut=x=>{var C=Cl(),he=a(C);Aa(he),t(C),xt("blur",he,D),ft(he,()=>e(Z),V=>c(Z,V)),l(x,C)};o(Je,x=>{e(w)==="notes"&&x(ut)})}t(P);var jt=s(P,2);{var zt=x=>{var C=Bl();l(x,C)};o(jt,x=>{e(ge)&&x(zt)})}t(te),p(()=>{ne=Ee(Ce,1,"section svelte-1hyfh06",null,ne,{expanded:e(w)==="mash"}),B=Ee(R,1,"section svelte-1hyfh06",null,B,{expanded:e(w)==="preboil"}),ze=Ee(ke,1,"section svelte-1hyfh06",null,ze,{expanded:e(w)==="postboil"}),ve=Ee(P,1,"section svelte-1hyfh06",null,ve,{expanded:e(w)==="notes"})}),l(De,te),Vt()}Yt(["click"]);var Tl=n('<span class="packaged-badge svelte-1yofiqc">Packaged</span>'),Al=n('<span class="save-indicator svelte-1yofiqc">Saved</span>'),Dl=n("<option> </option>"),Rl=n("<option> </option>"),Pl=n('<div class="field-row priming-row svelte-1yofiqc"><div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Priming Sugar Type</label> <input type="text" class="field-input svelte-1yofiqc" placeholder="e.g., table sugar, corn sugar"/></div> <div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Amount</label> <div class="input-with-unit svelte-1yofiqc"><input type="number" step="1" class="field-input svelte-1yofiqc" placeholder="--"/> <span class="unit svelte-1yofiqc">g</span></div></div></div>'),Nl=n('<div class="card-content svelte-1yofiqc"><div class="field-row svelte-1yofiqc"><div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Packaged On</label> <input type="date" class="field-input svelte-1yofiqc"/></div> <div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Package Type</label> <select class="field-input svelte-1yofiqc"><option>Select...</option><!></select></div></div> <div class="field-row svelte-1yofiqc"><div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Volume Packaged</label> <div class="input-with-unit svelte-1yofiqc"><input type="number" step="0.1" class="field-input svelte-1yofiqc" placeholder="--"/> <span class="unit svelte-1yofiqc">L</span></div></div> <div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Carbonation Method</label> <select class="field-input svelte-1yofiqc"><option>Select...</option><!></select></div></div> <!> <div class="field full-width svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Packaging Notes</label> <textarea class="notes-input svelte-1yofiqc" placeholder="Any observations about packaging day..." rows="3"></textarea></div></div>'),Ol=n('<div class="saving-indicator svelte-1yofiqc"><span class="spinner svelte-1yofiqc"></span> Saving...</div>'),Ll=n('<div class="packaging-card svelte-1yofiqc"><button type="button" class="card-header svelte-1yofiqc"><div class="header-content svelte-1yofiqc"><h3 class="card-title svelte-1yofiqc">Packaging</h3> <!></div> <div class="header-right svelte-1yofiqc"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div></button> <!> <!></div>');function El(De,i){Ut(i,!0);let g=U(Ze(i.batch.packaged_at?i.batch.packaged_at.split("T")[0]:"")),j=U(Ze(i.batch.packaging_type??"")),N=U(Ze(i.batch.packaging_volume??null)),A=U(Ze(i.batch.carbonation_method??"")),E=U(Ze(i.batch.priming_sugar_type??"")),r=U(Ze(i.batch.priming_sugar_amount??null)),I=U(Ze(i.batch.packaging_notes??"")),k=U(!1),Z=U(null),ge=U(!i.batch.packaged_at),Se=H(()=>e(A)==="bottle_conditioned"||e(A)==="keg_conditioned");async function w(){if(!e(k)){c(k,!0);try{const _={packaged_at:e(g)?new Date(e(g)).toISOString():void 0,packaging_type:e(j)||void 0,packaging_volume:e(N)??void 0,carbonation_method:e(A)||void 0,priming_sugar_type:e(Se)&&e(E)||void 0,priming_sugar_amount:e(Se)?e(r)??void 0:void 0,packaging_notes:e(I)||void 0},M=await fa(i.batch.id,_);c(Z,new Date,!0),i.onUpdate?.(M)}catch(_){console.error("Failed to save packaging info:",_)}finally{c(k,!1)}}}function X(){c(ge,!e(ge))}const $=[{value:"keg",label:"Keg"},{value:"bottles",label:"Bottles"},{value:"cans",label:"Cans"}],ue=[{value:"forced",label:"Force Carbonated"},{value:"bottle_conditioned",label:"Bottle Conditioned"},{value:"keg_conditioned",label:"Keg Conditioned"},{value:"natural",label:"Naturally Carbonated"}];var z=Ll(),J=a(z);J.__click=X;var Y=a(J),ie=s(a(Y),2);{var D=_=>{var M=Tl();l(_,M)};o(ie,_=>{i.batch.packaged_at&&_(D)})}t(Y);var L=s(Y,2),te=a(L);{var ae=_=>{var M=Al();l(_,M)};o(te,_=>{e(Z)&&_(ae)})}var ye=s(te,2);let Me;t(L),t(J);var Ce=s(J,2);{var ne=_=>{var M=Nl(),re=a(M),m=a(re),h=s(a(m),2);kt(h),t(m);var b=s(m,2),R=s(a(b),2);R.__change=w;var B=a(R);B.value=B.__value="";var G=s(B);Bt(G,17,()=>$,Ht,(f,y)=>{var F=Dl(),S=a(F,!0);t(F);var q={};p(()=>{u(S,e(y).label),q!==(q=e(y).value)&&(F.value=(F.__value=e(y).value)??"")}),l(f,F)}),t(R),t(b),t(re);var Q=s(re,2),O=a(Q),ee=s(a(O),2),K=a(ee);kt(K),be(2),t(ee),t(O);var se=s(O,2),oe=s(a(se),2);oe.__change=w;var xe=a(oe);xe.value=xe.__value="";var ke=s(xe);Bt(ke,17,()=>ue,Ht,(f,y)=>{var F=Rl(),S=a(F,!0);t(F);var q={};p(()=>{u(S,e(y).label),q!==(q=e(y).value)&&(F.value=(F.__value=e(y).value)??"")}),l(f,F)}),t(oe),t(se),t(Q);var ze=s(Q,2);{var Oe=f=>{var y=Pl(),F=a(y),S=s(a(F),2);kt(S),t(F);var q=s(F,2),P=s(a(q),2),ve=a(P);kt(ve),be(2),t(P),t(q),t(y),xt("blur",S,w),ft(S,()=>e(E),pe=>c(E,pe)),xt("blur",ve,w),ft(ve,()=>e(r),pe=>c(r,pe)),l(f,y)};o(ze,f=>{e(Se)&&f(Oe)})}var we=s(ze,2),le=s(a(we),2);Aa(le),t(we),t(M),xt("blur",h,w),ft(h,()=>e(g),f=>c(g,f)),Ta(R,()=>e(j),f=>c(j,f)),xt("blur",K,w),ft(K,()=>e(N),f=>c(N,f)),Ta(oe,()=>e(A),f=>c(A,f)),xt("blur",le,w),ft(le,()=>e(I),f=>c(I,f)),l(_,M)};o(Ce,_=>{e(ge)&&_(ne)})}var v=s(Ce,2);{var d=_=>{var M=Ol();l(_,M)};o(v,_=>{e(k)&&_(d)})}t(z),p(()=>Me=Ee(ye,0,"chevron svelte-1yofiqc",null,Me,{expanded:e(ge)})),l(De,z),Vt()}Yt(["click","change"]);var Il=n('<span class="note-count svelte-11n209s"> </span>'),Gl=n('<span class="avg-score svelte-11n209s"> </span>'),Hl=n('<button type="button" class="add-note-btn svelte-11n209s"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> Add Tasting Note</button>'),Ul=n('<button type="button"> </button>'),Vl=n('<div class="score-category svelte-11n209s"><div class="category-header svelte-11n209s"><span class="category-label svelte-11n209s"> </span> <div class="score-selector svelte-11n209s"></div></div> <textarea class="category-notes svelte-11n209s" rows="2"></textarea></div>'),Wl=n('<div class="note-form svelte-11n209s"><div class="form-header svelte-11n209s"><h4 class="svelte-11n209s"> </h4> <button type="button" class="close-btn svelte-11n209s"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <!> <div class="form-actions svelte-11n209s"><button type="button" class="cancel-btn svelte-11n209s">Cancel</button> <button type="button" class="save-btn svelte-11n209s"> </button></div></div>'),Xl=n('<div><span class="score-label svelte-11n209s"> </span> <span class="score-value svelte-11n209s"> </span></div>'),Jl=n('<p class="note-text svelte-11n209s"> </p>'),Kl=n('<div><div class="note-header svelte-11n209s"><span class="note-date svelte-11n209s"> </span> <div class="note-actions svelte-11n209s"><button type="button" class="action-btn svelte-11n209s" title="Edit"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button> <button type="button" class="action-btn delete svelte-11n209s" title="Delete"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div> <div class="note-scores svelte-11n209s"></div> <!></div>'),Yl=n('<div class="notes-list svelte-11n209s"></div>'),Ql=n('<p class="empty-message svelte-11n209s">No tasting notes yet. Add your first one to track how this batch develops over time.</p>'),Zl=n('<div class="card-content svelte-11n209s"><!> <!> <!></div>'),$l=n('<div class="tasting-card svelte-11n209s"><button type="button" class="card-header svelte-11n209s"><div class="header-content svelte-11n209s"><h3 class="card-title svelte-11n209s">Tasting Notes</h3> <!></div> <div class="header-right svelte-11n209s"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div></button> <!></div>');function ei(De,i){Ut(i,!0);let g=U(Ze(i.batch.tasting_notes??[])),j=U(!0),N=U(!1),A=U(null),E=U(!1),r=U(Ze({appearance_score:void 0,appearance_notes:"",aroma_score:void 0,aroma_notes:"",flavor_score:void 0,flavor_notes:"",mouthfeel_score:void 0,mouthfeel_notes:"",overall_score:void 0,overall_notes:""})),I=H(()=>()=>{if(e(g).length===0)return null;const v=e(g).filter(d=>d.overall_score!=null).map(d=>d.overall_score);return v.length===0?null:(v.reduce((d,_)=>d+_,0)/v.length).toFixed(1)});function k(){c(j,!e(j))}function Z(){c(r,{appearance_score:void 0,appearance_notes:"",aroma_score:void 0,aroma_notes:"",flavor_score:void 0,flavor_notes:"",mouthfeel_score:void 0,mouthfeel_notes:"",overall_score:void 0,overall_notes:""},!0),c(A,null),c(N,!1)}function ge(){Z(),c(N,!0)}function Se(v){c(r,{appearance_score:v.appearance_score??void 0,appearance_notes:v.appearance_notes??"",aroma_score:v.aroma_score??void 0,aroma_notes:v.aroma_notes??"",flavor_score:v.flavor_score??void 0,flavor_notes:v.flavor_notes??"",mouthfeel_score:v.mouthfeel_score??void 0,mouthfeel_notes:v.mouthfeel_notes??"",overall_score:v.overall_score??void 0,overall_notes:v.overall_notes??""},!0),c(A,v.id,!0),c(N,!0)}async function w(){if(!e(E)){c(E,!0);try{if(e(A)){const v=await xs(i.batch.id,e(A),e(r));c(g,e(g).map(d=>d.id===e(A)?v:d),!0)}else{const v=await ks(i.batch.id,e(r));c(g,[v,...e(g)],!0)}Z(),i.onUpdate?.({...i.batch,tasting_notes:e(g)})}catch(v){console.error("Failed to save tasting note:",v)}finally{c(E,!1)}}}async function X(v){if(confirm("Delete this tasting note?"))try{await ws(i.batch.id,v),c(g,e(g).filter(d=>d.id!==v),!0),i.onUpdate?.({...i.batch,tasting_notes:e(g)})}catch(d){console.error("Failed to delete tasting note:",d)}}function $(v){return new Date(v).toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric"})}function ue(v){return v==null?"-":"‚òÖ".repeat(v)+"‚òÜ".repeat(5-v)}var z=$l(),J=a(z);J.__click=k;var Y=a(J),ie=s(a(Y),2);{var D=v=>{var d=Il(),_=a(d,!0);t(d),p(()=>u(_,e(g).length)),l(v,d)};o(ie,v=>{e(g).length>0&&v(D)})}t(Y);var L=s(Y,2),te=a(L);{var ae=v=>{var d=Gl(),_=a(d);t(d),p(M=>u(_,`Avg: ${M??""}/5`),[()=>e(I)()]),l(v,d)};o(te,v=>{e(I)()&&v(ae)})}var ye=s(te,2);let Me;t(L),t(J);var Ce=s(J,2);{var ne=v=>{var d=Zl(),_=a(d);{var M=B=>{var G=Hl();G.__click=ge,l(B,G)};o(_,B=>{e(N)||B(M)})}var re=s(_,2);{var m=B=>{var G=Wl(),Q=a(G),O=a(Q),ee=a(O);t(O);var K=s(O,2);K.__click=Z,t(Q);var se=s(Q,2);Bt(se,16,()=>[{key:"appearance",label:"Appearance"},{key:"aroma",label:"Aroma"},{key:"flavor",label:"Flavor"},{key:"mouthfeel",label:"Mouthfeel"},{key:"overall",label:"Overall"}],Ht,(Oe,we)=>{var le=Vl(),f=a(le),y=a(f),F=a(y,!0);t(y);var S=s(y,2);Bt(S,20,()=>[1,2,3,4,5],Ht,(P,ve)=>{var pe=Ul();let Te;pe.__click=()=>{const Je=`${we.key}_score`;e(r)[Je]=ve};var Re=a(pe,!0);t(pe),p(()=>{Te=Ee(pe,1,"score-btn svelte-11n209s",null,Te,{selected:e(r)[`${we.key}_score`]===ve}),u(Re,ve)}),l(P,pe)}),t(S),t(f);var q=s(f,2);Aa(q),t(le),p(P=>{u(F,we.label),Kt(q,"placeholder",`Notes on ${P??""}...`)},[()=>we.label.toLowerCase()]),ft(q,()=>e(r)[`${we.key}_notes`],P=>e(r)[`${we.key}_notes`]=P),l(Oe,le)});var oe=s(se,2),xe=a(oe);xe.__click=Z;var ke=s(xe,2);ke.__click=w;var ze=a(ke,!0);t(ke),t(oe),t(G),p(()=>{u(ee,`${e(A)?"Edit":"New"} Tasting Note`),ke.disabled=e(E),u(ze,e(E)?"Saving...":e(A)?"Update":"Save")}),l(B,G)};o(re,B=>{e(N)&&B(m)})}var h=s(re,2);{var b=B=>{var G=Yl();Bt(G,21,()=>e(g),Ht,(Q,O)=>{var ee=Kl();let K;var se=a(ee),oe=a(se),xe=a(oe,!0);t(oe);var ke=s(oe,2),ze=a(ke);ze.__click=()=>Se(e(O));var Oe=s(ze,2);Oe.__click=()=>X(e(O).id),t(ke),t(se);var we=s(se,2);Bt(we,20,()=>[{key:"appearance",label:"App"},{key:"aroma",label:"Aroma"},{key:"flavor",label:"Flav"},{key:"mouthfeel",label:"Mouth"},{key:"overall",label:"Overall"}],Ht,(y,F)=>{var S=Xl();let q;var P=a(S),ve=a(P,!0);t(P);var pe=s(P,2),Te=a(pe,!0);t(pe),t(S),p(Re=>{q=Ee(S,1,"score-item svelte-11n209s",null,q,{overall:F.key==="overall"}),u(ve,F.label),u(Te,Re)},[()=>ue(e(O)[`${F.key}_score`])]),l(y,S)}),t(we);var le=s(we,2);{var f=y=>{var F=Jl(),S=a(F,!0);t(F),p(()=>u(S,e(O).overall_notes)),l(y,F)};o(le,y=>{e(O).overall_notes&&y(f)})}t(ee),p(y=>{K=Ee(ee,1,"note-item svelte-11n209s",null,K,{editing:e(A)===e(O).id}),u(xe,y)},[()=>$(e(O).tasted_at)]),l(Q,ee)}),t(G),l(B,G)},R=B=>{var G=He(),Q=ce(G);{var O=ee=>{var K=Ql();l(ee,K)};o(Q,ee=>{e(N)||ee(O)},!0)}l(B,G)};o(h,B=>{e(g).length>0?B(b):B(R,!1)})}t(d),l(v,d)};o(Ce,v=>{e(j)&&v(ne)})}t(z),p(()=>Me=Ee(ye,0,"chevron svelte-11n209s",null,Me,{expanded:e(j)})),l(De,z),Vt()}Yt(["click"]);var ti=n('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),ai=n('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),si=n('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),ri=n('<span class="recipe-type svelte-g5au2j"> </span>'),li=n('<a class="recipe-link svelte-g5au2j"> <!></a>'),ii=n('<div class="batch-timing svelte-g5au2j"> </div>'),ni=n('<div class="batch-timing svelte-g5au2j"> </div>'),vi=n('<option class="svelte-g5au2j"> </option>'),oi=ga('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" class="svelte-g5au2j"></path><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Resume',1),di=ga('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Pause',1),ci=n('<button type="button"><!></button>'),ui=n('<span class="chilling-icon svelte-g5au2j">üç∫</span> <h3 class="chilling-title svelte-g5au2j">Ready to Pitch!</h3>',1),_i=n('<span class="chilling-icon svelte-g5au2j">‚ùÑÔ∏è</span> <h3 class="chilling-title svelte-g5au2j">Chilling to Pitch Temperature</h3>',1),pi=n('<div class="progress-section svelte-g5au2j"><div class="progress-bar svelte-g5au2j"><div class="progress-fill svelte-g5au2j"></div></div> <span class="progress-text svelte-g5au2j"> </span></div>'),fi=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è No cooler configured - set a cooler entity to enable automated chilling</span>'),gi=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è Temperature control disabled in settings</span>'),hi=n('<span class="status-ready svelte-g5au2j">Wort has reached pitch temperature - ready to add yeast!</span>'),mi=n('<span class="status-active svelte-g5au2j">Cooler will run automatically when temp exceeds target + hysteresis</span>'),bi=n('<div><div class="chilling-header svelte-g5au2j"><!></div> <div class="chilling-content svelte-g5au2j"><div class="temp-display svelte-g5au2j"><div class="temp-current svelte-g5au2j"><span class="temp-label svelte-g5au2j">Current</span> <span class="temp-value svelte-g5au2j"> </span></div> <div class="temp-arrow svelte-g5au2j">‚Üí</div> <div class="temp-target svelte-g5au2j"><span class="temp-label svelte-g5au2j">Target</span> <span class="temp-value svelte-g5au2j"> </span></div></div> <!> <div class="chilling-status svelte-g5au2j"><!></div></div></div>'),yi=n(`<div class="paused-banner svelte-g5au2j"><div class="paused-header svelte-g5au2j"><svg class="paused-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> <h3 class="paused-title svelte-g5au2j">Readings Paused</h3></div> <p class="paused-text svelte-g5au2j">Hydrometer readings are not being stored. Live readings still display but won't be saved to the fermentation history.</p> <button type="button" class="resume-btn svelte-g5au2j"> </button></div>`),xi=n('<span class="btn-spinner svelte-g5au2j"></span> Starting...',1),ki=ga('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" class="svelte-g5au2j"></path><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Start Brew Day',1),wi=n(`<div class="planning-phase svelte-g5au2j"><div class="phase-action-card svelte-g5au2j"><div class="phase-icon svelte-g5au2j">üìã</div> <h2 class="phase-title svelte-g5au2j">Ready to Brew?</h2> <p class="phase-description svelte-g5au2j">Review your recipe below, then start brew day when you're ready to begin.</p> <button type="button" class="start-brewday-btn svelte-g5au2j"><!></button></div> <!></div>`),ji=n('<span class="btn-spinner svelte-g5au2j"></span> Starting...',1),qi=ga('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" class="svelte-g5au2j"></path></svg> Yeast Pitched - Start Fermentation',1),Mi=n(`<div class="brewing-phase svelte-g5au2j"><div class="phase-action-card brewing svelte-g5au2j"><div class="phase-icon svelte-g5au2j">üç∫</div> <h2 class="phase-title svelte-g5au2j">Brew Day in Progress</h2> <p class="phase-description svelte-g5au2j">Track your brew day activities. When you've pitched the yeast and fermentation begins, transition to the fermentation phase.</p> <button type="button" class="start-fermentation-btn svelte-g5au2j"><!></button></div> <div class="brewday-tools-grid svelte-g5au2j"><!> <!></div> <!> <!> <!></div>`),Si=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot brewing svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Brew Day</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Ci=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot fermenting svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Fermentation Started</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Bi=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot conditioning svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Conditioning Started</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Fi=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot completed svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Completed</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),zi=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot packaged svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j"> </span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Ti=n('<div class="completed-phase svelte-g5au2j"><div class="batch-summary-card svelte-g5au2j"><h2 class="summary-title svelte-g5au2j">Batch Complete</h2> <div class="summary-stats svelte-g5au2j"><div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Original Gravity</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Final Gravity</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">ABV</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Attenuation</span> <span class="stat-value svelte-g5au2j"><!></span></div></div></div> <div class="timeline-card svelte-g5au2j"><h3 class="timeline-title svelte-g5au2j">Batch Timeline</h3> <div class="timeline svelte-g5au2j"><!> <!> <!> <!> <!></div></div> <!> <!> <!></div>'),Ai=n('<span class="status-badge heater svelte-g5au2j">üî• Heating</span>'),Di=n('<span class="status-badge cooler svelte-g5au2j">‚ùÑÔ∏è Cooling</span>'),Ri=n('<span class="status-badge idle svelte-g5au2j"> </span>'),Pi=n('<div class="device-status heater svelte-g5au2j"><div>üî•</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Heater</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Ni=n('<div class="device-status cooler svelte-g5au2j"><div>‚ùÑÔ∏è</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Cooler</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Oi=n('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">‚ö°</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),Li=n('<button type="button" class="override-btn heat-on svelte-g5au2j">Force Heat ON</button> <button type="button" class="override-btn heat-off svelte-g5au2j">Force Heat OFF</button>',1),Ei=n('<button type="button" class="override-btn cool-on svelte-g5au2j">Force Cool ON</button> <button type="button" class="override-btn cool-off svelte-g5au2j">Force Cool OFF</button>',1),Ii=n('<div class="control-details svelte-g5au2j"><div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns-grid svelte-g5au2j"><!> <!> <button type="button" class="override-btn auto-mode svelte-g5au2j">Auto Mode</button></div></div>',1),Gi=n('<div class="device-status-grid svelte-g5au2j"><!> <!></div> <!>',1),Hi=n('<div><button type="button" class="collapsible-header svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="collapse-indicator svelte-g5au2j"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" class="svelte-g5au2j"></path></svg></div></button> <!></div>'),Ui=n('<span class="svelte-g5au2j"> </span>'),Vi=n('<span class="svelte-g5au2j"> </span>'),Wi=n('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><!> <!> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),Xi=n('<div class="chart-section svelte-g5au2j"><!></div>'),Ji=n('<div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!> <!></div></div> <!>',1),Ki=n('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <!> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j" aria-label="Delete batch"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <!> <!> <!>',1),Yi=n('<div class="modal-overlay svelte-g5au2j" role="presentation"><div class="modal svelte-g5au2j" role="dialog" aria-modal="true" aria-labelledby="delete-modal-title" tabindex="-1"><h2 id="delete-modal-title" class="modal-title svelte-g5au2j">Delete Batch?</h2> <p class="modal-text svelte-g5au2j"> </p> <div class="modal-actions svelte-g5au2j"><button type="button" class="modal-btn cancel svelte-g5au2j">Cancel</button> <button type="button" class="modal-btn delete svelte-g5au2j"> </button></div></div></div>'),Qi=n('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div> <!>',1);function xn(De,i){Ut(i,!0);const g=()=>_s(ps,"$page",j),[j,N]=us();let A=null,E=null,r=U(null),I=U(null),k=U(null),Z=Ze([]),ge=U(!0),Se=U(null),w=U(!1),X=U(!1),$=U(!1),ue=U(!1),z=U(!1),J=U(!1),Y=U(!1),ie=H(()=>parseInt(g().params.id??"0"));const D=["planning","brewing","fermenting","conditioning","completed","archived"];let L=H(()=>e(r)?Fa[e(r).status]:Fa.planning),te=H(Da),ae=H(()=>qa.config.ha_enabled&&qa.config.temp_control_enabled&&(e(r)?.heater_entity_id||e(r)?.cooler_entity_id)),ye=H(()=>e(r)?.status==="planning"&&e(r)?.temp_target!=null),Me=H(()=>!e(ye)||!e(ne)?.temp||!e(r)?.temp_target?!1:e(ne).temp<=e(r).temp_target),Ce=H(()=>{if(!e(ye)||!e(ne)?.temp||!e(r)?.temp_target)return null;const f=e(r).temp_target+30,y=e(ne).temp,F=e(r).temp_target;if(y<=F)return 100;if(y>=f)return 0;const S=(f-y)/(f-F)*100;return Math.min(100,Math.max(0,S))}),ne=H(()=>{if(!e(r)?.device_id)return null;const f=Ha.tilts.get(e(r).device_id);if(f)return f;const y=e(r).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!y?.[1])return null;const F=y[1].toUpperCase();for(const S of Ha.tilts.values())if(S.color&&S.color.toUpperCase()===F)return S;return null});async function v(){c(ge,!0),c(Se,null);try{if(c(r,await js(e(ie)),!0),e(r).status==="fermenting"||e(r).status==="conditioning"||e(r).status==="completed")try{c(I,await Ca(e(ie)),!0)}catch{}if(e(r).heater_entity_id||e(r).cooler_entity_id)try{c(k,await ja(e(ie)),!0)}catch{}}catch(f){c(Se,f instanceof Error?f.message:"Failed to load batch",!0)}finally{c(ge,!1)}}async function d(f){if(!(!e(r)||e(X))&&!(f==="conditioning"&&e(r).status==="fermenting"&&!confirm(`üí° Entering Conditioning Phase

Reminder: Adjust target temperature if cold crashing.
Temperature control will continue during conditioning.

Continue?`))){c(X,!0);try{c(r,await fa(e(r).id,{status:f}),!0),(f==="fermenting"||f==="conditioning")&&c(I,await Ca(e(r).id),!0)}catch(y){console.error("Failed to update status:",y)}finally{c(X,!1)}}}async function _(){if(!(!e(r)||e(X))){c(X,!0);try{c(r,await fa(e(r).id,{status:"brewing"}),!0)}catch(f){console.error("Failed to start brew day:",f)}finally{c(X,!1)}}}async function M(){if(!(!e(r)||e(X))){c(X,!0);try{c(r,await fa(e(r).id,{status:"fermenting"}),!0),c(I,await Ca(e(r).id),!0)}catch(f){console.error("Failed to start fermentation:",f)}finally{c(X,!1)}}}async function re(f){if(e(r)&&(c(r,await fa(e(r).id,f),!0),c(w,!1),e(r).heater_entity_id||e(r).cooler_entity_id))try{c(k,await ja(e(r).id),!0)}catch{}}async function m(){if(e(r)){c(z,!0);try{await qs(e(r).id),fs("/batches")}catch(f){c(Se,f instanceof Error?f.message:"Failed to delete batch",!0),c(z,!1),c(ue,!1)}}}async function h(){if(!(!e(r)||e(Y))){c(Y,!0);try{c(r,await fa(e(r).id,{readings_paused:!e(r).readings_paused}),!0)}catch(f){console.error("Failed to toggle pause:",f)}finally{c(Y,!1)}}}async function b(f,y){if(!(!e(r)||e($))){c($,!0);try{await Ba(e(r).id,y,60,f),c(k,await ja(e(r).id),!0)}catch(F){console.error("Failed to set override:",F)}finally{c($,!1)}}}async function R(){if(!(!e(r)||e($))){c($,!0);try{e(r).heater_entity_id&&await Ba(e(r).id,null,60,"heater"),e(r).cooler_entity_id&&await Ba(e(r).id,null,60,"cooler"),c(k,await ja(e(r).id),!0)}catch(f){console.error("Failed to clear overrides:",f)}finally{c($,!1)}}}function B(){if(A?.readyState===WebSocket.OPEN)return;const y=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;A=new WebSocket(y),A.onmessage=async F=>{try{const S=JSON.parse(F.data);S.type==="control_event"&&S.batch_id===e(ie)&&e(k)&&(S.action==="heat_on"?c(k,{...e(k),heater_state:"on"},!0):S.action==="heat_off"?c(k,{...e(k),heater_state:"off"},!0):S.action==="cool_on"?c(k,{...e(k),cooler_state:"on"},!0):S.action==="cool_off"&&c(k,{...e(k),cooler_state:"off"},!0))}catch{}},A.onclose=()=>{A=null,E=setTimeout(B,3e3)},A.onerror=()=>{A?.close()}}function G(){E&&(clearTimeout(E),E=null),A?.close(),A=null}function Q(f){return f==null?"--":wt(f)}function O(f){return f==null?"--":Ma(f)}function ee(f){return f?new Date(f).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"--"}function K(f){if(!f)return"--";const y=new Date(f),S=(new Date().getTime()-y.getTime())/(1e3*60*60);if(S<1)return`${Math.round(S*60)}m`;if(S<24)return`${S.toFixed(1)}h`;const q=S/24;return q<7?`${q.toFixed(1)}d`:`${Math.round(q)}d`}function se(f){return f?new Date(f).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"}):"--"}Wa(()=>{v(),B()}),ls(()=>{G()});var oe=Qi();vs("g5au2j",f=>{is(()=>{ns.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var xe=ce(oe),ke=s(a(xe),2);{var ze=f=>{var y=ti();l(f,y)},Oe=f=>{var y=He(),F=ce(y);{var S=P=>{var ve=ai(),pe=s(a(ve),2),Te=a(pe,!0);t(pe);var Re=s(pe,2);Re.__click=v,t(ve),p(()=>u(Te,e(Se))),l(P,ve)},q=P=>{var ve=He(),pe=ce(ve);{var Te=Je=>{var ut=si();l(Je,ut)},Re=Je=>{var ut=He(),jt=ce(ut);{var zt=C=>{Ms(C,{get batch(){return e(r)},onSubmit:re,onCancel:()=>c(w,!1)})},x=C=>{var he=Ki(),V=ce(he),de=a(V),T=a(de),W=a(T);t(T);var fe=s(T,2),Be=a(fe),Ue=a(Be,!0);t(Be);var Ve=s(Be,2);{var Ke=Fe=>{var me=li(),Le=a(me),tt=s(Le);{var it=lt=>{var Qe=ri(),nt=a(Qe);t(Qe),p(()=>u(nt,`(${e(r).recipe.type??""})`)),l(lt,Qe)};o(tt,lt=>{e(r).recipe.type&&lt(it)})}t(me),p(()=>{Kt(me,"href",`/recipes/${e(r).recipe.id??""}`),u(Le,`${e(r).recipe.name??""} `)}),l(Fe,me)};o(Ve,Fe=>{e(r).recipe&&Fe(Ke)})}var We=s(Ve,2);{var $e=Fe=>{var me=ii(),Le=a(me);t(me),p((tt,it)=>u(Le,`Started ${tt??""} ¬∑ ${it??""} ago`),[()=>ee(e(r).start_time),()=>K(e(r).start_time)]),l(Fe,me)},Ye=Fe=>{var me=He(),Le=ce(me);{var tt=it=>{var lt=ni(),Qe=a(lt);t(lt),p(nt=>u(Qe,`Brewed ${nt??""}`),[()=>ee(e(r).brew_date)]),l(it,lt)};o(Le,it=>{e(r).brew_date&&it(tt)},!0)}l(Fe,me)};o(We,Fe=>{e(r).start_time?Fe($e):Fe(Ye,!1)})}t(fe),t(de);var et=s(de,2),dt=a(et),Ae=a(dt);Ae.__change=Fe=>d(Fe.currentTarget.value),Bt(Ae,21,()=>D,Ht,(Fe,me)=>{var Le=vi(),tt=a(Le,!0);t(Le);var it={};p(()=>{u(tt,Fa[e(me)].label),it!==(it=e(me))&&(Le.value=(Le.__value=e(me))??"")}),l(Fe,Le)}),t(Ae);var _t;ds(Ae),t(dt);var je=s(dt,2);{var Xe=Fe=>{var me=ci();let Le;me.__click=h;var tt=a(me);{var it=Qe=>{var nt=oi();be(),l(Qe,nt)},lt=Qe=>{var nt=di();be(),l(Qe,nt)};o(tt,Qe=>{e(r).readings_paused?Qe(it):Qe(lt,!1)})}t(me),p(()=>{Le=Ee(me,1,"pause-btn svelte-g5au2j",null,Le,{paused:e(r).readings_paused}),me.disabled=e(Y),Kt(me,"title",e(r).readings_paused?"Resume storing readings":"Pause storing readings")}),l(Fe,me)};o(je,Fe=>{(e(r).status==="fermenting"||e(r).status==="conditioning")&&Fe(Xe)})}var Tt=s(je,2);Tt.__click=()=>c(w,!0);var va=s(Tt,2);va.__click=()=>c(ue,!0),t(et),t(V);var Ra=s(V,2);{var Ja=Fe=>{var me=bi();let Le;var tt=a(me),it=a(tt);{var lt=Ie=>{var st=ui();be(2),l(Ie,st)},Qe=Ie=>{var st=_i();be(2),l(Ie,st)};o(it,Ie=>{e(Me)?Ie(lt):Ie(Qe,!1)})}t(tt);var nt=s(tt,2),At=a(nt),vt=a(At),gt=s(a(vt),2),Wt=a(gt,!0);t(gt),t(vt);var mt=s(vt,4),Dt=s(a(mt),2),Xt=a(Dt,!0);t(Dt),t(mt),t(At);var Qt=s(At,2);{var oa=Ie=>{var st=pi(),qe=a(st),bt=a(qe);t(qe);var sa=s(qe,2),Pt=a(sa);t(sa),t(st),p(Jt=>{Ft(bt,`width: ${e(Ce)??""}%`),u(Pt,`${Jt??""}% to target`)},[()=>Math.round(e(Ce))]),l(Ie,st)};o(Qt,Ie=>{e(Ce)!=null&&!e(Me)&&Ie(oa)})}var Rt=s(Qt,2),Zt=a(Rt);{var $t=Ie=>{var st=fi();l(Ie,st)},ea=Ie=>{var st=He(),qe=ce(st);{var bt=Pt=>{var Jt=gi();l(Pt,Jt)},sa=Pt=>{var Jt=He(),da=ce(Jt);{var Pe=ht=>{var qt=hi();l(ht,qt)},ot=ht=>{var qt=mi();l(ht,qt)};o(da,ht=>{e(Me)?ht(Pe):ht(ot,!1)},!0)}l(Pt,Jt)};o(qe,Pt=>{!qa.config.ha_enabled||!qa.config.temp_control_enabled?Pt(bt):Pt(sa,!1)},!0)}l(Ie,st)};o(Zt,Ie=>{e(r).cooler_entity_id?Ie(ea,!1):Ie($t)})}t(Rt),t(nt),t(me),p((Ie,st)=>{Le=Ee(me,1,"chilling-banner svelte-g5au2j",null,Le,{ready:e(Me)}),u(Wt,Ie),u(Xt,st)},[()=>e(ne)?.temp!=null?O(e(ne).temp):"--",()=>e(r).temp_target!=null?O(e(r).temp_target):"--"]),l(Fe,me)};o(Ra,Fe=>{e(ye)&&Fe(Ja)})}var Pa=s(Ra,2);{var Ka=Fe=>{var me=yi(),Le=s(a(me),4);Le.__click=h;var tt=a(Le,!0);t(Le),t(me),p(()=>{Le.disabled=e(Y),u(tt,e(Y)?"Resuming...":"Resume Readings")}),l(Fe,me)};o(Pa,Fe=>{e(r).readings_paused&&(e(r).status==="fermenting"||e(r).status==="conditioning")&&Fe(Ka)})}var Ya=s(Pa,2);{var Qa=Fe=>{var me=wi(),Le=a(me),tt=s(a(Le),6);tt.__click=_;var it=a(tt);{var lt=vt=>{var gt=xi();be(),l(vt,gt)},Qe=vt=>{var gt=ki();be(),l(vt,gt)};o(it,vt=>{e(X)?vt(lt):vt(Qe,!1)})}t(tt),t(Le);var nt=s(Le,2);{var At=vt=>{za(vt,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};o(nt,vt=>{e(r).recipe&&vt(At)})}t(me),p(()=>tt.disabled=e(X)),l(Fe,me)},Za=Fe=>{var me=He(),Le=ce(me);{var tt=lt=>{var Qe=Mi(),nt=a(Qe),At=s(a(nt),6);At.__click=M;var vt=a(At);{var gt=qe=>{var bt=ji();be(),l(qe,bt)},Wt=qe=>{var bt=qi();be(),l(qe,bt)};o(vt,qe=>{e(X)?qe(gt):qe(Wt,!1)})}t(At),t(nt);var mt=s(nt,2),Dt=a(mt);{var Xt=qe=>{rl(qe,{get recipe(){return e(r).recipe}})};o(Dt,qe=>{e(r).recipe&&qe(Xt)})}var Qt=s(Dt,2);{var oa=qe=>{cl(qe,{get recipe(){return e(r).recipe},get batchId(){return e(r).id}})};o(Qt,qe=>{e(r).recipe&&qe(oa)})}t(mt);var Rt=s(mt,2);{var Zt=qe=>{zl(qe,{get batch(){return e(r)},get recipe(){return e(r).recipe},onUpdate:bt=>c(r,bt,!0)})};o(Rt,qe=>{e(r).recipe&&qe(Zt)})}var $t=s(Rt,2);{var ea=qe=>{Ua(qe,{get batch(){return e(r)},get liveReading(){return e(ne)},onEdit:()=>c(w,!0)})};o($t,qe=>{e(r).device_id&&qe(ea)})}var Ie=s($t,2);{var st=qe=>{za(qe,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};o(Ie,qe=>{e(r).recipe&&qe(st)})}t(Qe),p(()=>At.disabled=e(X)),l(lt,Qe)},it=lt=>{var Qe=He(),nt=ce(Qe);{var At=gt=>{var Wt=Ti(),mt=a(Wt),Dt=s(a(mt),2),Xt=a(Dt),Qt=s(a(Xt),2),oa=a(Qt,!0);t(Qt),t(Xt);var Rt=s(Xt,2),Zt=s(a(Rt),2),$t=a(Zt,!0);t(Zt),t(Rt);var ea=s(Rt,2),Ie=s(a(ea),2),st=a(Ie);t(Ie),t(ea);var qe=s(ea,2),bt=s(a(qe),2),sa=a(bt);{var Pt=_e=>{var Ne=na();p(Ge=>u(Ne,`${Ge??""}%`),[()=>((e(r).measured_og-e(r).measured_fg)/(e(r).measured_og-1)*100).toFixed(0)]),l(_e,Ne)},Jt=_e=>{var Ne=na("--");l(_e,Ne)};o(sa,_e=>{e(r).measured_og&&e(r).measured_fg?_e(Pt):_e(Jt,!1)})}t(bt),t(qe),t(Dt),t(mt);var da=s(mt,2),Pe=s(a(da),2),ot=a(Pe);{var ht=_e=>{var Ne=Si(),Ge=s(a(Ne),2),at=s(a(Ge),2),St=a(at,!0);t(at),t(Ge),t(Ne),p(yt=>u(St,yt),[()=>se(e(r).brewing_started_at||e(r).brew_date)]),l(_e,Ne)};o(ot,_e=>{(e(r).brew_date||e(r).brewing_started_at)&&_e(ht)})}var qt=s(ot,2);{var ra=_e=>{var Ne=Ci(),Ge=s(a(Ne),2),at=s(a(Ge),2),St=a(at,!0);t(at),t(Ge),t(Ne),p(yt=>u(St,yt),[()=>se(e(r).fermenting_started_at||e(r).start_time)]),l(_e,Ne)};o(qt,_e=>{(e(r).start_time||e(r).fermenting_started_at)&&_e(ra)})}var ta=s(qt,2);{var ha=_e=>{var Ne=Bi(),Ge=s(a(Ne),2),at=s(a(Ge),2),St=a(at,!0);t(at),t(Ge),t(Ne),p(yt=>u(St,yt),[()=>se(e(r).conditioning_started_at)]),l(_e,Ne)};o(ta,_e=>{e(r).conditioning_started_at&&_e(ha)})}var ca=s(ta,2);{var ka=_e=>{var Ne=Fi(),Ge=s(a(Ne),2),at=s(a(Ge),2),St=a(at,!0);t(at),t(Ge),t(Ne),p(yt=>u(St,yt),[()=>se(e(r).completed_at||e(r).end_time)]),l(_e,Ne)};o(ca,_e=>{(e(r).end_time||e(r).completed_at)&&_e(ka)})}var ma=s(ca,2);{var wa=_e=>{var Ne=zi(),Ge=s(a(Ne),2),at=a(Ge),St=a(at);t(at);var yt=s(at,2),ct=a(yt,!0);t(yt),t(Ge),t(Ne),p(pt=>{u(St,`Packaged (${(e(r).packaging_type||"kegged")??""})`),u(ct,pt)},[()=>se(e(r).packaged_at)]),l(_e,Ne)};o(ma,_e=>{e(r).packaged_at&&_e(wa)})}t(Pe),t(da);var Nt=s(da,2);El(Nt,{get batch(){return e(r)},onUpdate:_e=>c(r,_e,!0)});var rt=s(Nt,2);ei(rt,{get batch(){return e(r)},onUpdate:_e=>c(r,_e,!0)});var Mt=s(rt,2);{var ua=_e=>{Va(_e,{get notes(){return e(r).notes}})};o(Mt,_e=>{e(r).notes&&_e(ua)})}t(Wt),p((_e,Ne,Ge)=>{u(oa,_e),u($t,Ne),u(st,`${Ge??""}%`)},[()=>Q(e(r).measured_og),()=>Q(e(r).measured_fg),()=>e(r).measured_abv?.toFixed(1)??"--"]),l(gt,Wt)},vt=gt=>{var Wt=Ji(),mt=ce(Wt),Dt=a(mt),Xt=a(Dt);{let Pe=H(()=>e(ne)?.sg??e(I)?.measured?.current_sg);Hs(Xt,{get batch(){return e(r)},get currentSg(){return e(Pe)},get progress(){return e(I)},get liveReading(){return e(ne)}})}var Qt=s(Xt,2);{var oa=Pe=>{za(Pe,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};o(Qt,Pe=>{e(r).recipe&&Pe(oa)})}t(Dt);var Rt=s(Dt,2),Zt=a(Rt);Ua(Zt,{get batch(){return e(r)},get liveReading(){return e(ne)},onEdit:()=>c(w,!0)});var $t=s(Zt,2);{var ea=Pe=>{Wr(Pe,{get batchId(){return e(r).id}})};o($t,Pe=>{(e(r).status==="fermenting"||e(r).status==="conditioning")&&Pe(ea)})}var Ie=s($t,2);{let Pe=H(()=>e(r).measured_fg??e(I)?.measured?.fg),ot=H(()=>e(ne)?.sg??e(I)?.measured?.current_sg);Or(Ie,{get batchId(){return e(r).id},get batchStatus(){return e(r).status},get measuredOg(){return e(r).measured_og},get measuredFg(){return e(Pe)},get currentSg(){return e(ot)},get liveReading(){return e(ne)}})}var st=s(Ie,2);{var qe=Pe=>{var ot=Hi();let ht;var qt=a(ot);qt.__click=()=>c(J,!e(J));var ra=s(a(qt),2),ta=a(ra);{var ha=rt=>{var Mt=Ai();l(rt,Mt)},ca=rt=>{var Mt=He(),ua=ce(Mt);{var _e=Ge=>{var at=Di();l(Ge,at)},Ne=Ge=>{var at=He(),St=ce(at);{var yt=ct=>{var pt=Ri(),Ot=a(pt);t(pt),p(Lt=>u(Ot,`üéØ ${Lt??""}${e(te)??""}`),[()=>O(e(k).target_temp)]),l(ct,pt)};o(St,ct=>{e(J)&&e(k)&&ct(yt)},!0)}l(Ge,at)};o(ua,Ge=>{e(k)?.cooler_state==="on"?Ge(_e):Ge(Ne,!1)},!0)}l(rt,Mt)};o(ta,rt=>{e(k)?.heater_state==="on"?rt(ha):rt(ca,!1)})}var ka=s(ta,2);let ma;t(ra),t(qt);var wa=s(qt,2);{var Nt=rt=>{var Mt=Gi(),ua=ce(Mt),_e=a(ua);{var Ne=ct=>{var pt=Pi(),Ot=a(pt);let Lt;var la=s(Ot,2),Et=s(a(la),2);let ia;var ba=a(Et,!0);t(Et);var _a=s(Et,2),ya=a(_a,!0);t(_a),t(la),t(pt),p(()=>{Lt=Ee(Ot,1,"device-icon-wrap svelte-g5au2j",null,Lt,{active:e(k)?.heater_state==="on"}),ia=Ee(Et,1,"device-state svelte-g5au2j",null,ia,{on:e(k)?.heater_state==="on"}),u(ba,e(k)?.heater_state==="on"?"ON":"OFF"),u(ya,e(r).heater_entity_id)}),l(ct,pt)};o(_e,ct=>{e(r).heater_entity_id&&ct(Ne)})}var Ge=s(_e,2);{var at=ct=>{var pt=Ni(),Ot=a(pt);let Lt;var la=s(Ot,2),Et=s(a(la),2);let ia;var ba=a(Et,!0);t(Et);var _a=s(Et,2),ya=a(_a,!0);t(_a),t(la),t(pt),p(()=>{Lt=Ee(Ot,1,"device-icon-wrap svelte-g5au2j",null,Lt,{active:e(k)?.cooler_state==="on"}),ia=Ee(Et,1,"device-state svelte-g5au2j",null,ia,{on:e(k)?.cooler_state==="on"}),u(ba,e(k)?.cooler_state==="on"?"ON":"OFF"),u(ya,e(r).cooler_entity_id)}),l(ct,pt)};o(Ge,ct=>{e(r).cooler_entity_id&&ct(at)})}t(ua);var St=s(ua,2);{var yt=ct=>{var pt=Ii(),Ot=ce(pt),Lt=a(Ot),la=s(a(Lt),2),Et=a(la);t(la),t(Lt);var ia=s(Lt,2),ba=s(a(ia),2),_a=a(ba);t(ba),t(ia),t(Ot);var ya=s(Ot,2);{var $a=Ct=>{var It=Oi(),Gt=s(a(It),2),pa=a(Gt);t(Gt);var Ga=s(Gt,2);Ga.__click=()=>R(),t(It),p(as=>{u(pa,`Override active: ${as??""}`),Ga.disabled=e($)},[()=>e(k).override_state?.toUpperCase()]),l(Ct,It)};o(ya,Ct=>{e(k).override_active&&Ct($a)})}var Na=s(ya,2),Oa=s(a(Na),2),La=a(Oa);{var es=Ct=>{var It=Li(),Gt=ce(It);Gt.__click=()=>b("heater","on");var pa=s(Gt,2);pa.__click=()=>b("heater","off"),p(()=>{Gt.disabled=e($),pa.disabled=e($)}),l(Ct,It)};o(La,Ct=>{e(r).heater_entity_id&&Ct(es)})}var Ea=s(La,2);{var ts=Ct=>{var It=Ei(),Gt=ce(It);Gt.__click=()=>b("cooler","on");var pa=s(Gt,2);pa.__click=()=>b("cooler","off"),p(()=>{Gt.disabled=e($),pa.disabled=e($)}),l(Ct,It)};o(Ea,Ct=>{e(r).cooler_entity_id&&Ct(ts)})}var Ia=s(Ea,2);Ia.__click=()=>R(),t(Oa),t(Na),p((Ct,It)=>{u(Et,`${Ct??""}${e(te)??""}`),u(_a,`¬±${It??""}${e(te)??""}`),Ia.disabled=e($)},[()=>O(e(k).target_temp),()=>e(k).hysteresis?.toFixed(1)||"--"]),l(ct,pt)};o(St,ct=>{e(k)&&ct(yt)})}l(rt,Mt)};o(wa,rt=>{e(J)||rt(Nt)})}t(ot),p(()=>{ht=Ee(ot,1,"info-card temp-control-card svelte-g5au2j",null,ht,{"heater-on":e(k)?.heater_state==="on","cooler-on":e(k)?.cooler_state==="on",collapsed:e(J)}),ma=Ee(ka,0,"chevron svelte-g5au2j",null,ma,{rotated:!e(J)})}),l(Pe,ot)},bt=Pe=>{var ot=He(),ht=ce(ot);{var qt=ra=>{var ta=Wi(),ha=s(a(ta),2),ca=a(ha);{var ka=Nt=>{var rt=Ui(),Mt=a(rt);t(rt),p(()=>u(Mt,`Heater: ${e(r).heater_entity_id??""}`)),l(Nt,rt)};o(ca,Nt=>{e(r).heater_entity_id&&Nt(ka)})}var ma=s(ca,2);{var wa=Nt=>{var rt=Vi(),Mt=a(rt);t(rt),p(()=>u(Mt,`Cooler: ${e(r).cooler_entity_id??""}`)),l(Nt,rt)};o(ma,Nt=>{e(r).cooler_entity_id&&Nt(wa)})}be(2),t(ha),t(ta),l(ra,ta)};o(ht,ra=>{(e(r).heater_entity_id||e(r).cooler_entity_id)&&e(r).status!=="fermenting"&&ra(qt)},!0)}l(Pe,ot)};o(st,Pe=>{e(ae)&&(e(r).status==="fermenting"||e(r).status==="conditioning")?Pe(qe):Pe(bt,!1)})}var sa=s(st,2);{var Pt=Pe=>{Va(Pe,{get notes(){return e(r).notes}})};o(sa,Pe=>{e(r).notes&&Pe(Pt)})}t(Rt),t(mt);var Jt=s(mt,2);{var da=Pe=>{var ot=Xi(),ht=a(ot);Cs(ht,{get batchId(){return e(r).id},get deviceColor(){return e(r).device_id},get originalGravity(){return e(r).measured_og},get controlEvents(){return Z}}),t(ot),l(Pe,ot)};o(Jt,Pe=>{e(r).device_id&&Pe(da)})}l(gt,Wt)};o(nt,gt=>{e(r).status==="completed"?gt(At):gt(vt,!1)},!0)}l(lt,Qe)};o(Le,lt=>{e(r).status==="brewing"?lt(tt):lt(it,!1)},!0)}l(Fe,me)};o(Ya,Fe=>{e(r).status==="planning"?Fe(Qa):Fe(Za,!1)})}p(()=>{u(W,`#${(e(r).batch_number||"?")??""}`),u(Ue,e(r).name||e(r).recipe?.name||"Unnamed Batch"),Ae.disabled=e(X),Ft(Ae,`color: ${e(L).color??""}; background: ${e(L).bg??""};`),_t!==(_t=e(r).status)&&(Ae.value=(Ae.__value=e(r).status)??"",cs(Ae,e(r).status))}),l(C,he)};o(jt,C=>{e(w)?C(zt):C(x,!1)},!0)}l(Je,ut)};o(pe,Je=>{e(r)?Je(Re,!1):Je(Te)},!0)}l(P,ve)};o(F,P=>{e(Se)?P(S):P(q,!1)},!0)}l(f,y)};o(ke,f=>{e(ge)?f(ze):f(Oe,!1)})}t(xe);var we=s(xe,2);{var le=f=>{var y=Yi();y.__click=()=>c(ue,!1),y.__keydown=Re=>Re.key==="Escape"&&c(ue,!1);var F=a(y);F.__click=Re=>Re.stopPropagation(),F.__keydown=Re=>Re.stopPropagation();var S=s(a(F),2),q=a(S);t(S);var P=s(S,2),ve=a(P);ve.__click=()=>c(ue,!1);var pe=s(ve,2);pe.__click=m;var Te=a(pe,!0);t(pe),t(P),t(F),t(y),p(()=>{u(q,`Are you sure you want to delete "${(e(r)?.name||"this batch")??""}"? This cannot be undone.`),ve.disabled=e(z),pe.disabled=e(z),u(Te,e(z)?"Deleting...":"Delete Batch")}),l(f,y)};o(we,f=>{e(ue)&&f(le)})}l(De,oe),Vt(),N()}Yt(["click","change","keydown"]);export{xn as component,yn as universal};
