import{d as Na,f as i,s as o,a as l,c as je,t as Aa,h as Xa}from"../chunks/BPY3LF1i.js";import{d as t,e as r,r as a,t as d,a as Da,f as T,h as e,u as C,n as Te,g as Pa,s as ye,p as Ka,o as ut,c as _,az as Mt,aJ as Rt,aC as St,ax as Bt}from"../chunks/WzhiZOZ9.js";import{e as Ha,i as Za}from"../chunks/DnC7am1E.js";import{i as v}from"../chunks/DTo_ih-i.js";import{h as At}from"../chunks/BJzfFUzm.js";import{s as fa}from"../chunks/D5Ox4mlS.js";import{s as Ze}from"../chunks/BYYdgBsh.js";import{s as da}from"../chunks/6KfV5OBv.js";import{b as Tt,i as Dt,s as Pt}from"../chunks/BX-VZZUc.js";import{s as Ot,a as Et}from"../chunks/fcLv_oK9.js";import{p as Lt}from"../chunks/BhWD6fDY.js";import{g as Gt}from"../chunks/Z0qgmlGA.js";import{a8 as Nt,a9 as Ut,aa as It,ab as Ht,ac as Vt,X as Wt,S as dt,ad as Ua,a3 as Jt,Q as Ja,ae as Ya}from"../chunks/K3YiLSbk.js";import{b as ga,d as _t,g as gt,c as Ia}from"../chunks/Dhf-mfqW.js";import{t as ct}from"../chunks/DGrXzhna.js";import{B as Yt}from"../chunks/B3n1llnb.js";import{s as Qt}from"../chunks/sGHY5uTo.js";import{p as pa}from"../chunks/AVMQxM7Q.js";import{F as Xt}from"../chunks/BYbR5wwK.js";import{s as Qa}from"../chunks/BuoPMR_v.js";const Kt=!1,jl=Object.freeze(Object.defineProperty({__proto__:null,prerender:Kt},Symbol.toStringTag,{value:"Module"}));function Zt(we){return we>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:we>=-60?{bars:3,color:"var(--positive)",label:"Good"}:we>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function pt(we){const n=Math.floor((Date.now()-new Date(we).getTime())/1e3);if(n<10)return"just now";if(n<60)return`${n}s ago`;const B=Math.floor(n/60);if(B<60)return`${B}m ago`;const ee=Math.floor(B/60);return ee<24?`${ee}h ago`:`${Math.floor(ee/24)}d ago`}var $t=i('<div class="accent-bar svelte-1oyrwd9"></div>'),es=i('<span class="card-icon svelte-1oyrwd9"> </span>'),as=i('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),ts=i('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function Ta(we,n){let B=pa(n,"highlight",3,!1),ee=pa(n,"compact",3,!1),H=pa(n,"collapsible",3,!1),V=pa(n,"expanded",3,!1);var L=ts();let s;var E=t(L);{var m=q=>{var F=$t();l(q,F)};v(E,q=>{B()&&q(m)})}var W=r(E,2),fe=t(W),ke=t(fe);{var k=q=>{var F=es(),Q=t(F,!0);a(F),d(()=>o(Q,n.icon)),l(q,F)};v(ke,q=>{n.icon&&q(k)})}var le=r(ke,2),S=t(le,!0);a(le),a(fe);var de=r(fe,2);{var y=q=>{var F=as();F.__click=function(...ve){n.onToggle?.apply(this,ve)};var Q=t(F);let I;a(F),d(()=>{fa(F,"aria-label",V()?"Collapse":"Expand"),I=Ze(Q,0,"expand-icon svelte-1oyrwd9",null,I,{"rotate-180":V()})}),l(q,F)};v(de,q=>{H()&&n.onToggle&&q(y)})}a(W);var G=r(W,2);let N;var U=t(G);Qt(U,()=>n.children),a(G),a(L),d(()=>{s=Ze(L,1,"batch-card svelte-1oyrwd9",null,s,{highlight:B(),compact:ee()}),o(S,n.title),N=Ze(G,1,"card-content svelte-1oyrwd9",null,N,{collapsed:H()&&!V()})}),l(we,L)}Na(["click"]);var ss=i('<span class="updated-text svelte-t80j9z"> </span>'),rs=i('<div class="hero-divider svelte-t80j9z"></div> <div class="hero-metric temperature svelte-t80j9z"><span class="hero-value svelte-t80j9z"> <span class="hero-unit svelte-t80j9z"> </span></span> <span class="hero-label svelte-t80j9z">Temperature</span></div>',1),ls=i('<div class="remaining-text svelte-t80j9z"> </div>'),ns=i('<div class="progress-section svelte-t80j9z"><div class="progress-labels svelte-t80j9z"><div class="progress-endpoint start svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">OG</span></div> <div class="progress-current svelte-t80j9z"><span class="current-percent svelte-t80j9z"> </span></div> <div class="progress-endpoint end svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">Target FG</span></div></div> <div class="progress-track svelte-t80j9z"><div class="progress-fill svelte-t80j9z"></div> <div><div class="marker-dot svelte-t80j9z"></div> <div class="marker-value svelte-t80j9z"> </div></div></div> <!></div>'),is=i('<div class="metrics-row svelte-t80j9z"><div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">ABV</span></div> <div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">Attenuation</span></div></div>'),vs=i('<div class="status-row svelte-t80j9z"><div class="live-indicator svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> <span class="status-text svelte-t80j9z">LIVE</span></div> <!></div> <div class="hero-section svelte-t80j9z"><div class="hero-metric gravity svelte-t80j9z"><span class="hero-value svelte-t80j9z"> </span> <span class="hero-label svelte-t80j9z">Gravity</span></div> <!></div> <!> <!>',1),os=i('<div class="completed-grid svelte-t80j9z"><div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Original Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Final Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">ABV</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Attenuation</span></div></div>'),ds=i('<div class="empty-state svelte-t80j9z"><div class="empty-icon svelte-t80j9z">‚óé</div> <p class="empty-text svelte-t80j9z">Set Original Gravity to track fermentation</p></div>');function cs(we,n){Da(n,!0);let B=C(()=>n.currentSg??n.progress?.measured?.current_sg),ee=C(()=>n.liveReading?.temp??n.progress?.temperature?.current),H=C(()=>n.liveReading?.last_seen),V=C(()=>e(H)?pt(e(H)):null),L=C(gt),s=C(()=>{if(!n.batch.measured_og||!e(B))return null;const k=Math.max(0,(n.batch.measured_og-e(B))*131.25),le=n.batch.measured_og-1,S=le!==0?Math.max(0,Math.min(100,(n.batch.measured_og-e(B))/le*100)):0;return{abv:k,attenuation:S}}),E=C(()=>{const k=n.batch.measured_og,le=n.batch.recipe?.fg;if(!k||!le||!e(B))return null;const S=k-le,de=k-e(B);return S<=0?null:Math.max(0,Math.min(100,de/S*100))}),m=C(()=>n.batch.status==="fermenting"||n.batch.status==="conditioning");function W(k){return k==null?"--":ga(k)}function fe(k){return k==null?"--":`${k.toFixed(1)}%`}function ke(k){return k==null?"--":_t(k)}Ta(we,{title:"Fermentation",children:(k,le)=>{var S=je(),de=T(S);{var y=N=>{var U=vs(),q=T(U),F=r(t(q),2);{var Q=z=>{var c=ss(),p=t(c);a(c),d(()=>o(p,`Updated ${e(V)??""}`)),l(z,c)};v(F,z=>{e(V)&&z(Q)})}a(q);var I=r(q,2),ve=t(I),ge=t(ve),Me=t(ge,!0);a(ge),Te(2),a(ve);var J=r(ve,2);{var me=z=>{var c=rs(),p=r(T(c),2),R=t(p),A=t(R,!0),ae=r(A),oe=t(ae,!0);a(ae),a(R),Te(2),a(p),d(X=>{o(A,X),o(oe,e(L))},[()=>ke(e(ee))]),l(z,c)};v(J,z=>{e(ee)!=null&&z(me)})}a(I);var g=r(I,2);{var w=z=>{var c=ns(),p=t(c),R=t(p),A=t(R),ae=t(A,!0);a(A),Te(2),a(R);var oe=r(R,2),X=t(oe),qe=t(X);a(X),a(oe);var ce=r(oe,2),Be=t(ce),ze=t(Be,!0);a(Be),Te(2),a(ce),a(p);var Oe=r(p,2),Ge=t(Oe),u=r(Ge,2);let M;var K=r(t(u),2),h=t(K,!0);a(K),a(u),a(Oe);var Z=r(Oe,2);{var ie=te=>{var se=ls(),P=t(se);a(se),d(O=>o(P,`${O??""} points to go`),[()=>n.progress.progress.sg_remaining.toFixed(3)]),l(te,se)};v(Z,te=>{n.progress?.progress?.sg_remaining!=null&&n.progress.progress.sg_remaining>0&&te(ie)})}a(c),d((te,se,P,O)=>{o(ae,te),o(qe,`${se??""}%`),o(ze,P),da(Ge,`width: ${e(E)??""}%`),M=Ze(u,1,"progress-marker svelte-t80j9z",null,M,{"at-start":e(E)<3}),da(u,`left: ${e(E)??""}%`),o(h,O)},[()=>W(n.batch.measured_og),()=>e(E).toFixed(0),()=>W(n.batch.recipe.fg),()=>W(e(B))]),l(z,c)};v(g,z=>{e(E)!==null&&n.batch.measured_og&&n.batch.recipe?.fg&&z(w)})}var ne=r(g,2);{var be=z=>{var c=is(),p=t(c),R=t(p),A=t(R,!0);a(R),Te(2),a(p);var ae=r(p,2),oe=t(ae),X=t(oe,!0);a(oe),Te(2),a(ae),a(c),d((qe,ce)=>{o(A,qe),o(X,ce)},[()=>fe(e(s).abv),()=>fe(e(s).attenuation)]),l(z,c)};v(ne,z=>{e(s)&&z(be)})}d(z=>o(Me,z),[()=>W(e(B))]),l(N,U)},G=N=>{var U=je(),q=T(U);{var F=I=>{const ve=C(()=>n.batch.measured_fg??n.progress?.measured?.fg??n.progress?.measured?.current_sg),ge=C(()=>n.batch.measured_abv??n.progress?.measured?.abv),Me=C(()=>n.batch.measured_attenuation??n.progress?.measured?.attenuation);var J=os(),me=t(J),g=t(me),w=t(g,!0);a(g),Te(2),a(me);var ne=r(me,2),be=t(ne),z=t(be,!0);a(be),Te(2),a(ne);var c=r(ne,2),p=t(c),R=t(p,!0);a(p),Te(2),a(c);var A=r(c,2),ae=t(A),oe=t(ae,!0);a(ae),Te(2),a(A),a(J),d((X,qe,ce,Be)=>{o(w,X),o(z,qe),o(R,ce),o(oe,Be)},[()=>W(n.batch.measured_og),()=>W(e(ve)),()=>e(ge)!=null?fe(e(ge)):"--",()=>e(Me)!=null?fe(e(Me)):"--"]),l(I,J)},Q=I=>{var ve=ds();l(I,ve)};v(q,I=>{n.batch.measured_og?I(F):I(Q,!1)},!0)}l(N,U)};v(de,N=>{e(B)&&e(m)?N(y):N(G,!1)})}l(k,S)},$$slots:{default:!0}}),Pa()}var us=i('<span class="device-last-seen svelte-1kdxwtz"> </span>'),_s=i('<div class="signal-bar svelte-1kdxwtz"></div>'),gs=i('<div class="metric-item svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="metric-text svelte-1kdxwtz"> </span></div>'),ps=i('<div class="metric-item battery svelte-1kdxwtz"><svg class="battery-icon svelte-1kdxwtz" viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="2" y="7" width="18" height="10" rx="2"></rect><rect x="4" y="9" height="6" stroke="none" rx="1"></rect><path d="M20 10v4h2v-4z" stroke="none"></path></svg> <span class="metric-text svelte-1kdxwtz"><!></span></div>'),fs=i('<div class="device-metrics svelte-1kdxwtz"><!> <!></div>'),ms=i('<div class="device-row svelte-1kdxwtz"><div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!></div> <!>',1),hs=i('<div class="device-row svelte-1kdxwtz"><div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <span class="device-last-seen svelte-1kdxwtz">No data</span></div>'),bs=i('<div class="device-info svelte-1kdxwtz"><!></div>'),xs=i('<button type="button" class="link-btn svelte-1kdxwtz">Link device</button>'),ys=i('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function js(we,n){Da(n,!0);let B=C(()=>n.liveReading?.device_type==="tilt"),ee=C(()=>e(B)&&n.liveReading?.rssi?Zt(n.liveReading.rssi):null),H=C(()=>n.liveReading?.last_seen?pt(n.liveReading.last_seen):null),V=C(()=>n.liveReading?.battery_percent!=null||n.liveReading?.battery_voltage!=null),L=C(()=>n.liveReading?.battery_percent),s=C(()=>n.liveReading?.battery_voltage),E=C(()=>e(L)?e(L)>50?"var(--positive)":e(L)>20?"var(--warning)":"var(--negative)":"var(--text-muted)"),m=C(()=>{if(!n.liveReading)return n.batch.device_id||"Unknown";const W=n.liveReading.device_type;return W==="tilt"?`${n.liveReading.color} Tilt`:W==="gravitymon"?`GravityMon (${n.liveReading.id})`:W==="ispindel"?`iSpindel (${n.liveReading.id})`:W==="floaty"?`Floaty (${n.liveReading.id})`:n.liveReading.color||n.liveReading.id});Ta(we,{title:"Tracking Device",compact:!0,children:(W,fe)=>{var ke=je(),k=T(ke);{var le=de=>{var y=bs(),G=t(y);{var N=q=>{var F=ms(),Q=T(F),I=t(Q),ve=r(t(I));a(I);var ge=r(I,2);{var Me=g=>{var w=us(),ne=t(w,!0);a(w),d(()=>o(ne,e(H))),l(g,w)};v(ge,g=>{e(H)&&g(Me)})}a(Q);var J=r(Q,2);{var me=g=>{var w=fs(),ne=t(w);{var be=p=>{var R=gs(),A=t(R);Ha(A,20,()=>Array(4),Za,(X,qe,ce)=>{var Be=_s();d(()=>da(Be,`height: ${4+ce*2}px; background: ${(ce<e(ee).bars?e(ee).color:"var(--bg-hover)")??""}; opacity: ${ce<e(ee).bars?1:.4};`)),l(X,Be)}),a(A);var ae=r(A,2),oe=t(ae);a(ae),a(R),d(()=>{da(ae,`color: ${e(ee).color??""}`),o(oe,`${n.liveReading.rssi??""}dBm`)}),l(p,R)};v(ne,p=>{e(ee)&&p(be)})}var z=r(ne,2);{var c=p=>{var R=ps(),A=t(R),ae=r(t(A)),oe=r(ae);a(A);var X=r(A,2),qe=t(X);{var ce=ze=>{var Oe=Aa();d(Ge=>o(Oe,`${Ge??""}%`),[()=>e(L).toFixed(0)]),l(ze,Oe)},Be=ze=>{var Oe=je(),Ge=T(Oe);{var u=M=>{var K=Aa();d(h=>o(K,`${h??""}V`),[()=>e(s).toFixed(2)]),l(M,K)};v(Ge,M=>{e(s)!=null&&M(u)},!0)}l(ze,Oe)};v(qe,ze=>{e(L)!=null?ze(ce):ze(Be,!1)})}a(X),a(R),d(()=>{fa(A,"stroke",e(E)),fa(ae,"width",(e(L)??50)*.14),fa(ae,"fill",e(E)),fa(oe,"fill",e(E)),da(X,`color: ${e(E)??""}`)}),l(p,R)};v(z,p=>{e(V)&&p(c)})}a(w),l(g,w)};v(J,g=>{(e(ee)||e(V))&&g(me)})}d(()=>o(ve,` ${e(m)??""}`)),l(q,F)},U=q=>{var F=hs(),Q=t(F),I=r(t(Q));a(Q),Te(2),a(F),d(()=>o(I,` ${n.batch.device_id??""}`)),l(q,F)};v(G,q=>{n.liveReading?q(N):q(U,!1)})}a(y),l(de,y)},S=de=>{var y=ys(),G=r(t(y),2);{var N=U=>{var q=xs();q.__click=function(...F){n.onEdit?.apply(this,F)},l(U,q)};v(G,U=>{n.onEdit&&U(N)})}a(y),l(de,y)};v(k,de=>{n.batch.device_id?de(le):de(S,!1)})}l(W,ke)},$$slots:{default:!0}}),Pa()}Na(["click"]);const ws=131.25;var ks=i('<span class="yeast-producer svelte-19u9n31"> </span>'),qs=i('<span class="yeast-temp svelte-19u9n31"> </span>'),zs=i('<div class="yeast-row recipe svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Recipe</span> <span class="yeast-value muted svelte-19u9n31"> </span></div>'),Fs=i('<div class="yeast-row actual svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span> <!> <!></div> <!>',1),Cs=i('<div class="yeast-row svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span></div>'),Ms=i('<div class="yeast-section svelte-19u9n31"><!></div>'),Rs=i('<div class="targets-row svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div></div> <!>',1);function Ss(we,n){Da(n,!0);function B(H){return H==null?"--":ga(H)}let ee=C(()=>n.recipe.abv!=null?n.recipe.abv:n.recipe.og&&n.recipe.fg?(n.recipe.og-n.recipe.fg)*ws:null);Ta(we,{title:"Recipe Targets",compact:!0,children:(H,V)=>{var L=Rs(),s=T(L),E=t(s),m=r(t(E),2),W=t(m,!0);a(m),a(E);var fe=r(E,2),ke=r(t(fe),2),k=t(ke,!0);a(ke),a(fe);var le=r(fe,2),S=r(t(le),2),de=t(S,!0);a(S),a(le),a(s);var y=r(s,2);{var G=N=>{var U=Ms(),q=t(U);{var F=I=>{var ve=Fs(),ge=T(ve),Me=r(t(ge),2),J=t(Me,!0);a(Me);var me=r(Me,2);{var g=c=>{var p=ks(),R=t(p);a(p),d(()=>o(R,`(${n.yeastStrain.producer??""})`)),l(c,p)};v(me,c=>{n.yeastStrain.producer&&c(g)})}var w=r(me,2);{var ne=c=>{var p=qs(),R=t(p);a(p),d((A,ae)=>o(R,`${A??""}-${ae??""}¬∞C`),[()=>n.yeastStrain.temp_low.toFixed(0),()=>n.yeastStrain.temp_high.toFixed(0)]),l(c,p)};v(w,c=>{n.yeastStrain.temp_low&&n.yeastStrain.temp_high&&c(ne)})}a(ge);var be=r(ge,2);{var z=c=>{var p=zs(),R=r(t(p),2),A=t(R,!0);a(R),a(p),d(()=>o(A,n.recipe.yeast_name)),l(c,p)};v(be,c=>{n.recipe.yeast_name&&c(z)})}d(()=>o(J,n.yeastStrain.name)),l(I,ve)},Q=I=>{var ve=je(),ge=T(ve);{var Me=J=>{var me=Cs(),g=r(t(me),2),w=t(g,!0);a(g),a(me),d(()=>o(w,n.recipe.yeast_name)),l(J,me)};v(ge,J=>{n.recipe.yeast_name&&J(Me)},!0)}l(I,ve)};v(q,I=>{n.yeastStrain?I(F):I(Q,!1)})}a(U),l(N,U)};v(y,N=>{(n.yeastStrain||n.recipe.yeast_name)&&N(G)})}d((N,U,q)=>{o(W,N),o(k,U),o(de,q)},[()=>B(n.recipe.og),()=>B(n.recipe.fg),()=>e(ee)!=null?`${e(ee).toFixed(1)}%`:"--"]),l(H,L)},$$slots:{default:!0}}),Pa()}var Bs=i('<p class="notes-content svelte-hkv31i"> </p>');function As(we,n){Ta(we,{title:"Notes",children:(B,ee)=>{var H=Bs(),V=t(H,!0);a(H),d(()=>o(V,n.notes)),l(B,H)},$$slots:{default:!0}})}var Ts=i('<div class="ml-panel loading svelte-1xs394q"><p> </p></div>'),Ds=i('<div class="ml-panel error svelte-1xs394q"><p class="error-text svelte-1xs394q"> </p></div>'),Ps=i("<option> </option>"),Os=i('<div class="header-controls svelte-1xs394q"><select class="model-select svelte-1xs394q" title="Select prediction model"></select> <button type="button" class="reload-btn svelte-1xs394q" title="Recalculate predictions from database history"> </button></div>'),Es=i('<span class="accuracy-icon svelte-1xs394q">‚úì</span> <span class="accuracy-title svelte-1xs394q">Excellent Prediction</span>',1),Ls=i('<span class="accuracy-icon svelte-1xs394q">‚âà</span> <span class="accuracy-title svelte-1xs394q">Close Prediction</span>',1),Gs=i('<span class="accuracy-icon svelte-1xs394q">‚ñ≥</span> <span class="accuracy-title svelte-1xs394q">Prediction Variance</span>',1),Ns=i('<div><div class="accuracy-header svelte-1xs394q"><!></div> <p class="accuracy-detail svelte-1xs394q"> <span class="accuracy-diff svelte-1xs394q"> </span></p></div>'),Us=i('<span class="comparison-predicted svelte-1xs394q"> </span>'),Is=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model:</span> <span class="model-value model-type svelte-1xs394q"> </span></div>'),Hs=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),Vs=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),Ws=i('<div class="summary-section svelte-1xs394q"><!> <div class="comparison-grid svelte-1xs394q"><div class="comparison-item svelte-1xs394q"><span class="comparison-label svelte-1xs394q">Final Gravity</span> <div class="comparison-values svelte-1xs394q"><span class="comparison-actual svelte-1xs394q"> </span> <!></div></div></div> <div class="model-info summary-model svelte-1xs394q"><!> <!> <!></div></div>'),Js=i('<span class="anomaly-reasons svelte-1xs394q"> </span>'),Ys=i('<div class="anomaly-banner svelte-1xs394q"><span class="anomaly-icon svelte-1xs394q">‚ö†Ô∏è</span> <div class="anomaly-content svelte-1xs394q"><span class="anomaly-label svelte-1xs394q">Anomaly Detected</span> <!></div></div>'),Qs=i('<span class="activity-badge svelte-1xs394q"> </span>'),Xs=i('<div class="progress-section svelte-1xs394q"><div class="progress-header svelte-1xs394q"><span class="progress-label svelte-1xs394q">Fermentation Progress</span> <!></div> <div class="fermentation-progress-bar svelte-1xs394q"><div class="fermentation-fill svelte-1xs394q"></div></div> <div class="progress-labels svelte-1xs394q"><span class="og-label svelte-1xs394q"> </span> <span class="progress-percent svelte-1xs394q"> </span> <span class="fg-label svelte-1xs394q"> </span></div></div>'),Ks=i('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Predicted FG:</span> <span class="value svelte-1xs394q"> </span></div>'),Zs=i('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Attenuation:</span> <span class="value attenuation svelte-1xs394q"> </span></div>'),$s=i('<span class="complete-now svelte-1xs394q">Ready now!</span>'),er=i('<span class="days svelte-1xs394q"> </span>'),ar=i(" <!>",1),tr=i('<div class="metric completion-metric svelte-1xs394q"><span class="label svelte-1xs394q">Est. Completion:</span> <span class="value svelte-1xs394q"><!></span></div>'),sr=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model:</span> <span class="model-value model-type svelte-1xs394q"> </span></div>'),rr=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),lr=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),nr=i('<!> <!> <div class="metrics svelte-1xs394q"><!> <!> <!> <div class="model-info svelte-1xs394q"><!> <!> <!></div></div>',1),ir=i('<div><div class="panel-header svelte-1xs394q"><h3 class="panel-title svelte-1xs394q"> </h3> <!></div> <!></div>'),vr=i('<div class="ml-panel disabled svelte-1xs394q"><div class="disabled-header svelte-1xs394q"><p class="unavailable-text svelte-1xs394q"> </p> <button type="button" class="reload-btn svelte-1xs394q" title="Reload predictions from database"> </button></div> <p class="unavailable-hint svelte-1xs394q"><!></p></div>');function or(we,n){Da(n,!0);let B=pa(n,"batchStatus",3,"fermenting"),ee=pa(n,"measuredOg",3,null),H=pa(n,"measuredFg",3,null),V=pa(n,"currentSg",3,null),L=pa(n,"liveReading",3,null),s=ye(Ka({available:!1})),E=ye(!0),m=ye(!1),W=ye(null),fe=ye("auto");const ke=[{value:"auto",label:"Auto (Best Fit)"},{value:"exponential",label:"Exponential"},{value:"gompertz",label:"Gompertz (S-Curve)"},{value:"logistic",label:"Logistic"}];let k=C(()=>B()==="completed"||B()==="archived"),le=C(()=>H()??V()),S=C(()=>{if(!e(k)||!e(s).predicted_fg||!e(le))return null;const g=Math.abs(e(s).predicted_fg-e(le)),w=Math.round(g*1e3);return{diff:g,points:w,isAccurate:w<=2,isClose:w<=5}});async function de(){_(E,!0),_(W,null);try{_(s,await Ut(n.batchId,e(fe)),!0)}catch(g){_(W,g instanceof Error?g.message:"Failed to load predictions",!0),console.error("Failed to load ML predictions:",g)}finally{_(E,!1)}}async function y(){_(m,!0),_(W,null);try{const g=await Nt(n.batchId);console.log("Reloaded predictions:",g.message),await de()}catch(g){_(W,g instanceof Error?g.message:"Failed to reload predictions",!0),console.error("Failed to reload predictions:",g)}finally{_(m,!1)}}function G(){de()}ut(y);function N(g){return g?new Date(g).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}):"N/A"}function U(g){if(!g)return null;const w=new Date(g),ne=new Date,be=w.getTime()-ne.getTime();return Math.ceil(be/(1e3*60*60*24))}let q=C(()=>{const g=ee()??e(s).predicted_og,w=e(s).predicted_fg,ne=V()??L()?.sg;if(!g||!w||!ne||g<=w)return null;const be=g-w,c=(g-ne)/be*100;return Math.min(100,Math.max(0,c))}),F=C(()=>{const g=ee()??e(s).predicted_og,w=V()??L()?.sg;if(!g||!w||g<=1)return null;const ne=(g-w)/(g-1)*100;return Math.min(100,Math.max(0,ne))}),Q=C(()=>{const g=L()?.sg_rate;if(g==null)return null;const w=Math.abs(g);return w>.002?{label:"Very Active",color:"var(--activity-very-active)",emoji:"üî•"}:w>5e-4?{label:"Active",color:"var(--activity-active)",emoji:"‚ú®"}:w>1e-4?{label:"Slowing",color:"var(--activity-slowing)",emoji:"üê¢"}:{label:"Complete",color:"var(--activity-complete)",emoji:"‚úì"}}),I=C(()=>L()?.is_anomaly??!1),ve=C(()=>L()?.anomaly_reasons??[]);var ge=je(),Me=T(ge);{var J=g=>{var w=Ts(),ne=t(w),be=t(ne);a(ne),a(w),d(()=>o(be,`Loading ${e(k)?"summary":"predictions"}...`)),l(g,w)},me=g=>{var w=je(),ne=T(w);{var be=c=>{var p=Ds(),R=t(p),A=t(R);a(R),a(p),d(()=>o(A,`‚ö†Ô∏è ${e(W)??""}`)),l(c,p)},z=c=>{var p=je(),R=T(p);{var A=oe=>{var X=ir();let qe;var ce=t(X),Be=t(ce),ze=t(Be,!0);a(Be);var Oe=r(Be,2);{var Ge=h=>{var Z=Os(),ie=t(Z);ie.__change=G,Ha(ie,21,()=>ke,Za,(P,O)=>{var he=Ps(),Je=t(he,!0);a(he);var $e={};d(()=>{o(Je,e(O).label),$e!==($e=e(O).value)&&(he.value=(he.__value=e(O).value)??"")}),l(P,he)}),a(ie);var te=r(ie,2);te.__click=y;var se=t(te,!0);a(te),a(Z),d(()=>{ie.disabled=e(E)||e(m),te.disabled=e(m)||e(E),o(se,e(m)?"Reloading...":"‚Üª")}),Tt(ie,()=>e(fe),P=>_(fe,P)),l(h,Z)};v(Oe,h=>{e(k)||h(Ge)})}a(ce);var u=r(ce,2);{var M=h=>{var Z=Ws(),ie=t(Z);{var te=ue=>{var _e=Ns();let x;var b=t(_e),Y=t(b);{var Re=Ne=>{var Ie=Es();Te(2),l(Ne,Ie)},Ue=Ne=>{var Ie=je(),qa=T(Ie);{var ta=Ee=>{var la=Ls();Te(2),l(Ee,la)},ua=Ee=>{var la=Gs();Te(2),l(Ee,la)};v(qa,Ee=>{e(S).isClose?Ee(ta):Ee(ua,!1)},!0)}l(Ne,Ie)};v(Y,Ne=>{e(S).isAccurate?Ne(Re):Ne(Ue,!1)})}a(b);var Xe=r(b,2),aa=t(Xe),De=r(aa),xe=t(De);a(De),a(Xe),a(_e),d((Ne,Ie)=>{x=Ze(_e,1,"accuracy-banner svelte-1xs394q",null,x,{accurate:e(S).isAccurate,close:e(S).isClose&&!e(S).isAccurate}),o(aa,`Model predicted ${Ne??""}, actual was ${Ie??""} `),o(xe,`(${e(S).points??""} points ${e(s).predicted_fg&&e(s).predicted_fg>e(le)?"high":"low"})`)},[()=>ga(e(s).predicted_fg??0),()=>ga(e(le))]),l(ue,_e)};v(ie,ue=>{e(S)&&e(le)&&ue(te)})}var se=r(ie,2),P=t(se),O=r(t(P),2),he=t(O),Je=t(he,!0);a(he);var $e=r(he,2);{var Ye=ue=>{var _e=Us(),x=t(_e);a(_e),d(b=>o(x,`ML: ${b??""}`),[()=>ga(e(s).predicted_fg)]),l(ue,_e)};v($e,ue=>{e(s).predicted_fg&&ue(Ye)})}a(O),a(P),a(se);var Qe=r(se,2),ea=t(Qe);{var wa=ue=>{var _e=Is(),x=r(t(_e),2),b=t(x,!0);a(x),a(_e),d(()=>o(b,e(s).model_type)),l(ue,_e)};v(ea,ue=>{e(s).model_type&&ue(wa)})}var ca=r(ea,2);{var ka=ue=>{var _e=Hs(),x=r(t(_e),2),b=t(x);a(x),a(_e),d(Y=>o(b,`${Y??""}%`),[()=>(e(s).r_squared*100).toFixed(0)]),l(ue,_e)};v(ca,ue=>{e(s).r_squared!==void 0&&ue(ka)})}var ma=r(ca,2);{var Oa=ue=>{var _e=Vs(),x=r(t(_e),2),b=t(x,!0);a(x),a(_e),d(()=>o(b,e(s).num_readings)),l(ue,_e)};v(ma,ue=>{e(s).num_readings&&ue(Oa)})}a(Qe),a(Z),d(ue=>o(Je,ue),[()=>ga(e(le)??0)]),l(h,Z)},K=h=>{var Z=nr(),ie=T(Z);{var te=x=>{var b=Ys(),Y=r(t(b),2),Re=r(t(Y),2);{var Ue=Xe=>{var aa=Js(),De=t(aa,!0);a(aa),d(xe=>o(De,xe),[()=>e(ve).join(", ")]),l(Xe,aa)};v(Re,Xe=>{e(ve).length>0&&Xe(Ue)})}a(Y),a(b),l(x,b)};v(ie,x=>{e(I)&&x(te)})}var se=r(ie,2);{var P=x=>{var b=Xs(),Y=t(b),Re=r(t(Y),2);{var Ue=Ee=>{var la=Qs(),Ra=t(la);a(la),d(()=>{da(la,`color: ${e(Q).color??""}`),o(Ra,`${e(Q).emoji??""} ${e(Q).label??""}`)}),l(Ee,la)};v(Re,Ee=>{e(Q)&&Ee(Ue)})}a(Y);var Xe=r(Y,2),aa=t(Xe);a(Xe);var De=r(Xe,2),xe=t(De),Ne=t(xe);a(xe);var Ie=r(xe,2),qa=t(Ie);a(Ie);var ta=r(Ie,2),ua=t(ta);a(ta),a(De),a(b),d((Ee,la,Ra)=>{da(aa,`width: ${e(q)??""}%`),o(Ne,`OG: ${Ee??""}`),o(qa,`${la??""}%`),o(ua,`FG: ${Ra??""}`)},[()=>ga(ee()??e(s).predicted_og??0),()=>e(q).toFixed(0),()=>ga(e(s).predicted_fg??0)]),l(x,b)};v(se,x=>{e(q)!==null&&x(P)})}var O=r(se,2),he=t(O);{var Je=x=>{var b=Ks(),Y=r(t(b),2),Re=t(Y,!0);a(Y),a(b),d(Ue=>o(Re,Ue),[()=>ga(e(s).predicted_fg)]),l(x,b)};v(he,x=>{e(s).predicted_fg&&x(Je)})}var $e=r(he,2);{var Ye=x=>{var b=Zs(),Y=r(t(b),2),Re=t(Y);a(Y),a(b),d(Ue=>o(Re,`${Ue??""}%`),[()=>e(F).toFixed(1)]),l(x,b)};v($e,x=>{e(F)!==null&&x(Ye)})}var Qe=r($e,2);{var ea=x=>{const b=C(()=>U(e(s).estimated_completion));var Y=tr(),Re=r(t(Y),2),Ue=t(Re);{var Xe=De=>{var xe=$s();l(De,xe)},aa=De=>{var xe=ar(),Ne=T(xe),Ie=r(Ne);{var qa=ta=>{var ua=er(),Ee=t(ua);a(ua),d(()=>o(Ee,`(${e(b)??""} ${e(b)===1?"day":"days"})`)),l(ta,ua)};v(Ie,ta=>{e(b)!==null&&ta(qa)})}d(ta=>o(Ne,`${ta??""} `),[()=>N(e(s).estimated_completion)]),l(De,xe)};v(Ue,De=>{e(b)!==null&&e(b)<=0?De(Xe):De(aa,!1)})}a(Re),a(Y),l(x,Y)};v(Qe,x=>{e(s).estimated_completion&&x(ea)})}var wa=r(Qe,2),ca=t(wa);{var ka=x=>{var b=sr(),Y=r(t(b),2),Re=t(Y,!0);a(Y),a(b),d(()=>o(Re,e(s).model_type)),l(x,b)};v(ca,x=>{e(s).model_type&&x(ka)})}var ma=r(ca,2);{var Oa=x=>{var b=rr(),Y=r(t(b),2),Re=t(Y);a(Y),a(b),d(Ue=>o(Re,`${Ue??""}%`),[()=>(e(s).r_squared*100).toFixed(0)]),l(x,b)};v(ma,x=>{e(s).r_squared!==void 0&&x(Oa)})}var ue=r(ma,2);{var _e=x=>{var b=lr(),Y=r(t(b),2),Re=t(Y,!0);a(Y),a(b),d(()=>o(Re,e(s).num_readings)),l(x,b)};v(ue,x=>{e(s).num_readings&&x(_e)})}a(wa),a(O),l(h,Z)};v(u,h=>{e(k)?h(M):h(K,!1)})}a(X),d(()=>{qe=Ze(X,1,"ml-panel svelte-1xs394q",null,qe,{"has-anomaly":e(I),completed:e(k)}),o(ze,e(k)?"Fermentation Summary":"Fermentation Intelligence")}),l(oe,X)},ae=oe=>{var X=vr(),qe=t(X),ce=t(qe),Be=t(ce,!0);a(ce);var ze=r(ce,2);ze.__click=y;var Oe=t(ze,!0);a(ze),a(qe);var Ge=r(qe,2),u=t(Ge);{var M=h=>{var Z=Aa("Waiting for fermentation to progress (need visible SG drop)");l(h,Z)},K=h=>{var Z=je(),ie=T(Z);{var te=P=>{var O=Aa("Need more fermentation curve data for reliable prediction");l(P,O)},se=P=>{var O=je(),he=T(O);{var Je=Ye=>{var Qe=Aa("Need at least 10 readings to make predictions");l(Ye,Qe)},$e=Ye=>{var Qe=Aa();d(()=>o(Qe,e(k)?"No fermentation data recorded":"Predictions will appear once fermentation is underway")),l(Ye,Qe)};v(he,Ye=>{e(s).reason==="insufficient_data"?Ye(Je):Ye($e,!1)},!0)}l(P,O)};v(ie,P=>{e(s).reason==="insufficient_curve_data"?P(te):P(se,!1)},!0)}l(h,Z)};v(u,h=>{e(s).reason==="insufficient_fermentation_progress"?h(M):h(K,!1)})}a(Ge),a(X),d(()=>{o(Be,e(k)?"Fermentation summary unavailable":"ML predictions unavailable"),ze.disabled=e(m)||e(E),o(Oe,e(m)?"Reloading...":"‚Üª Reload")}),l(oe,X)};v(R,oe=>{e(s).available?oe(A):oe(ae,!1)},!0)}l(c,p)};v(ne,c=>{e(W)?c(be):c(z,!1)},!0)}l(g,w)};v(Me,g=>{e(E)?g(J):g(me,!1)})}l(we,ge),Pa()}Na(["change","click"]);var dr=i('<div class="loading svelte-1hws0u6">Loading alerts...</div>'),cr=i('<div class="error-banner svelte-1hws0u6"><span> </span> <button type="button" class="dismiss-error svelte-1hws0u6">√ó</button></div>'),ur=i('<button type="button" class="dismiss-all-btn svelte-1hws0u6"> </button>'),_r=i('<span class="spinner svelte-1hws0u6"></span>'),gr=Xa('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1hws0u6"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg>'),pr=i('<div class="alert-item svelte-1hws0u6"><div class="alert-icon svelte-1hws0u6"> </div> <div class="alert-content svelte-1hws0u6"><div class="alert-header svelte-1hws0u6"><span class="alert-type svelte-1hws0u6"> </span> <span class="severity-badge svelte-1hws0u6"> </span></div> <p class="alert-message svelte-1hws0u6"> </p> <div class="alert-meta svelte-1hws0u6"><span class="alert-time svelte-1hws0u6"> </span> <span class="alert-separator svelte-1hws0u6">¬∑</span> <span class="alert-time svelte-1hws0u6"> </span></div></div> <button type="button" class="dismiss-btn svelte-1hws0u6" title="Dismiss alert"><!></button></div>'),fr=i('<!> <div class="alerts-header svelte-1hws0u6"><span class="alert-count svelte-1hws0u6"> </span> <!></div> <div class="alerts-list svelte-1hws0u6"></div>',1);function mr(we,n){Da(n,!0);let B=ye(Ka([])),ee=ye(!0),H=ye(null),V=ye(null),L=ye(!1);Mt(()=>{s()});async function s(){try{_(ee,!0),_(H,null),_(B,await It(n.batchId,!1),!0)}catch(y){_(H,y instanceof Error?y.message:"Failed to load alerts",!0)}finally{_(ee,!1)}}async function E(y){try{_(V,y,!0),await Ht(n.batchId,y),_(B,e(B).filter(G=>G.id!==y),!0)}catch(G){_(H,G instanceof Error?G.message:"Failed to dismiss alert",!0)}finally{_(V,null)}}async function m(){try{_(L,!0),await Vt(n.batchId),_(B,[],!0)}catch(y){_(H,y instanceof Error?y.message:"Failed to dismiss alerts",!0)}finally{_(L,!1)}}function W(y){switch(y){case"critical":return"var(--negative)";case"warning":return"var(--warning)";case"info":return"var(--accent)";default:return"var(--text-muted)"}}function fe(y){switch(y){case"stall":return"‚è∏";case"temperature_high":return"üî•";case"temperature_low":return"‚ùÑ";case"anomaly":return"‚ö†";default:return"‚ö†"}}function ke(y){const G=new Date(y),U=new Date().getTime()-G.getTime(),q=Math.floor(U/6e4),F=Math.floor(q/60),Q=Math.floor(F/24);return Q>0?`${Q}d ago`:F>0?`${F}h ago`:q>0?`${q}m ago`:"just now"}var k=je(),le=T(k);{var S=y=>{Ta(y,{title:"Alerts",icon:"üîî",children:(G,N)=>{var U=dr();l(G,U)},$$slots:{default:!0}})},de=y=>{var G=je(),N=T(G);{var U=F=>{},q=F=>{Ta(F,{title:"Active Alerts",icon:"üîî",highlight:!0,children:(Q,I)=>{var ve=fr(),ge=T(ve);{var Me=z=>{var c=cr(),p=t(c),R=t(p,!0);a(p);var A=r(p,2);A.__click=()=>_(H,null),a(c),d(()=>o(R,e(H))),l(z,c)};v(ge,z=>{e(H)&&z(Me)})}var J=r(ge,2),me=t(J),g=t(me);a(me);var w=r(me,2);{var ne=z=>{var c=ur();c.__click=m;var p=t(c,!0);a(c),d(()=>{c.disabled=e(L),o(p,e(L)?"Dismissing...":"Dismiss All")}),l(z,c)};v(w,z=>{e(B).length>1&&z(ne)})}a(J);var be=r(J,2);Ha(be,21,()=>e(B),z=>z.id,(z,c)=>{var p=pr(),R=t(p),A=t(R,!0);a(R);var ae=r(R,2),oe=t(ae),X=t(oe),qe=t(X,!0);a(X);var ce=r(X,2),Be=t(ce,!0);a(ce),a(oe);var ze=r(oe,2),Oe=t(ze,!0);a(ze);var Ge=r(ze,2),u=t(Ge),M=t(u);a(u);var K=r(u,4),h=t(K);a(K),a(Ge),a(ae);var Z=r(ae,2);Z.__click=()=>E(e(c).id);var ie=t(Z);{var te=P=>{var O=_r();l(P,O)},se=P=>{var O=gr();l(P,O)};v(ie,P=>{e(V)===e(c).id?P(te):P(se,!1)})}a(Z),a(p),d((P,O,he,Je,$e,Ye,Qe,ea)=>{da(p,`--severity-color: ${P??""}`),o(A,O),o(qe,he),da(ce,`background: ${Je??""}`),o(Be,e(c).severity),o(Oe,e(c).message),fa(u,"title",`First detected: ${$e??""}`),o(M,`First: ${Ye??""}`),fa(K,"title",`Last seen: ${Qe??""}`),o(h,`Last: ${ea??""}`),Z.disabled=e(V)===e(c).id},[()=>W(e(c).severity),()=>fe(e(c).alert_type),()=>e(c).alert_type.replace("_"," "),()=>W(e(c).severity),()=>new Date(e(c).first_detected_at).toLocaleString(),()=>ke(e(c).first_detected_at),()=>new Date(e(c).last_seen_at).toLocaleString(),()=>ke(e(c).last_seen_at)]),l(z,p)}),a(be),d(()=>o(g,`${e(B).length??""} active`)),l(Q,ve)},$$slots:{default:!0}})};v(N,F=>{e(B).length===0?F(U):F(q,!1)},!0)}l(y,G)};v(le,y=>{e(ee)?y(S):y(de,!1)})}l(we,k),Pa()}Na(["click"]);var hr=i('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),br=i('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),xr=i('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),yr=i('<span class="recipe-type svelte-g5au2j"> </span>'),jr=i('<a class="recipe-link svelte-g5au2j"> <!></a>'),wr=i('<div class="batch-timing svelte-g5au2j"> </div>'),kr=i('<div class="batch-timing svelte-g5au2j"> </div>'),qr=i('<option class="svelte-g5au2j"> </option>'),zr=Xa('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" class="svelte-g5au2j"></path><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Resume',1),Fr=Xa('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Pause',1),Cr=i('<button type="button"><!></button>'),Mr=i('<span class="chilling-icon svelte-g5au2j">üç∫</span> <h3 class="chilling-title svelte-g5au2j">Ready to Pitch!</h3>',1),Rr=i('<span class="chilling-icon svelte-g5au2j">‚ùÑÔ∏è</span> <h3 class="chilling-title svelte-g5au2j">Chilling to Pitch Temperature</h3>',1),Sr=i('<div class="progress-section svelte-g5au2j"><div class="progress-bar svelte-g5au2j"><div class="progress-fill svelte-g5au2j"></div></div> <span class="progress-text svelte-g5au2j"> </span></div>'),Br=i('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è No cooler configured - set a cooler entity to enable automated chilling</span>'),Ar=i('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è Temperature control disabled in settings</span>'),Tr=i('<span class="status-ready svelte-g5au2j">Wort has reached pitch temperature - ready to add yeast!</span>'),Dr=i('<span class="status-active svelte-g5au2j">Cooler will run automatically when temp exceeds target + hysteresis</span>'),Pr=i('<div><div class="chilling-header svelte-g5au2j"><!></div> <div class="chilling-content svelte-g5au2j"><div class="temp-display svelte-g5au2j"><div class="temp-current svelte-g5au2j"><span class="temp-label svelte-g5au2j">Current</span> <span class="temp-value svelte-g5au2j"> </span></div> <div class="temp-arrow svelte-g5au2j">‚Üí</div> <div class="temp-target svelte-g5au2j"><span class="temp-label svelte-g5au2j">Target</span> <span class="temp-value svelte-g5au2j"> </span></div></div> <!> <div class="chilling-status svelte-g5au2j"><!></div></div></div>'),Or=i(`<div class="paused-banner svelte-g5au2j"><div class="paused-header svelte-g5au2j"><svg class="paused-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> <h3 class="paused-title svelte-g5au2j">Readings Paused</h3></div> <p class="paused-text svelte-g5au2j">Hydrometer readings are not being stored. Live readings still display but won't be saved to the fermentation history.</p> <button type="button" class="resume-btn svelte-g5au2j"> </button></div>`),Er=i('<span class="status-badge heater svelte-g5au2j">üî• Heating</span>'),Lr=i('<span class="status-badge cooler svelte-g5au2j">‚ùÑÔ∏è Cooling</span>'),Gr=i('<span class="status-badge idle svelte-g5au2j"> </span>'),Nr=i('<div class="device-status heater svelte-g5au2j"><div>üî•</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Heater</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Ur=i('<div class="device-status cooler svelte-g5au2j"><div>‚ùÑÔ∏è</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Cooler</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Ir=i('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">‚ö°</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),Hr=i('<button type="button" class="override-btn heat-on svelte-g5au2j">Force Heat ON</button> <button type="button" class="override-btn heat-off svelte-g5au2j">Force Heat OFF</button>',1),Vr=i('<button type="button" class="override-btn cool-on svelte-g5au2j">Force Cool ON</button> <button type="button" class="override-btn cool-off svelte-g5au2j">Force Cool OFF</button>',1),Wr=i('<div class="control-details svelte-g5au2j"><div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns-grid svelte-g5au2j"><!> <!> <button type="button" class="override-btn auto-mode svelte-g5au2j">Auto Mode</button></div></div>',1),Jr=i('<div class="device-status-grid svelte-g5au2j"><!> <!></div> <!>',1),Yr=i('<div><button type="button" class="collapsible-header svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="collapse-indicator svelte-g5au2j"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" class="svelte-g5au2j"></path></svg></div></button> <!></div>'),Qr=i('<span class="svelte-g5au2j"> </span>'),Xr=i('<span class="svelte-g5au2j"> </span>'),Kr=i('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><!> <!> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),Zr=i('<div class="chart-section svelte-g5au2j"><!></div>'),$r=i('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <!> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j" aria-label="Delete batch"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <!> <!> <div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!> <!></div></div>  <!>',1),el=i('<div class="modal-overlay svelte-g5au2j" role="presentation"><div class="modal svelte-g5au2j" role="dialog" aria-modal="true" aria-labelledby="delete-modal-title" tabindex="-1"><h2 id="delete-modal-title" class="modal-title svelte-g5au2j">Delete Batch?</h2> <p class="modal-text svelte-g5au2j"> </p> <div class="modal-actions svelte-g5au2j"><button type="button" class="modal-btn cancel svelte-g5au2j">Cancel</button> <button type="button" class="modal-btn delete svelte-g5au2j"> </button></div></div></div>'),al=i('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div> <!>',1);function wl(we,n){Da(n,!0);const B=()=>Et(Lt,"$page",ee),[ee,H]=Ot();let V=null,L=null,s=ye(null),E=ye(null),m=ye(null),W=Ka([]),fe=ye(!0),ke=ye(null),k=ye(!1),le=ye(!1),S=ye(!1),de=ye(!1),y=ye(!1),G=ye(!1),N=ye(!1),U=C(()=>parseInt(B().params.id??"0"));const q=["planning","fermenting","conditioning","completed","archived"];let F=C(()=>e(s)?Qa[e(s).status]:Qa.planning),Q=C(gt),I=C(()=>Ia.config.ha_enabled&&Ia.config.temp_control_enabled&&(e(s)?.heater_entity_id||e(s)?.cooler_entity_id)),ve=C(()=>e(s)?.status==="planning"&&e(s)?.temp_target!=null),ge=C(()=>!e(ve)||!e(J)?.temp||!e(s)?.temp_target?!1:e(J).temp<=e(s).temp_target),Me=C(()=>{if(!e(ve)||!e(J)?.temp||!e(s)?.temp_target)return null;const u=e(s).temp_target+30,M=e(J).temp,K=e(s).temp_target;if(M<=K)return 100;if(M>=u)return 0;const h=(u-M)/(u-K)*100;return Math.min(100,Math.max(0,h))}),J=C(()=>{if(!e(s)?.device_id)return null;const u=ct.tilts.get(e(s).device_id);if(u)return u;const M=e(s).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!M?.[1])return null;const K=M[1].toUpperCase();for(const h of ct.tilts.values())if(h.color&&h.color.toUpperCase()===K)return h;return null});async function me(){_(fe,!0),_(ke,null);try{if(_(s,await Wt(e(U)),!0),e(s).status==="fermenting"||e(s).status==="conditioning"||e(s).status==="completed")try{_(E,await dt(e(U)),!0)}catch{}if(e(s).heater_entity_id||e(s).cooler_entity_id)try{_(m,await Ua(e(U)),!0)}catch{}}catch(u){_(ke,u instanceof Error?u.message:"Failed to load batch",!0)}finally{_(fe,!1)}}async function g(u){if(!(!e(s)||e(le))&&!(u==="conditioning"&&e(s).status==="fermenting"&&!confirm(`üí° Entering Conditioning Phase

Reminder: Adjust target temperature if cold crashing.
Temperature control will continue during conditioning.

Continue?`))){_(le,!0);try{_(s,await Ja(e(s).id,{status:u}),!0),(u==="fermenting"||u==="conditioning")&&_(E,await dt(e(s).id),!0)}catch(M){console.error("Failed to update status:",M)}finally{_(le,!1)}}}async function w(u){if(e(s)&&(_(s,await Ja(e(s).id,u),!0),_(k,!1),e(s).heater_entity_id||e(s).cooler_entity_id))try{_(m,await Ua(e(s).id),!0)}catch{}}async function ne(){if(e(s)){_(y,!0);try{await Jt(e(s).id),Gt("/batches")}catch(u){_(ke,u instanceof Error?u.message:"Failed to delete batch",!0),_(y,!1),_(de,!1)}}}async function be(){if(!(!e(s)||e(N))){_(N,!0);try{_(s,await Ja(e(s).id,{readings_paused:!e(s).readings_paused}),!0)}catch(u){console.error("Failed to toggle pause:",u)}finally{_(N,!1)}}}async function z(u,M){if(!(!e(s)||e(S))){_(S,!0);try{await Ya(e(s).id,M,60,u),_(m,await Ua(e(s).id),!0)}catch(K){console.error("Failed to set override:",K)}finally{_(S,!1)}}}async function c(){if(!(!e(s)||e(S))){_(S,!0);try{e(s).heater_entity_id&&await Ya(e(s).id,null,60,"heater"),e(s).cooler_entity_id&&await Ya(e(s).id,null,60,"cooler"),_(m,await Ua(e(s).id),!0)}catch(u){console.error("Failed to clear overrides:",u)}finally{_(S,!1)}}}function p(){if(V?.readyState===WebSocket.OPEN)return;const M=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;V=new WebSocket(M),V.onmessage=async K=>{try{const h=JSON.parse(K.data);h.type==="control_event"&&h.batch_id===e(U)&&e(m)&&(h.action==="heat_on"?_(m,{...e(m),heater_state:"on"},!0):h.action==="heat_off"?_(m,{...e(m),heater_state:"off"},!0):h.action==="cool_on"?_(m,{...e(m),cooler_state:"on"},!0):h.action==="cool_off"&&_(m,{...e(m),cooler_state:"off"},!0))}catch{}},V.onclose=()=>{V=null,L=setTimeout(p,3e3)},V.onerror=()=>{V?.close()}}function R(){L&&(clearTimeout(L),L=null),V?.close(),V=null}function A(u){return u==null?"--":_t(u)}function ae(u){return u?new Date(u).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"--"}function oe(u){if(!u)return"--";const M=new Date(u),h=(new Date().getTime()-M.getTime())/(1e3*60*60);if(h<1)return`${Math.round(h*60)}m`;if(h<24)return`${h.toFixed(1)}h`;const Z=h/24;return Z<7?`${Z.toFixed(1)}d`:`${Math.round(Z)}d`}ut(()=>{me(),p()}),Rt(()=>{R()});var X=al();At("g5au2j",u=>{St(()=>{Bt.title=`${(e(s)?.name||"Batch")??""} | BrewSignal`})});var qe=T(X),ce=r(t(qe),2);{var Be=u=>{var M=hr();l(u,M)},ze=u=>{var M=je(),K=T(M);{var h=ie=>{var te=br(),se=r(t(te),2),P=t(se,!0);a(se);var O=r(se,2);O.__click=me,a(te),d(()=>o(P,e(ke))),l(ie,te)},Z=ie=>{var te=je(),se=T(te);{var P=he=>{var Je=xr();l(he,Je)},O=he=>{var Je=je(),$e=T(Je);{var Ye=ea=>{Yt(ea,{get batch(){return e(s)},onSubmit:w,onCancel:()=>_(k,!1)})},Qe=ea=>{var wa=$r(),ca=T(wa),ka=t(ca),ma=t(ka),Oa=t(ma);a(ma);var ue=r(ma,2),_e=t(ue),x=t(_e,!0);a(_e);var b=r(_e,2);{var Y=f=>{var j=jr(),$=t(j),pe=r($);{var Fe=Pe=>{var Ae=yr(),He=t(Ae);a(Ae),d(()=>o(He,`(${e(s).recipe.type??""})`)),l(Pe,Ae)};v(pe,Pe=>{e(s).recipe.type&&Pe(Fe)})}a(j),d(()=>{fa(j,"href",`/recipes/${e(s).recipe.id??""}`),o($,`${e(s).recipe.name??""} `)}),l(f,j)};v(b,f=>{e(s).recipe&&f(Y)})}var Re=r(b,2);{var Ue=f=>{var j=wr(),$=t(j);a(j),d((pe,Fe)=>o($,`Started ${pe??""} ¬∑ ${Fe??""} ago`),[()=>ae(e(s).start_time),()=>oe(e(s).start_time)]),l(f,j)},Xe=f=>{var j=je(),$=T(j);{var pe=Fe=>{var Pe=kr(),Ae=t(Pe);a(Pe),d(He=>o(Ae,`Brewed ${He??""}`),[()=>ae(e(s).brew_date)]),l(Fe,Pe)};v($,Fe=>{e(s).brew_date&&Fe(pe)},!0)}l(f,j)};v(Re,f=>{e(s).start_time?f(Ue):f(Xe,!1)})}a(ue),a(ka);var aa=r(ka,2),De=t(aa),xe=t(De);xe.__change=f=>g(f.currentTarget.value),Ha(xe,21,()=>q,Za,(f,j)=>{var $=qr(),pe=t($,!0);a($);var Fe={};d(()=>{o(pe,Qa[e(j)].label),Fe!==(Fe=e(j))&&($.value=($.__value=e(j))??"")}),l(f,$)}),a(xe);var Ne;Dt(xe),a(De);var Ie=r(De,2);{var qa=f=>{var j=Cr();let $;j.__click=be;var pe=t(j);{var Fe=Ae=>{var He=zr();Te(),l(Ae,He)},Pe=Ae=>{var He=Fr();Te(),l(Ae,He)};v(pe,Ae=>{e(s).readings_paused?Ae(Fe):Ae(Pe,!1)})}a(j),d(()=>{$=Ze(j,1,"pause-btn svelte-g5au2j",null,$,{paused:e(s).readings_paused}),j.disabled=e(N),fa(j,"title",e(s).readings_paused?"Resume storing readings":"Pause storing readings")}),l(f,j)};v(Ie,f=>{(e(s).status==="fermenting"||e(s).status==="conditioning")&&f(qa)})}var ta=r(Ie,2);ta.__click=()=>_(k,!0);var ua=r(ta,2);ua.__click=()=>_(de,!0),a(aa),a(ca);var Ee=r(ca,2);{var la=f=>{var j=Pr();let $;var pe=t(j),Fe=t(pe);{var Pe=D=>{var re=Mr();Te(2),l(D,re)},Ae=D=>{var re=Rr();Te(2),l(D,re)};v(Fe,D=>{e(ge)?D(Pe):D(Ae,!1)})}a(pe);var He=r(pe,2),za=t(He),ha=t(za),Sa=r(t(ha),2),na=t(Sa,!0);a(Sa),a(ha);var Ce=r(ha,4),Ke=r(t(Ce),2),Fa=t(Ke,!0);a(Ke),a(Ce),a(za);var Ca=r(za,2);{var Ea=D=>{var re=Sr(),Le=t(re),Ve=t(Le);a(Le);var sa=r(Le,2),Se=t(sa);a(sa),a(re),d(We=>{da(Ve,`width: ${e(Me)??""}%`),o(Se,`${We??""}% to target`)},[()=>Math.round(e(Me))]),l(D,re)};v(Ca,D=>{e(Me)!=null&&!e(ge)&&D(Ea)})}var ia=r(Ca,2),ba=t(ia);{var La=D=>{var re=Br();l(D,re)},Ga=D=>{var re=je(),Le=T(re);{var Ve=Se=>{var We=Ar();l(Se,We)},sa=Se=>{var We=je(),xa=T(We);{var _a=ja=>{var Ba=Tr();l(ja,Ba)},ya=ja=>{var Ba=Dr();l(ja,Ba)};v(xa,ja=>{e(ge)?ja(_a):ja(ya,!1)},!0)}l(Se,We)};v(Le,Se=>{!Ia.config.ha_enabled||!Ia.config.temp_control_enabled?Se(Ve):Se(sa,!1)},!0)}l(D,re)};v(ba,D=>{e(s).cooler_entity_id?D(Ga,!1):D(La)})}a(ia),a(He),a(j),d((D,re)=>{$=Ze(j,1,"chilling-banner svelte-g5au2j",null,$,{ready:e(ge)}),o(na,D),o(Fa,re)},[()=>e(J)?.temp!=null?A(e(J).temp):"--",()=>e(s).temp_target!=null?A(e(s).temp_target):"--"]),l(f,j)};v(Ee,f=>{e(ve)&&f(la)})}var Ra=r(Ee,2);{var ft=f=>{var j=Or(),$=r(t(j),4);$.__click=be;var pe=t($,!0);a($),a(j),d(()=>{$.disabled=e(N),o(pe,e(N)?"Resuming...":"Resume Readings")}),l(f,j)};v(Ra,f=>{e(s).readings_paused&&(e(s).status==="fermenting"||e(s).status==="conditioning")&&f(ft)})}var Va=r(Ra,2),Wa=t(Va),$a=t(Wa);{let f=C(()=>e(J)?.sg??e(E)?.measured?.current_sg);cs($a,{get batch(){return e(s)},get currentSg(){return e(f)},get progress(){return e(E)},get liveReading(){return e(J)}})}var mt=r($a,2);{var ht=f=>{Ss(f,{get recipe(){return e(s).recipe},get yeastStrain(){return e(s).yeast_strain}})};v(mt,f=>{e(s).recipe&&f(ht)})}a(Wa);var et=r(Wa,2),at=t(et);js(at,{get batch(){return e(s)},get liveReading(){return e(J)},onEdit:()=>_(k,!0)});var tt=r(at,2);{var bt=f=>{mr(f,{get batchId(){return e(s).id}})};v(tt,f=>{(e(s).status==="fermenting"||e(s).status==="conditioning")&&f(bt)})}var st=r(tt,2);{let f=C(()=>e(s).measured_fg??e(E)?.measured?.fg),j=C(()=>e(J)?.sg??e(E)?.measured?.current_sg);or(st,{get batchId(){return e(s).id},get batchStatus(){return e(s).status},get measuredOg(){return e(s).measured_og},get measuredFg(){return e(f)},get currentSg(){return e(j)},get liveReading(){return e(J)}})}var rt=r(st,2);{var xt=f=>{var j=Yr();let $;var pe=t(j);pe.__click=()=>_(G,!e(G));var Fe=r(t(pe),2),Pe=t(Fe);{var Ae=Ce=>{var Ke=Er();l(Ce,Ke)},He=Ce=>{var Ke=je(),Fa=T(Ke);{var Ca=ia=>{var ba=Lr();l(ia,ba)},Ea=ia=>{var ba=je(),La=T(ba);{var Ga=D=>{var re=Gr(),Le=t(re);a(re),d(Ve=>o(Le,`üéØ ${Ve??""}${e(Q)??""}`),[()=>A(e(m).target_temp)]),l(D,re)};v(La,D=>{e(G)&&e(m)&&D(Ga)},!0)}l(ia,ba)};v(Fa,ia=>{e(m)?.cooler_state==="on"?ia(Ca):ia(Ea,!1)},!0)}l(Ce,Ke)};v(Pe,Ce=>{e(m)?.heater_state==="on"?Ce(Ae):Ce(He,!1)})}var za=r(Pe,2);let ha;a(Fe),a(pe);var Sa=r(pe,2);{var na=Ce=>{var Ke=Jr(),Fa=T(Ke),Ca=t(Fa);{var Ea=D=>{var re=Nr(),Le=t(re);let Ve;var sa=r(Le,2),Se=r(t(sa),2);let We;var xa=t(Se,!0);a(Se);var _a=r(Se,2),ya=t(_a,!0);a(_a),a(sa),a(re),d(()=>{Ve=Ze(Le,1,"device-icon-wrap svelte-g5au2j",null,Ve,{active:e(m)?.heater_state==="on"}),We=Ze(Se,1,"device-state svelte-g5au2j",null,We,{on:e(m)?.heater_state==="on"}),o(xa,e(m)?.heater_state==="on"?"ON":"OFF"),o(ya,e(s).heater_entity_id)}),l(D,re)};v(Ca,D=>{e(s).heater_entity_id&&D(Ea)})}var ia=r(Ca,2);{var ba=D=>{var re=Ur(),Le=t(re);let Ve;var sa=r(Le,2),Se=r(t(sa),2);let We;var xa=t(Se,!0);a(Se);var _a=r(Se,2),ya=t(_a,!0);a(_a),a(sa),a(re),d(()=>{Ve=Ze(Le,1,"device-icon-wrap svelte-g5au2j",null,Ve,{active:e(m)?.cooler_state==="on"}),We=Ze(Se,1,"device-state svelte-g5au2j",null,We,{on:e(m)?.cooler_state==="on"}),o(xa,e(m)?.cooler_state==="on"?"ON":"OFF"),o(ya,e(s).cooler_entity_id)}),l(D,re)};v(ia,D=>{e(s).cooler_entity_id&&D(ba)})}a(Fa);var La=r(Fa,2);{var Ga=D=>{var re=Wr(),Le=T(re),Ve=t(Le),sa=r(t(Ve),2),Se=t(sa);a(sa),a(Ve);var We=r(Ve,2),xa=r(t(We),2),_a=t(xa);a(xa),a(We),a(Le);var ya=r(Le,2);{var ja=ra=>{var va=Ir(),oa=r(t(va),2),Ma=t(oa);a(oa);var ot=r(oa,2);ot.__click=()=>c(),a(va),d(Ct=>{o(Ma,`Override active: ${Ct??""}`),ot.disabled=e(S)},[()=>e(m).override_state?.toUpperCase()]),l(ra,va)};v(ya,ra=>{e(m).override_active&&ra(ja)})}var Ba=r(ya,2),lt=r(t(Ba),2),nt=t(lt);{var zt=ra=>{var va=Hr(),oa=T(va);oa.__click=()=>z("heater","on");var Ma=r(oa,2);Ma.__click=()=>z("heater","off"),d(()=>{oa.disabled=e(S),Ma.disabled=e(S)}),l(ra,va)};v(nt,ra=>{e(s).heater_entity_id&&ra(zt)})}var it=r(nt,2);{var Ft=ra=>{var va=Vr(),oa=T(va);oa.__click=()=>z("cooler","on");var Ma=r(oa,2);Ma.__click=()=>z("cooler","off"),d(()=>{oa.disabled=e(S),Ma.disabled=e(S)}),l(ra,va)};v(it,ra=>{e(s).cooler_entity_id&&ra(Ft)})}var vt=r(it,2);vt.__click=()=>c(),a(lt),a(Ba),d((ra,va)=>{o(Se,`${ra??""}${e(Q)??""}`),o(_a,`¬±${va??""}${e(Q)??""}`),vt.disabled=e(S)},[()=>A(e(m).target_temp),()=>e(m).hysteresis?.toFixed(1)||"--"]),l(D,re)};v(La,D=>{e(m)&&D(Ga)})}l(Ce,Ke)};v(Sa,Ce=>{e(G)||Ce(na)})}a(j),d(()=>{$=Ze(j,1,"info-card temp-control-card svelte-g5au2j",null,$,{"heater-on":e(m)?.heater_state==="on","cooler-on":e(m)?.cooler_state==="on",collapsed:e(G)}),ha=Ze(za,0,"chevron svelte-g5au2j",null,ha,{rotated:!e(G)})}),l(f,j)},yt=f=>{var j=je(),$=T(j);{var pe=Fe=>{var Pe=Kr(),Ae=r(t(Pe),2),He=t(Ae);{var za=na=>{var Ce=Qr(),Ke=t(Ce);a(Ce),d(()=>o(Ke,`Heater: ${e(s).heater_entity_id??""}`)),l(na,Ce)};v(He,na=>{e(s).heater_entity_id&&na(za)})}var ha=r(He,2);{var Sa=na=>{var Ce=Xr(),Ke=t(Ce);a(Ce),d(()=>o(Ke,`Cooler: ${e(s).cooler_entity_id??""}`)),l(na,Ce)};v(ha,na=>{e(s).cooler_entity_id&&na(Sa)})}Te(2),a(Ae),a(Pe),l(Fe,Pe)};v($,Fe=>{(e(s).heater_entity_id||e(s).cooler_entity_id)&&e(s).status!=="fermenting"&&Fe(pe)},!0)}l(f,j)};v(rt,f=>{e(I)&&(e(s).status==="fermenting"||e(s).status==="conditioning")?f(xt):f(yt,!1)})}var jt=r(rt,2);{var wt=f=>{As(f,{get notes(){return e(s).notes}})};v(jt,f=>{e(s).notes&&f(wt)})}a(et),a(Va);var kt=r(Va,2);{var qt=f=>{var j=Zr(),$=t(j);{let pe=C(()=>e(s).device_id||"historical");Xt($,{get batchId(){return e(s).id},get deviceColor(){return e(pe)},get originalGravity(){return e(s).measured_og},get controlEvents(){return W}})}a(j),l(f,j)};v(kt,f=>{(e(s).device_id||e(s).status==="completed"||e(s).status==="archived")&&f(qt)})}d(()=>{o(Oa,`#${(e(s).batch_number||"?")??""}`),o(x,e(s).name||e(s).recipe?.name||"Unnamed Batch"),xe.disabled=e(le),da(xe,`color: ${e(F).color??""}; background: ${e(F).bg??""};`),Ne!==(Ne=e(s).status)&&(xe.value=(xe.__value=e(s).status)??"",Pt(xe,e(s).status))}),l(ea,wa)};v($e,ea=>{e(k)?ea(Ye):ea(Qe,!1)},!0)}l(he,Je)};v(se,he=>{e(s)?he(O,!1):he(P)},!0)}l(ie,te)};v(K,ie=>{e(ke)?ie(h):ie(Z,!1)},!0)}l(u,M)};v(ce,u=>{e(fe)?u(Be):u(ze,!1)})}a(qe);var Oe=r(qe,2);{var Ge=u=>{var M=el();M.__click=()=>_(de,!1),M.__keydown=O=>O.key==="Escape"&&_(de,!1);var K=t(M);K.__click=O=>O.stopPropagation(),K.__keydown=O=>O.stopPropagation();var h=r(t(K),2),Z=t(h);a(h);var ie=r(h,2),te=t(ie);te.__click=()=>_(de,!1);var se=r(te,2);se.__click=ne;var P=t(se,!0);a(se),a(ie),a(K),a(M),d(()=>{o(Z,`Are you sure you want to delete "${(e(s)?.name||"this batch")??""}"? This cannot be undone.`),te.disabled=e(y),se.disabled=e(y),o(P,e(y)?"Deleting...":"Delete Batch")}),l(u,M)};v(Oe,u=>{e(de)&&u(Ge)})}l(we,X),Pa(),H()}Na(["click","change","keydown"]);export{wl as component,jl as universal};
