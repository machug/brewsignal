import{d as Ca,f as d,a as o,s as f,t as ss,b as ft}from"../chunks/BHvHOtuG.js";import{ab as Aa,ac as c,p as Fa,ad as Ea,ae as za,af as Oa,s as n,V as Ha,ag as a,ah as t,g as e,am as ut,ai as Ua,aj as s,an as E,al as T,ak as ts}from"../chunks/BeYMcFNd.js";import{e as Ia,i as Ma}from"../chunks/Cn7aBH5Z.js";import{i as h}from"../chunks/Cd5u1CHp.js";import{c as b,h as Ra,f as _t,r as R,s as K,u as as,b as Na}from"../chunks/uDRD4AdC.js";import{s as I}from"../chunks/r5hj-VAX.js";import{b as N}from"../chunks/BperHIsi.js";import{i as Pa,s as Ba,b as Da}from"../chunks/UEX34lHC.js";var La=d('<div class="loading-state svelte-hj1sc2"><div class="loading-spinner svelte-hj1sc2"></div> <span class="svelte-hj1sc2">Loading system information...</span></div>'),Ja=d('<div class="info-grid svelte-hj1sc2"><div class="info-item svelte-hj1sc2"><span class="info-label svelte-hj1sc2">Hostname</span> <span class="info-value font-mono svelte-hj1sc2"> </span></div> <div class="info-item svelte-hj1sc2"><span class="info-label svelte-hj1sc2">Version</span> <span class="info-value font-mono svelte-hj1sc2"> </span></div> <div class="info-item svelte-hj1sc2"><span class="info-label svelte-hj1sc2">Uptime</span> <span class="info-value font-mono svelte-hj1sc2"> </span></div> <div class="info-item svelte-hj1sc2"><span class="info-label svelte-hj1sc2">IP Address</span> <span class="info-value font-mono svelte-hj1sc2"> </span></div></div>'),Wa=d('<p class="text-muted svelte-hj1sc2">Unable to load system information</p>'),Ka=d('<div class="setting-row sub-setting svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Smoothing Samples</span> <span class="setting-description svelte-hj1sc2">Number of readings to average</span></div> <select class="select-input-sm svelte-hj1sc2"><option class="svelte-hj1sc2">3</option><option class="svelte-hj1sc2">5</option><option class="svelte-hj1sc2">10</option><option class="svelte-hj1sc2">15</option><option class="svelte-hj1sc2">20</option></select></div>'),Va=d('<span class="loading-dot svelte-hj1sc2"></span> Saving...',1),qa=d('<p class="config-error svelte-hj1sc2"> </p>'),Ga=d('<p class="config-success svelte-hj1sc2">Settings saved</p>'),Ya=d('<option class="svelte-hj1sc2"> </option>'),Qa=d('<div class="loading-spinner-small svelte-hj1sc2"></div>'),Xa=d('<div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Connection Status</span></div> <span> </span></div>'),Za=d("<span> </span>"),$a=d('<span class="loading-dot svelte-hj1sc2"></span> Saving...',1),en=d('<p class="config-error svelte-hj1sc2"> </p>'),sn=d('<p class="config-success svelte-hj1sc2">Settings saved</p>'),tn=d('<!> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Home Assistant URL</span> <span class="setting-description svelte-hj1sc2">e.g., http://192.168.1.100:8123</span></div> <input type="url" placeholder="http://homeassistant.local:8123" class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Access Token</span> <span class="setting-description svelte-hj1sc2">Long-lived access token from HA profile</span></div> <input type="password" placeholder="Enter token..." class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Test Connection</span></div> <div class="test-connection svelte-hj1sc2"><button type="button" class="btn-secondary-sm svelte-hj1sc2"> </button> <!></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Ambient Temp Entity</span> <span class="setting-description svelte-hj1sc2">e.g., sensor.fermenter_room_temperature</span></div> <input type="text" placeholder="sensor.xxx_temperature" class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Ambient Humidity Entity</span> <span class="setting-description svelte-hj1sc2">Optional humidity sensor</span></div> <input type="text" placeholder="sensor.xxx_humidity" class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Weather Entity</span> <span class="setting-description svelte-hj1sc2">For forecast display, e.g., weather.home</span></div> <input type="text" placeholder="weather.home" class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Heater Switch Entity</span> <span class="setting-description svelte-hj1sc2">Switch to control fermentation heating</span></div> <input type="text" placeholder="switch.fermenter_heater" class="input-field svelte-hj1sc2"/></div> <div class="mt-4 config-actions svelte-hj1sc2"><button type="button" class="btn-primary svelte-hj1sc2"><!></button> <!> <!></div>',1),an=d('<div class="status-item override svelte-hj1sc2"><span class="status-label svelte-hj1sc2">Override</span> <span class="status-value svelte-hj1sc2"> </span></div>'),nn=d('<div class="control-status svelte-hj1sc2"><div class="status-item svelte-hj1sc2"><span class="status-label svelte-hj1sc2">Heater</span> <span> </span></div> <div class="status-item svelte-hj1sc2"><span class="status-label svelte-hj1sc2">Wort Temp</span> <span class="status-value svelte-hj1sc2"> </span></div> <!></div>'),ln=d('<button type="button" class="btn-override btn-cancel svelte-hj1sc2">Cancel</button>'),rn=d('<span class="loading-dot svelte-hj1sc2"></span> Saving...',1),on=d('<p class="config-error svelte-hj1sc2"> </p>'),cn=d('<p class="config-success svelte-hj1sc2">Settings saved</p>'),vn=d('<!> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Target Temperature</span> <span class="setting-description svelte-hj1sc2"> </span></div> <div class="input-with-unit svelte-hj1sc2"><input type="number" step="0.5" class="input-field input-number svelte-hj1sc2"/> <span class="unit svelte-hj1sc2"> </span></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Hysteresis</span> <span class="setting-description svelte-hj1sc2"> </span></div> <div class="input-with-unit svelte-hj1sc2"><input type="number" class="input-field input-number svelte-hj1sc2"/> <span class="unit svelte-hj1sc2"> </span></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Manual Override</span> <span class="setting-description svelte-hj1sc2">Temporarily override automatic control (1 hour)</span></div> <div class="override-buttons svelte-hj1sc2"><button type="button">Force ON</button> <button type="button">Force OFF</button> <!></div></div> <div class="mt-4 config-actions svelte-hj1sc2"><button type="button" class="btn-primary svelte-hj1sc2"><!></button> <!> <!></div>',1),dn=d('<div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Temperature Control</h2></div> <div class="card-body svelte-hj1sc2"><div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Enable Temperature Control</span> <span class="setting-description svelte-hj1sc2">Automatically control heater based on wort temp</span></div> <button type="button" aria-label="Toggle temperature control"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <!></div></div>'),pn=d('<div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Alert Threshold</span> <span class="setting-description svelte-hj1sc2">Alert when forecast differs from target by this amount (°C)</span></div> <div class="input-with-unit svelte-hj1sc2"><input type="number" min="1" max="15" step="0.5" class="input-field-sm svelte-hj1sc2"/> <span class="unit svelte-hj1sc2">°C</span></div></div> <p class="setting-hint mt-2 svelte-hj1sc2">Alerts are generated when the forecast high or low temperatures differ from your target fermentation temperature by more than the threshold.</p>',1),hn=d('<span class="loading-dot svelte-hj1sc2"></span> Saving...',1),un=d('<p class="config-error svelte-hj1sc2"> </p>'),_n=d('<p class="config-success svelte-hj1sc2">Settings saved</p>'),fn=d('<div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Weather Alerts</h2></div> <div class="card-body svelte-hj1sc2"><div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Enable Weather Alerts</span> <span class="setting-description svelte-hj1sc2">Get alerts when forecast temps may affect fermentation</span></div> <button type="button" aria-label="Toggle weather alerts"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <!> <div class="mt-4 config-actions svelte-hj1sc2"><button type="button" class="btn-primary svelte-hj1sc2"><!></button> <!> <!></div></div></div>'),gn=d('<div class="stat-item svelte-hj1sc2"><span class="stat-value font-mono svelte-hj1sc2"> </span> <span class="stat-label svelte-hj1sc2">Total Readings</span></div> <div class="stat-item svelte-hj1sc2"><span class="stat-value font-mono svelte-hj1sc2"> </span> <span class="stat-label svelte-hj1sc2">Estimated Size</span></div>',1),mn=d('<p class="text-muted svelte-hj1sc2">Unable to load storage stats</p>'),jn=d('<button type="button" class="btn-danger-sm svelte-hj1sc2"> </button>'),bn=d('<p class="cleanup-message svelte-hj1sc2"> </p>'),yn=d('<span class="loading-dot svelte-hj1sc2"></span> Rebooting...',1),wn=ft('<svg class="w-4 h-4 svelte-hj1sc2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" class="svelte-hj1sc2"></path></svg> Reboot System',1),Sn=d('<span class="loading-dot svelte-hj1sc2"></span> Shutting down...',1),xn=ft('<svg class="w-4 h-4 svelte-hj1sc2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" class="svelte-hj1sc2"></path></svg> Shutdown System',1),Tn=d('<div class="grid gap-6 svelte-hj1sc2"><div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">System Information</h2></div> <div class="card-body svelte-hj1sc2"><!></div></div> <div class="grid gap-6 md:grid-cols-2 svelte-hj1sc2"><div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Application Settings</h2></div> <div class="card-body svelte-hj1sc2"><div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Temperature Units</span> <span class="setting-description svelte-hj1sc2">Display temperature in Celsius or Fahrenheit</span></div> <div class="unit-toggle svelte-hj1sc2"><button type="button">°C</button> <button type="button">°F</button></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Minimum RSSI</span> <span class="setting-description svelte-hj1sc2">Ignore readings below this signal strength</span></div> <div class="rssi-input svelte-hj1sc2"><input type="number" min="-100" max="0" class="input-field-sm svelte-hj1sc2"/> <span class="input-suffix svelte-hj1sc2">dBm</span></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Reading Smoothing</span> <span class="setting-description svelte-hj1sc2">Average multiple readings to reduce noise</span></div> <button type="button" aria-label="Toggle reading smoothing"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <!> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Identify by MAC</span> <span class="setting-description svelte-hj1sc2">Use MAC address instead of broadcast ID</span></div> <button type="button" aria-label="Toggle identify by MAC address"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <div class="mt-4 config-actions svelte-hj1sc2"><button type="button" class="btn-primary svelte-hj1sc2"><!></button> <!> <!></div></div></div> <div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Timezone</h2></div> <div class="card-body svelte-hj1sc2"><p class="section-description svelte-hj1sc2">Current timezone: <span class="font-mono text-[var(--amber-400)] svelte-hj1sc2"> </span></p> <div class="timezone-selector svelte-hj1sc2"><select class="select-input svelte-hj1sc2"></select> <!></div></div></div></div> <div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Home Assistant</h2></div> <div class="card-body svelte-hj1sc2"><div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Enable Integration</span> <span class="setting-description svelte-hj1sc2">Connect to Home Assistant for ambient temp and control</span></div> <button type="button" aria-label="Enable Home Assistant integration"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <!></div></div> <!> <!> <div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Storage & Data Cleanup</h2></div> <div class="card-body svelte-hj1sc2"><div class="storage-grid svelte-hj1sc2"><div class="storage-stats svelte-hj1sc2"><!></div> <div class="cleanup-section svelte-hj1sc2"><p class="section-description mb-3 svelte-hj1sc2">Remove old readings to free up storage. Readings older than the specified days will be permanently deleted.</p> <div class="cleanup-controls svelte-hj1sc2"><div class="cleanup-input-group svelte-hj1sc2"><label for="retention-days" class="svelte-hj1sc2">Keep readings from last</label> <input id="retention-days" type="number" min="1" max="365" class="input-field-sm svelte-hj1sc2"/> <span class="svelte-hj1sc2">days</span></div> <div class="cleanup-actions svelte-hj1sc2"><button type="button" class="btn-secondary-sm svelte-hj1sc2"> </button> <!></div></div> <!></div></div></div></div> <div class="card danger-zone svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Power Controls</h2></div> <div class="card-body svelte-hj1sc2"><p class="section-description danger-text svelte-hj1sc2">These actions will affect the entire system. Make sure you have saved any pending work.</p> <div class="power-buttons svelte-hj1sc2"><button type="button" class="btn-warning svelte-hj1sc2"><!></button> <button type="button" class="btn-danger svelte-hj1sc2"><!></button></div></div></div></div>'),kn=d('<div class="page-container svelte-hj1sc2"><div class="page-header svelte-hj1sc2"><h1 class="page-title svelte-hj1sc2">System</h1> <p class="page-description svelte-hj1sc2">System settings, timezone configuration, and power controls</p></div> <!></div>');function In(gt,mt){Aa(mt,!0);let $=c(null),Fe=c(null),As=c(Fa([])),re=c(""),Fs=c(!0),y=c(null),oe=c("C"),Ee=c(-100),ee=c(!1),ze=c(5),ce=c(!1),Oe=c(!1),He=c(null),Ue=c(!1),ve=c(30),P=c(null),V=c(!1),de=c(""),pe=c(""),Ie=c(""),Me=c(""),fe=c(""),ge=c(""),Re=c(!1),se=c(null),Ne=c(null),Pe=c(!1),Be=c(null),De=c(!1),H=c(null),te=c(!1),Le=c(68),me=c(1),Je=c(!1),We=c(null),Ke=c(!1),je=c(!1),ae=c(!1),Ve=c(3),qe=c(!1),Ge=c(null),Ye=c(!1),B=ut(()=>b.config.temp_units==="C"),be=ut(()=>e(B)?"°C":"°F");function jt(i){return i==null?"—":e(B)?_t(i).toFixed(1):i.toFixed(1)}function bt(i){return e(B)?Na(i):i}function yt(i){return e(B)?_t(i):i}async function wt(){try{const i=await fetch("/api/system/info");i.ok&&n($,await i.json(),!0)}catch(i){console.error("Failed to load system info:",i)}}async function Es(){try{const i=await fetch("/api/system/storage");i.ok&&n(Fe,await i.json(),!0)}catch(i){console.error("Failed to load storage stats:",i)}}async function St(){try{const[i,w]=await Promise.all([fetch("/api/system/timezones"),fetch("/api/system/timezone")]);if(i.ok){const z=await i.json();n(As,z.timezones||[],!0)}if(w.ok){const z=await w.json();n(re,z.timezone||"UTC",!0)}}catch(i){console.error("Failed to load timezones:",i)}}function zs(){n(oe,b.config.temp_units,!0),n(Ee,b.config.min_rssi,!0),n(ee,b.config.smoothing_enabled,!0),n(ze,b.config.smoothing_samples,!0),n(ce,b.config.id_by_mac,!0),n(V,b.config.ha_enabled,!0),n(de,b.config.ha_url,!0),n(pe,b.config.ha_token,!0),n(Ie,b.config.ha_ambient_temp_entity_id,!0),n(Me,b.config.ha_ambient_humidity_entity_id,!0),n(fe,b.config.ha_weather_entity_id,!0),n(ge,b.config.ha_heater_entity_id,!0),n(te,b.config.temp_control_enabled,!0),n(Le,Math.round(yt(b.config.temp_target)*2)/2),n(me,b.config.temp_units==="C"?Math.round(b.config.temp_hysteresis*(5/9)*100)/100:b.config.temp_hysteresis,!0),n(ae,b.config.weather_alerts_enabled,!0),n(Ve,b.config.alert_temp_threshold,!0)}async function xt(){n(Oe,!0),n(He,null),n(Ue,!1);try{const i=await as({temp_units:e(oe),min_rssi:e(Ee),smoothing_enabled:e(ee),smoothing_samples:e(ze),id_by_mac:e(ce)});i.success?(n(Ue,!0),setTimeout(()=>n(Ue,!1),3e3)):n(He,i.error||"Failed to save settings",!0)}finally{n(Oe,!1)}}async function Tt(){n(Pe,!0),n(Be,null),n(De,!1);try{const i=await as({ha_enabled:e(V),ha_url:e(de),ha_token:e(pe),ha_ambient_temp_entity_id:e(Ie),ha_ambient_humidity_entity_id:e(Me),ha_weather_entity_id:e(fe),ha_heater_entity_id:e(ge)});i.success?(n(De,!0),setTimeout(()=>n(De,!1),3e3),await Hs()):n(Be,i.error||"Failed to save settings",!0)}finally{n(Pe,!1)}}async function ns(){try{const i=await fetch("/api/control/status");i.ok&&n(H,await i.json(),!0)}catch(i){console.error("Failed to load control status:",i)}}async function kt(){n(Je,!0),n(We,null),n(Ke,!1);try{const i=bt(e(Le)),w=e(B)?e(me)*(9/5):e(me),z=await as({temp_control_enabled:e(te),temp_target:i,temp_hysteresis:w});z.success?(n(Ke,!0),setTimeout(()=>n(Ke,!1),3e3),await ns()):n(We,z.error||"Failed to save settings",!0)}finally{n(Je,!1)}}async function Ct(){n(qe,!0),n(Ge,null),n(Ye,!1);try{const i=await as({weather_alerts_enabled:e(ae),alert_temp_threshold:e(Ve)});i.success?(n(Ye,!0),setTimeout(()=>n(Ye,!1),3e3)):n(Ge,i.error||"Failed to save settings",!0)}finally{n(qe,!1)}}async function is(i){n(je,!0);try{(await fetch("/api/control/override",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({state:i,duration_minutes:60})})).ok&&await ns()}catch(w){console.error("Failed to set override:",w)}finally{n(je,!1)}}async function At(i){n(y,"timezone");try{(await fetch("/api/system/timezone",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({timezone:i})})).ok&&n(re,i,!0)}catch(w){console.error("Failed to set timezone:",w)}finally{n(y,null)}}async function Ft(){n(y,"cleanup-preview");try{const i=await fetch("/api/system/cleanup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({retention_days:e(ve),confirm:!1})});i.ok&&n(P,await i.json(),!0)}catch(i){console.error("Failed to preview cleanup:",i)}finally{n(y,null)}}async function Et(){if(!(!e(P)||e(P).readings_to_delete===0)&&confirm(`Delete ${e(P).readings_to_delete.toLocaleString()} readings older than ${e(ve)} days?`)){n(y,"cleanup");try{(await fetch("/api/system/cleanup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({retention_days:e(ve),confirm:!0})})).ok&&(n(P,null),await Es())}catch(i){console.error("Failed to execute cleanup:",i)}finally{n(y,null)}}}async function zt(){if(confirm("Are you sure you want to reboot the system? The UI will be unavailable until restart completes.")){n(y,"reboot");try{await fetch("/api/system/reboot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirm:!0})})}catch(i){console.error("Reboot command failed:",i)}finally{n(y,null)}}}async function Ot(){if(confirm("Are you sure you want to shut down the system? You will need physical access to restart.")){n(y,"shutdown");try{await fetch("/api/system/shutdown",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirm:!0})})}catch(i){console.error("Shutdown command failed:",i)}finally{n(y,null)}}}function Ht(i){if(!i)return"Unknown";const w=Math.floor(i/86400),z=Math.floor(i%86400/3600),ye=Math.floor(i%3600/60),ne=[];return w>0&&ne.push(`${w}d`),z>0&&ne.push(`${z}h`),ye>0&&ne.push(`${ye}m`),ne.length>0?ne.join(" "):"< 1m"}function Ut(i){return!Number.isFinite(i)||i<0?"0 B":i<1024?`${i} B`:i<1024*1024?`${(i/1024).toFixed(1)} KB`:`${(i/(1024*1024)).toFixed(1)} MB`}function Os(i){return i.toLocaleString()}async function It(){n(Re,!0),n(se,null);try{const i=await fetch("/api/ha/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e(de),token:e(pe)})});i.ok?n(se,await i.json(),!0):n(se,{success:!1,message:"Request failed"},!0)}catch{n(se,{success:!1,message:"Network error"},!0)}finally{n(Re,!1)}}async function Hs(){try{const i=await fetch("/api/ha/status");i.ok&&n(Ne,await i.json(),!0)}catch(i){console.error("Failed to load HA status:",i)}}Ea(async()=>{await Promise.all([wt(),Es(),St(),Hs(),ns()]),zs(),n(Fs,!1)}),za(()=>{b.loaded&&zs()});var ls=kn();Ra("hj1sc2",i=>{Ha(()=>{Ua.title="System | Tilt UI"})});var Mt=a(t(ls),2);{var Rt=i=>{var w=La();o(i,w)},Nt=i=>{var w=Tn(),z=t(w),ye=a(t(z),2),ne=t(ye);{var Pt=l=>{var r=Ja(),p=t(r),g=a(t(p),2),j=t(g,!0);s(g),s(p);var S=a(p,2),k=a(t(S),2),O=t(k);s(k),s(S);var C=a(S,2),F=a(t(C),2),U=t(F,!0);s(F),s(C);var Q=a(C,2),D=a(t(Q),2),L=t(D,!0);s(D),s(Q),s(r),T(J=>{f(j,e($).hostname),f(O,`v${e($).version??""}`),f(U,J),f(L,e($).ip_addresses.length>0?e($).ip_addresses[0]:"Unknown")},[()=>Ht(e($).uptime_seconds)]),o(l,r)},Bt=l=>{var r=Wa();o(l,r)};h(ne,l=>{e($)?l(Pt):l(Bt,!1)})}s(ye),s(z);var rs=a(z,2),os=t(rs),Us=a(t(os),2),cs=t(Us),Is=a(t(cs),2),vs=t(Is);let Ms;vs.__click=()=>n(oe,"C");var Rs=a(vs,2);let Ns;Rs.__click=()=>n(oe,"F"),s(Is),s(cs);var ds=a(cs,2),Ps=a(t(ds),2),Bs=t(Ps);R(Bs),E(2),s(Ps),s(ds);var ps=a(ds,2),hs=a(t(ps),2);let Ds;hs.__click=()=>n(ee,!e(ee)),s(ps);var Ls=a(ps,2);{var Dt=l=>{var r=Ka(),p=a(t(r),2),g=t(p);g.value=g.__value=3;var j=a(g);j.value=j.__value=5;var S=a(j);S.value=S.__value=10;var k=a(S);k.value=k.__value=15;var O=a(k);O.value=O.__value=20,s(p),s(r),Da(p,()=>e(ze),C=>n(ze,C)),o(l,r)};h(Ls,l=>{e(ee)&&l(Dt)})}var us=a(Ls,2),_s=a(t(us),2);let Js;_s.__click=()=>n(ce,!e(ce)),s(us);var Ws=a(us,2),we=t(Ws);we.__click=xt;var Lt=t(we);{var Jt=l=>{var r=Va();E(),o(l,r)},Wt=l=>{var r=ss("Save Settings");o(l,r)};h(Lt,l=>{e(Oe)?l(Jt):l(Wt,!1)})}s(we);var Ks=a(we,2);{var Kt=l=>{var r=qa(),p=t(r,!0);s(r),T(()=>f(p,e(He))),o(l,r)};h(Ks,l=>{e(He)&&l(Kt)})}var Vt=a(Ks,2);{var qt=l=>{var r=Ga();o(l,r)};h(Vt,l=>{e(Ue)&&l(qt)})}s(Ws),s(Us),s(os);var Vs=a(os,2),qs=a(t(Vs),2),fs=t(qs),Gs=a(t(fs)),Gt=t(Gs,!0);s(Gs),s(fs);var Ys=a(fs,2),q=t(Ys);q.__change=l=>At(l.currentTarget.value),Ia(q,21,()=>e(As),Ma,(l,r)=>{var p=Ya(),g=t(p,!0);s(p);var j={};T(()=>{f(g,e(r)),j!==(j=e(r))&&(p.value=(p.__value=e(r))??"")}),o(l,p)}),s(q);var Qs;Pa(q);var Yt=a(q,2);{var Qt=l=>{var r=Qa();o(l,r)};h(Yt,l=>{e(y)==="timezone"&&l(Qt)})}s(Ys),s(qs),s(Vs),s(rs);var gs=a(rs,2),Xs=a(t(gs),2),ms=t(Xs),js=a(t(ms),2);let Zs;js.__click=()=>n(V,!e(V)),s(ms);var Xt=a(ms,2);{var Zt=l=>{var r=tn(),p=ts(r);{var g=v=>{var m=Xa(),M=a(t(m),2);let _e;var xs=t(M,!0);s(M),s(m),T(()=>{_e=I(M,1,"status-badge svelte-hj1sc2",null,_e,{connected:e(Ne).connected}),f(xs,e(Ne).connected?"Connected":"Disconnected")}),o(v,m)};h(p,v=>{e(Ne)&&v(g)})}var j=a(p,2),S=a(t(j),2);R(S),s(j);var k=a(j,2),O=a(t(k),2);R(O),s(k);var C=a(k,2),F=a(t(C),2),U=t(F);U.__click=It;var Q=t(U,!0);s(U);var D=a(U,2);{var L=v=>{var m=Za();let M;var _e=t(m,!0);s(m),T(()=>{M=I(m,1,"test-result svelte-hj1sc2",null,M,{success:e(se).success}),f(_e,e(se).message)}),o(v,m)};h(D,v=>{e(se)&&v(L)})}s(F),s(C);var J=a(C,2),he=a(t(J),2);R(he),s(J);var X=a(J,2),u=a(t(X),2);R(u),s(X);var x=a(X,2),G=a(t(x),2);R(G),s(x);var W=a(x,2),Y=a(t(W),2);R(Y),s(W);var ie=a(W,2),le=t(ie);le.__click=Tt;var Xe=t(le);{var Z=v=>{var m=$a();E(),o(v,m)},Ze=v=>{var m=ss("Save HA Settings");o(v,m)};h(Xe,v=>{e(Pe)?v(Z):v(Ze,!1)})}s(le);var $e=a(le,2);{var Te=v=>{var m=en(),M=t(m,!0);s(m),T(()=>f(M,e(Be))),o(v,m)};h($e,v=>{e(Be)&&v(Te)})}var es=a($e,2);{var ue=v=>{var m=sn();o(v,m)};h(es,v=>{e(De)&&v(ue)})}s(ie),T(()=>{U.disabled=e(Re)||!e(de)||!e(pe),f(Q,e(Re)?"Testing...":"Test"),le.disabled=e(Pe)}),N(S,()=>e(de),v=>n(de,v)),N(O,()=>e(pe),v=>n(pe,v)),N(he,()=>e(Ie),v=>n(Ie,v)),N(u,()=>e(Me),v=>n(Me,v)),N(G,()=>e(fe),v=>n(fe,v)),N(Y,()=>e(ge),v=>n(ge,v)),o(l,r)};h(Xt,l=>{e(V)&&l(Zt)})}s(Xs),s(gs);var $s=a(gs,2);{var $t=l=>{var r=dn(),p=a(t(r),2),g=t(p),j=a(t(g),2);let S;j.__click=()=>n(te,!e(te)),s(g);var k=a(g,2);{var O=C=>{var F=vn(),U=ts(F);{var Q=_=>{var A=nn(),Ce=t(A),Ts=a(t(Ce),2);let dt;var ya=t(Ts,!0);s(Ts),s(Ce);var ks=a(Ce,2),pt=a(t(ks),2),wa=t(pt,!0);s(pt),s(ks);var Sa=a(ks,2);{var xa=Ae=>{var Cs=an(),ht=a(t(Cs),2),Ta=t(ht,!0);s(ht),s(Cs),T(ka=>f(Ta,ka),[()=>e(H).override_state?.toUpperCase()]),o(Ae,Cs)};h(Sa,Ae=>{e(H).override_active&&Ae(xa)})}s(A),T(Ae=>{dt=I(Ts,1,"status-value svelte-hj1sc2",null,dt,{"heater-on":e(H).heater_state==="on"}),f(ya,e(H).heater_state==="on"?"ON":e(H).heater_state==="off"?"OFF":"—"),f(wa,Ae)},[()=>e(H).wort_temp!==null?`${jt(e(H).wort_temp)}${e(be)}`:"—"]),o(_,A)};h(U,_=>{e(H)&&_(Q)})}var D=a(U,2),L=t(D),J=a(t(L),2),he=t(J);s(J),s(L);var X=a(L,2),u=t(X);R(u);var x=a(u,2),G=t(x,!0);s(x),s(X),s(D);var W=a(D,2),Y=t(W),ie=a(t(Y),2),le=t(ie);s(ie),s(Y);var Xe=a(Y,2),Z=t(Xe);R(Z);var Ze=a(Z,2),$e=t(Ze,!0);s(Ze),s(Xe),s(W);var Te=a(W,2),es=a(t(Te),2),ue=t(es);let v;ue.__click=()=>is("on");var m=a(ue,2);let M;m.__click=()=>is("off");var _e=a(m,2);{var xs=_=>{var A=ln();A.__click=()=>is(null),T(()=>A.disabled=e(je)),o(_,A)};h(_e,_=>{e(H)?.override_active&&_(xs)})}s(es),s(Te);var ct=a(Te,2),ke=t(ct);ke.__click=kt;var _a=t(ke);{var fa=_=>{var A=rn();E(),o(_,A)},ga=_=>{var A=ss("Save Control Settings");o(_,A)};h(_a,_=>{e(Je)?_(fa):_(ga,!1)})}s(ke);var vt=a(ke,2);{var ma=_=>{var A=on(),Ce=t(A,!0);s(A),T(()=>f(Ce,e(We))),o(_,A)};h(vt,_=>{e(We)&&_(ma)})}var ja=a(vt,2);{var ba=_=>{var A=cn();o(_,A)};h(ja,_=>{e(Ke)&&_(ba)})}s(ct),T(()=>{f(he,`Desired fermentation temperature (${e(be)??""})`),K(u,"min",e(B)?0:32),K(u,"max",e(B)?38:100),f(G,e(be)),f(le,`± tolerance before triggering (${e(be)??""})`),K(Z,"min",e(B)?.3:.5),K(Z,"max",e(B)?5.5:10),K(Z,"step",e(B)?.25:.5),f($e,e(be)),v=I(ue,1,"btn-override svelte-hj1sc2",null,v,{active:e(H)?.override_state==="on"}),ue.disabled=e(je),M=I(m,1,"btn-override svelte-hj1sc2",null,M,{active:e(H)?.override_state==="off"}),m.disabled=e(je),ke.disabled=e(Je)}),N(u,()=>e(Le),_=>n(Le,_)),N(Z,()=>e(me),_=>n(me,_)),o(C,F)};h(k,C=>{e(te)&&C(O)})}s(p),s(r),T(()=>{S=I(j,1,"toggle svelte-hj1sc2",null,S,{active:e(te)}),K(j,"aria-pressed",e(te))}),o(l,r)};h($s,l=>{e(V)&&e(ge)&&l($t)})}var et=a($s,2);{var ea=l=>{var r=fn(),p=a(t(r),2),g=t(p),j=a(t(g),2);let S;j.__click=()=>n(ae,!e(ae)),s(g);var k=a(g,2);{var O=u=>{var x=pn(),G=ts(x),W=a(t(G),2),Y=t(W);R(Y),E(2),s(W),s(G),E(2),N(Y,()=>e(Ve),ie=>n(Ve,ie)),o(u,x)};h(k,u=>{e(ae)&&u(O)})}var C=a(k,2),F=t(C);F.__click=Ct;var U=t(F);{var Q=u=>{var x=hn();E(),o(u,x)},D=u=>{var x=ss("Save Alert Settings");o(u,x)};h(U,u=>{e(qe)?u(Q):u(D,!1)})}s(F);var L=a(F,2);{var J=u=>{var x=un(),G=t(x,!0);s(x),T(()=>f(G,e(Ge))),o(u,x)};h(L,u=>{e(Ge)&&u(J)})}var he=a(L,2);{var X=u=>{var x=_n();o(u,x)};h(he,u=>{e(Ye)&&u(X)})}s(C),s(p),s(r),T(()=>{S=I(j,1,"toggle svelte-hj1sc2",null,S,{active:e(ae)}),K(j,"aria-pressed",e(ae)),F.disabled=e(qe)}),o(l,r)};h(et,l=>{e(V)&&e(fe)&&l(ea)})}var bs=a(et,2),st=a(t(bs),2),tt=t(st),ys=t(tt),sa=t(ys);{var ta=l=>{var r=gn(),p=ts(r),g=t(p),j=t(g,!0);s(g),E(2),s(p);var S=a(p,2),k=t(S),O=t(k,!0);s(k),E(2),s(S),T((C,F)=>{f(j,C),f(O,F)},[()=>Os(e(Fe).total_readings),()=>Ut(e(Fe).estimated_size_bytes)]),o(l,r)},aa=l=>{var r=mn();o(l,r)};h(sa,l=>{e(Fe)?l(ta):l(aa,!1)})}s(ys);var at=a(ys,2),ws=a(t(at),2),Ss=t(ws),nt=a(t(Ss),2);R(nt),E(2),s(Ss);var it=a(Ss,2),Se=t(it);Se.__click=Ft;var na=t(Se,!0);s(Se);var ia=a(Se,2);{var la=l=>{var r=jn();r.__click=Et;var p=t(r,!0);s(r),T(g=>{r.disabled=e(y)!==null,f(p,g)},[()=>e(y)==="cleanup"?"Deleting...":`Delete ${Os(e(P).readings_to_delete)} readings`]),o(l,r)};h(ia,l=>{e(P)&&e(P).readings_to_delete>0&&l(la)})}s(it),s(ws);var ra=a(ws,2);{var oa=l=>{var r=bn(),p=t(r);s(r),T(()=>f(p,`No readings older than ${e(ve)??""} days found.`)),o(l,r)};h(ra,l=>{e(P)&&e(P).readings_to_delete===0&&l(oa)})}s(at),s(tt),s(st),s(bs);var lt=a(bs,2),rt=a(t(lt),2),ot=a(t(rt),2),xe=t(ot);xe.__click=zt;var ca=t(xe);{var va=l=>{var r=yn();E(),o(l,r)},da=l=>{var r=wn();E(),o(l,r)};h(ca,l=>{e(y)==="reboot"?l(va):l(da,!1)})}s(xe);var Qe=a(xe,2);Qe.__click=Ot;var pa=t(Qe);{var ha=l=>{var r=Sn();E(),o(l,r)},ua=l=>{var r=xn();E(),o(l,r)};h(pa,l=>{e(y)==="shutdown"?l(ha):l(ua,!1)})}s(Qe),s(ot),s(rt),s(lt),s(w),T(()=>{Ms=I(vs,1,"unit-btn svelte-hj1sc2",null,Ms,{active:e(oe)==="C"}),Ns=I(Rs,1,"unit-btn svelte-hj1sc2",null,Ns,{active:e(oe)==="F"}),Ds=I(hs,1,"toggle svelte-hj1sc2",null,Ds,{active:e(ee)}),K(hs,"aria-pressed",e(ee)),Js=I(_s,1,"toggle svelte-hj1sc2",null,Js,{active:e(ce)}),K(_s,"aria-pressed",e(ce)),we.disabled=e(Oe),f(Gt,e(re)),q.disabled=e(y)==="timezone",Qs!==(Qs=e(re))&&(q.value=(q.__value=e(re))??"",Ba(q,e(re))),Zs=I(js,1,"toggle svelte-hj1sc2",null,Zs,{active:e(V)}),K(js,"aria-pressed",e(V)),Se.disabled=e(y)!==null,f(na,e(y)==="cleanup-preview"?"Checking...":"Preview"),xe.disabled=e(y)!==null,Qe.disabled=e(y)!==null}),N(Bs,()=>e(Ee),l=>n(Ee,l)),N(nt,()=>e(ve),l=>n(ve,l)),o(i,w)};h(Mt,i=>{e(Fs)?i(Rt):i(Nt,!1)})}s(ls),o(gt,ls),Oa()}Ca(["click","change"]);export{In as component};
