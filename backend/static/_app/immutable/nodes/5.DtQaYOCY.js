import{d as Yt,f as n,s as d,a as l,c as Ge,t as va,h as ga,e as kt}from"../chunks/orbuQWWI.js";import{d as a,e as s,r as t,t as _,a as Ut,f as oe,h as e,u as I,n as je,g as Vt,s as G,p as Qe,o as Wa,c as o,az as Ma,b9 as ss,ay as rs,i as Aa,aJ as ls,aC as is,ax as ns}from"../chunks/pAodAtlG.js";import{e as Bt,i as Ht}from"../chunks/0whDC7Rl.js";import{i as v}from"../chunks/ucc1DXe2.js";import{h as vs}from"../chunks/DJBMpqSf.js";import{s as Kt,r as wt,a as os}from"../chunks/CYuZshLQ.js";import{s as He}from"../chunks/Cpbxxhlc.js";import{s as Ft}from"../chunks/C-5oeV0L.js";import{b as Ta,i as ds,s as cs}from"../chunks/RboyDiSx.js";import{s as us,a as _s}from"../chunks/BkeTWnxc.js";import{p as ps}from"../chunks/Cv0rN01i.js";import{g as fs}from"../chunks/KM-9IPl1.js";import{a8 as gs,a9 as hs,aa as ms,ab as bs,ac as ys,Q as na,ad as xs,ae as ks,af as ws,X as js,S as Ca,ag as ja,a3 as qs,ah as Ba}from"../chunks/DsM_eXzM.js";import{b as jt,d as Sa,g as Da,c as qa}from"../chunks/C54DtTUy.js";import{t as Ha}from"../chunks/DWpXqN03.js";import{B as Ss}from"../chunks/Dzjp8j6H.js";import{s as Ms}from"../chunks/GbV1md6Y.js";import{p as aa}from"../chunks/C44MPb_E.js";import{F as Cs}from"../chunks/CfPvXJRK.js";import{b as ft}from"../chunks/Dh5hCwq1.js";import{s as Fa}from"../chunks/BkabqQ1A.js";const Bs=!1,xn=Object.freeze(Object.defineProperty({__proto__:null,prerender:Bs},Symbol.toStringTag,{value:"Module"}));function Fs(Re){return Re>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:Re>=-60?{bars:3,color:"var(--positive)",label:"Good"}:Re>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function Xa(Re){const i=Math.floor((Date.now()-new Date(Re).getTime())/1e3);if(i<10)return"just now";if(i<60)return`${i}s ago`;const g=Math.floor(i/60);if(g<60)return`${g}m ago`;const w=Math.floor(g/60);return w<24?`${w}h ago`:`${Math.floor(w/24)}d ago`}var zs=n('<div class="accent-bar svelte-1oyrwd9"></div>'),Ts=n('<span class="card-icon svelte-1oyrwd9"> </span>'),As=n('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),Ds=n('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function xa(Re,i){let g=aa(i,"highlight",3,!1),w=aa(i,"compact",3,!1),N=aa(i,"collapsible",3,!1),M=aa(i,"expanded",3,!1);var W=Ds();let r;var A=a(W);{var j=O=>{var E=zs();l(O,E)};v(A,O=>{g()&&O(j)})}var Z=s(A,2),ye=a(Z),Fe=a(ye);{var S=O=>{var E=Ts(),ae=a(E,!0);t(E),_(()=>d(ae,i.icon)),l(O,E)};v(Fe,O=>{i.icon&&O(S)})}var $=s(Fe,2),K=a($,!0);t($),t(ye);var _e=s(ye,2);{var D=O=>{var E=As();E.__click=function(...fe){i.onToggle?.apply(this,fe)};var ae=a(E);let te;t(E),_(()=>{Kt(E,"aria-label",M()?"Collapse":"Expand"),te=He(ae,0,"expand-icon svelte-1oyrwd9",null,te,{"rotate-180":M()})}),l(O,E)};v(_e,O=>{N()&&i.onToggle&&O(D)})}t(Z);var Y=s(Z,2);let ee;var ne=a(Y);Ms(ne,()=>i.children),t(Y),t(W),_(()=>{r=He(W,1,"batch-card svelte-1oyrwd9",null,r,{highlight:g(),compact:w()}),d(K,i.title),ee=He(Y,1,"card-content svelte-1oyrwd9",null,ee,{collapsed:N()&&!M()})}),l(Re,W)}Yt(["click"]);var Rs=n('<span class="updated-text svelte-t80j9z"> </span>'),Ps=n('<div class="hero-divider svelte-t80j9z"></div> <div class="hero-metric temperature svelte-t80j9z"><span class="hero-value svelte-t80j9z"> <span class="hero-unit svelte-t80j9z"> </span></span> <span class="hero-label svelte-t80j9z">Temperature</span></div>',1),Ns=n('<div class="remaining-text svelte-t80j9z"> </div>'),Os=n('<div class="progress-section svelte-t80j9z"><div class="progress-labels svelte-t80j9z"><div class="progress-endpoint start svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">OG</span></div> <div class="progress-current svelte-t80j9z"><span class="current-percent svelte-t80j9z"> </span></div> <div class="progress-endpoint end svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">Target FG</span></div></div> <div class="progress-track svelte-t80j9z"><div class="progress-fill svelte-t80j9z"></div> <div><div class="marker-dot svelte-t80j9z"></div> <div class="marker-value svelte-t80j9z"> </div></div></div> <!></div>'),Ls=n('<div class="metrics-row svelte-t80j9z"><div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">ABV</span></div> <div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">Attenuation</span></div></div>'),Is=n('<div class="status-row svelte-t80j9z"><div class="live-indicator svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> <span class="status-text svelte-t80j9z">LIVE</span></div> <!></div> <div class="hero-section svelte-t80j9z"><div class="hero-metric gravity svelte-t80j9z"><span class="hero-value svelte-t80j9z"> </span> <span class="hero-label svelte-t80j9z">Gravity</span></div> <!></div> <!> <!>',1),Es=n('<div class="completed-grid svelte-t80j9z"><div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Original Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Final Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">ABV</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Attenuation</span></div></div>'),Gs=n('<div class="empty-state svelte-t80j9z"><div class="empty-icon svelte-t80j9z">‚óé</div> <p class="empty-text svelte-t80j9z">Set Original Gravity to track fermentation</p></div>');function Hs(Re,i){Ut(i,!0);let g=I(()=>i.currentSg??i.progress?.measured?.current_sg),w=I(()=>i.liveReading?.temp??i.progress?.temperature?.current),N=I(()=>i.liveReading?.last_seen),M=I(()=>e(N)?Xa(e(N)):null),W=I(Da),r=I(()=>{if(!i.batch.measured_og||!e(g))return null;const S=Math.max(0,(i.batch.measured_og-e(g))*131.25),$=i.batch.measured_og-1,K=$!==0?Math.max(0,Math.min(100,(i.batch.measured_og-e(g))/$*100)):0;return{abv:S,attenuation:K}}),A=I(()=>{const S=i.batch.measured_og,$=i.batch.recipe?.fg;if(!S||!$||!e(g))return null;const K=S-$,_e=S-e(g);return K<=0?null:Math.max(0,Math.min(100,_e/K*100))}),j=I(()=>i.batch.status==="fermenting"||i.batch.status==="conditioning");function Z(S){return S==null?"--":jt(S)}function ye(S){return S==null?"--":`${S.toFixed(1)}%`}function Fe(S){return S==null?"--":Sa(S)}xa(Re,{title:"Fermentation",children:(S,$)=>{var K=Ge(),_e=oe(K);{var D=ee=>{var ne=Is(),O=oe(ne),E=s(a(O),2);{var ae=m=>{var f=Rs(),b=a(f);t(f),_(()=>d(b,`Updated ${e(M)??""}`)),l(m,f)};v(E,m=>{e(M)&&m(ae)})}t(O);var te=s(O,2),fe=a(te),qe=a(fe),ze=a(qe,!0);t(qe),je(2),t(fe);var ve=s(fe,2);{var u=m=>{var f=Ps(),b=s(oe(f),2),C=a(b),x=a(C,!0),F=s(x),X=a(F,!0);t(F),t(C),je(2),t(b),_(P=>{d(x,P),d(X,e(W))},[()=>Fe(e(w))]),l(m,f)};v(ve,m=>{e(w)!=null&&m(u)})}t(te);var c=s(te,2);{var h=m=>{var f=Os(),b=a(f),C=a(b),x=a(C),F=a(x,!0);t(x),je(2),t(C);var X=s(C,2),P=a(X),se=a(P);t(P),t(X);var Q=s(X,2),re=a(Q),le=a(re,!0);t(re),je(2),t(Q),t(b);var de=s(b,2),ge=a(de),Ce=s(ge,2);let Ne;var Be=s(a(Ce),2),ie=a(Be,!0);t(Be),t(Ce),t(de);var p=s(de,2);{var k=z=>{var T=Ns(),V=a(T);t(T),_(J=>d(V,`${J??""} points to go`),[()=>i.progress.progress.sg_remaining.toFixed(3)]),l(z,T)};v(p,z=>{i.progress?.progress?.sg_remaining!=null&&i.progress.progress.sg_remaining>0&&z(k)})}t(f),_((z,T,V,J)=>{d(F,z),d(se,`${T??""}%`),d(le,V),Ft(ge,`width: ${e(A)??""}%`),Ne=He(Ce,1,"progress-marker svelte-t80j9z",null,Ne,{"at-start":e(A)<3}),Ft(Ce,`left: ${e(A)??""}%`),d(ie,J)},[()=>Z(i.batch.measured_og),()=>e(A).toFixed(0),()=>Z(i.batch.recipe.fg),()=>Z(e(g))]),l(m,f)};v(c,m=>{e(A)!==null&&i.batch.measured_og&&i.batch.recipe?.fg&&m(h)})}var L=s(c,2);{var y=m=>{var f=Ls(),b=a(f),C=a(b),x=a(C,!0);t(C),je(2),t(b);var F=s(b,2),X=a(F),P=a(X,!0);t(X),je(2),t(F),t(f),_((se,Q)=>{d(x,se),d(P,Q)},[()=>ye(e(r).abv),()=>ye(e(r).attenuation)]),l(m,f)};v(L,m=>{e(r)&&m(y)})}_(m=>d(ze,m),[()=>Z(e(g))]),l(ee,ne)},Y=ee=>{var ne=Ge(),O=oe(ne);{var E=te=>{const fe=I(()=>i.batch.measured_fg??i.progress?.measured?.fg??i.progress?.measured?.current_sg),qe=I(()=>i.batch.measured_abv??i.progress?.measured?.abv),ze=I(()=>i.batch.measured_attenuation??i.progress?.measured?.attenuation);var ve=Es(),u=a(ve),c=a(u),h=a(c,!0);t(c),je(2),t(u);var L=s(u,2),y=a(L),m=a(y,!0);t(y),je(2),t(L);var f=s(L,2),b=a(f),C=a(b,!0);t(b),je(2),t(f);var x=s(f,2),F=a(x),X=a(F,!0);t(F),je(2),t(x),t(ve),_((P,se,Q,re)=>{d(h,P),d(m,se),d(C,Q),d(X,re)},[()=>Z(i.batch.measured_og),()=>Z(e(fe)),()=>e(qe)!=null?ye(e(qe)):"--",()=>e(ze)!=null?ye(e(ze)):"--"]),l(te,ve)},ae=te=>{var fe=Gs();l(te,fe)};v(O,te=>{i.batch.measured_og?te(E):te(ae,!1)},!0)}l(ee,ne)};v(_e,ee=>{e(g)&&e(j)?ee(D):ee(Y,!1)})}l(S,K)},$$slots:{default:!0}}),Vt()}var Us=n('<span class="device-last-seen svelte-1kdxwtz"> </span>'),Vs=n('<div class="signal-bar svelte-1kdxwtz"></div>'),Ws=n('<div class="metric-item svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="metric-text svelte-1kdxwtz"> </span></div>'),Xs=n('<div class="metric-item battery svelte-1kdxwtz"><svg class="battery-icon svelte-1kdxwtz" viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="2" y="7" width="18" height="10" rx="2"></rect><rect x="4" y="9" height="6" stroke="none" rx="1"></rect><path d="M20 10v4h2v-4z" stroke="none"></path></svg> <span class="metric-text svelte-1kdxwtz"><!></span></div>'),Js=n('<div class="device-metrics svelte-1kdxwtz"><!> <!></div>'),Ks=n('<div class="device-row svelte-1kdxwtz"><div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!></div> <!>',1),Ys=n('<div class="device-row svelte-1kdxwtz"><div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <span class="device-last-seen svelte-1kdxwtz">No data</span></div>'),Qs=n('<div class="device-info svelte-1kdxwtz"><!></div>'),Zs=n('<button type="button" class="link-btn svelte-1kdxwtz">Link device</button>'),$s=n('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function Ua(Re,i){Ut(i,!0);let g=I(()=>i.liveReading?.device_type==="tilt"),w=I(()=>e(g)&&i.liveReading?.rssi?Fs(i.liveReading.rssi):null),N=I(()=>i.liveReading?.last_seen?Xa(i.liveReading.last_seen):null),M=I(()=>i.liveReading?.battery_percent!=null||i.liveReading?.battery_voltage!=null),W=I(()=>i.liveReading?.battery_percent),r=I(()=>i.liveReading?.battery_voltage),A=I(()=>e(W)?e(W)>50?"var(--positive)":e(W)>20?"var(--warning)":"var(--negative)":"var(--text-muted)"),j=I(()=>{if(!i.liveReading)return i.batch.device_id||"Unknown";const Z=i.liveReading.device_type;return Z==="tilt"?`${i.liveReading.color} Tilt`:Z==="gravitymon"?`GravityMon (${i.liveReading.id})`:Z==="ispindel"?`iSpindel (${i.liveReading.id})`:Z==="floaty"?`Floaty (${i.liveReading.id})`:i.liveReading.color||i.liveReading.id});xa(Re,{title:"Tracking Device",compact:!0,children:(Z,ye)=>{var Fe=Ge(),S=oe(Fe);{var $=_e=>{var D=Qs(),Y=a(D);{var ee=O=>{var E=Ks(),ae=oe(E),te=a(ae),fe=s(a(te));t(te);var qe=s(te,2);{var ze=c=>{var h=Us(),L=a(h,!0);t(h),_(()=>d(L,e(N))),l(c,h)};v(qe,c=>{e(N)&&c(ze)})}t(ae);var ve=s(ae,2);{var u=c=>{var h=Js(),L=a(h);{var y=b=>{var C=Ws(),x=a(C);Bt(x,20,()=>Array(4),Ht,(P,se,Q)=>{var re=Vs();_(()=>Ft(re,`height: ${4+Q*2}px; background: ${(Q<e(w).bars?e(w).color:"var(--bg-hover)")??""}; opacity: ${Q<e(w).bars?1:.4};`)),l(P,re)}),t(x);var F=s(x,2),X=a(F);t(F),t(C),_(()=>{Ft(F,`color: ${e(w).color??""}`),d(X,`${i.liveReading.rssi??""}dBm`)}),l(b,C)};v(L,b=>{e(w)&&b(y)})}var m=s(L,2);{var f=b=>{var C=Xs(),x=a(C),F=s(a(x)),X=s(F);t(x);var P=s(x,2),se=a(P);{var Q=le=>{var de=va();_(ge=>d(de,`${ge??""}%`),[()=>e(W).toFixed(0)]),l(le,de)},re=le=>{var de=Ge(),ge=oe(de);{var Ce=Ne=>{var Be=va();_(ie=>d(Be,`${ie??""}V`),[()=>e(r).toFixed(2)]),l(Ne,Be)};v(ge,Ne=>{e(r)!=null&&Ne(Ce)},!0)}l(le,de)};v(se,le=>{e(W)!=null?le(Q):le(re,!1)})}t(P),t(C),_(()=>{Kt(x,"stroke",e(A)),Kt(F,"width",(e(W)??50)*.14),Kt(F,"fill",e(A)),Kt(X,"fill",e(A)),Ft(P,`color: ${e(A)??""}`)}),l(b,C)};v(m,b=>{e(M)&&b(f)})}t(h),l(c,h)};v(ve,c=>{(e(w)||e(M))&&c(u)})}_(()=>d(fe,` ${e(j)??""}`)),l(O,E)},ne=O=>{var E=Ys(),ae=a(E),te=s(a(ae));t(ae),je(2),t(E),_(()=>d(te,` ${i.batch.device_id??""}`)),l(O,E)};v(Y,O=>{i.liveReading?O(ee):O(ne,!1)})}t(D),l(_e,D)},K=_e=>{var D=$s(),Y=s(a(D),2);{var ee=ne=>{var O=Zs();O.__click=function(...E){i.onEdit?.apply(this,E)},l(ne,O)};v(Y,ne=>{i.onEdit&&ne(ee)})}t(D),l(_e,D)};v(S,_e=>{i.batch.device_id?_e($):_e(K,!1)})}l(Z,Fe)},$$slots:{default:!0}}),Vt()}Yt(["click"]);const er=131.25;var tr=n('<span class="yeast-producer svelte-19u9n31"> </span>'),ar=n('<span class="yeast-temp svelte-19u9n31"> </span>'),sr=n('<div class="yeast-row recipe svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Recipe</span> <span class="yeast-value muted svelte-19u9n31"> </span></div>'),rr=n('<div class="yeast-row actual svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span> <!> <!></div> <!>',1),lr=n('<div class="yeast-row svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span></div>'),ir=n('<div class="yeast-section svelte-19u9n31"><!></div>'),nr=n('<div class="targets-row svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div></div> <!>',1);function za(Re,i){Ut(i,!0);function g(N){return N==null?"--":jt(N)}let w=I(()=>i.recipe.abv!=null?i.recipe.abv:i.recipe.og&&i.recipe.fg?(i.recipe.og-i.recipe.fg)*er:null);xa(Re,{title:"Recipe Targets",compact:!0,children:(N,M)=>{var W=nr(),r=oe(W),A=a(r),j=s(a(A),2),Z=a(j,!0);t(j),t(A);var ye=s(A,2),Fe=s(a(ye),2),S=a(Fe,!0);t(Fe),t(ye);var $=s(ye,2),K=s(a($),2),_e=a(K,!0);t(K),t($),t(r);var D=s(r,2);{var Y=ee=>{var ne=ir(),O=a(ne);{var E=te=>{var fe=rr(),qe=oe(fe),ze=s(a(qe),2),ve=a(ze,!0);t(ze);var u=s(ze,2);{var c=f=>{var b=tr(),C=a(b);t(b),_(()=>d(C,`(${i.yeastStrain.producer??""})`)),l(f,b)};v(u,f=>{i.yeastStrain.producer&&f(c)})}var h=s(u,2);{var L=f=>{var b=ar(),C=a(b);t(b),_((x,F)=>d(C,`${x??""}-${F??""}¬∞C`),[()=>i.yeastStrain.temp_low.toFixed(0),()=>i.yeastStrain.temp_high.toFixed(0)]),l(f,b)};v(h,f=>{i.yeastStrain.temp_low&&i.yeastStrain.temp_high&&f(L)})}t(qe);var y=s(qe,2);{var m=f=>{var b=sr(),C=s(a(b),2),x=a(C,!0);t(C),t(b),_(()=>d(x,i.recipe.yeast_name)),l(f,b)};v(y,f=>{i.recipe.yeast_name&&f(m)})}_(()=>d(ve,i.yeastStrain.name)),l(te,fe)},ae=te=>{var fe=Ge(),qe=oe(fe);{var ze=ve=>{var u=lr(),c=s(a(u),2),h=a(c,!0);t(c),t(u),_(()=>d(h,i.recipe.yeast_name)),l(ve,u)};v(qe,ve=>{i.recipe.yeast_name&&ve(ze)},!0)}l(te,fe)};v(O,te=>{i.yeastStrain?te(E):te(ae,!1)})}t(ne),l(ee,ne)};v(D,ee=>{(i.yeastStrain||i.recipe.yeast_name)&&ee(Y)})}_((ee,ne,O)=>{d(Z,ee),d(S,ne),d(_e,O)},[()=>g(i.recipe.og),()=>g(i.recipe.fg),()=>e(w)!=null?`${e(w).toFixed(1)}%`:"--"]),l(N,W)},$$slots:{default:!0}}),Vt()}var vr=n('<p class="notes-content svelte-hkv31i"> </p>');function Va(Re,i){xa(Re,{title:"Notes",children:(g,w)=>{var N=vr(),M=a(N,!0);t(N),_(()=>d(M,i.notes)),l(g,N)},$$slots:{default:!0}})}var or=n('<div class="ml-panel loading svelte-1xs394q"><p> </p></div>'),dr=n('<div class="ml-panel error svelte-1xs394q"><p class="error-text svelte-1xs394q"> </p></div>'),cr=n("<option> </option>"),ur=n('<div class="header-controls svelte-1xs394q"><select class="model-select svelte-1xs394q" title="Select prediction model"></select> <button type="button" class="reload-btn svelte-1xs394q" title="Recalculate predictions from database history"> </button></div>'),_r=n('<span class="accuracy-icon svelte-1xs394q">‚úì</span> <span class="accuracy-title svelte-1xs394q">Excellent Prediction</span>',1),pr=n('<span class="accuracy-icon svelte-1xs394q">‚âà</span> <span class="accuracy-title svelte-1xs394q">Close Prediction</span>',1),fr=n('<span class="accuracy-icon svelte-1xs394q">‚ñ≥</span> <span class="accuracy-title svelte-1xs394q">Prediction Variance</span>',1),gr=n('<div><div class="accuracy-header svelte-1xs394q"><!></div> <p class="accuracy-detail svelte-1xs394q"> <span class="accuracy-diff svelte-1xs394q"> </span></p></div>'),hr=n('<span class="comparison-predicted svelte-1xs394q"> </span>'),mr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model:</span> <span class="model-value model-type svelte-1xs394q"> </span></div>'),br=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),yr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),xr=n('<div class="summary-section svelte-1xs394q"><!> <div class="comparison-grid svelte-1xs394q"><div class="comparison-item svelte-1xs394q"><span class="comparison-label svelte-1xs394q">Final Gravity</span> <div class="comparison-values svelte-1xs394q"><span class="comparison-actual svelte-1xs394q"> </span> <!></div></div></div> <div class="model-info summary-model svelte-1xs394q"><!> <!> <!></div></div>'),kr=n('<span class="anomaly-reasons svelte-1xs394q"> </span>'),wr=n('<div class="anomaly-banner svelte-1xs394q"><span class="anomaly-icon svelte-1xs394q">‚ö†Ô∏è</span> <div class="anomaly-content svelte-1xs394q"><span class="anomaly-label svelte-1xs394q">Anomaly Detected</span> <!></div></div>'),jr=n('<span class="activity-badge svelte-1xs394q"> </span>'),qr=n('<div class="progress-section svelte-1xs394q"><div class="progress-header svelte-1xs394q"><span class="progress-label svelte-1xs394q">Fermentation Progress</span> <!></div> <div class="fermentation-progress-bar svelte-1xs394q"><div class="fermentation-fill svelte-1xs394q"></div></div> <div class="progress-labels svelte-1xs394q"><span class="og-label svelte-1xs394q"> </span> <span class="progress-percent svelte-1xs394q"> </span> <span class="fg-label svelte-1xs394q"> </span></div></div>'),Sr=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Predicted FG:</span> <span class="value svelte-1xs394q"> </span></div>'),Mr=n('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Attenuation:</span> <span class="value attenuation svelte-1xs394q"> </span></div>'),Cr=n('<span class="complete-now svelte-1xs394q">Ready now!</span>'),Br=n('<span class="days svelte-1xs394q"> </span>'),Fr=n(" <!>",1),zr=n('<div class="metric completion-metric svelte-1xs394q"><span class="label svelte-1xs394q">Est. Completion:</span> <span class="value svelte-1xs394q"><!></span></div>'),Tr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model:</span> <span class="model-value model-type svelte-1xs394q"> </span></div>'),Ar=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),Dr=n('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),Rr=n('<!> <!> <div class="metrics svelte-1xs394q"><!> <!> <!> <div class="model-info svelte-1xs394q"><!> <!> <!></div></div>',1),Pr=n('<div><div class="panel-header svelte-1xs394q"><h3 class="panel-title svelte-1xs394q"> </h3> <!></div> <!></div>'),Nr=n('<div class="ml-panel disabled svelte-1xs394q"><div class="disabled-header svelte-1xs394q"><p class="unavailable-text svelte-1xs394q"> </p> <button type="button" class="reload-btn svelte-1xs394q" title="Reload predictions from database"> </button></div> <p class="unavailable-hint svelte-1xs394q"><!></p></div>');function Or(Re,i){Ut(i,!0);let g=aa(i,"batchStatus",3,"fermenting"),w=aa(i,"measuredOg",3,null),N=aa(i,"measuredFg",3,null),M=aa(i,"currentSg",3,null),W=aa(i,"liveReading",3,null),r=G(Qe({available:!1})),A=G(!0),j=G(!1),Z=G(null),ye=G("auto");const Fe=[{value:"auto",label:"Auto (Best Fit)"},{value:"exponential",label:"Exponential"},{value:"gompertz",label:"Gompertz (S-Curve)"},{value:"logistic",label:"Logistic"}];let S=I(()=>g()==="completed"||g()==="archived"),$=I(()=>N()??M()),K=I(()=>{if(!e(S)||!e(r).predicted_fg||!e($))return null;const c=Math.abs(e(r).predicted_fg-e($)),h=Math.round(c*1e3);return{diff:c,points:h,isAccurate:h<=2,isClose:h<=5}});async function _e(){o(A,!0),o(Z,null);try{o(r,await hs(i.batchId,e(ye)),!0)}catch(c){o(Z,c instanceof Error?c.message:"Failed to load predictions",!0),console.error("Failed to load ML predictions:",c)}finally{o(A,!1)}}async function D(){o(j,!0),o(Z,null);try{const c=await gs(i.batchId);console.log("Reloaded predictions:",c.message),await _e()}catch(c){o(Z,c instanceof Error?c.message:"Failed to reload predictions",!0),console.error("Failed to reload predictions:",c)}finally{o(j,!1)}}function Y(){_e()}Wa(D);function ee(c){return c?new Date(c).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}):"N/A"}function ne(c){if(!c)return null;const h=new Date(c),L=new Date,y=h.getTime()-L.getTime();return Math.ceil(y/(1e3*60*60*24))}let O=I(()=>{const c=w()??e(r).predicted_og,h=e(r).predicted_fg,L=M()??W()?.sg;if(!c||!h||!L||c<=h)return null;const y=c-h,f=(c-L)/y*100;return Math.min(100,Math.max(0,f))}),E=I(()=>{const c=w()??e(r).predicted_og,h=M()??W()?.sg;if(!c||!h||c<=1)return null;const L=(c-h)/(c-1)*100;return Math.min(100,Math.max(0,L))}),ae=I(()=>{const c=W()?.sg_rate;if(c==null)return null;const h=Math.abs(c);return h>.002?{label:"Very Active",color:"var(--activity-very-active)",emoji:"üî•"}:h>5e-4?{label:"Active",color:"var(--activity-active)",emoji:"‚ú®"}:h>1e-4?{label:"Slowing",color:"var(--activity-slowing)",emoji:"üê¢"}:{label:"Complete",color:"var(--activity-complete)",emoji:"‚úì"}}),te=I(()=>W()?.is_anomaly??!1),fe=I(()=>W()?.anomaly_reasons??[]);var qe=Ge(),ze=oe(qe);{var ve=c=>{var h=or(),L=a(h),y=a(L);t(L),t(h),_(()=>d(y,`Loading ${e(S)?"summary":"predictions"}...`)),l(c,h)},u=c=>{var h=Ge(),L=oe(h);{var y=f=>{var b=dr(),C=a(b),x=a(C);t(C),t(b),_(()=>d(x,`‚ö†Ô∏è ${e(Z)??""}`)),l(f,b)},m=f=>{var b=Ge(),C=oe(b);{var x=X=>{var P=Pr();let se;var Q=a(P),re=a(Q),le=a(re,!0);t(re);var de=s(re,2);{var ge=ie=>{var p=ur(),k=a(p);k.__change=Y,Bt(k,21,()=>Fe,Ht,(V,J)=>{var ce=cr(),he=a(ce,!0);t(ce);var xe={};_(()=>{d(he,e(J).label),xe!==(xe=e(J).value)&&(ce.value=(ce.__value=e(J).value)??"")}),l(V,ce)}),t(k);var z=s(k,2);z.__click=D;var T=a(z,!0);t(z),t(p),_(()=>{k.disabled=e(A)||e(j),z.disabled=e(j)||e(A),d(T,e(j)?"Reloading...":"‚Üª")}),Ta(k,()=>e(ye),V=>o(ye,V)),l(ie,p)};v(de,ie=>{e(S)||ie(ge)})}t(Q);var Ce=s(Q,2);{var Ne=ie=>{var p=xr(),k=a(p);{var z=H=>{var ue=gr();let R;var U=a(ue),be=a(U);{var Te=Ze=>{var et=_r();je(2),l(Ze,et)},Je=Ze=>{var et=Ge(),dt=oe(et);{var De=Se=>{var Ke=pr();je(2),l(Se,Ke)},_t=Se=>{var Ke=fr();je(2),l(Se,Ke)};v(dt,Se=>{e(K).isClose?Se(De):Se(_t,!1)},!0)}l(Ze,et)};v(be,Ze=>{e(K).isAccurate?Ze(Te):Ze(Je,!1)})}t(U);var Ee=s(U,2),Ue=a(Ee),Oe=s(Ue),Ye=a(Oe);t(Oe),t(Ee),t(ue),_((Ze,et)=>{R=He(ue,1,"accuracy-banner svelte-1xs394q",null,R,{accurate:e(K).isAccurate,close:e(K).isClose&&!e(K).isAccurate}),d(Ue,`Model predicted ${Ze??""}, actual was ${et??""} `),d(Ye,`(${e(K).points??""} points ${e(r).predicted_fg&&e(r).predicted_fg>e($)?"high":"low"})`)},[()=>jt(e(r).predicted_fg??0),()=>jt(e($))]),l(H,ue)};v(k,H=>{e(K)&&e($)&&H(z)})}var T=s(k,2),V=a(T),J=s(a(V),2),ce=a(J),he=a(ce,!0);t(ce);var xe=s(ce,2);{var ke=H=>{var ue=hr(),R=a(ue);t(ue),_(U=>d(R,`ML: ${U??""}`),[()=>jt(e(r).predicted_fg)]),l(H,ue)};v(xe,H=>{e(r).predicted_fg&&H(ke)})}t(J),t(V),t(T);var Xe=s(T,2),gt=a(Xe);{var ut=H=>{var ue=mr(),R=s(a(ue),2),U=a(R,!0);t(R),t(ue),_(()=>d(U,e(r).model_type)),l(H,ue)};v(gt,H=>{e(r).model_type&&H(ut)})}var zt=s(gt,2);{var q=H=>{var ue=br(),R=s(a(ue),2),U=a(R);t(R),t(ue),_(be=>d(U,`${be??""}%`),[()=>(e(r).r_squared*100).toFixed(0)]),l(H,ue)};v(zt,H=>{e(r).r_squared!==void 0&&H(q)})}var B=s(zt,2);{var me=H=>{var ue=yr(),R=s(a(ue),2),U=a(R,!0);t(R),t(ue),_(()=>d(U,e(r).num_readings)),l(H,ue)};v(B,H=>{e(r).num_readings&&H(me)})}t(Xe),t(p),_(H=>d(he,H),[()=>jt(e($)??0)]),l(ie,p)},Be=ie=>{var p=Rr(),k=oe(p);{var z=R=>{var U=wr(),be=s(a(U),2),Te=s(a(be),2);{var Je=Ee=>{var Ue=kr(),Oe=a(Ue,!0);t(Ue),_(Ye=>d(Oe,Ye),[()=>e(fe).join(", ")]),l(Ee,Ue)};v(Te,Ee=>{e(fe).length>0&&Ee(Je)})}t(be),t(U),l(R,U)};v(k,R=>{e(te)&&R(z)})}var T=s(k,2);{var V=R=>{var U=qr(),be=a(U),Te=s(a(be),2);{var Je=Se=>{var Ke=jr(),Tt=a(Ke);t(Ke),_(()=>{Ft(Ke,`color: ${e(ae).color??""}`),d(Tt,`${e(ae).emoji??""} ${e(ae).label??""}`)}),l(Se,Ke)};v(Te,Se=>{e(ae)&&Se(Je)})}t(be);var Ee=s(be,2),Ue=a(Ee);t(Ee);var Oe=s(Ee,2),Ye=a(Oe),Ze=a(Ye);t(Ye);var et=s(Ye,2),dt=a(et);t(et);var De=s(et,2),_t=a(De);t(De),t(Oe),t(U),_((Se,Ke,Tt)=>{Ft(Ue,`width: ${e(O)??""}%`),d(Ze,`OG: ${Se??""}`),d(dt,`${Ke??""}%`),d(_t,`FG: ${Tt??""}`)},[()=>jt(w()??e(r).predicted_og??0),()=>e(O).toFixed(0),()=>jt(e(r).predicted_fg??0)]),l(R,U)};v(T,R=>{e(O)!==null&&R(V)})}var J=s(T,2),ce=a(J);{var he=R=>{var U=Sr(),be=s(a(U),2),Te=a(be,!0);t(be),t(U),_(Je=>d(Te,Je),[()=>jt(e(r).predicted_fg)]),l(R,U)};v(ce,R=>{e(r).predicted_fg&&R(he)})}var xe=s(ce,2);{var ke=R=>{var U=Mr(),be=s(a(U),2),Te=a(be);t(be),t(U),_(Je=>d(Te,`${Je??""}%`),[()=>e(E).toFixed(1)]),l(R,U)};v(xe,R=>{e(E)!==null&&R(ke)})}var Xe=s(xe,2);{var gt=R=>{const U=I(()=>ne(e(r).estimated_completion));var be=zr(),Te=s(a(be),2),Je=a(Te);{var Ee=Oe=>{var Ye=Cr();l(Oe,Ye)},Ue=Oe=>{var Ye=Fr(),Ze=oe(Ye),et=s(Ze);{var dt=De=>{var _t=Br(),Se=a(_t);t(_t),_(()=>d(Se,`(${e(U)??""} ${e(U)===1?"day":"days"})`)),l(De,_t)};v(et,De=>{e(U)!==null&&De(dt)})}_(De=>d(Ze,`${De??""} `),[()=>ee(e(r).estimated_completion)]),l(Oe,Ye)};v(Je,Oe=>{e(U)!==null&&e(U)<=0?Oe(Ee):Oe(Ue,!1)})}t(Te),t(be),l(R,be)};v(Xe,R=>{e(r).estimated_completion&&R(gt)})}var ut=s(Xe,2),zt=a(ut);{var q=R=>{var U=Tr(),be=s(a(U),2),Te=a(be,!0);t(be),t(U),_(()=>d(Te,e(r).model_type)),l(R,U)};v(zt,R=>{e(r).model_type&&R(q)})}var B=s(zt,2);{var me=R=>{var U=Ar(),be=s(a(U),2),Te=a(be);t(be),t(U),_(Je=>d(Te,`${Je??""}%`),[()=>(e(r).r_squared*100).toFixed(0)]),l(R,U)};v(B,R=>{e(r).r_squared!==void 0&&R(me)})}var H=s(B,2);{var ue=R=>{var U=Dr(),be=s(a(U),2),Te=a(be,!0);t(be),t(U),_(()=>d(Te,e(r).num_readings)),l(R,U)};v(H,R=>{e(r).num_readings&&R(ue)})}t(ut),t(J),l(ie,p)};v(Ce,ie=>{e(S)?ie(Ne):ie(Be,!1)})}t(P),_(()=>{se=He(P,1,"ml-panel svelte-1xs394q",null,se,{"has-anomaly":e(te),completed:e(S)}),d(le,e(S)?"Fermentation Summary":"Fermentation Intelligence")}),l(X,P)},F=X=>{var P=Nr(),se=a(P),Q=a(se),re=a(Q,!0);t(Q);var le=s(Q,2);le.__click=D;var de=a(le,!0);t(le),t(se);var ge=s(se,2),Ce=a(ge);{var Ne=ie=>{var p=va("Waiting for fermentation to progress (need visible SG drop)");l(ie,p)},Be=ie=>{var p=Ge(),k=oe(p);{var z=V=>{var J=va("Need more fermentation curve data for reliable prediction");l(V,J)},T=V=>{var J=Ge(),ce=oe(J);{var he=ke=>{var Xe=va("Need at least 10 readings to make predictions");l(ke,Xe)},xe=ke=>{var Xe=va();_(()=>d(Xe,e(S)?"No fermentation data recorded":"Predictions will appear once fermentation is underway")),l(ke,Xe)};v(ce,ke=>{e(r).reason==="insufficient_data"?ke(he):ke(xe,!1)},!0)}l(V,J)};v(k,V=>{e(r).reason==="insufficient_curve_data"?V(z):V(T,!1)},!0)}l(ie,p)};v(Ce,ie=>{e(r).reason==="insufficient_fermentation_progress"?ie(Ne):ie(Be,!1)})}t(ge),t(P),_(()=>{d(re,e(S)?"Fermentation summary unavailable":"ML predictions unavailable"),le.disabled=e(j)||e(A),d(de,e(j)?"Reloading...":"‚Üª Reload")}),l(X,P)};v(C,X=>{e(r).available?X(x):X(F,!1)},!0)}l(f,b)};v(L,f=>{e(Z)?f(y):f(m,!1)},!0)}l(c,h)};v(ze,c=>{e(A)?c(ve):c(u,!1)})}l(Re,qe),Vt()}Yt(["change","click"]);var Lr=n('<div class="loading svelte-1hws0u6">Loading alerts...</div>'),Ir=n('<div class="error-banner svelte-1hws0u6"><span> </span> <button type="button" class="dismiss-error svelte-1hws0u6">√ó</button></div>'),Er=n('<button type="button" class="dismiss-all-btn svelte-1hws0u6"> </button>'),Gr=n('<span class="spinner svelte-1hws0u6"></span>'),Hr=ga('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-1hws0u6"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg>'),Ur=n('<div class="alert-item svelte-1hws0u6"><div class="alert-icon svelte-1hws0u6"> </div> <div class="alert-content svelte-1hws0u6"><div class="alert-header svelte-1hws0u6"><span class="alert-type svelte-1hws0u6"> </span> <span class="severity-badge svelte-1hws0u6"> </span></div> <p class="alert-message svelte-1hws0u6"> </p> <div class="alert-meta svelte-1hws0u6"><span class="alert-time svelte-1hws0u6"> </span> <span class="alert-separator svelte-1hws0u6">¬∑</span> <span class="alert-time svelte-1hws0u6"> </span></div></div> <button type="button" class="dismiss-btn svelte-1hws0u6" title="Dismiss alert"><!></button></div>'),Vr=n('<!> <div class="alerts-header svelte-1hws0u6"><span class="alert-count svelte-1hws0u6"> </span> <!></div> <div class="alerts-list svelte-1hws0u6"></div>',1);function Wr(Re,i){Ut(i,!0);let g=G(Qe([])),w=G(!0),N=G(null),M=G(null),W=G(!1);Ma(()=>{r()});async function r(){try{o(w,!0),o(N,null),o(g,await ms(i.batchId,!1),!0)}catch(D){o(N,D instanceof Error?D.message:"Failed to load alerts",!0)}finally{o(w,!1)}}async function A(D){try{o(M,D,!0),await bs(i.batchId,D),o(g,e(g).filter(Y=>Y.id!==D),!0)}catch(Y){o(N,Y instanceof Error?Y.message:"Failed to dismiss alert",!0)}finally{o(M,null)}}async function j(){try{o(W,!0),await ys(i.batchId),o(g,[],!0)}catch(D){o(N,D instanceof Error?D.message:"Failed to dismiss alerts",!0)}finally{o(W,!1)}}function Z(D){switch(D){case"critical":return"var(--negative)";case"warning":return"var(--warning)";case"info":return"var(--accent)";default:return"var(--text-muted)"}}function ye(D){switch(D){case"stall":return"‚è∏";case"temperature_high":return"üî•";case"temperature_low":return"‚ùÑ";case"anomaly":return"‚ö†";default:return"‚ö†"}}function Fe(D){const Y=new Date(D),ne=new Date().getTime()-Y.getTime(),O=Math.floor(ne/6e4),E=Math.floor(O/60),ae=Math.floor(E/24);return ae>0?`${ae}d ago`:E>0?`${E}h ago`:O>0?`${O}m ago`:"just now"}var S=Ge(),$=oe(S);{var K=D=>{xa(D,{title:"Alerts",icon:"üîî",children:(Y,ee)=>{var ne=Lr();l(Y,ne)},$$slots:{default:!0}})},_e=D=>{var Y=Ge(),ee=oe(Y);{var ne=E=>{},O=E=>{xa(E,{title:"Active Alerts",icon:"üîî",highlight:!0,children:(ae,te)=>{var fe=Vr(),qe=oe(fe);{var ze=m=>{var f=Ir(),b=a(f),C=a(b,!0);t(b);var x=s(b,2);x.__click=()=>o(N,null),t(f),_(()=>d(C,e(N))),l(m,f)};v(qe,m=>{e(N)&&m(ze)})}var ve=s(qe,2),u=a(ve),c=a(u);t(u);var h=s(u,2);{var L=m=>{var f=Er();f.__click=j;var b=a(f,!0);t(f),_(()=>{f.disabled=e(W),d(b,e(W)?"Dismissing...":"Dismiss All")}),l(m,f)};v(h,m=>{e(g).length>1&&m(L)})}t(ve);var y=s(ve,2);Bt(y,21,()=>e(g),m=>m.id,(m,f)=>{var b=Ur(),C=a(b),x=a(C,!0);t(C);var F=s(C,2),X=a(F),P=a(X),se=a(P,!0);t(P);var Q=s(P,2),re=a(Q,!0);t(Q),t(X);var le=s(X,2),de=a(le,!0);t(le);var ge=s(le,2),Ce=a(ge),Ne=a(Ce);t(Ce);var Be=s(Ce,4),ie=a(Be);t(Be),t(ge),t(F);var p=s(F,2);p.__click=()=>A(e(f).id);var k=a(p);{var z=V=>{var J=Gr();l(V,J)},T=V=>{var J=Hr();l(V,J)};v(k,V=>{e(M)===e(f).id?V(z):V(T,!1)})}t(p),t(b),_((V,J,ce,he,xe,ke,Xe,gt)=>{Ft(b,`--severity-color: ${V??""}`),d(x,J),d(se,ce),Ft(Q,`background: ${he??""}`),d(re,e(f).severity),d(de,e(f).message),Kt(Ce,"title",`First detected: ${xe??""}`),d(Ne,`First: ${ke??""}`),Kt(Be,"title",`Last seen: ${Xe??""}`),d(ie,`Last: ${gt??""}`),p.disabled=e(M)===e(f).id},[()=>Z(e(f).severity),()=>ye(e(f).alert_type),()=>e(f).alert_type.replace("_"," "),()=>Z(e(f).severity),()=>new Date(e(f).first_detected_at).toLocaleString(),()=>Fe(e(f).first_detected_at),()=>new Date(e(f).last_seen_at).toLocaleString(),()=>Fe(e(f).last_seen_at)]),l(m,b)}),t(y),_(()=>d(c,`${e(g).length??""} active`)),l(ae,fe)},$$slots:{default:!0}})};v(ee,E=>{e(g).length===0?E(ne):E(O,!1)},!0)}l(D,Y)};v($,D=>{e(w)?D(K):D(_e,!1)})}l(Re,S),Vt()}Yt(["click"]);var Xr=n('<span class="saving-indicator svelte-ukh80y">Syncing...</span>'),Jr=n("<span> </span>"),Kr=n('<div class="timer-idle svelte-ukh80y"><div class="timer-option svelte-ukh80y"><label class="option-label svelte-ukh80y">Mash Duration</label> <div class="duration-input svelte-ukh80y"><button type="button" class="duration-btn svelte-ukh80y">‚àí</button> <span class="duration-value svelte-ukh80y"> </span> <button type="button" class="duration-btn svelte-ukh80y">+</button> <span class="duration-unit svelte-ukh80y">min</span></div></div> <div class="timer-option svelte-ukh80y"><label class="option-label svelte-ukh80y">Boil Duration</label> <div class="duration-display svelte-ukh80y"><span class="duration-value svelte-ukh80y"> </span> <span class="duration-unit svelte-ukh80y">min</span></div></div> <div class="timer-actions svelte-ukh80y"><button type="button" class="start-btn mash svelte-ukh80y"><svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path></svg> Start Mash</button> <button type="button" class="start-btn boil svelte-ukh80y">Skip to Boil</button></div></div>'),Yr=n('<div class="timer-complete svelte-ukh80y"><div class="complete-icon svelte-ukh80y">‚úì</div> <p class="complete-text svelte-ukh80y">Boil complete! Time to chill the wort.</p> <button type="button" class="reset-btn svelte-ukh80y">Reset Timer</button></div>'),Qr=ga('<svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path></svg> Resume',1),Zr=ga('<svg class="btn-icon svelte-ukh80y" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6"></path></svg> Pause',1),$r=n('<span class="hop-check svelte-ukh80y">‚úì</span>'),el=n('<div><span class="hop-time svelte-ukh80y"> </span> <span class="hop-name svelte-ukh80y"> </span> <span class="hop-amount svelte-ukh80y"> </span> <!></div>'),tl=n('<div class="hop-schedule svelte-ukh80y"><h4 class="schedule-title svelte-ukh80y">Hop Additions</h4> <div class="hop-list svelte-ukh80y"></div></div>'),al=n('<button type="button" class="next-phase-btn svelte-ukh80y">Mash Done ‚Üí Start Boil</button>'),sl=n('<div class="timer-active svelte-ukh80y"><div class="timer-display svelte-ukh80y"><span class="time-value svelte-ukh80y"> </span> <span class="time-label svelte-ukh80y">remaining</span></div> <div class="progress-bar svelte-ukh80y"><div></div></div> <div class="timer-controls svelte-ukh80y"><button type="button" class="control-btn svelte-ukh80y" title="Subtract 1 minute">‚àí1m</button> <button type="button"><!></button> <button type="button" class="control-btn svelte-ukh80y" title="Add 1 minute">+1m</button></div> <!> <div class="phase-actions svelte-ukh80y"><!> <button type="button" class="reset-btn svelte-ukh80y">Reset</button></div></div>'),rl=n('<div class="timer-card svelte-ukh80y"><div class="timer-header svelte-ukh80y"><h3 class="timer-title svelte-ukh80y">Brew Day Timer</h3> <!></div> <!></div>');function ll(Re,i){Ut(i,!0);let g=G(Qe(i.batch.timer_phase||"idle")),w=G(0),N=null,M=G(i.batch.timer_paused_at!=null),W=G(!1),r=G(Qe(new Set)),A=G(60),j=I(()=>i.recipe.boil_time_minutes||60),Z=I(()=>i.recipe.hops?i.recipe.hops.filter(y=>y.timing?.use==="add_to_boil"||!y.timing?.use).map(y=>({name:y.name,amount:y.amount_grams,time:y.timing?.duration?.value||0,unit:y.timing?.duration?.unit||"min"})).sort((y,m)=>m.time-y.time):[]),ye=I(()=>{const y=Math.floor(e(w)/60),m=e(w)%60;return`${y.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}`}),Fe=I(()=>e(g)==="mash"?(e(A)*60-e(w))/(e(A)*60)*100:e(g)==="boil"?(e(j)*60-e(w))/(e(j)*60)*100:0),S=I(()=>{switch(e(g)){case"mash":return"Mash";case"boil":return"Boil";case"complete":return"Complete!";default:return"Ready"}});function $(){if(!i.batch.timer_started_at||!i.batch.timer_duration_seconds)return 0;const y=new Date(i.batch.timer_started_at).getTime(),m=i.batch.timer_duration_seconds*1e3,f=Date.now();if(i.batch.timer_paused_at){const C=new Date(i.batch.timer_paused_at).getTime()-y;return Math.max(0,Math.floor((m-C)/1e3))}else{const b=f-y;return Math.max(0,Math.floor((m-b)/1e3))}}async function K(y,m,f=!1){o(W,!0);try{const b={timer_phase:y,timer_duration_seconds:m};y==="idle"||y==="complete"?(b.timer_started_at=null,b.timer_paused_at=null):f?b.timer_paused_at=new Date().toISOString():(b.timer_started_at=new Date().toISOString(),b.timer_paused_at=null),await na(i.batch.id,b)}catch(b){console.error("Failed to save timer state:",b)}finally{o(W,!1)}}async function _e(){o(g,"mash"),o(w,e(A)*60),o(r,new Set,!0),o(M,!1),await K("mash",e(A)*60),Y()}async function D(){o(g,"boil"),o(w,e(j)*60),o(r,new Set,!0),o(M,!1),await K("boil",e(j)*60),Y()}function Y(){N&&clearInterval(N),N=setInterval(()=>{if(!e(M)&&e(w)>0){if(ss(w,-1),e(g)==="boil"){const y=Math.floor(e(w)/60);for(const m of e(Z)){const f=m.time;y===f&&!e(r).has(f)&&(e(r).add(f),ae(),te(`Add ${m.name}`,`${m.amount}g at ${f} minutes`))}}e(w)===0&&(clearInterval(N),N=null,ae(),e(g)==="mash"?te("Mash Complete","Time to sparge and start the boil!"):e(g)==="boil"&&(o(g,"complete"),K("complete",0),te("Boil Complete","Time to chill the wort!"),i.onComplete?.()))}},1e3)}async function ee(){o(M,!e(M)),e(M)?await K(e(g),e(w),!0):await K(e(g),e(w),!1)}async function ne(){N&&(clearInterval(N),N=null),o(g,"idle"),o(w,0),o(M,!1),o(r,new Set,!0),await K("idle",0)}function O(){o(w,e(w)+60)}function E(){e(w)>=60&&o(w,e(w)-60)}function ae(){try{const y=new(window.AudioContext||window.webkitAudioContext),m=y.createOscillator(),f=y.createGain();m.connect(f),f.connect(y.destination),m.frequency.value=880,m.type="sine",f.gain.value=.3,m.start(),setTimeout(()=>f.gain.value=0,150),setTimeout(()=>f.gain.value=.3,250),setTimeout(()=>f.gain.value=0,400),setTimeout(()=>f.gain.value=.3,500),setTimeout(()=>f.gain.value=0,650),setTimeout(()=>{m.stop(),y.close()},700)}catch(y){console.warn("Audio notification not available:",y)}}function te(y,m){"Notification"in window&&Notification.permission==="granted"&&new Notification(y,{body:m,icon:"/favicon.png"})}Ma(()=>("Notification"in window&&Notification.permission==="default"&&Notification.requestPermission(),i.batch.timer_phase&&i.batch.timer_phase!=="idle"&&i.batch.timer_phase!=="complete"&&(o(g,i.batch.timer_phase,!0),o(w,$(),!0),o(M,i.batch.timer_paused_at!=null),!e(M)&&e(w)>0&&Y()),()=>{N&&clearInterval(N)}));var fe=rl(),qe=a(fe),ze=s(a(qe),2);{var ve=y=>{var m=Xr();l(y,m)},u=y=>{var m=Ge(),f=oe(m);{var b=C=>{var x=Jr();let F;var X=a(x,!0);t(x),_(()=>{F=He(x,1,"phase-badge svelte-ukh80y",null,F,{mash:e(g)==="mash",boil:e(g)==="boil"}),d(X,e(S))}),l(C,x)};v(f,C=>{e(g)!=="idle"&&e(g)!=="complete"&&C(b)},!0)}l(y,m)};v(ze,y=>{e(W)?y(ve):y(u,!1)})}t(qe);var c=s(qe,2);{var h=y=>{var m=Kr(),f=a(m),b=s(a(f),2),C=a(b);C.__click=()=>o(A,Math.max(1,e(A)-5),!0);var x=s(C,2),F=a(x,!0);t(x);var X=s(x,2);X.__click=()=>o(A,e(A)+5),je(2),t(b),t(f);var P=s(f,2),se=s(a(P),2),Q=a(se),re=a(Q,!0);t(Q),je(2),t(se),t(P);var le=s(P,2),de=a(le);de.__click=_e;var ge=s(de,2);ge.__click=D,t(le),t(m),_(()=>{d(F,e(A)),d(re,e(j))}),l(y,m)},L=y=>{var m=Ge(),f=oe(m);{var b=x=>{var F=Yr(),X=s(a(F),4);X.__click=ne,t(F),l(x,F)},C=x=>{var F=sl(),X=a(F),P=a(X),se=a(P,!0);t(P),je(2),t(X);var Q=s(X,2),re=a(Q);let le;t(Q);var de=s(Q,2),ge=a(de);ge.__click=E;var Ce=s(ge,2);let Ne;Ce.__click=ee;var Be=a(Ce);{var ie=xe=>{var ke=Qr();je(),l(xe,ke)},p=xe=>{var ke=Zr();je(),l(xe,ke)};v(Be,xe=>{e(M)?xe(ie):xe(p,!1)})}t(Ce);var k=s(Ce,2);k.__click=O,t(de);var z=s(de,2);{var T=xe=>{var ke=tl(),Xe=s(a(ke),2);Bt(Xe,21,()=>e(Z),Ht,(gt,ut)=>{const zt=I(()=>Math.floor(e(w)/60)),q=I(()=>e(ut).time<=e(zt)&&!e(r).has(e(ut).time)),B=I(()=>e(r).has(e(ut).time)||e(ut).time>e(zt));var me=el();let H;var ue=a(me),R=a(ue);t(ue);var U=s(ue,2),be=a(U,!0);t(U);var Te=s(U,2),Je=a(Te);t(Te);var Ee=s(Te,2);{var Ue=Oe=>{var Ye=$r();l(Oe,Ye)};v(Ee,Oe=>{e(B)&&Oe(Ue)})}t(me),_(()=>{H=He(me,1,"hop-item svelte-ukh80y",null,H,{next:e(q),done:e(B)}),d(R,`${e(ut).time??""}m`),d(be,e(ut).name),d(Je,`${e(ut).amount??""}g`)}),l(gt,me)}),t(Xe),t(ke),l(xe,ke)};v(z,xe=>{e(g)==="boil"&&e(Z).length>0&&xe(T)})}var V=s(z,2),J=a(V);{var ce=xe=>{var ke=al();ke.__click=D,l(xe,ke)};v(J,xe=>{e(g)==="mash"&&xe(ce)})}var he=s(J,2);he.__click=ne,t(V),t(F),_(()=>{d(se,e(ye)),le=He(re,1,"progress-fill svelte-ukh80y",null,le,{mash:e(g)==="mash",boil:e(g)==="boil"}),Ft(re,`width: ${e(Fe)??""}%`),Ne=He(Ce,1,"control-btn pause svelte-ukh80y",null,Ne,{paused:e(M)})}),l(x,F)};v(f,x=>{e(g)==="complete"?x(b):x(C,!1)},!0)}l(y,m)};v(c,y=>{e(g)==="idle"?y(h):y(L,!1)})}t(fe),l(Re,fe),Vt()}Yt(["click"]);var il=n('<button type="button" class="remove-btn svelte-ue9vqt" title="Remove item">√ó</button>'),nl=n('<label><input type="checkbox" class="svelte-ue9vqt"/> <span class="item-text svelte-ue9vqt"> </span> <!></label>'),vl=n('<div class="category-group svelte-ue9vqt"><h4 class="category-title svelte-ue9vqt"> </h4> <div class="items-list svelte-ue9vqt"></div></div>'),ol=n('<div class="add-form svelte-ue9vqt"><input type="text" class="add-input svelte-ue9vqt" placeholder="Add custom item..."/> <button type="button" class="add-btn svelte-ue9vqt">Add</button> <button type="button" class="cancel-btn svelte-ue9vqt">Cancel</button></div>'),dl=n('<button type="button" class="show-add-btn svelte-ue9vqt"><svg class="btn-icon svelte-ue9vqt" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path></svg> Add custom item</button>'),cl=n('<div class="checklist-card svelte-ue9vqt"><div class="checklist-header svelte-ue9vqt"><div class="header-left svelte-ue9vqt"><h3 class="checklist-title svelte-ue9vqt">Brew Day Checklist</h3> <span class="progress-badge svelte-ue9vqt"> </span></div> <button type="button" class="reset-btn svelte-ue9vqt" title="Reset all items"><svg class="btn-icon svelte-ue9vqt" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg></button></div> <div class="progress-bar svelte-ue9vqt"><div class="progress-fill svelte-ue9vqt"></div></div> <div class="checklist-groups svelte-ue9vqt"></div> <div class="add-section svelte-ue9vqt"><!></div></div>');function ul(Re,i){Ut(i,!0);let g=G(Qe([])),w=G(""),N=G(!1),M=I(()=>`brewday-checklist-${i.batchId}`);function W(){const u=[];return u.push({id:"prep-sanitize",text:"Sanitize all equipment",checked:!1,category:"prep"}),u.push({id:"prep-water",text:`Heat strike water (${i.recipe.batch_size_liters?Math.round(i.recipe.batch_size_liters*1.3):"--"}L)`,checked:!1,category:"prep"}),i.recipe.fermentables&&i.recipe.fermentables.forEach((c,h)=>{const L=c.amount_kg?`${(c.amount_kg*1e3).toFixed(0)}g`:"";u.push({id:`ferm-${h}`,text:`Mill grain: ${c.name} ${L}`,checked:!1,category:"prep"})}),u.push({id:"mash-dough-in",text:"Dough in - add grain to strike water",checked:!1,category:"mash"}),u.push({id:"mash-temp",text:"Check mash temperature",checked:!1,category:"mash"}),u.push({id:"mash-rest",text:"Mash rest complete",checked:!1,category:"mash"}),u.push({id:"mash-sparge",text:"Sparge and collect wort",checked:!1,category:"mash"}),u.push({id:"boil-preboil",text:"Record pre-boil gravity",checked:!1,category:"boil"}),u.push({id:"boil-start",text:"Bring to boil",checked:!1,category:"boil"}),i.recipe.hops&&i.recipe.hops.filter(h=>h.timing?.use==="add_to_boil"||!h.timing?.use).sort((h,L)=>(L.timing?.duration?.value||0)-(h.timing?.duration?.value||0)).forEach((h,L)=>{const y=h.timing?.duration?.value||0,m=h.amount_grams?`${h.amount_grams}g`:"";u.push({id:`hop-${L}`,text:`Add ${h.name} ${m} @ ${y}min`,checked:!1,category:"boil"})}),u.push({id:"postboil-flame-off",text:"Flame off / end boil",checked:!1,category:"post-boil"}),u.push({id:"postboil-chill",text:"Chill wort to pitch temp",checked:!1,category:"post-boil"}),u.push({id:"postboil-og",text:"Record original gravity (OG)",checked:!1,category:"post-boil"}),u.push({id:"postboil-transfer",text:"Transfer to fermenter",checked:!1,category:"post-boil"}),u.push({id:"postboil-yeast",text:"Pitch yeast",checked:!1,category:"post-boil"}),u.push({id:"postboil-airlock",text:"Seal fermenter and add airlock",checked:!1,category:"post-boil"}),u}function r(){try{const u=localStorage.getItem(e(M));if(u){const c=JSON.parse(u),h=W(),L=new Map(c.map(m=>[m.id,m]));for(const m of h){const f=L.get(m.id);f&&(m.checked=f.checked)}const y=c.filter(m=>m.category==="custom");o(g,[...h,...y],!0)}else o(g,W(),!0)}catch{o(g,W(),!0)}}function A(){try{localStorage.setItem(e(M),JSON.stringify(e(g)))}catch(u){console.warn("Failed to save checklist:",u)}}function j(u){o(g,e(g).map(c=>c.id===u?{...c,checked:!c.checked}:c),!0),A()}function Z(){if(!e(w).trim())return;const u={id:`custom-${Date.now()}`,text:e(w).trim(),checked:!1,category:"custom"};o(g,[...e(g),u],!0),o(w,""),o(N,!1),A()}function ye(u){o(g,e(g).filter(c=>c.id!==u),!0),A()}function Fe(){confirm("Reset all checklist items to unchecked?")&&(o(g,e(g).map(u=>({...u,checked:!1})),!0),A())}let S=I(()=>{if(e(g).length===0)return 0;const u=e(g).filter(c=>c.checked).length;return Math.round(u/e(g).length*100)}),$=I(()=>{const u={prep:[],mash:[],boil:[],"post-boil":[],custom:[]};for(const c of e(g))u[c.category].push(c);return u});const K={prep:"Preparation",mash:"Mash",boil:"Boil","post-boil":"Post-Boil",custom:"Custom"};Ma(()=>{r()});var _e=cl(),D=a(_e),Y=a(D),ee=s(a(Y),2),ne=a(ee);t(ee),t(Y);var O=s(Y,2);O.__click=Fe,t(D);var E=s(D,2),ae=a(E);t(E);var te=s(E,2);Bt(te,21,()=>Object.entries(e($)),Ht,(u,c)=>{var h=I(()=>rs(e(c),2));let L=()=>e(h)[0],y=()=>e(h)[1];var m=Ge(),f=oe(m);{var b=C=>{var x=vl(),F=a(x),X=a(F,!0);t(F);var P=s(F,2);Bt(P,21,y,se=>se.id,(se,Q)=>{var re=nl();let le;var de=a(re);wt(de),de.__change=()=>j(e(Q).id);var ge=s(de,2),Ce=a(ge,!0);t(ge);var Ne=s(ge,2);{var Be=ie=>{var p=il();p.__click=()=>ye(e(Q).id),l(ie,p)};v(Ne,ie=>{e(Q).category==="custom"&&ie(Be)})}t(re),_(()=>{le=He(re,1,"checklist-item svelte-ue9vqt",null,le,{checked:e(Q).checked}),os(de,e(Q).checked),d(Ce,e(Q).text)}),l(se,re)}),t(P),t(x),_(()=>d(X,K[L()])),l(C,x)};v(f,C=>{y().length>0&&C(b)})}l(u,m)}),t(te);var fe=s(te,2),qe=a(fe);{var ze=u=>{var c=ol(),h=a(c);wt(h),h.__keydown=m=>m.key==="Enter"&&Z();var L=s(h,2);L.__click=Z;var y=s(L,2);y.__click=()=>{o(N,!1),o(w,"")},t(c),ft(h,()=>e(w),m=>o(w,m)),l(u,c)},ve=u=>{var c=dl();c.__click=()=>o(N,!0),l(u,c)};v(qe,u=>{e(N)?u(ze):u(ve,!1)})}t(fe),t(_e),_(()=>{d(ne,`${e(S)??""}%`),Ft(ae,`width: ${e(S)??""}%`)}),l(Re,_e),Vt()}Yt(["click","change","keydown"]);var _l=n('<span class="save-indicator svelte-1hyfh06"> </span>'),pl=n('<span class="summary-value svelte-1hyfh06"> </span>'),fl=n('<span class="summary-value svelte-1hyfh06"> </span>'),gl=n('<span class="target svelte-1hyfh06"> </span>'),hl=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Mash Temperature</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06"> </span></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Mash pH</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.01" min="4" max="7" class="field-input svelte-1hyfh06" placeholder="--"/></div> <span class="target svelte-1hyfh06">Target: 5.2-5.6</span></div></div> <div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Strike Water Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div></div></div></div>'),ml=n('<span class="summary-value svelte-1hyfh06"> </span>'),bl=n('<span class="summary-value svelte-1hyfh06"> </span>'),yl=n('<span class="target svelte-1hyfh06"> </span>'),xl=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Pre-Boil Gravity</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.001" min="1.000" max="1.200" class="field-input svelte-1hyfh06" placeholder="1.0XX"/></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Pre-Boil Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div></div></div></div>'),kl=n('<span class="summary-value og svelte-1hyfh06"> </span>'),wl=n('<span class="summary-value svelte-1hyfh06"> </span>'),jl=n('<span class="target svelte-1hyfh06"> </span>'),ql=n('<span class="target svelte-1hyfh06"> </span>'),Sl=n('<span class="target svelte-1hyfh06"> </span>'),Ml=n('<div class="section-content svelte-1hyfh06"><div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Original Gravity (OG)</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.001" min="1.000" max="1.200" class="field-input og-input svelte-1hyfh06" placeholder="1.0XX"/></div> <!></div> <div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Post-Boil Volume</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">L</span></div> <!></div></div> <div class="field-row svelte-1hyfh06"><div class="field svelte-1hyfh06"><label class="field-label svelte-1hyfh06">Brewhouse Efficiency</label> <div class="input-with-target svelte-1hyfh06"><input type="number" step="0.1" min="0" max="100" class="field-input svelte-1hyfh06" placeholder="--"/> <span class="unit svelte-1hyfh06">%</span></div> <!></div></div></div>'),Cl=n('<span class="has-notes svelte-1hyfh06">Has notes</span>'),Bl=n('<div class="section-content svelte-1hyfh06"><textarea class="notes-input svelte-1hyfh06" placeholder="Record any deviations, substitutions, or observations..." rows="4"></textarea></div>'),Fl=n('<div class="saving-indicator svelte-1hyfh06"><span class="spinner svelte-1hyfh06"></span> Saving...</div>'),zl=n('<div class="observations-card svelte-1hyfh06"><div class="card-header svelte-1hyfh06"><h3 class="card-title svelte-1hyfh06">Brew Day Log</h3> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Mash</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Pre-Boil</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Post-Boil / OG</span> <div class="section-summary svelte-1hyfh06"><!> <!></div> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <div><button type="button" class="section-header svelte-1hyfh06"><span class="section-title svelte-1hyfh06">Brew Day Notes</span> <!> <svg class="chevron svelte-1hyfh06" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button> <!></div> <!></div>');function Tl(Re,i){Ut(i,!0);let g=G(Qe(i.batch.actual_mash_temp??null)),w=G(Qe(i.batch.actual_mash_ph??null)),N=G(Qe(i.batch.strike_water_volume??null)),M=G(Qe(i.batch.pre_boil_gravity??null)),W=G(Qe(i.batch.pre_boil_volume??null)),r=G(Qe(i.batch.post_boil_volume??null)),A=G(Qe(i.batch.measured_og??null)),j=G(Qe(i.batch.actual_efficiency??null)),Z=G(Qe(i.batch.brew_day_notes??"")),ye=G(!1),Fe=G(null),S=G("mash"),$=I(Da),K=I(()=>i.recipe.mash_temp),_e=I(()=>i.recipe.og),D=I(()=>i.recipe.pre_boil_og),Y=I(()=>i.recipe.batch_size_liters),ee=I(()=>i.recipe.efficiency);function ne(){if(!e(A)||!e(_e)||!e(ee))return null;const q=(e(A)-1)*1e3,B=(e(_e)-1)*1e3;return B===0?null:q/B*e(ee)}Ma(()=>{if(e(A)&&!e(j)){const q=ne();q&&o(j,Math.round(q*10)/10)}});async function O(){if(!e(ye)){o(ye,!0);try{const q={actual_mash_temp:e(g)??void 0,actual_mash_ph:e(w)??void 0,strike_water_volume:e(N)??void 0,pre_boil_gravity:e(M)??void 0,pre_boil_volume:e(W)??void 0,post_boil_volume:e(r)??void 0,measured_og:e(A)??void 0,actual_efficiency:e(j)??void 0,brew_day_notes:e(Z)||void 0},B=await na(i.batch.id,q);o(Fe,new Date,!0),i.onUpdate?.(B)}catch(q){console.error("Failed to save observations:",q)}finally{o(ye,!1)}}}function E(q){o(S,e(S)===q?null:q,!0)}var ae=zl(),te=a(ae),fe=s(a(te),2);{var qe=q=>{var B=_l(),me=a(B);t(B),_(H=>d(me,`Saved ${H??""}`),[()=>e(Fe).toLocaleTimeString()]),l(q,B)};v(fe,q=>{e(Fe)&&q(qe)})}t(te);var ze=s(te,2);let ve;var u=a(ze);u.__click=()=>E("mash");var c=s(a(u),2),h=a(c);{var L=q=>{var B=pl(),me=a(B);t(B),_(H=>d(me,`${H??""}${e($)??""}`),[()=>Sa(e(g))]),l(q,B)};v(h,q=>{e(g)&&q(L)})}var y=s(h,2);{var m=q=>{var B=fl(),me=a(B);t(B),_(H=>d(me,`pH ${H??""}`),[()=>e(w).toFixed(2)]),l(q,B)};v(y,q=>{e(w)&&q(m)})}t(c),je(2),t(u);var f=s(u,2);{var b=q=>{var B=hl(),me=a(B),H=a(me),ue=s(a(H),2),R=a(ue);wt(R);var U=s(R,2),be=a(U,!0);t(U),t(ue);var Te=s(ue,2);{var Je=De=>{var _t=gl(),Se=a(_t);t(_t),_(Ke=>d(Se,`Target: ${Ke??""}${e($)??""}`),[()=>Sa(e(K))]),l(De,_t)};v(Te,De=>{e(K)&&De(Je)})}t(H);var Ee=s(H,2),Ue=s(a(Ee),2),Oe=a(Ue);wt(Oe),t(Ue),je(2),t(Ee),t(me);var Ye=s(me,2),Ze=a(Ye),et=s(a(Ze),2),dt=a(et);wt(dt),je(2),t(et),t(Ze),t(Ye),t(B),_(()=>d(be,e($))),kt("blur",R,O),ft(R,()=>e(g),De=>o(g,De)),kt("blur",Oe,O),ft(Oe,()=>e(w),De=>o(w,De)),kt("blur",dt,O),ft(dt,()=>e(N),De=>o(N,De)),l(q,B)};v(f,q=>{e(S)==="mash"&&q(b)})}t(ze);var C=s(ze,2);let x;var F=a(C);F.__click=()=>E("preboil");var X=s(a(F),2),P=a(X);{var se=q=>{var B=ml(),me=a(B,!0);t(B),_(H=>d(me,H),[()=>jt(e(M))]),l(q,B)};v(P,q=>{e(M)&&q(se)})}var Q=s(P,2);{var re=q=>{var B=bl(),me=a(B);t(B),_(H=>d(me,`${H??""}L`),[()=>e(W).toFixed(1)]),l(q,B)};v(Q,q=>{e(W)&&q(re)})}t(X),je(2),t(F);var le=s(F,2);{var de=q=>{var B=xl(),me=a(B),H=a(me),ue=s(a(H),2),R=a(ue);wt(R),t(ue);var U=s(ue,2);{var be=Ue=>{var Oe=yl(),Ye=a(Oe);t(Oe),_(Ze=>d(Ye,`Target: ${Ze??""}`),[()=>jt(e(D))]),l(Ue,Oe)};v(U,Ue=>{e(D)&&Ue(be)})}t(H);var Te=s(H,2),Je=s(a(Te),2),Ee=a(Je);wt(Ee),je(2),t(Je),t(Te),t(me),t(B),kt("blur",R,O),ft(R,()=>e(M),Ue=>o(M,Ue)),kt("blur",Ee,O),ft(Ee,()=>e(W),Ue=>o(W,Ue)),l(q,B)};v(le,q=>{e(S)==="preboil"&&q(de)})}t(C);var ge=s(C,2);let Ce;var Ne=a(ge);Ne.__click=()=>E("postboil");var Be=s(a(Ne),2),ie=a(Be);{var p=q=>{var B=kl(),me=a(B,!0);t(B),_(H=>d(me,H),[()=>jt(e(A))]),l(q,B)};v(ie,q=>{e(A)&&q(p)})}var k=s(ie,2);{var z=q=>{var B=wl(),me=a(B);t(B),_(H=>d(me,`${H??""}% eff`),[()=>e(j).toFixed(0)]),l(q,B)};v(k,q=>{e(j)&&q(z)})}t(Be),je(2),t(Ne);var T=s(Ne,2);{var V=q=>{var B=Ml(),me=a(B),H=a(me),ue=s(a(H),2),R=a(ue);wt(R),t(ue);var U=s(ue,2);{var be=Se=>{var Ke=jl(),Tt=a(Ke);t(Ke),_(oa=>d(Tt,`Target: ${oa??""}`),[()=>jt(e(_e))]),l(Se,Ke)};v(U,Se=>{e(_e)&&Se(be)})}t(H);var Te=s(H,2),Je=s(a(Te),2),Ee=a(Je);wt(Ee),je(2),t(Je);var Ue=s(Je,2);{var Oe=Se=>{var Ke=ql(),Tt=a(Ke);t(Ke),_(oa=>d(Tt,`Target: ${oa??""}L`),[()=>e(Y).toFixed(1)]),l(Se,Ke)};v(Ue,Se=>{e(Y)&&Se(Oe)})}t(Te),t(me);var Ye=s(me,2),Ze=a(Ye),et=s(a(Ze),2),dt=a(et);wt(dt),je(2),t(et);var De=s(et,2);{var _t=Se=>{var Ke=Sl(),Tt=a(Ke);t(Ke),_(oa=>d(Tt,`Target: ${oa??""}%`),[()=>e(ee).toFixed(0)]),l(Se,Ke)};v(De,Se=>{e(ee)&&Se(_t)})}t(Ze),t(Ye),t(B),kt("blur",R,O),ft(R,()=>e(A),Se=>o(A,Se)),kt("blur",Ee,O),ft(Ee,()=>e(r),Se=>o(r,Se)),kt("blur",dt,O),ft(dt,()=>e(j),Se=>o(j,Se)),l(q,B)};v(T,q=>{e(S)==="postboil"&&q(V)})}t(ge);var J=s(ge,2);let ce;var he=a(J);he.__click=()=>E("notes");var xe=s(a(he),2);{var ke=q=>{var B=Cl();l(q,B)};v(xe,q=>{e(Z)&&q(ke)})}je(2),t(he);var Xe=s(he,2);{var gt=q=>{var B=Bl(),me=a(B);Aa(me),t(B),kt("blur",me,O),ft(me,()=>e(Z),H=>o(Z,H)),l(q,B)};v(Xe,q=>{e(S)==="notes"&&q(gt)})}t(J);var ut=s(J,2);{var zt=q=>{var B=Fl();l(q,B)};v(ut,q=>{e(ye)&&q(zt)})}t(ae),_(()=>{ve=He(ze,1,"section svelte-1hyfh06",null,ve,{expanded:e(S)==="mash"}),x=He(C,1,"section svelte-1hyfh06",null,x,{expanded:e(S)==="preboil"}),Ce=He(ge,1,"section svelte-1hyfh06",null,Ce,{expanded:e(S)==="postboil"}),ce=He(J,1,"section svelte-1hyfh06",null,ce,{expanded:e(S)==="notes"})}),l(Re,ae),Vt()}Yt(["click"]);var Al=n('<span class="packaged-badge svelte-1yofiqc">Packaged</span>'),Dl=n('<span class="save-indicator svelte-1yofiqc">Saved</span>'),Rl=n("<option> </option>"),Pl=n("<option> </option>"),Nl=n('<div class="field-row priming-row svelte-1yofiqc"><div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Priming Sugar Type</label> <input type="text" class="field-input svelte-1yofiqc" placeholder="e.g., table sugar, corn sugar"/></div> <div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Amount</label> <div class="input-with-unit svelte-1yofiqc"><input type="number" step="1" class="field-input svelte-1yofiqc" placeholder="--"/> <span class="unit svelte-1yofiqc">g</span></div></div></div>'),Ol=n('<div class="card-content svelte-1yofiqc"><div class="field-row svelte-1yofiqc"><div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Packaged On</label> <input type="date" class="field-input svelte-1yofiqc"/></div> <div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Package Type</label> <select class="field-input svelte-1yofiqc"><option>Select...</option><!></select></div></div> <div class="field-row svelte-1yofiqc"><div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Volume Packaged</label> <div class="input-with-unit svelte-1yofiqc"><input type="number" step="0.1" class="field-input svelte-1yofiqc" placeholder="--"/> <span class="unit svelte-1yofiqc">L</span></div></div> <div class="field svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Carbonation Method</label> <select class="field-input svelte-1yofiqc"><option>Select...</option><!></select></div></div> <!> <div class="field full-width svelte-1yofiqc"><label class="field-label svelte-1yofiqc">Packaging Notes</label> <textarea class="notes-input svelte-1yofiqc" placeholder="Any observations about packaging day..." rows="3"></textarea></div></div>'),Ll=n('<div class="saving-indicator svelte-1yofiqc"><span class="spinner svelte-1yofiqc"></span> Saving...</div>'),Il=n('<div class="packaging-card svelte-1yofiqc"><button type="button" class="card-header svelte-1yofiqc"><div class="header-content svelte-1yofiqc"><h3 class="card-title svelte-1yofiqc">Packaging</h3> <!></div> <div class="header-right svelte-1yofiqc"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div></button> <!> <!></div>');function El(Re,i){Ut(i,!0);let g=G(Qe(i.batch.packaged_at?i.batch.packaged_at.split("T")[0]:"")),w=G(Qe(i.batch.packaging_type??"")),N=G(Qe(i.batch.packaging_volume??null)),M=G(Qe(i.batch.carbonation_method??"")),W=G(Qe(i.batch.priming_sugar_type??"")),r=G(Qe(i.batch.priming_sugar_amount??null)),A=G(Qe(i.batch.packaging_notes??"")),j=G(!1),Z=G(null),ye=G(!i.batch.packaged_at),Fe=I(()=>e(M)==="bottle_conditioned"||e(M)==="keg_conditioned");async function S(){if(!e(j)){o(j,!0);try{const h={packaged_at:e(g)?new Date(e(g)).toISOString():void 0,packaging_type:e(w)||void 0,packaging_volume:e(N)??void 0,carbonation_method:e(M)||void 0,priming_sugar_type:e(Fe)&&e(W)||void 0,priming_sugar_amount:e(Fe)?e(r)??void 0:void 0,packaging_notes:e(A)||void 0},L=await na(i.batch.id,h);o(Z,new Date,!0),i.onUpdate?.(L)}catch(h){console.error("Failed to save packaging info:",h)}finally{o(j,!1)}}}function $(){o(ye,!e(ye))}const K=[{value:"keg",label:"Keg"},{value:"bottles",label:"Bottles"},{value:"cans",label:"Cans"}],_e=[{value:"forced",label:"Force Carbonated"},{value:"bottle_conditioned",label:"Bottle Conditioned"},{value:"keg_conditioned",label:"Keg Conditioned"},{value:"natural",label:"Naturally Carbonated"}];var D=Il(),Y=a(D);Y.__click=$;var ee=a(Y),ne=s(a(ee),2);{var O=h=>{var L=Al();l(h,L)};v(ne,h=>{i.batch.packaged_at&&h(O)})}t(ee);var E=s(ee,2),ae=a(E);{var te=h=>{var L=Dl();l(h,L)};v(ae,h=>{e(Z)&&h(te)})}var fe=s(ae,2);let qe;t(E),t(Y);var ze=s(Y,2);{var ve=h=>{var L=Ol(),y=a(L),m=a(y),f=s(a(m),2);wt(f),t(m);var b=s(m,2),C=s(a(b),2);C.__change=S;var x=a(C);x.value=x.__value="";var F=s(x);Bt(F,17,()=>K,Ht,(p,k)=>{var z=Rl(),T=a(z,!0);t(z);var V={};_(()=>{d(T,e(k).label),V!==(V=e(k).value)&&(z.value=(z.__value=e(k).value)??"")}),l(p,z)}),t(C),t(b),t(y);var X=s(y,2),P=a(X),se=s(a(P),2),Q=a(se);wt(Q),je(2),t(se),t(P);var re=s(P,2),le=s(a(re),2);le.__change=S;var de=a(le);de.value=de.__value="";var ge=s(de);Bt(ge,17,()=>_e,Ht,(p,k)=>{var z=Pl(),T=a(z,!0);t(z);var V={};_(()=>{d(T,e(k).label),V!==(V=e(k).value)&&(z.value=(z.__value=e(k).value)??"")}),l(p,z)}),t(le),t(re),t(X);var Ce=s(X,2);{var Ne=p=>{var k=Nl(),z=a(k),T=s(a(z),2);wt(T),t(z);var V=s(z,2),J=s(a(V),2),ce=a(J);wt(ce),je(2),t(J),t(V),t(k),kt("blur",T,S),ft(T,()=>e(W),he=>o(W,he)),kt("blur",ce,S),ft(ce,()=>e(r),he=>o(r,he)),l(p,k)};v(Ce,p=>{e(Fe)&&p(Ne)})}var Be=s(Ce,2),ie=s(a(Be),2);Aa(ie),t(Be),t(L),kt("blur",f,S),ft(f,()=>e(g),p=>o(g,p)),Ta(C,()=>e(w),p=>o(w,p)),kt("blur",Q,S),ft(Q,()=>e(N),p=>o(N,p)),Ta(le,()=>e(M),p=>o(M,p)),kt("blur",ie,S),ft(ie,()=>e(A),p=>o(A,p)),l(h,L)};v(ze,h=>{e(ye)&&h(ve)})}var u=s(ze,2);{var c=h=>{var L=Ll();l(h,L)};v(u,h=>{e(j)&&h(c)})}t(D),_(()=>qe=He(fe,0,"chevron svelte-1yofiqc",null,qe,{expanded:e(ye)})),l(Re,D),Vt()}Yt(["click","change"]);var Gl=n('<span class="note-count svelte-11n209s"> </span>'),Hl=n('<span class="avg-score svelte-11n209s"> </span>'),Ul=n('<button type="button" class="add-note-btn svelte-11n209s"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg> Add Tasting Note</button>'),Vl=n('<button type="button"> </button>'),Wl=n('<div class="score-category svelte-11n209s"><div class="category-header svelte-11n209s"><span class="category-label svelte-11n209s"> </span> <div class="score-selector svelte-11n209s"></div></div> <textarea class="category-notes svelte-11n209s" rows="2"></textarea></div>'),Xl=n('<div class="note-form svelte-11n209s"><div class="form-header svelte-11n209s"><h4 class="svelte-11n209s"> </h4> <button type="button" class="close-btn svelte-11n209s"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <!> <div class="form-actions svelte-11n209s"><button type="button" class="cancel-btn svelte-11n209s">Cancel</button> <button type="button" class="save-btn svelte-11n209s"> </button></div></div>'),Jl=n('<div><span class="score-label svelte-11n209s"> </span> <span class="score-value svelte-11n209s"> </span></div>'),Kl=n('<p class="note-text svelte-11n209s"> </p>'),Yl=n('<div><div class="note-header svelte-11n209s"><span class="note-date svelte-11n209s"> </span> <div class="note-actions svelte-11n209s"><button type="button" class="action-btn svelte-11n209s" title="Edit"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></button> <button type="button" class="action-btn delete svelte-11n209s" title="Delete"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="svelte-11n209s"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div> <div class="note-scores svelte-11n209s"></div> <!></div>'),Ql=n('<div class="notes-list svelte-11n209s"></div>'),Zl=n('<p class="empty-message svelte-11n209s">No tasting notes yet. Add your first one to track how this batch develops over time.</p>'),$l=n('<div class="card-content svelte-11n209s"><!> <!> <!></div>'),ei=n('<div class="tasting-card svelte-11n209s"><button type="button" class="card-header svelte-11n209s"><div class="header-content svelte-11n209s"><h3 class="card-title svelte-11n209s">Tasting Notes</h3> <!></div> <div class="header-right svelte-11n209s"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></div></button> <!></div>');function ti(Re,i){Ut(i,!0);let g=G(Qe(i.batch.tasting_notes??[])),w=G(!0),N=G(!1),M=G(null),W=G(!1),r=G(Qe({appearance_score:void 0,appearance_notes:"",aroma_score:void 0,aroma_notes:"",flavor_score:void 0,flavor_notes:"",mouthfeel_score:void 0,mouthfeel_notes:"",overall_score:void 0,overall_notes:""})),A=I(()=>()=>{if(e(g).length===0)return null;const u=e(g).filter(c=>c.overall_score!=null).map(c=>c.overall_score);return u.length===0?null:(u.reduce((c,h)=>c+h,0)/u.length).toFixed(1)});function j(){o(w,!e(w))}function Z(){o(r,{appearance_score:void 0,appearance_notes:"",aroma_score:void 0,aroma_notes:"",flavor_score:void 0,flavor_notes:"",mouthfeel_score:void 0,mouthfeel_notes:"",overall_score:void 0,overall_notes:""},!0),o(M,null),o(N,!1)}function ye(){Z(),o(N,!0)}function Fe(u){o(r,{appearance_score:u.appearance_score??void 0,appearance_notes:u.appearance_notes??"",aroma_score:u.aroma_score??void 0,aroma_notes:u.aroma_notes??"",flavor_score:u.flavor_score??void 0,flavor_notes:u.flavor_notes??"",mouthfeel_score:u.mouthfeel_score??void 0,mouthfeel_notes:u.mouthfeel_notes??"",overall_score:u.overall_score??void 0,overall_notes:u.overall_notes??""},!0),o(M,u.id,!0),o(N,!0)}async function S(){if(!e(W)){o(W,!0);try{if(e(M)){const u=await xs(i.batch.id,e(M),e(r));o(g,e(g).map(c=>c.id===e(M)?u:c),!0)}else{const u=await ks(i.batch.id,e(r));o(g,[u,...e(g)],!0)}Z(),i.onUpdate?.({...i.batch,tasting_notes:e(g)})}catch(u){console.error("Failed to save tasting note:",u)}finally{o(W,!1)}}}async function $(u){if(confirm("Delete this tasting note?"))try{await ws(i.batch.id,u),o(g,e(g).filter(c=>c.id!==u),!0),i.onUpdate?.({...i.batch,tasting_notes:e(g)})}catch(c){console.error("Failed to delete tasting note:",c)}}function K(u){return new Date(u).toLocaleDateString("en-AU",{day:"numeric",month:"short",year:"numeric"})}function _e(u){return u==null?"-":"‚òÖ".repeat(u)+"‚òÜ".repeat(5-u)}var D=ei(),Y=a(D);Y.__click=j;var ee=a(Y),ne=s(a(ee),2);{var O=u=>{var c=Gl(),h=a(c,!0);t(c),_(()=>d(h,e(g).length)),l(u,c)};v(ne,u=>{e(g).length>0&&u(O)})}t(ee);var E=s(ee,2),ae=a(E);{var te=u=>{var c=Hl(),h=a(c);t(c),_(L=>d(h,`Avg: ${L??""}/5`),[()=>e(A)()]),l(u,c)};v(ae,u=>{e(A)()&&u(te)})}var fe=s(ae,2);let qe;t(E),t(Y);var ze=s(Y,2);{var ve=u=>{var c=$l(),h=a(c);{var L=x=>{var F=Ul();F.__click=ye,l(x,F)};v(h,x=>{e(N)||x(L)})}var y=s(h,2);{var m=x=>{var F=Xl(),X=a(F),P=a(X),se=a(P);t(P);var Q=s(P,2);Q.__click=Z,t(X);var re=s(X,2);Bt(re,16,()=>[{key:"appearance",label:"Appearance"},{key:"aroma",label:"Aroma"},{key:"flavor",label:"Flavor"},{key:"mouthfeel",label:"Mouthfeel"},{key:"overall",label:"Overall"}],Ht,(Ne,Be)=>{var ie=Wl(),p=a(ie),k=a(p),z=a(k,!0);t(k);var T=s(k,2);Bt(T,20,()=>[1,2,3,4,5],Ht,(J,ce)=>{var he=Vl();let xe;he.__click=()=>{const Xe=`${Be.key}_score`;e(r)[Xe]=ce};var ke=a(he,!0);t(he),_(()=>{xe=He(he,1,"score-btn svelte-11n209s",null,xe,{selected:e(r)[`${Be.key}_score`]===ce}),d(ke,ce)}),l(J,he)}),t(T),t(p);var V=s(p,2);Aa(V),t(ie),_(J=>{d(z,Be.label),Kt(V,"placeholder",`Notes on ${J??""}...`)},[()=>Be.label.toLowerCase()]),ft(V,()=>e(r)[`${Be.key}_notes`],J=>e(r)[`${Be.key}_notes`]=J),l(Ne,ie)});var le=s(re,2),de=a(le);de.__click=Z;var ge=s(de,2);ge.__click=S;var Ce=a(ge,!0);t(ge),t(le),t(F),_(()=>{d(se,`${e(M)?"Edit":"New"} Tasting Note`),ge.disabled=e(W),d(Ce,e(W)?"Saving...":e(M)?"Update":"Save")}),l(x,F)};v(y,x=>{e(N)&&x(m)})}var f=s(y,2);{var b=x=>{var F=Ql();Bt(F,21,()=>e(g),Ht,(X,P)=>{var se=Yl();let Q;var re=a(se),le=a(re),de=a(le,!0);t(le);var ge=s(le,2),Ce=a(ge);Ce.__click=()=>Fe(e(P));var Ne=s(Ce,2);Ne.__click=()=>$(e(P).id),t(ge),t(re);var Be=s(re,2);Bt(Be,20,()=>[{key:"appearance",label:"App"},{key:"aroma",label:"Aroma"},{key:"flavor",label:"Flav"},{key:"mouthfeel",label:"Mouth"},{key:"overall",label:"Overall"}],Ht,(k,z)=>{var T=Jl();let V;var J=a(T),ce=a(J,!0);t(J);var he=s(J,2),xe=a(he,!0);t(he),t(T),_(ke=>{V=He(T,1,"score-item svelte-11n209s",null,V,{overall:z.key==="overall"}),d(ce,z.label),d(xe,ke)},[()=>_e(e(P)[`${z.key}_score`])]),l(k,T)}),t(Be);var ie=s(Be,2);{var p=k=>{var z=Kl(),T=a(z,!0);t(z),_(()=>d(T,e(P).overall_notes)),l(k,z)};v(ie,k=>{e(P).overall_notes&&k(p)})}t(se),_(k=>{Q=He(se,1,"note-item svelte-11n209s",null,Q,{editing:e(M)===e(P).id}),d(de,k)},[()=>K(e(P).tasted_at)]),l(X,se)}),t(F),l(x,F)},C=x=>{var F=Ge(),X=oe(F);{var P=se=>{var Q=Zl();l(se,Q)};v(X,se=>{e(N)||se(P)},!0)}l(x,F)};v(f,x=>{e(g).length>0?x(b):x(C,!1)})}t(c),l(u,c)};v(ze,u=>{e(w)&&u(ve)})}t(D),_(()=>qe=He(fe,0,"chevron svelte-11n209s",null,qe,{expanded:e(w)})),l(Re,D),Vt()}Yt(["click"]);var ai=n('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),si=n('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),ri=n('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),li=n('<span class="recipe-type svelte-g5au2j"> </span>'),ii=n('<a class="recipe-link svelte-g5au2j"> <!></a>'),ni=n('<div class="batch-timing svelte-g5au2j"> </div>'),vi=n('<div class="batch-timing svelte-g5au2j"> </div>'),oi=n('<option class="svelte-g5au2j"> </option>'),di=ga('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" class="svelte-g5au2j"></path><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Resume',1),ci=ga('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Pause',1),ui=n('<button type="button"><!></button>'),_i=n('<span class="chilling-icon svelte-g5au2j">üç∫</span> <h3 class="chilling-title svelte-g5au2j">Ready to Pitch!</h3>',1),pi=n('<span class="chilling-icon svelte-g5au2j">‚ùÑÔ∏è</span> <h3 class="chilling-title svelte-g5au2j">Chilling to Pitch Temperature</h3>',1),fi=n('<div class="progress-section svelte-g5au2j"><div class="progress-bar svelte-g5au2j"><div class="progress-fill svelte-g5au2j"></div></div> <span class="progress-text svelte-g5au2j"> </span></div>'),gi=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è No cooler configured - set a cooler entity to enable automated chilling</span>'),hi=n('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è Temperature control disabled in settings</span>'),mi=n('<span class="status-ready svelte-g5au2j">Wort has reached pitch temperature - ready to add yeast!</span>'),bi=n('<span class="status-active svelte-g5au2j">Cooler will run automatically when temp exceeds target + hysteresis</span>'),yi=n('<div><div class="chilling-header svelte-g5au2j"><!></div> <div class="chilling-content svelte-g5au2j"><div class="temp-display svelte-g5au2j"><div class="temp-current svelte-g5au2j"><span class="temp-label svelte-g5au2j">Current</span> <span class="temp-value svelte-g5au2j"> </span></div> <div class="temp-arrow svelte-g5au2j">‚Üí</div> <div class="temp-target svelte-g5au2j"><span class="temp-label svelte-g5au2j">Target</span> <span class="temp-value svelte-g5au2j"> </span></div></div> <!> <div class="chilling-status svelte-g5au2j"><!></div></div></div>'),xi=n(`<div class="paused-banner svelte-g5au2j"><div class="paused-header svelte-g5au2j"><svg class="paused-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> <h3 class="paused-title svelte-g5au2j">Readings Paused</h3></div> <p class="paused-text svelte-g5au2j">Hydrometer readings are not being stored. Live readings still display but won't be saved to the fermentation history.</p> <button type="button" class="resume-btn svelte-g5au2j"> </button></div>`),ki=n('<span class="btn-spinner svelte-g5au2j"></span> Starting...',1),wi=ga('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" class="svelte-g5au2j"></path><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="svelte-g5au2j"></path></svg> Start Brew Day',1),ji=n(`<div class="planning-phase svelte-g5au2j"><div class="phase-action-card svelte-g5au2j"><div class="phase-icon svelte-g5au2j">üìã</div> <h2 class="phase-title svelte-g5au2j">Ready to Brew?</h2> <p class="phase-description svelte-g5au2j">Review your recipe below, then start brew day when you're ready to begin.</p> <button type="button" class="start-brewday-btn svelte-g5au2j"><!></button></div> <!></div>`),qi=n('<span class="btn-spinner svelte-g5au2j"></span> Starting...',1),Si=ga('<svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" class="svelte-g5au2j"></path></svg> Yeast Pitched - Start Fermentation',1),Mi=n(`<div class="brewing-phase svelte-g5au2j"><div class="phase-action-card brewing svelte-g5au2j"><div class="phase-icon svelte-g5au2j">üç∫</div> <h2 class="phase-title svelte-g5au2j">Brew Day in Progress</h2> <p class="phase-description svelte-g5au2j">Track your brew day activities. When you've pitched the yeast and fermentation begins, transition to the fermentation phase.</p> <button type="button" class="start-fermentation-btn svelte-g5au2j"><!></button></div> <div class="brewday-tools-grid svelte-g5au2j"><!> <!></div> <!> <!> <!></div>`),Ci=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot brewing svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Brew Day</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Bi=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot fermenting svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Fermentation Started</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Fi=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot conditioning svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Conditioning Started</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),zi=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot completed svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Completed</span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Ti=n('<div class="timeline-item svelte-g5au2j"><div class="timeline-dot packaged svelte-g5au2j"></div> <div class="timeline-content svelte-g5au2j"><span class="timeline-label svelte-g5au2j"> </span> <span class="timeline-date svelte-g5au2j"> </span></div></div>'),Ai=n('<div class="completed-phase svelte-g5au2j"><div class="batch-summary-card svelte-g5au2j"><h2 class="summary-title svelte-g5au2j">Batch Complete</h2> <div class="summary-stats svelte-g5au2j"><div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Original Gravity</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Final Gravity</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">ABV</span> <span class="stat-value svelte-g5au2j"> </span></div> <div class="summary-stat svelte-g5au2j"><span class="stat-label svelte-g5au2j">Attenuation</span> <span class="stat-value svelte-g5au2j"><!></span></div></div></div> <div class="timeline-card svelte-g5au2j"><h3 class="timeline-title svelte-g5au2j">Batch Timeline</h3> <div class="timeline svelte-g5au2j"><!> <!> <!> <!> <!></div></div> <!> <!> <!></div>'),Di=n('<span class="status-badge heater svelte-g5au2j">üî• Heating</span>'),Ri=n('<span class="status-badge cooler svelte-g5au2j">‚ùÑÔ∏è Cooling</span>'),Pi=n('<span class="status-badge idle svelte-g5au2j"> </span>'),Ni=n('<div class="device-status heater svelte-g5au2j"><div>üî•</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Heater</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Oi=n('<div class="device-status cooler svelte-g5au2j"><div>‚ùÑÔ∏è</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Cooler</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Li=n('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">‚ö°</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),Ii=n('<button type="button" class="override-btn heat-on svelte-g5au2j">Force Heat ON</button> <button type="button" class="override-btn heat-off svelte-g5au2j">Force Heat OFF</button>',1),Ei=n('<button type="button" class="override-btn cool-on svelte-g5au2j">Force Cool ON</button> <button type="button" class="override-btn cool-off svelte-g5au2j">Force Cool OFF</button>',1),Gi=n('<div class="control-details svelte-g5au2j"><div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns-grid svelte-g5au2j"><!> <!> <button type="button" class="override-btn auto-mode svelte-g5au2j">Auto Mode</button></div></div>',1),Hi=n('<div class="device-status-grid svelte-g5au2j"><!> <!></div> <!>',1),Ui=n('<div><button type="button" class="collapsible-header svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="collapse-indicator svelte-g5au2j"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" class="svelte-g5au2j"></path></svg></div></button> <!></div>'),Vi=n('<span class="svelte-g5au2j"> </span>'),Wi=n('<span class="svelte-g5au2j"> </span>'),Xi=n('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><!> <!> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),Ji=n('<div class="chart-section svelte-g5au2j"><!></div>'),Ki=n('<div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!> <!></div></div> <!>',1),Yi=n('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <!> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j" aria-label="Delete batch"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <!> <!> <!>',1),Qi=n('<div class="modal-overlay svelte-g5au2j" role="presentation"><div class="modal svelte-g5au2j" role="dialog" aria-modal="true" aria-labelledby="delete-modal-title" tabindex="-1"><h2 id="delete-modal-title" class="modal-title svelte-g5au2j">Delete Batch?</h2> <p class="modal-text svelte-g5au2j"> </p> <div class="modal-actions svelte-g5au2j"><button type="button" class="modal-btn cancel svelte-g5au2j">Cancel</button> <button type="button" class="modal-btn delete svelte-g5au2j"> </button></div></div></div>'),Zi=n('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div> <!>',1);function kn(Re,i){Ut(i,!0);const g=()=>_s(ps,"$page",w),[w,N]=us();let M=null,W=null,r=G(null),A=G(null),j=G(null),Z=Qe([]),ye=G(!0),Fe=G(null),S=G(!1),$=G(!1),K=G(!1),_e=G(!1),D=G(!1),Y=G(!1),ee=G(!1),ne=I(()=>parseInt(g().params.id??"0"));const O=["planning","brewing","fermenting","conditioning","completed","archived"];let E=I(()=>e(r)?Fa[e(r).status]:Fa.planning),ae=I(Da),te=I(()=>qa.config.ha_enabled&&qa.config.temp_control_enabled&&(e(r)?.heater_entity_id||e(r)?.cooler_entity_id)),fe=I(()=>e(r)?.status==="planning"&&e(r)?.temp_target!=null),qe=I(()=>!e(fe)||!e(ve)?.temp||!e(r)?.temp_target?!1:e(ve).temp<=e(r).temp_target),ze=I(()=>{if(!e(fe)||!e(ve)?.temp||!e(r)?.temp_target)return null;const p=e(r).temp_target+30,k=e(ve).temp,z=e(r).temp_target;if(k<=z)return 100;if(k>=p)return 0;const T=(p-k)/(p-z)*100;return Math.min(100,Math.max(0,T))}),ve=I(()=>{if(!e(r)?.device_id)return null;const p=Ha.tilts.get(e(r).device_id);if(p)return p;const k=e(r).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!k?.[1])return null;const z=k[1].toUpperCase();for(const T of Ha.tilts.values())if(T.color&&T.color.toUpperCase()===z)return T;return null});async function u(){o(ye,!0),o(Fe,null);try{if(o(r,await js(e(ne)),!0),e(r).status==="fermenting"||e(r).status==="conditioning"||e(r).status==="completed")try{o(A,await Ca(e(ne)),!0)}catch{}if(e(r).heater_entity_id||e(r).cooler_entity_id)try{o(j,await ja(e(ne)),!0)}catch{}}catch(p){o(Fe,p instanceof Error?p.message:"Failed to load batch",!0)}finally{o(ye,!1)}}async function c(p){if(!(!e(r)||e($))&&!(p==="conditioning"&&e(r).status==="fermenting"&&!confirm(`üí° Entering Conditioning Phase

Reminder: Adjust target temperature if cold crashing.
Temperature control will continue during conditioning.

Continue?`))){o($,!0);try{o(r,await na(e(r).id,{status:p}),!0),(p==="fermenting"||p==="conditioning")&&o(A,await Ca(e(r).id),!0)}catch(k){console.error("Failed to update status:",k)}finally{o($,!1)}}}async function h(){if(!(!e(r)||e($))){o($,!0);try{o(r,await na(e(r).id,{status:"brewing"}),!0)}catch(p){console.error("Failed to start brew day:",p)}finally{o($,!1)}}}async function L(){if(!(!e(r)||e($))){o($,!0);try{o(r,await na(e(r).id,{status:"fermenting"}),!0),o(A,await Ca(e(r).id),!0)}catch(p){console.error("Failed to start fermentation:",p)}finally{o($,!1)}}}async function y(p){if(e(r)&&(o(r,await na(e(r).id,p),!0),o(S,!1),e(r).heater_entity_id||e(r).cooler_entity_id))try{o(j,await ja(e(r).id),!0)}catch{}}async function m(){if(e(r)){o(D,!0);try{await qs(e(r).id),fs("/batches")}catch(p){o(Fe,p instanceof Error?p.message:"Failed to delete batch",!0),o(D,!1),o(_e,!1)}}}async function f(){if(!(!e(r)||e(ee))){o(ee,!0);try{o(r,await na(e(r).id,{readings_paused:!e(r).readings_paused}),!0)}catch(p){console.error("Failed to toggle pause:",p)}finally{o(ee,!1)}}}async function b(p,k){if(!(!e(r)||e(K))){o(K,!0);try{await Ba(e(r).id,k,60,p),o(j,await ja(e(r).id),!0)}catch(z){console.error("Failed to set override:",z)}finally{o(K,!1)}}}async function C(){if(!(!e(r)||e(K))){o(K,!0);try{e(r).heater_entity_id&&await Ba(e(r).id,null,60,"heater"),e(r).cooler_entity_id&&await Ba(e(r).id,null,60,"cooler"),o(j,await ja(e(r).id),!0)}catch(p){console.error("Failed to clear overrides:",p)}finally{o(K,!1)}}}function x(){if(M?.readyState===WebSocket.OPEN)return;const k=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;M=new WebSocket(k),M.onmessage=async z=>{try{const T=JSON.parse(z.data);T.type==="control_event"&&T.batch_id===e(ne)&&e(j)&&(T.action==="heat_on"?o(j,{...e(j),heater_state:"on"},!0):T.action==="heat_off"?o(j,{...e(j),heater_state:"off"},!0):T.action==="cool_on"?o(j,{...e(j),cooler_state:"on"},!0):T.action==="cool_off"&&o(j,{...e(j),cooler_state:"off"},!0))}catch{}},M.onclose=()=>{M=null,W=setTimeout(x,3e3)},M.onerror=()=>{M?.close()}}function F(){W&&(clearTimeout(W),W=null),M?.close(),M=null}function X(p){return p==null?"--":jt(p)}function P(p){return p==null?"--":Sa(p)}function se(p){return p?new Date(p).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"--"}function Q(p){if(!p)return"--";const k=new Date(p),T=(new Date().getTime()-k.getTime())/(1e3*60*60);if(T<1)return`${Math.round(T*60)}m`;if(T<24)return`${T.toFixed(1)}h`;const V=T/24;return V<7?`${V.toFixed(1)}d`:`${Math.round(V)}d`}function re(p){return p?new Date(p).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"}):"--"}Wa(()=>{u(),x()}),ls(()=>{F()});var le=Zi();vs("g5au2j",p=>{is(()=>{ns.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var de=oe(le),ge=s(a(de),2);{var Ce=p=>{var k=ai();l(p,k)},Ne=p=>{var k=Ge(),z=oe(k);{var T=J=>{var ce=si(),he=s(a(ce),2),xe=a(he,!0);t(he);var ke=s(he,2);ke.__click=u,t(ce),_(()=>d(xe,e(Fe))),l(J,ce)},V=J=>{var ce=Ge(),he=oe(ce);{var xe=Xe=>{var gt=ri();l(Xe,gt)},ke=Xe=>{var gt=Ge(),ut=oe(gt);{var zt=B=>{Ss(B,{get batch(){return e(r)},onSubmit:y,onCancel:()=>o(S,!1)})},q=B=>{var me=Yi(),H=oe(me),ue=a(H),R=a(ue),U=a(R);t(R);var be=s(R,2),Te=a(be),Je=a(Te,!0);t(Te);var Ee=s(Te,2);{var Ue=Ae=>{var we=ii(),Ie=a(we),tt=s(Ie);{var it=lt=>{var $e=li(),nt=a($e);t($e),_(()=>d(nt,`(${e(r).recipe.type??""})`)),l(lt,$e)};v(tt,lt=>{e(r).recipe.type&&lt(it)})}t(we),_(()=>{Kt(we,"href",`/recipes/${e(r).recipe.id??""}`),d(Ie,`${e(r).recipe.name??""} `)}),l(Ae,we)};v(Ee,Ae=>{e(r).recipe&&Ae(Ue)})}var Oe=s(Ee,2);{var Ye=Ae=>{var we=ni(),Ie=a(we);t(we),_((tt,it)=>d(Ie,`Started ${tt??""} ¬∑ ${it??""} ago`),[()=>se(e(r).start_time),()=>Q(e(r).start_time)]),l(Ae,we)},Ze=Ae=>{var we=Ge(),Ie=oe(we);{var tt=it=>{var lt=vi(),$e=a(lt);t(lt),_(nt=>d($e,`Brewed ${nt??""}`),[()=>se(e(r).brew_date)]),l(it,lt)};v(Ie,it=>{e(r).brew_date&&it(tt)},!0)}l(Ae,we)};v(Oe,Ae=>{e(r).start_time?Ae(Ye):Ae(Ze,!1)})}t(be),t(ue);var et=s(ue,2),dt=a(et),De=a(dt);De.__change=Ae=>c(Ae.currentTarget.value),Bt(De,21,()=>O,Ht,(Ae,we)=>{var Ie=oi(),tt=a(Ie,!0);t(Ie);var it={};_(()=>{d(tt,Fa[e(we)].label),it!==(it=e(we))&&(Ie.value=(Ie.__value=e(we))??"")}),l(Ae,Ie)}),t(De);var _t;ds(De),t(dt);var Se=s(dt,2);{var Ke=Ae=>{var we=ui();let Ie;we.__click=f;var tt=a(we);{var it=$e=>{var nt=di();je(),l($e,nt)},lt=$e=>{var nt=ci();je(),l($e,nt)};v(tt,$e=>{e(r).readings_paused?$e(it):$e(lt,!1)})}t(we),_(()=>{Ie=He(we,1,"pause-btn svelte-g5au2j",null,Ie,{paused:e(r).readings_paused}),we.disabled=e(ee),Kt(we,"title",e(r).readings_paused?"Resume storing readings":"Pause storing readings")}),l(Ae,we)};v(Se,Ae=>{(e(r).status==="fermenting"||e(r).status==="conditioning")&&Ae(Ke)})}var Tt=s(Se,2);Tt.__click=()=>o(S,!0);var oa=s(Tt,2);oa.__click=()=>o(_e,!0),t(et),t(H);var Ra=s(H,2);{var Ja=Ae=>{var we=yi();let Ie;var tt=a(we),it=a(tt);{var lt=Ve=>{var st=_i();je(2),l(Ve,st)},$e=Ve=>{var st=pi();je(2),l(Ve,st)};v(it,Ve=>{e(qe)?Ve(lt):Ve($e,!1)})}t(tt);var nt=s(tt,2),At=a(nt),vt=a(At),ht=s(a(vt),2),Wt=a(ht,!0);t(ht),t(vt);var bt=s(vt,4),Dt=s(a(bt),2),Xt=a(Dt,!0);t(Dt),t(bt),t(At);var Qt=s(At,2);{var da=Ve=>{var st=fi(),Me=a(st),yt=a(Me);t(Me);var sa=s(Me,2),Pt=a(sa);t(sa),t(st),_(Jt=>{Ft(yt,`width: ${e(ze)??""}%`),d(Pt,`${Jt??""}% to target`)},[()=>Math.round(e(ze))]),l(Ve,st)};v(Qt,Ve=>{e(ze)!=null&&!e(qe)&&Ve(da)})}var Rt=s(Qt,2),Zt=a(Rt);{var $t=Ve=>{var st=gi();l(Ve,st)},ea=Ve=>{var st=Ge(),Me=oe(st);{var yt=Pt=>{var Jt=hi();l(Pt,Jt)},sa=Pt=>{var Jt=Ge(),ca=oe(Jt);{var Pe=mt=>{var qt=mi();l(mt,qt)},ot=mt=>{var qt=bi();l(mt,qt)};v(ca,mt=>{e(qe)?mt(Pe):mt(ot,!1)},!0)}l(Pt,Jt)};v(Me,Pt=>{!qa.config.ha_enabled||!qa.config.temp_control_enabled?Pt(yt):Pt(sa,!1)},!0)}l(Ve,st)};v(Zt,Ve=>{e(r).cooler_entity_id?Ve(ea,!1):Ve($t)})}t(Rt),t(nt),t(we),_((Ve,st)=>{Ie=He(we,1,"chilling-banner svelte-g5au2j",null,Ie,{ready:e(qe)}),d(Wt,Ve),d(Xt,st)},[()=>e(ve)?.temp!=null?P(e(ve).temp):"--",()=>e(r).temp_target!=null?P(e(r).temp_target):"--"]),l(Ae,we)};v(Ra,Ae=>{e(fe)&&Ae(Ja)})}var Pa=s(Ra,2);{var Ka=Ae=>{var we=xi(),Ie=s(a(we),4);Ie.__click=f;var tt=a(Ie,!0);t(Ie),t(we),_(()=>{Ie.disabled=e(ee),d(tt,e(ee)?"Resuming...":"Resume Readings")}),l(Ae,we)};v(Pa,Ae=>{e(r).readings_paused&&(e(r).status==="fermenting"||e(r).status==="conditioning")&&Ae(Ka)})}var Ya=s(Pa,2);{var Qa=Ae=>{var we=ji(),Ie=a(we),tt=s(a(Ie),6);tt.__click=h;var it=a(tt);{var lt=vt=>{var ht=ki();je(),l(vt,ht)},$e=vt=>{var ht=wi();je(),l(vt,ht)};v(it,vt=>{e($)?vt(lt):vt($e,!1)})}t(tt),t(Ie);var nt=s(Ie,2);{var At=vt=>{za(vt,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(nt,vt=>{e(r).recipe&&vt(At)})}t(we),_(()=>tt.disabled=e($)),l(Ae,we)},Za=Ae=>{var we=Ge(),Ie=oe(we);{var tt=lt=>{var $e=Mi(),nt=a($e),At=s(a(nt),6);At.__click=L;var vt=a(At);{var ht=Me=>{var yt=qi();je(),l(Me,yt)},Wt=Me=>{var yt=Si();je(),l(Me,yt)};v(vt,Me=>{e($)?Me(ht):Me(Wt,!1)})}t(At),t(nt);var bt=s(nt,2),Dt=a(bt);{var Xt=Me=>{ll(Me,{get batch(){return e(r)},get recipe(){return e(r).recipe}})};v(Dt,Me=>{e(r).recipe&&Me(Xt)})}var Qt=s(Dt,2);{var da=Me=>{ul(Me,{get recipe(){return e(r).recipe},get batchId(){return e(r).id}})};v(Qt,Me=>{e(r).recipe&&Me(da)})}t(bt);var Rt=s(bt,2);{var Zt=Me=>{Tl(Me,{get batch(){return e(r)},get recipe(){return e(r).recipe},onUpdate:yt=>o(r,yt,!0)})};v(Rt,Me=>{e(r).recipe&&Me(Zt)})}var $t=s(Rt,2);{var ea=Me=>{Ua(Me,{get batch(){return e(r)},get liveReading(){return e(ve)},onEdit:()=>o(S,!0)})};v($t,Me=>{e(r).device_id&&Me(ea)})}var Ve=s($t,2);{var st=Me=>{za(Me,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(Ve,Me=>{e(r).recipe&&Me(st)})}t($e),_(()=>At.disabled=e($)),l(lt,$e)},it=lt=>{var $e=Ge(),nt=oe($e);{var At=ht=>{var Wt=Ai(),bt=a(Wt),Dt=s(a(bt),2),Xt=a(Dt),Qt=s(a(Xt),2),da=a(Qt,!0);t(Qt),t(Xt);var Rt=s(Xt,2),Zt=s(a(Rt),2),$t=a(Zt,!0);t(Zt),t(Rt);var ea=s(Rt,2),Ve=s(a(ea),2),st=a(Ve);t(Ve),t(ea);var Me=s(ea,2),yt=s(a(Me),2),sa=a(yt);{var Pt=pe=>{var Le=va();_(We=>d(Le,`${We??""}%`),[()=>((e(r).measured_og-e(r).measured_fg)/(e(r).measured_og-1)*100).toFixed(0)]),l(pe,Le)},Jt=pe=>{var Le=va("--");l(pe,Le)};v(sa,pe=>{e(r).measured_og&&e(r).measured_fg?pe(Pt):pe(Jt,!1)})}t(yt),t(Me),t(Dt),t(bt);var ca=s(bt,2),Pe=s(a(ca),2),ot=a(Pe);{var mt=pe=>{var Le=Ci(),We=s(a(Le),2),at=s(a(We),2),Mt=a(at,!0);t(at),t(We),t(Le),_(xt=>d(Mt,xt),[()=>re(e(r).brewing_started_at||e(r).brew_date)]),l(pe,Le)};v(ot,pe=>{(e(r).brew_date||e(r).brewing_started_at)&&pe(mt)})}var qt=s(ot,2);{var ra=pe=>{var Le=Bi(),We=s(a(Le),2),at=s(a(We),2),Mt=a(at,!0);t(at),t(We),t(Le),_(xt=>d(Mt,xt),[()=>re(e(r).fermenting_started_at||e(r).start_time)]),l(pe,Le)};v(qt,pe=>{(e(r).start_time||e(r).fermenting_started_at)&&pe(ra)})}var ta=s(qt,2);{var ha=pe=>{var Le=Fi(),We=s(a(Le),2),at=s(a(We),2),Mt=a(at,!0);t(at),t(We),t(Le),_(xt=>d(Mt,xt),[()=>re(e(r).conditioning_started_at)]),l(pe,Le)};v(ta,pe=>{e(r).conditioning_started_at&&pe(ha)})}var ua=s(ta,2);{var ka=pe=>{var Le=zi(),We=s(a(Le),2),at=s(a(We),2),Mt=a(at,!0);t(at),t(We),t(Le),_(xt=>d(Mt,xt),[()=>re(e(r).completed_at||e(r).end_time)]),l(pe,Le)};v(ua,pe=>{(e(r).end_time||e(r).completed_at)&&pe(ka)})}var ma=s(ua,2);{var wa=pe=>{var Le=Ti(),We=s(a(Le),2),at=a(We),Mt=a(at);t(at);var xt=s(at,2),ct=a(xt,!0);t(xt),t(We),t(Le),_(pt=>{d(Mt,`Packaged (${(e(r).packaging_type||"kegged")??""})`),d(ct,pt)},[()=>re(e(r).packaged_at)]),l(pe,Le)};v(ma,pe=>{e(r).packaged_at&&pe(wa)})}t(Pe),t(ca);var Nt=s(ca,2);El(Nt,{get batch(){return e(r)},onUpdate:pe=>o(r,pe,!0)});var rt=s(Nt,2);ti(rt,{get batch(){return e(r)},onUpdate:pe=>o(r,pe,!0)});var St=s(rt,2);{var _a=pe=>{Va(pe,{get notes(){return e(r).notes}})};v(St,pe=>{e(r).notes&&pe(_a)})}t(Wt),_((pe,Le,We)=>{d(da,pe),d($t,Le),d(st,`${We??""}%`)},[()=>X(e(r).measured_og),()=>X(e(r).measured_fg),()=>e(r).measured_abv?.toFixed(1)??"--"]),l(ht,Wt)},vt=ht=>{var Wt=Ki(),bt=oe(Wt),Dt=a(bt),Xt=a(Dt);{let Pe=I(()=>e(ve)?.sg??e(A)?.measured?.current_sg);Hs(Xt,{get batch(){return e(r)},get currentSg(){return e(Pe)},get progress(){return e(A)},get liveReading(){return e(ve)}})}var Qt=s(Xt,2);{var da=Pe=>{za(Pe,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(Qt,Pe=>{e(r).recipe&&Pe(da)})}t(Dt);var Rt=s(Dt,2),Zt=a(Rt);Ua(Zt,{get batch(){return e(r)},get liveReading(){return e(ve)},onEdit:()=>o(S,!0)});var $t=s(Zt,2);{var ea=Pe=>{Wr(Pe,{get batchId(){return e(r).id}})};v($t,Pe=>{(e(r).status==="fermenting"||e(r).status==="conditioning")&&Pe(ea)})}var Ve=s($t,2);{let Pe=I(()=>e(r).measured_fg??e(A)?.measured?.fg),ot=I(()=>e(ve)?.sg??e(A)?.measured?.current_sg);Or(Ve,{get batchId(){return e(r).id},get batchStatus(){return e(r).status},get measuredOg(){return e(r).measured_og},get measuredFg(){return e(Pe)},get currentSg(){return e(ot)},get liveReading(){return e(ve)}})}var st=s(Ve,2);{var Me=Pe=>{var ot=Ui();let mt;var qt=a(ot);qt.__click=()=>o(Y,!e(Y));var ra=s(a(qt),2),ta=a(ra);{var ha=rt=>{var St=Di();l(rt,St)},ua=rt=>{var St=Ge(),_a=oe(St);{var pe=We=>{var at=Ri();l(We,at)},Le=We=>{var at=Ge(),Mt=oe(at);{var xt=ct=>{var pt=Pi(),Ot=a(pt);t(pt),_(Lt=>d(Ot,`üéØ ${Lt??""}${e(ae)??""}`),[()=>P(e(j).target_temp)]),l(ct,pt)};v(Mt,ct=>{e(Y)&&e(j)&&ct(xt)},!0)}l(We,at)};v(_a,We=>{e(j)?.cooler_state==="on"?We(pe):We(Le,!1)},!0)}l(rt,St)};v(ta,rt=>{e(j)?.heater_state==="on"?rt(ha):rt(ua,!1)})}var ka=s(ta,2);let ma;t(ra),t(qt);var wa=s(qt,2);{var Nt=rt=>{var St=Hi(),_a=oe(St),pe=a(_a);{var Le=ct=>{var pt=Ni(),Ot=a(pt);let Lt;var la=s(Ot,2),It=s(a(la),2);let ia;var ba=a(It,!0);t(It);var pa=s(It,2),ya=a(pa,!0);t(pa),t(la),t(pt),_(()=>{Lt=He(Ot,1,"device-icon-wrap svelte-g5au2j",null,Lt,{active:e(j)?.heater_state==="on"}),ia=He(It,1,"device-state svelte-g5au2j",null,ia,{on:e(j)?.heater_state==="on"}),d(ba,e(j)?.heater_state==="on"?"ON":"OFF"),d(ya,e(r).heater_entity_id)}),l(ct,pt)};v(pe,ct=>{e(r).heater_entity_id&&ct(Le)})}var We=s(pe,2);{var at=ct=>{var pt=Oi(),Ot=a(pt);let Lt;var la=s(Ot,2),It=s(a(la),2);let ia;var ba=a(It,!0);t(It);var pa=s(It,2),ya=a(pa,!0);t(pa),t(la),t(pt),_(()=>{Lt=He(Ot,1,"device-icon-wrap svelte-g5au2j",null,Lt,{active:e(j)?.cooler_state==="on"}),ia=He(It,1,"device-state svelte-g5au2j",null,ia,{on:e(j)?.cooler_state==="on"}),d(ba,e(j)?.cooler_state==="on"?"ON":"OFF"),d(ya,e(r).cooler_entity_id)}),l(ct,pt)};v(We,ct=>{e(r).cooler_entity_id&&ct(at)})}t(_a);var Mt=s(_a,2);{var xt=ct=>{var pt=Gi(),Ot=oe(pt),Lt=a(Ot),la=s(a(Lt),2),It=a(la);t(la),t(Lt);var ia=s(Lt,2),ba=s(a(ia),2),pa=a(ba);t(ba),t(ia),t(Ot);var ya=s(Ot,2);{var $a=Ct=>{var Et=Li(),Gt=s(a(Et),2),fa=a(Gt);t(Gt);var Ga=s(Gt,2);Ga.__click=()=>C(),t(Et),_(as=>{d(fa,`Override active: ${as??""}`),Ga.disabled=e(K)},[()=>e(j).override_state?.toUpperCase()]),l(Ct,Et)};v(ya,Ct=>{e(j).override_active&&Ct($a)})}var Na=s(ya,2),Oa=s(a(Na),2),La=a(Oa);{var es=Ct=>{var Et=Ii(),Gt=oe(Et);Gt.__click=()=>b("heater","on");var fa=s(Gt,2);fa.__click=()=>b("heater","off"),_(()=>{Gt.disabled=e(K),fa.disabled=e(K)}),l(Ct,Et)};v(La,Ct=>{e(r).heater_entity_id&&Ct(es)})}var Ia=s(La,2);{var ts=Ct=>{var Et=Ei(),Gt=oe(Et);Gt.__click=()=>b("cooler","on");var fa=s(Gt,2);fa.__click=()=>b("cooler","off"),_(()=>{Gt.disabled=e(K),fa.disabled=e(K)}),l(Ct,Et)};v(Ia,Ct=>{e(r).cooler_entity_id&&Ct(ts)})}var Ea=s(Ia,2);Ea.__click=()=>C(),t(Oa),t(Na),_((Ct,Et)=>{d(It,`${Ct??""}${e(ae)??""}`),d(pa,`¬±${Et??""}${e(ae)??""}`),Ea.disabled=e(K)},[()=>P(e(j).target_temp),()=>e(j).hysteresis?.toFixed(1)||"--"]),l(ct,pt)};v(Mt,ct=>{e(j)&&ct(xt)})}l(rt,St)};v(wa,rt=>{e(Y)||rt(Nt)})}t(ot),_(()=>{mt=He(ot,1,"info-card temp-control-card svelte-g5au2j",null,mt,{"heater-on":e(j)?.heater_state==="on","cooler-on":e(j)?.cooler_state==="on",collapsed:e(Y)}),ma=He(ka,0,"chevron svelte-g5au2j",null,ma,{rotated:!e(Y)})}),l(Pe,ot)},yt=Pe=>{var ot=Ge(),mt=oe(ot);{var qt=ra=>{var ta=Xi(),ha=s(a(ta),2),ua=a(ha);{var ka=Nt=>{var rt=Vi(),St=a(rt);t(rt),_(()=>d(St,`Heater: ${e(r).heater_entity_id??""}`)),l(Nt,rt)};v(ua,Nt=>{e(r).heater_entity_id&&Nt(ka)})}var ma=s(ua,2);{var wa=Nt=>{var rt=Wi(),St=a(rt);t(rt),_(()=>d(St,`Cooler: ${e(r).cooler_entity_id??""}`)),l(Nt,rt)};v(ma,Nt=>{e(r).cooler_entity_id&&Nt(wa)})}je(2),t(ha),t(ta),l(ra,ta)};v(mt,ra=>{(e(r).heater_entity_id||e(r).cooler_entity_id)&&e(r).status!=="fermenting"&&ra(qt)},!0)}l(Pe,ot)};v(st,Pe=>{e(te)&&(e(r).status==="fermenting"||e(r).status==="conditioning")?Pe(Me):Pe(yt,!1)})}var sa=s(st,2);{var Pt=Pe=>{Va(Pe,{get notes(){return e(r).notes}})};v(sa,Pe=>{e(r).notes&&Pe(Pt)})}t(Rt),t(bt);var Jt=s(bt,2);{var ca=Pe=>{var ot=Ji(),mt=a(ot);Cs(mt,{get batchId(){return e(r).id},get deviceColor(){return e(r).device_id},get originalGravity(){return e(r).measured_og},get controlEvents(){return Z}}),t(ot),l(Pe,ot)};v(Jt,Pe=>{e(r).device_id&&Pe(ca)})}l(ht,Wt)};v(nt,ht=>{e(r).status==="completed"?ht(At):ht(vt,!1)},!0)}l(lt,$e)};v(Ie,lt=>{e(r).status==="brewing"?lt(tt):lt(it,!1)},!0)}l(Ae,we)};v(Ya,Ae=>{e(r).status==="planning"?Ae(Qa):Ae(Za,!1)})}_(()=>{d(U,`#${(e(r).batch_number||"?")??""}`),d(Je,e(r).name||e(r).recipe?.name||"Unnamed Batch"),De.disabled=e($),Ft(De,`color: ${e(E).color??""}; background: ${e(E).bg??""};`),_t!==(_t=e(r).status)&&(De.value=(De.__value=e(r).status)??"",cs(De,e(r).status))}),l(B,me)};v(ut,B=>{e(S)?B(zt):B(q,!1)},!0)}l(Xe,gt)};v(he,Xe=>{e(r)?Xe(ke,!1):Xe(xe)},!0)}l(J,ce)};v(z,J=>{e(Fe)?J(T):J(V,!1)},!0)}l(p,k)};v(ge,p=>{e(ye)?p(Ce):p(Ne,!1)})}t(de);var Be=s(de,2);{var ie=p=>{var k=Qi();k.__click=()=>o(_e,!1),k.__keydown=ke=>ke.key==="Escape"&&o(_e,!1);var z=a(k);z.__click=ke=>ke.stopPropagation(),z.__keydown=ke=>ke.stopPropagation();var T=s(a(z),2),V=a(T);t(T);var J=s(T,2),ce=a(J);ce.__click=()=>o(_e,!1);var he=s(ce,2);he.__click=m;var xe=a(he,!0);t(he),t(J),t(z),t(k),_(()=>{d(V,`Are you sure you want to delete "${(e(r)?.name||"this batch")??""}"? This cannot be undone.`),ce.disabled=e(D),he.disabled=e(D),d(xe,e(D)?"Deleting...":"Delete Batch")}),l(p,k)};v(Be,p=>{e(_e)&&p(ie)})}l(Re,le),Vt(),N()}Yt(["click","change","keydown"]);export{kn as component,xn as universal};
