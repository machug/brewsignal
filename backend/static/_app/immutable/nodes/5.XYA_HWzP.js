import{d as Ft,f as i,s as o,a as n,c as fe,t as ft}from"../chunks/DZ15WIaR.js";import{d as a,g as s,j as t,t as u,a as jt,f as T,i as e,l as M,n as Me,h as wt,s as Ce,p as Xt,o as Zt,c as g,aO as ma,ay as ha,at as ba}from"../chunks/CdgKpHHH.js";import{e as Kt,i as Qt}from"../chunks/Xm3Ul2fO.js";import{i as v}from"../chunks/CiVu40Aa.js";import{h as xa}from"../chunks/DwuO6wC8.js";import{s as mt}from"../chunks/C7rhiFvF.js";import{s as Ee}from"../chunks/CXy9Ft3Z.js";import{s as Qe}from"../chunks/DPM3yeI3.js";import{i as ya,s as ja}from"../chunks/DKHZoZvF.js";import{s as wa,a as ka}from"../chunks/DKl8-VAe.js";import{p as za}from"../chunks/DwekV_SB.js";import{g as Fa}from"../chunks/DHzOlpqF.js";import{W as Ra,X as qa,O as Ca,H as Wt,Y as kt,J as Sa,U as Yt,Z as St}from"../chunks/CxswqFen.js";import{d as yt,e as $t,g as ea,c as zt}from"../chunks/C_yfWKmV.js";import{t as Jt}from"../chunks/BeSckFGa.js";import{B as Ba}from"../chunks/D7c5RjoK.js";import{s as Ma}from"../chunks/DIbSDM2a.js";import{p as ut}from"../chunks/Bdrb6ahB.js";const Ta=!1,Sr=Object.freeze(Object.defineProperty({__proto__:null,prerender:Ta},Symbol.toStringTag,{value:"Module"}));function Da(ue){return ue>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:ue>=-60?{bars:3,color:"var(--positive)",label:"Good"}:ue>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function ta(ue){const l=Math.floor((Date.now()-new Date(ue).getTime())/1e3);if(l<10)return"just now";if(l<60)return`${l}s ago`;const E=Math.floor(l/60);if(E<60)return`${E}m ago`;const X=Math.floor(E/60);return X<24?`${X}h ago`:`${Math.floor(X/24)}d ago`}var Oa=i('<div class="accent-bar svelte-1oyrwd9"></div>'),Pa=i('<span class="card-icon svelte-1oyrwd9"> </span>'),Aa=i('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),Ga=i('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function Rt(ue,l){let E=ut(l,"highlight",3,!1),X=ut(l,"compact",3,!1),N=ut(l,"collapsible",3,!1),p=ut(l,"expanded",3,!1);var U=Ga();let r;var P=a(U);{var f=z=>{var d=Oa();n(z,d)};v(P,z=>{E()&&z(f)})}var H=s(P,2),re=a(H),me=a(re);{var R=z=>{var d=Pa(),j=a(d,!0);t(d),u(()=>o(j,l.icon)),n(z,d)};v(me,z=>{l.icon&&z(R)})}var D=s(me,2),W=a(D,!0);t(D),t(re);var Q=s(re,2);{var $=z=>{var d=Aa();d.__click=function(...O){l.onToggle?.apply(this,O)};var j=a(d);let x;t(d),u(()=>{mt(d,"aria-label",p()?"Collapse":"Expand"),x=Ee(j,0,"expand-icon svelte-1oyrwd9",null,x,{"rotate-180":p()})}),n(z,d)};v(Q,z=>{N()&&l.onToggle&&z($)})}t(H);var _e=s(H,2);let Y;var ee=a(_e);Ma(ee,()=>l.children),t(_e),t(U),u(()=>{r=Ee(U,1,"batch-card svelte-1oyrwd9",null,r,{highlight:E(),compact:X()}),o(W,l.title),Y=Ee(_e,1,"card-content svelte-1oyrwd9",null,Y,{collapsed:N()&&!p()})}),n(ue,U)}Ft(["click"]);var Ea=i('<span class="updated-text svelte-t80j9z"> </span>'),La=i('<div class="hero-divider svelte-t80j9z"></div> <div class="hero-metric temperature svelte-t80j9z"><span class="hero-value svelte-t80j9z"> <span class="hero-unit svelte-t80j9z"> </span></span> <span class="hero-label svelte-t80j9z">Temperature</span></div>',1),Na=i('<div class="remaining-text svelte-t80j9z"> </div>'),Ua=i('<div class="progress-section svelte-t80j9z"><div class="progress-labels svelte-t80j9z"><div class="progress-endpoint start svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">OG</span></div> <div class="progress-current svelte-t80j9z"><span class="current-percent svelte-t80j9z"> </span></div> <div class="progress-endpoint end svelte-t80j9z"><span class="endpoint-value svelte-t80j9z"> </span> <span class="endpoint-label svelte-t80j9z">Target FG</span></div></div> <div class="progress-track svelte-t80j9z"><div class="progress-fill svelte-t80j9z"></div> <div><div class="marker-dot svelte-t80j9z"></div> <div class="marker-value svelte-t80j9z"> </div></div></div> <!></div>'),Ha=i('<div class="metrics-row svelte-t80j9z"><div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">ABV</span></div> <div class="metric svelte-t80j9z"><span class="metric-value svelte-t80j9z"> </span> <span class="metric-label svelte-t80j9z">Attenuation</span></div></div>'),Va=i('<div class="status-row svelte-t80j9z"><div class="live-indicator svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> <span class="status-text svelte-t80j9z">LIVE</span></div> <!></div> <div class="hero-section svelte-t80j9z"><div class="hero-metric gravity svelte-t80j9z"><span class="hero-value svelte-t80j9z"> </span> <span class="hero-label svelte-t80j9z">Gravity</span></div> <!></div> <!> <!>',1),Ia=i('<div class="completed-grid svelte-t80j9z"><div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Original Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Final Gravity</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">ABV</span></div> <div class="completed-metric svelte-t80j9z"><span class="completed-value svelte-t80j9z"> </span> <span class="completed-label svelte-t80j9z">Attenuation</span></div></div>'),Wa=i('<div class="empty-state svelte-t80j9z"><div class="empty-icon svelte-t80j9z">‚óé</div> <p class="empty-text svelte-t80j9z">Set Original Gravity to track fermentation</p></div>');function Ya(ue,l){jt(l,!0);let E=M(()=>l.currentSg??l.progress?.measured?.current_sg),X=M(()=>l.liveReading?.temp??l.progress?.temperature?.current),N=M(()=>l.liveReading?.last_seen),p=M(()=>e(N)?ta(e(N)):null),U=M(ea),r=M(()=>{if(!l.batch.measured_og||!e(E))return null;const R=Math.max(0,(l.batch.measured_og-e(E))*131.25),D=l.batch.measured_og-1,W=D!==0?Math.max(0,Math.min(100,(l.batch.measured_og-e(E))/D*100)):0;return{abv:R,attenuation:W}}),P=M(()=>{const R=l.batch.measured_og,D=l.batch.recipe?.fg;if(!R||!D||!e(E))return null;const W=R-D,Q=R-e(E);return W<=0?null:Math.max(0,Math.min(100,Q/W*100))}),f=M(()=>l.batch.status==="fermenting"||l.batch.status==="conditioning");function H(R){return R==null?"--":yt(R)}function re(R){return R==null?"--":`${R.toFixed(1)}%`}function me(R){return R==null?"--":$t(R)}Rt(ue,{title:"Fermentation",children:(R,D)=>{var W=fe(),Q=T(W);{var $=Y=>{var ee=Va(),z=T(ee),d=s(a(z),2);{var j=S=>{var m=Ea(),_=a(m);t(m),u(()=>o(_,`Updated ${e(p)??""}`)),n(S,m)};v(d,S=>{e(p)&&S(j)})}t(z);var x=s(z,2),O=a(x),le=a(O),C=a(le,!0);t(le),Me(2),t(O);var ne=s(O,2);{var ie=S=>{var m=La(),_=s(T(m),2),q=a(_),A=a(q,!0),V=s(A),te=a(V,!0);t(V),t(q),Me(2),t(_),u(J=>{o(A,J),o(te,e(U))},[()=>me(e(X))]),n(S,m)};v(ne,S=>{e(X)!=null&&S(ie)})}t(x);var Z=s(x,2);{var ge=S=>{var m=Ua(),_=a(m),q=a(_),A=a(q),V=a(A,!0);t(A),Me(2),t(q);var te=s(q,2),J=a(te),ke=a(J);t(J),t(te);var je=s(te,2),Te=a(je),Fe=a(Te,!0);t(Te),Me(2),t(je),t(_);var c=s(_,2),h=a(c),I=s(h,2);let w;var he=s(a(I),2),se=a(he,!0);t(he),t(I),t(c);var be=s(c,2);{var Se=y=>{var b=Na(),B=a(b);t(b),u(ae=>o(B,`${ae??""} points to go`),[()=>l.progress.progress.sg_remaining.toFixed(3)]),n(y,b)};v(be,y=>{l.progress?.progress?.sg_remaining!=null&&l.progress.progress.sg_remaining>0&&y(Se)})}t(m),u((y,b,B,ae)=>{o(V,y),o(ke,`${b??""}%`),o(Fe,B),Qe(h,`width: ${e(P)??""}%`),w=Ee(I,1,"progress-marker svelte-t80j9z",null,w,{"at-start":e(P)<3}),Qe(I,`left: ${e(P)??""}%`),o(se,ae)},[()=>H(l.batch.measured_og),()=>e(P).toFixed(0),()=>H(l.batch.recipe.fg),()=>H(e(E))]),n(S,m)};v(Z,S=>{e(P)!==null&&l.batch.measured_og&&l.batch.recipe?.fg&&S(ge)})}var K=s(Z,2);{var oe=S=>{var m=Ha(),_=a(m),q=a(_),A=a(q,!0);t(q),Me(2),t(_);var V=s(_,2),te=a(V),J=a(te,!0);t(te),Me(2),t(V),t(m),u((ke,je)=>{o(A,ke),o(J,je)},[()=>re(e(r).abv),()=>re(e(r).attenuation)]),n(S,m)};v(K,S=>{e(r)&&S(oe)})}u(S=>o(C,S),[()=>H(e(E))]),n(Y,ee)},_e=Y=>{var ee=fe(),z=T(ee);{var d=x=>{var O=Ia(),le=a(O),C=a(le),ne=a(C,!0);t(C),Me(2),t(le);var ie=s(le,2),Z=a(ie),ge=a(Z,!0);t(Z),Me(2),t(ie);var K=s(ie,2),oe=a(K),S=a(oe,!0);t(oe),Me(2),t(K);var m=s(K,2),_=a(m),q=a(_,!0);t(_),Me(2),t(m),t(O),u((A,V,te,J)=>{o(ne,A),o(ge,V),o(S,te),o(q,J)},[()=>H(l.batch.measured_og),()=>H(l.batch.measured_fg),()=>l.batch.measured_abv!=null?re(l.batch.measured_abv):"--",()=>l.batch.measured_attenuation!=null?re(l.batch.measured_attenuation):"--"]),n(x,O)},j=x=>{var O=Wa();n(x,O)};v(z,x=>{l.batch.measured_og?x(d):x(j,!1)},!0)}n(Y,ee)};v(Q,Y=>{e(E)&&e(f)?Y($):Y(_e,!1)})}n(R,W)},$$slots:{default:!0}}),wt()}var Ja=i('<span class="device-last-seen svelte-1kdxwtz"> </span>'),Xa=i('<div class="signal-bar svelte-1kdxwtz"></div>'),Za=i('<div class="metric-item svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="metric-text svelte-1kdxwtz"> </span></div>'),Ka=i('<div class="metric-item battery svelte-1kdxwtz"><svg class="battery-icon svelte-1kdxwtz" viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="2" y="7" width="18" height="10" rx="2"></rect><rect x="4" y="9" height="6" stroke="none" rx="1"></rect><path d="M20 10v4h2v-4z" stroke="none"></path></svg> <span class="metric-text svelte-1kdxwtz"><!></span></div>'),Qa=i('<div class="device-metrics svelte-1kdxwtz"><!> <!></div>'),$a=i('<div class="device-row svelte-1kdxwtz"><div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!></div> <!>',1),es=i('<div class="device-row svelte-1kdxwtz"><div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <span class="device-last-seen svelte-1kdxwtz">No data</span></div>'),ts=i('<div class="device-info svelte-1kdxwtz"><!></div>'),as=i('<button type="button" class="link-btn svelte-1kdxwtz">Link device</button>'),ss=i('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function rs(ue,l){jt(l,!0);let E=M(()=>l.liveReading?.device_type==="tilt"),X=M(()=>e(E)&&l.liveReading?.rssi?Da(l.liveReading.rssi):null),N=M(()=>l.liveReading?.last_seen?ta(l.liveReading.last_seen):null),p=M(()=>l.liveReading?.battery_percent!=null||l.liveReading?.battery_voltage!=null),U=M(()=>l.liveReading?.battery_percent),r=M(()=>l.liveReading?.battery_voltage),P=M(()=>e(U)?e(U)>50?"var(--positive)":e(U)>20?"#f59e0b":"var(--negative)":"var(--text-muted)"),f=M(()=>{if(!l.liveReading)return l.batch.device_id||"Unknown";const H=l.liveReading.device_type;return H==="tilt"?`${l.liveReading.color} Tilt`:H==="gravitymon"?`GravityMon (${l.liveReading.id})`:H==="ispindel"?`iSpindel (${l.liveReading.id})`:H==="floaty"?`Floaty (${l.liveReading.id})`:l.liveReading.color||l.liveReading.id});Rt(ue,{title:"Tracking Device",compact:!0,children:(H,re)=>{var me=fe(),R=T(me);{var D=Q=>{var $=ts(),_e=a($);{var Y=z=>{var d=$a(),j=T(d),x=a(j),O=s(a(x));t(x);var le=s(x,2);{var C=Z=>{var ge=Ja(),K=a(ge,!0);t(ge),u(()=>o(K,e(N))),n(Z,ge)};v(le,Z=>{e(N)&&Z(C)})}t(j);var ne=s(j,2);{var ie=Z=>{var ge=Qa(),K=a(ge);{var oe=_=>{var q=Za(),A=a(q);Kt(A,20,()=>Array(4),Qt,(J,ke,je)=>{var Te=Xa();u(()=>Qe(Te,`height: ${4+je*2}px; background: ${(je<e(X).bars?e(X).color:"var(--bg-hover)")??""}; opacity: ${je<e(X).bars?1:.4};`)),n(J,Te)}),t(A);var V=s(A,2),te=a(V);t(V),t(q),u(()=>{Qe(V,`color: ${e(X).color??""}`),o(te,`${l.liveReading.rssi??""}dBm`)}),n(_,q)};v(K,_=>{e(X)&&_(oe)})}var S=s(K,2);{var m=_=>{var q=Ka(),A=a(q),V=s(a(A)),te=s(V);t(A);var J=s(A,2),ke=a(J);{var je=Fe=>{var c=ft();u(h=>o(c,`${h??""}%`),[()=>e(U).toFixed(0)]),n(Fe,c)},Te=Fe=>{var c=fe(),h=T(c);{var I=w=>{var he=ft();u(se=>o(he,`${se??""}V`),[()=>e(r).toFixed(2)]),n(w,he)};v(h,w=>{e(r)!=null&&w(I)},!0)}n(Fe,c)};v(ke,Fe=>{e(U)!=null?Fe(je):Fe(Te,!1)})}t(J),t(q),u(()=>{mt(A,"stroke",e(P)),mt(V,"width",(e(U)??50)*.14),mt(V,"fill",e(P)),mt(te,"fill",e(P)),Qe(J,`color: ${e(P)??""}`)}),n(_,q)};v(S,_=>{e(p)&&_(m)})}t(ge),n(Z,ge)};v(ne,Z=>{(e(X)||e(p))&&Z(ie)})}u(()=>o(O,` ${e(f)??""}`)),n(z,d)},ee=z=>{var d=es(),j=a(d),x=s(a(j));t(j),Me(2),t(d),u(()=>o(x,` ${l.batch.device_id??""}`)),n(z,d)};v(_e,z=>{l.liveReading?z(Y):z(ee,!1)})}t($),n(Q,$)},W=Q=>{var $=ss(),_e=s(a($),2);{var Y=ee=>{var z=as();z.__click=function(...d){l.onEdit?.apply(this,d)},n(ee,z)};v(_e,ee=>{l.onEdit&&ee(Y)})}t($),n(Q,$)};v(R,Q=>{l.batch.device_id?Q(D):Q(W,!1)})}n(H,me)},$$slots:{default:!0}}),wt()}Ft(["click"]);const ls=131.25;var ns=i('<span class="yeast-producer svelte-19u9n31"> </span>'),is=i('<span class="yeast-temp svelte-19u9n31"> </span>'),vs=i('<div class="yeast-row recipe svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Recipe</span> <span class="yeast-value muted svelte-19u9n31"> </span></div>'),os=i('<div class="yeast-row actual svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span> <!> <!></div> <!>',1),ds=i('<div class="yeast-row svelte-19u9n31"><span class="yeast-label svelte-19u9n31">Yeast</span> <span class="yeast-value svelte-19u9n31"> </span></div>'),cs=i('<div class="yeast-section svelte-19u9n31"><!></div>'),us=i('<div class="targets-row svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div></div> <!>',1);function _s(ue,l){jt(l,!0);function E(N){return N==null?"--":yt(N)}let X=M(()=>l.recipe.abv!=null?l.recipe.abv:l.recipe.og&&l.recipe.fg?(l.recipe.og-l.recipe.fg)*ls:null);Rt(ue,{title:"Recipe Targets",compact:!0,children:(N,p)=>{var U=us(),r=T(U),P=a(r),f=s(a(P),2),H=a(f,!0);t(f),t(P);var re=s(P,2),me=s(a(re),2),R=a(me,!0);t(me),t(re);var D=s(re,2),W=s(a(D),2),Q=a(W,!0);t(W),t(D),t(r);var $=s(r,2);{var _e=Y=>{var ee=cs(),z=a(ee);{var d=x=>{var O=os(),le=T(O),C=s(a(le),2),ne=a(C,!0);t(C);var ie=s(C,2);{var Z=m=>{var _=ns(),q=a(_);t(_),u(()=>o(q,`(${l.yeastStrain.producer??""})`)),n(m,_)};v(ie,m=>{l.yeastStrain.producer&&m(Z)})}var ge=s(ie,2);{var K=m=>{var _=is(),q=a(_);t(_),u((A,V)=>o(q,`${A??""}-${V??""}¬∞C`),[()=>l.yeastStrain.temp_low.toFixed(0),()=>l.yeastStrain.temp_high.toFixed(0)]),n(m,_)};v(ge,m=>{l.yeastStrain.temp_low&&l.yeastStrain.temp_high&&m(K)})}t(le);var oe=s(le,2);{var S=m=>{var _=vs(),q=s(a(_),2),A=a(q,!0);t(q),t(_),u(()=>o(A,l.recipe.yeast_name)),n(m,_)};v(oe,m=>{l.recipe.yeast_name&&m(S)})}u(()=>o(ne,l.yeastStrain.name)),n(x,O)},j=x=>{var O=fe(),le=T(O);{var C=ne=>{var ie=ds(),Z=s(a(ie),2),ge=a(Z,!0);t(Z),t(ie),u(()=>o(ge,l.recipe.yeast_name)),n(ne,ie)};v(le,ne=>{l.recipe.yeast_name&&ne(C)},!0)}n(x,O)};v(z,x=>{l.yeastStrain?x(d):x(j,!1)})}t(ee),n(Y,ee)};v($,Y=>{(l.yeastStrain||l.recipe.yeast_name)&&Y(_e)})}u((Y,ee,z)=>{o(H,Y),o(R,ee),o(Q,z)},[()=>E(l.recipe.og),()=>E(l.recipe.fg),()=>e(X)!=null?`${e(X).toFixed(1)}%`:"--"]),n(N,U)},$$slots:{default:!0}}),wt()}var gs=i('<p class="notes-content svelte-hkv31i"> </p>');function ps(ue,l){Rt(ue,{title:"Notes",children:(E,X)=>{var N=gs(),p=a(N,!0);t(N),u(()=>o(p,l.notes)),n(E,N)},$$slots:{default:!0}})}var fs=i('<div class="ml-panel loading svelte-1xs394q"><p>Loading predictions...</p></div>'),ms=i('<div class="ml-panel error svelte-1xs394q"><p class="error-text svelte-1xs394q"> </p></div>'),hs=i('<span class="anomaly-reasons svelte-1xs394q"> </span>'),bs=i('<div class="anomaly-banner svelte-1xs394q"><span class="anomaly-icon svelte-1xs394q">‚ö†Ô∏è</span> <div class="anomaly-content svelte-1xs394q"><span class="anomaly-label svelte-1xs394q">Anomaly Detected</span> <!></div></div>'),xs=i('<span class="activity-badge svelte-1xs394q"> </span>'),ys=i('<div class="progress-section svelte-1xs394q"><div class="progress-header svelte-1xs394q"><span class="progress-label svelte-1xs394q">Fermentation Progress</span> <!></div> <div class="fermentation-progress-bar svelte-1xs394q"><div class="fermentation-fill svelte-1xs394q"></div></div> <div class="progress-labels svelte-1xs394q"><span class="og-label svelte-1xs394q"> </span> <span class="progress-percent svelte-1xs394q"> </span> <span class="fg-label svelte-1xs394q"> </span></div></div>'),js=i('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Predicted FG:</span> <span class="value svelte-1xs394q"> </span></div>'),ws=i('<div class="metric svelte-1xs394q"><span class="label svelte-1xs394q">Attenuation:</span> <span class="value attenuation svelte-1xs394q"> </span></div>'),ks=i('<span class="complete-now svelte-1xs394q">Ready now!</span>'),zs=i('<span class="days svelte-1xs394q"> </span>'),Fs=i(" <!>",1),Rs=i('<div class="metric completion-metric svelte-1xs394q"><span class="label svelte-1xs394q">Est. Completion:</span> <span class="value svelte-1xs394q"><!></span></div>'),qs=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Model fit:</span> <span class="model-value svelte-1xs394q"> </span></div>'),Cs=i('<div class="model-metric svelte-1xs394q"><span class="model-label svelte-1xs394q">Data points:</span> <span class="model-value svelte-1xs394q"> </span></div>'),Ss=i('<div><div class="panel-header svelte-1xs394q"><h3 class="panel-title svelte-1xs394q">Fermentation Intelligence</h3> <button type="button" class="reload-btn svelte-1xs394q" title="Recalculate predictions from database history"> </button></div> <!> <!> <div class="metrics svelte-1xs394q"><!> <!> <!> <div class="model-info svelte-1xs394q"><!> <!></div></div></div>'),Bs=i('<div class="ml-panel disabled svelte-1xs394q"><div class="disabled-header svelte-1xs394q"><p class="unavailable-text svelte-1xs394q">ML predictions unavailable</p> <button type="button" class="reload-btn svelte-1xs394q" title="Reload predictions from database"> </button></div> <p class="unavailable-hint svelte-1xs394q"><!></p></div>');function Ms(ue,l){jt(l,!0);let E=ut(l,"measuredOg",3,null),X=ut(l,"currentSg",3,null),N=ut(l,"liveReading",3,null),p=Ce(Xt({available:!1})),U=Ce(!0),r=Ce(!1),P=Ce(null);async function f(){g(U,!0),g(P,null);try{g(p,await Ra(l.batchId),!0)}catch(d){g(P,d instanceof Error?d.message:"Failed to load predictions",!0),console.error("Failed to load ML predictions:",d)}finally{g(U,!1)}}async function H(){g(r,!0),g(P,null);try{const d=await qa(l.batchId);console.log("Reloaded predictions:",d.message),await f()}catch(d){g(P,d instanceof Error?d.message:"Failed to reload predictions",!0),console.error("Failed to reload predictions:",d)}finally{g(r,!1)}}Zt(f);function re(d){return d?new Date(d).toLocaleDateString("en-AU",{month:"short",day:"numeric",year:"numeric"}):"N/A"}function me(d){if(!d)return null;const j=new Date(d),x=new Date,O=j.getTime()-x.getTime();return Math.ceil(O/(1e3*60*60*24))}let R=M(()=>{const d=E()??e(p).predicted_og,j=e(p).predicted_fg,x=X()??N()?.sg;if(!d||!j||!x||d<=j)return null;const O=d-j,C=(d-x)/O*100;return Math.min(100,Math.max(0,C))}),D=M(()=>{const d=E()??e(p).predicted_og,j=X()??N()?.sg;if(!d||!j||d<=1)return null;const x=(d-j)/(d-1)*100;return Math.min(100,Math.max(0,x))}),W=M(()=>{const d=N()?.sg_rate;if(d==null)return null;const j=Math.abs(d);return j>.002?{label:"Very Active",color:"#22c55e",emoji:"üî•"}:j>5e-4?{label:"Active",color:"#84cc16",emoji:"‚ú®"}:j>1e-4?{label:"Slowing",color:"#eab308",emoji:"üê¢"}:{label:"Complete",color:"#6b7280",emoji:"‚úì"}}),Q=M(()=>N()?.is_anomaly??!1),$=M(()=>N()?.anomaly_reasons??[]);var _e=fe(),Y=T(_e);{var ee=d=>{var j=fs();n(d,j)},z=d=>{var j=fe(),x=T(j);{var O=C=>{var ne=ms(),ie=a(ne),Z=a(ie);t(ie),t(ne),u(()=>o(Z,`‚ö†Ô∏è ${e(P)??""}`)),n(C,ne)},le=C=>{var ne=fe(),ie=T(ne);{var Z=K=>{var oe=Ss();let S;var m=a(oe),_=s(a(m),2);_.__click=H;var q=a(_,!0);t(_),t(m);var A=s(m,2);{var V=y=>{var b=bs(),B=s(a(b),2),ae=s(a(B),2);{var De=Le=>{var Je=hs(),xe=a(Je,!0);t(Je),u(Oe=>o(xe,Oe),[()=>e($).join(", ")]),n(Le,Je)};v(ae,Le=>{e($).length>0&&Le(De)})}t(B),t(b),n(y,b)};v(A,y=>{e(Q)&&y(V)})}var te=s(A,2);{var J=y=>{var b=ys(),B=a(b),ae=s(a(B),2);{var De=Ne=>{var tt=xs(),_t=a(tt);t(tt),u(()=>{Qe(tt,`color: ${e(W).color??""}`),o(_t,`${e(W).emoji??""} ${e(W).label??""}`)}),n(Ne,tt)};v(ae,Ne=>{e(W)&&Ne(De)})}t(B);var Le=s(B,2),Je=a(Le);t(Le);var xe=s(Le,2),Oe=a(xe),$e=a(Oe);t(Oe);var Xe=s(Oe,2),it=a(Xe);t(Xe);var Ye=s(Xe,2),et=a(Ye);t(Ye),t(xe),t(b),u((Ne,tt,_t)=>{Qe(Je,`width: ${e(R)??""}%`),o($e,`OG: ${Ne??""}`),o(it,`${tt??""}%`),o(et,`FG: ${_t??""}`)},[()=>yt(E()??e(p).predicted_og??0),()=>e(R).toFixed(0),()=>yt(e(p).predicted_fg??0)]),n(y,b)};v(te,y=>{e(R)!==null&&y(J)})}var ke=s(te,2),je=a(ke);{var Te=y=>{var b=js(),B=s(a(b),2),ae=a(B,!0);t(B),t(b),u(De=>o(ae,De),[()=>yt(e(p).predicted_fg)]),n(y,b)};v(je,y=>{e(p).predicted_fg&&y(Te)})}var Fe=s(je,2);{var c=y=>{var b=ws(),B=s(a(b),2),ae=a(B);t(B),t(b),u(De=>o(ae,`${De??""}%`),[()=>e(D).toFixed(1)]),n(y,b)};v(Fe,y=>{e(D)!==null&&y(c)})}var h=s(Fe,2);{var I=y=>{const b=M(()=>me(e(p).estimated_completion));var B=Rs(),ae=s(a(B),2),De=a(ae);{var Le=xe=>{var Oe=ks();n(xe,Oe)},Je=xe=>{var Oe=Fs(),$e=T(Oe),Xe=s($e);{var it=Ye=>{var et=zs(),Ne=a(et);t(et),u(()=>o(Ne,`(${e(b)??""} ${e(b)===1?"day":"days"})`)),n(Ye,et)};v(Xe,Ye=>{e(b)!==null&&Ye(it)})}u(Ye=>o($e,`${Ye??""} `),[()=>re(e(p).estimated_completion)]),n(xe,Oe)};v(De,xe=>{e(b)!==null&&e(b)<=0?xe(Le):xe(Je,!1)})}t(ae),t(B),n(y,B)};v(h,y=>{e(p).estimated_completion&&y(I)})}var w=s(h,2),he=a(w);{var se=y=>{var b=qs(),B=s(a(b),2),ae=a(B);t(B),t(b),u(De=>o(ae,`${De??""}%`),[()=>(e(p).r_squared*100).toFixed(0)]),n(y,b)};v(he,y=>{e(p).r_squared!==void 0&&y(se)})}var be=s(he,2);{var Se=y=>{var b=Cs(),B=s(a(b),2),ae=a(B,!0);t(B),t(b),u(()=>o(ae,e(p).num_readings)),n(y,b)};v(be,y=>{e(p).num_readings&&y(Se)})}t(w),t(ke),t(oe),u(()=>{S=Ee(oe,1,"ml-panel svelte-1xs394q",null,S,{"has-anomaly":e(Q)}),_.disabled=e(r)||e(U),o(q,e(r)?"Reloading...":"‚Üª Reload")}),n(K,oe)},ge=K=>{var oe=Bs(),S=a(oe),m=s(a(S),2);m.__click=H;var _=a(m,!0);t(m),t(S);var q=s(S,2),A=a(q);{var V=J=>{var ke=ft("Waiting for fermentation to progress (need visible SG drop)");n(J,ke)},te=J=>{var ke=fe(),je=T(ke);{var Te=c=>{var h=ft("Need more fermentation curve data for reliable prediction");n(c,h)},Fe=c=>{var h=fe(),I=T(h);{var w=se=>{var be=ft("Need at least 10 readings to make predictions");n(se,be)},he=se=>{var be=ft("Predictions will appear once fermentation is underway");n(se,be)};v(I,se=>{e(p).reason==="insufficient_data"?se(w):se(he,!1)},!0)}n(c,h)};v(je,c=>{e(p).reason==="insufficient_curve_data"?c(Te):c(Fe,!1)},!0)}n(J,ke)};v(A,J=>{e(p).reason==="insufficient_fermentation_progress"?J(V):J(te,!1)})}t(q),t(oe),u(()=>{m.disabled=e(r)||e(U),o(_,e(r)?"Reloading...":"‚Üª Reload")}),n(K,oe)};v(ie,K=>{e(p).available?K(Z):K(ge,!1)},!0)}n(C,ne)};v(x,C=>{e(P)?C(O):C(le,!1)},!0)}n(d,j)};v(Y,d=>{e(U)?d(ee):d(z,!1)})}n(ue,_e),wt()}Ft(["click"]);var Ts=i('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),Ds=i('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),Os=i('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),Ps=i('<span class="recipe-type svelte-g5au2j"> </span>'),As=i('<a class="recipe-link svelte-g5au2j"> <!></a>'),Gs=i('<div class="batch-timing svelte-g5au2j"> </div>'),Es=i('<div class="batch-timing svelte-g5au2j"> </div>'),Ls=i('<option class="svelte-g5au2j"> </option>'),Ns=i('<span class="chilling-icon svelte-g5au2j">üç∫</span> <h3 class="chilling-title svelte-g5au2j">Ready to Pitch!</h3>',1),Us=i('<span class="chilling-icon svelte-g5au2j">‚ùÑÔ∏è</span> <h3 class="chilling-title svelte-g5au2j">Chilling to Pitch Temperature</h3>',1),Hs=i('<div class="progress-section svelte-g5au2j"><div class="progress-bar svelte-g5au2j"><div class="progress-fill svelte-g5au2j"></div></div> <span class="progress-text svelte-g5au2j"> </span></div>'),Vs=i('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è No cooler configured - set a cooler entity to enable automated chilling</span>'),Is=i('<span class="status-warning svelte-g5au2j">‚ö†Ô∏è Temperature control disabled in settings</span>'),Ws=i('<span class="status-ready svelte-g5au2j">Wort has reached pitch temperature - ready to add yeast!</span>'),Ys=i('<span class="status-active svelte-g5au2j">Cooler will run automatically when temp exceeds target + hysteresis</span>'),Js=i('<div><div class="chilling-header svelte-g5au2j"><!></div> <div class="chilling-content svelte-g5au2j"><div class="temp-display svelte-g5au2j"><div class="temp-current svelte-g5au2j"><span class="temp-label svelte-g5au2j">Current</span> <span class="temp-value svelte-g5au2j"> </span></div> <div class="temp-arrow svelte-g5au2j">‚Üí</div> <div class="temp-target svelte-g5au2j"><span class="temp-label svelte-g5au2j">Target</span> <span class="temp-value svelte-g5au2j"> </span></div></div> <!> <div class="chilling-status svelte-g5au2j"><!></div></div></div>'),Xs=i('<span class="status-badge heater svelte-g5au2j">üî• Heating</span>'),Zs=i('<span class="status-badge cooler svelte-g5au2j">‚ùÑÔ∏è Cooling</span>'),Ks=i('<span class="status-badge idle svelte-g5au2j"> </span>'),Qs=i('<div class="device-status heater svelte-g5au2j"><div>üî•</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Heater</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),$s=i('<div class="device-status cooler svelte-g5au2j"><div>‚ùÑÔ∏è</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Cooler</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),er=i('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">‚ö°</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),tr=i('<button type="button" class="override-btn heat-on svelte-g5au2j">Force Heat ON</button> <button type="button" class="override-btn heat-off svelte-g5au2j">Force Heat OFF</button>',1),ar=i('<button type="button" class="override-btn cool-on svelte-g5au2j">Force Cool ON</button> <button type="button" class="override-btn cool-off svelte-g5au2j">Force Cool OFF</button>',1),sr=i('<div class="control-details svelte-g5au2j"><div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns-grid svelte-g5au2j"><!> <!> <button type="button" class="override-btn auto-mode svelte-g5au2j">Auto Mode</button></div></div>',1),rr=i('<div class="device-status-grid svelte-g5au2j"><!> <!></div> <!>',1),lr=i('<div><button type="button" class="collapsible-header svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="collapse-indicator svelte-g5au2j"><!> <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" class="svelte-g5au2j"></path></svg></div></button> <!></div>'),nr=i('<span class="svelte-g5au2j"> </span>'),ir=i('<span class="svelte-g5au2j"> </span>'),vr=i('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><!> <!> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),or=i('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j" aria-label="Delete batch"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <!> <div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!></div></div>',1),dr=i('<div class="modal-overlay svelte-g5au2j"><div class="modal svelte-g5au2j"><h2 class="modal-title svelte-g5au2j">Delete Batch?</h2> <p class="modal-text svelte-g5au2j"> </p> <div class="modal-actions svelte-g5au2j"><button type="button" class="modal-btn cancel svelte-g5au2j">Cancel</button> <button type="button" class="modal-btn delete svelte-g5au2j"> </button></div></div></div>'),cr=i('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div> <!>',1);function Br(ue,l){jt(l,!0);const E=()=>ka(za,"$page",X),[X,N]=wa();let p=null,U=null,r=Ce(null),P=Ce(null),f=Ce(null);Xt([]);let H=Ce(!0),re=Ce(null),me=Ce(!1),R=Ce(!1),D=Ce(!1),W=Ce(!1),Q=Ce(!1),$=Ce(!1),_e=M(()=>parseInt(E().params.id??"0"));const Y={planning:{label:"Planning",color:"var(--text-secondary)",bg:"var(--bg-elevated)"},fermenting:{label:"Fermenting",color:"#f59e0b",bg:"rgba(245, 158, 11, 0.12)"},conditioning:{label:"Conditioning",color:"#8b5cf6",bg:"rgba(139, 92, 246, 0.12)"},completed:{label:"Completed",color:"var(--positive)",bg:"rgba(34, 197, 94, 0.12)"},archived:{label:"Archived",color:"var(--text-muted)",bg:"var(--bg-elevated)"}},ee=["planning","fermenting","conditioning","completed","archived"];let z=M(()=>e(r)?Y[e(r).status]:Y.planning),d=M(ea),j=M(()=>zt.config.ha_enabled&&zt.config.temp_control_enabled&&(e(r)?.heater_entity_id||e(r)?.cooler_entity_id)),x=M(()=>e(r)?.status==="planning"&&e(r)?.temp_target!=null),O=M(()=>!e(x)||!e(C)?.temp||!e(r)?.temp_target?!1:e(C).temp<=e(r).temp_target),le=M(()=>{if(!e(x)||!e(C)?.temp||!e(r)?.temp_target)return null;const c=e(r).temp_target+30,h=e(C).temp,I=e(r).temp_target;if(h<=I)return 100;if(h>=c)return 0;const w=(c-h)/(c-I)*100;return Math.min(100,Math.max(0,w))}),C=M(()=>{if(!e(r)?.device_id)return null;const c=Jt.tilts.get(e(r).device_id);if(c)return c;const h=e(r).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!h?.[1])return null;const I=h[1].toUpperCase();for(const w of Jt.tilts.values())if(w.color&&w.color.toUpperCase()===I)return w;return null});async function ne(){g(H,!0),g(re,null);try{if(g(r,await Ca(e(_e)),!0),e(r).status==="fermenting"||e(r).status==="conditioning")try{g(P,await Wt(e(_e)),!0)}catch{}if(e(r).heater_entity_id||e(r).cooler_entity_id)try{g(f,await kt(e(_e)),!0)}catch{}}catch(c){g(re,c instanceof Error?c.message:"Failed to load batch",!0)}finally{g(H,!1)}}async function ie(c){if(!(!e(r)||e(R))&&!(c==="conditioning"&&e(r).status==="fermenting"&&!confirm(`üí° Entering Conditioning Phase

Reminder: Adjust target temperature if cold crashing.
Temperature control will continue during conditioning.

Continue?`))){g(R,!0);try{g(r,await Yt(e(r).id,{status:c}),!0),(c==="fermenting"||c==="conditioning")&&g(P,await Wt(e(r).id),!0)}catch(h){console.error("Failed to update status:",h)}finally{g(R,!1)}}}async function Z(c){if(e(r)&&(g(r,await Yt(e(r).id,c),!0),g(me,!1),e(r).heater_entity_id||e(r).cooler_entity_id))try{g(f,await kt(e(r).id),!0)}catch{}}async function ge(){if(e(r)){g(Q,!0);try{await Sa(e(r).id),Fa("/batches")}catch(c){g(re,c instanceof Error?c.message:"Failed to delete batch",!0),g(Q,!1),g(W,!1)}}}async function K(c,h){if(!(!e(r)||e(D))){g(D,!0);try{await St(e(r).id,h,60,c),g(f,await kt(e(r).id),!0)}catch(I){console.error("Failed to set override:",I)}finally{g(D,!1)}}}async function oe(){if(!(!e(r)||e(D))){g(D,!0);try{e(r).heater_entity_id&&await St(e(r).id,null,60,"heater"),e(r).cooler_entity_id&&await St(e(r).id,null,60,"cooler"),g(f,await kt(e(r).id),!0)}catch(c){console.error("Failed to clear overrides:",c)}finally{g(D,!1)}}}function S(){if(p?.readyState===WebSocket.OPEN)return;const h=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;p=new WebSocket(h),p.onmessage=async I=>{try{const w=JSON.parse(I.data);w.type==="control_event"&&w.batch_id===e(_e)&&e(f)&&(w.action==="heat_on"?g(f,{...e(f),heater_state:"on"},!0):w.action==="heat_off"?g(f,{...e(f),heater_state:"off"},!0):w.action==="cool_on"?g(f,{...e(f),cooler_state:"on"},!0):w.action==="cool_off"&&g(f,{...e(f),cooler_state:"off"},!0))}catch{}},p.onclose=()=>{p=null,U=setTimeout(S,3e3)},p.onerror=()=>{p?.close()}}function m(){U&&(clearTimeout(U),U=null),p?.close(),p=null}function _(c){return c==null?"--":$t(c)}function q(c){return c?new Date(c).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"--"}function A(c){if(!c)return"--";const h=new Date(c),w=(new Date().getTime()-h.getTime())/(1e3*60*60);if(w<1)return`${Math.round(w*60)}m`;if(w<24)return`${w.toFixed(1)}h`;const he=w/24;return he<7?`${he.toFixed(1)}d`:`${Math.round(he)}d`}Zt(()=>{ne(),S()}),ma(()=>{m()});var V=cr();xa("g5au2j",c=>{ha(()=>{ba.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var te=T(V),J=s(a(te),2);{var ke=c=>{var h=Ts();n(c,h)},je=c=>{var h=fe(),I=T(h);{var w=se=>{var be=Ds(),Se=s(a(be),2),y=a(Se,!0);t(Se);var b=s(Se,2);b.__click=ne,t(be),u(()=>o(y,e(re))),n(se,be)},he=se=>{var be=fe(),Se=T(be);{var y=B=>{var ae=Os();n(B,ae)},b=B=>{var ae=fe(),De=T(ae);{var Le=xe=>{Ba(xe,{get batch(){return e(r)},onSubmit:Z,onCancel:()=>g(me,!1)})},Je=xe=>{var Oe=or(),$e=T(Oe),Xe=a($e),it=a(Xe),Ye=a(it);t(it);var et=s(it,2),Ne=a(et),tt=a(Ne,!0);t(Ne);var _t=s(Ne,2);{var aa=k=>{var L=As(),de=a(L),ye=s(de);{var pe=ze=>{var Ge=Ps(),Ue=a(Ge);t(Ge),u(()=>o(Ue,`(${e(r).recipe.type??""})`)),n(ze,Ge)};v(ye,ze=>{e(r).recipe.type&&ze(pe)})}t(L),u(()=>{mt(L,"href",`/recipes/${e(r).recipe.id??""}`),o(de,`${e(r).recipe.name??""} `)}),n(k,L)};v(_t,k=>{e(r).recipe&&k(aa)})}var sa=s(_t,2);{var ra=k=>{var L=Gs(),de=a(L);t(L),u((ye,pe)=>o(de,`Started ${ye??""} ¬∑ ${pe??""} ago`),[()=>q(e(r).start_time),()=>A(e(r).start_time)]),n(k,L)},la=k=>{var L=fe(),de=T(L);{var ye=pe=>{var ze=Es(),Ge=a(ze);t(ze),u(Ue=>o(Ge,`Brewed ${Ue??""}`),[()=>q(e(r).brew_date)]),n(pe,ze)};v(de,pe=>{e(r).brew_date&&pe(ye)},!0)}n(k,L)};v(sa,k=>{e(r).start_time?k(ra):k(la,!1)})}t(et),t(Xe);var Bt=s(Xe,2),qt=a(Bt),Ze=a(qt);Ze.__change=k=>ie(k.currentTarget.value),Kt(Ze,21,()=>ee,Qt,(k,L)=>{var de=Ls(),ye=a(de,!0);t(de);var pe={};u(()=>{o(ye,Y[e(L)].label),pe!==(pe=e(L))&&(de.value=(de.__value=e(L))??"")}),n(k,de)}),t(Ze);var Mt;ya(Ze),t(qt);var Tt=s(qt,2);Tt.__click=()=>g(me,!0);var na=s(Tt,2);na.__click=()=>g(W,!0),t(Bt),t($e);var Dt=s($e,2);{var ia=k=>{var L=Js();let de;var ye=a(L),pe=a(ye);{var ze=F=>{var G=Ns();Me(2),n(F,G)},Ge=F=>{var G=Us();Me(2),n(F,G)};v(pe,F=>{e(O)?F(ze):F(Ge,!1)})}t(ye);var Ue=s(ye,2),vt=a(Ue),at=a(vt),gt=s(a(at),2),He=a(gt,!0);t(gt),t(at);var ve=s(at,4),Be=s(a(ve),2),ot=a(Be,!0);t(Be),t(ve),t(vt);var dt=s(vt,2);{var ht=F=>{var G=Hs(),we=a(G),Re=a(we);t(we);var Pe=s(we,2),ce=a(Pe);t(Pe),t(G),u(qe=>{Qe(Re,`width: ${e(le)??""}%`),o(ce,`${qe??""}% to target`)},[()=>Math.round(e(le))]),n(F,G)};v(dt,F=>{e(le)!=null&&!e(O)&&F(ht)})}var Ve=s(dt,2),st=a(Ve);{var bt=F=>{var G=Vs();n(F,G)},xt=F=>{var G=fe(),we=T(G);{var Re=ce=>{var qe=Is();n(ce,qe)},Pe=ce=>{var qe=fe(),rt=T(qe);{var Ke=nt=>{var pt=Ws();n(nt,pt)},lt=nt=>{var pt=Ys();n(nt,pt)};v(rt,nt=>{e(O)?nt(Ke):nt(lt,!1)},!0)}n(ce,qe)};v(we,ce=>{!zt.config.ha_enabled||!zt.config.temp_control_enabled?ce(Re):ce(Pe,!1)},!0)}n(F,G)};v(st,F=>{e(r).cooler_entity_id?F(xt,!1):F(bt)})}t(Ve),t(Ue),t(L),u((F,G)=>{de=Ee(L,1,"chilling-banner svelte-g5au2j",null,de,{ready:e(O)}),o(He,F),o(ot,G)},[()=>e(C)?.temp!=null?_(e(C).temp):"--",()=>e(r).temp_target!=null?_(e(r).temp_target):"--"]),n(k,L)};v(Dt,k=>{e(x)&&k(ia)})}var Ot=s(Dt,2),Ct=a(Ot),Pt=a(Ct);{let k=M(()=>e(C)?.sg??e(P)?.measured?.current_sg);Ya(Pt,{get batch(){return e(r)},get currentSg(){return e(k)},get progress(){return e(P)},get liveReading(){return e(C)}})}var va=s(Pt,2);{var oa=k=>{_s(k,{get recipe(){return e(r).recipe},get yeastStrain(){return e(r).yeast_strain}})};v(va,k=>{e(r).recipe&&k(oa)})}t(Ct);var At=s(Ct,2),Gt=a(At);rs(Gt,{get batch(){return e(r)},get liveReading(){return e(C)},onEdit:()=>g(me,!0)});var Et=s(Gt,2);{let k=M(()=>e(C)?.sg);Ms(Et,{get batchId(){return e(r).id},get measuredOg(){return e(r).measured_og},get currentSg(){return e(k)},get liveReading(){return e(C)}})}var Lt=s(Et,2);{var da=k=>{var L=lr();let de;var ye=a(L);ye.__click=()=>g($,!e($));var pe=s(a(ye),2),ze=a(pe);{var Ge=ve=>{var Be=Xs();n(ve,Be)},Ue=ve=>{var Be=fe(),ot=T(Be);{var dt=Ve=>{var st=Zs();n(Ve,st)},ht=Ve=>{var st=fe(),bt=T(st);{var xt=F=>{var G=Ks(),we=a(G);t(G),u(Re=>o(we,`üéØ ${Re??""}${e(d)??""}`),[()=>_(e(f).target_temp)]),n(F,G)};v(bt,F=>{e($)&&e(f)&&F(xt)},!0)}n(Ve,st)};v(ot,Ve=>{e(f)?.cooler_state==="on"?Ve(dt):Ve(ht,!1)},!0)}n(ve,Be)};v(ze,ve=>{e(f)?.heater_state==="on"?ve(Ge):ve(Ue,!1)})}var vt=s(ze,2);let at;t(pe),t(ye);var gt=s(ye,2);{var He=ve=>{var Be=rr(),ot=T(Be),dt=a(ot);{var ht=F=>{var G=Qs(),we=a(G);let Re;var Pe=s(we,2),ce=s(a(Pe),2);let qe;var rt=a(ce,!0);t(ce);var Ke=s(ce,2),lt=a(Ke,!0);t(Ke),t(Pe),t(G),u(()=>{Re=Ee(we,1,"device-icon-wrap svelte-g5au2j",null,Re,{active:e(f)?.heater_state==="on"}),qe=Ee(ce,1,"device-state svelte-g5au2j",null,qe,{on:e(f)?.heater_state==="on"}),o(rt,e(f)?.heater_state==="on"?"ON":"OFF"),o(lt,e(r).heater_entity_id)}),n(F,G)};v(dt,F=>{e(r).heater_entity_id&&F(ht)})}var Ve=s(dt,2);{var st=F=>{var G=$s(),we=a(G);let Re;var Pe=s(we,2),ce=s(a(Pe),2);let qe;var rt=a(ce,!0);t(ce);var Ke=s(ce,2),lt=a(Ke,!0);t(Ke),t(Pe),t(G),u(()=>{Re=Ee(we,1,"device-icon-wrap svelte-g5au2j",null,Re,{active:e(f)?.cooler_state==="on"}),qe=Ee(ce,1,"device-state svelte-g5au2j",null,qe,{on:e(f)?.cooler_state==="on"}),o(rt,e(f)?.cooler_state==="on"?"ON":"OFF"),o(lt,e(r).cooler_entity_id)}),n(F,G)};v(Ve,F=>{e(r).cooler_entity_id&&F(st)})}t(ot);var bt=s(ot,2);{var xt=F=>{var G=sr(),we=T(G),Re=a(we),Pe=s(a(Re),2),ce=a(Pe);t(Pe),t(Re);var qe=s(Re,2),rt=s(a(qe),2),Ke=a(rt);t(rt),t(qe),t(we);var lt=s(we,2);{var nt=Ae=>{var Ie=er(),We=s(a(Ie),2),ct=a(We);t(We);var It=s(We,2);It.__click=()=>oe(),t(Ie),u(fa=>{o(ct,`Override active: ${fa??""}`),It.disabled=e(D)},[()=>e(f).override_state?.toUpperCase()]),n(Ae,Ie)};v(lt,Ae=>{e(f).override_active&&Ae(nt)})}var pt=s(lt,2),Nt=s(a(pt),2),Ut=a(Nt);{var ga=Ae=>{var Ie=tr(),We=T(Ie);We.__click=()=>K("heater","on");var ct=s(We,2);ct.__click=()=>K("heater","off"),u(()=>{We.disabled=e(D),ct.disabled=e(D)}),n(Ae,Ie)};v(Ut,Ae=>{e(r).heater_entity_id&&Ae(ga)})}var Ht=s(Ut,2);{var pa=Ae=>{var Ie=ar(),We=T(Ie);We.__click=()=>K("cooler","on");var ct=s(We,2);ct.__click=()=>K("cooler","off"),u(()=>{We.disabled=e(D),ct.disabled=e(D)}),n(Ae,Ie)};v(Ht,Ae=>{e(r).cooler_entity_id&&Ae(pa)})}var Vt=s(Ht,2);Vt.__click=()=>oe(),t(Nt),t(pt),u((Ae,Ie)=>{o(ce,`${Ae??""}${e(d)??""}`),o(Ke,`¬±${Ie??""}${e(d)??""}`),Vt.disabled=e(D)},[()=>_(e(f).target_temp),()=>e(f).hysteresis?.toFixed(1)||"--"]),n(F,G)};v(bt,F=>{e(f)&&F(xt)})}n(ve,Be)};v(gt,ve=>{e($)||ve(He)})}t(L),u(()=>{de=Ee(L,1,"info-card temp-control-card svelte-g5au2j",null,de,{"heater-on":e(f)?.heater_state==="on","cooler-on":e(f)?.cooler_state==="on",collapsed:e($)}),at=Ee(vt,0,"chevron svelte-g5au2j",null,at,{rotated:!e($)})}),n(k,L)},ca=k=>{var L=fe(),de=T(L);{var ye=pe=>{var ze=vr(),Ge=s(a(ze),2),Ue=a(Ge);{var vt=He=>{var ve=nr(),Be=a(ve);t(ve),u(()=>o(Be,`Heater: ${e(r).heater_entity_id??""}`)),n(He,ve)};v(Ue,He=>{e(r).heater_entity_id&&He(vt)})}var at=s(Ue,2);{var gt=He=>{var ve=ir(),Be=a(ve);t(ve),u(()=>o(Be,`Cooler: ${e(r).cooler_entity_id??""}`)),n(He,ve)};v(at,He=>{e(r).cooler_entity_id&&He(gt)})}Me(2),t(Ge),t(ze),n(pe,ze)};v(de,pe=>{(e(r).heater_entity_id||e(r).cooler_entity_id)&&e(r).status!=="fermenting"&&pe(ye)},!0)}n(k,L)};v(Lt,k=>{e(j)&&(e(r).status==="fermenting"||e(r).status==="conditioning")?k(da):k(ca,!1)})}var ua=s(Lt,2);{var _a=k=>{ps(k,{get notes(){return e(r).notes}})};v(ua,k=>{e(r).notes&&k(_a)})}t(At),t(Ot),u(()=>{o(Ye,`#${(e(r).batch_number||"?")??""}`),o(tt,e(r).name||e(r).recipe?.name||"Unnamed Batch"),Ze.disabled=e(R),Qe(Ze,`color: ${e(z).color??""}; background: ${e(z).bg??""};`),Mt!==(Mt=e(r).status)&&(Ze.value=(Ze.__value=e(r).status)??"",ja(Ze,e(r).status))}),n(xe,Oe)};v(De,xe=>{e(me)?xe(Le):xe(Je,!1)},!0)}n(B,ae)};v(Se,B=>{e(r)?B(b,!1):B(y)},!0)}n(se,be)};v(I,se=>{e(re)?se(w):se(he,!1)},!0)}n(c,h)};v(J,c=>{e(H)?c(ke):c(je,!1)})}t(te);var Te=s(te,2);{var Fe=c=>{var h=dr();h.__click=()=>g(W,!1);var I=a(h);I.__click=b=>b.stopPropagation();var w=s(a(I),2),he=a(w);t(w);var se=s(w,2),be=a(se);be.__click=()=>g(W,!1);var Se=s(be,2);Se.__click=ge;var y=a(Se,!0);t(Se),t(se),t(I),t(h),u(()=>{o(he,`Are you sure you want to delete "${(e(r)?.name||"this batch")??""}"? This cannot be undone.`),be.disabled=e(Q),Se.disabled=e(Q),o(y,e(Q)?"Deleting...":"Delete Batch")}),n(c,h)};v(Te,c=>{e(W)&&c(Fe)})}n(ue,V),wt(),N()}Ft(["click","change"]);export{Br as component,Sr as universal};
